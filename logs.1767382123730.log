2026-01-02T19:12:28.000000000Z [inf]  Starting Container
2026-01-02T19:12:28.906452011Z [inf]  =========================================
2026-01-02T19:12:28.906510592Z [inf]  =========================================
2026-01-02T19:12:28.906516661Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2026-01-02T19:12:28.906522773Z [inf]  =========================================
2026-01-02T19:12:28.906532277Z [inf]  üìç Working directory: /app/backend
2026-01-02T19:12:28.906542278Z [inf]  üîç Python path: /app/backend
2026-01-02T19:12:28.906547423Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2026-01-02T19:12:30.924756694Z [err]  [2026-01-02 19:12:30 +0000] [1] [INFO] Starting gunicorn 22.0.0
2026-01-02T19:12:30.924763653Z [err]  [2026-01-02 19:12:30 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2026-01-02T19:12:30.924770241Z [err]  [2026-01-02 19:12:30 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2026-01-02T19:12:30.924776588Z [err]  [2026-01-02 19:12:30 +0000] [3] [INFO] Booting worker with pid: 3
2026-01-02T19:12:30.924782402Z [err]  [2026-01-02 19:12:30 +0000] [4] [INFO] Booting worker with pid: 4
2026-01-02T19:12:30.924790791Z [err]  [2026-01-02 19:12:30 +0000] [5] [INFO] Booting worker with pid: 5
2026-01-02T19:12:30.924796953Z [err]  [2026-01-02 19:12:30 +0000] [6] [INFO] Booting worker with pid: 6
2026-01-02T19:12:50.453780697Z [err]  2026-01-02 19:12:47,702 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-02T19:12:50.453792369Z [err]  2026-01-02 19:12:47,702 - server - INFO - üî• Pre-warming connection libraries...
2026-01-02T19:12:50.453800705Z [err]  2026-01-02 19:12:47,704 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-02T19:12:50.453806554Z [err]  2026-01-02 19:12:47,704 - server - INFO - üî• Pre-warming connection libraries...
2026-01-02T19:12:50.453812297Z [err]  2026-01-02 19:12:47,733 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-02T19:12:50.453818646Z [err]  2026-01-02 19:12:47,745 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-02T19:12:50.453823932Z [err]  2026-01-02 19:12:47,856 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-02T19:12:50.453829648Z [err]  2026-01-02 19:12:47,888 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-02T19:12:50.453835251Z [err]  2026-01-02 19:12:47,928 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-02T19:12:50.453843417Z [err]  2026-01-02 19:12:47,928 - server - INFO - üî• Pre-warming connection libraries...
2026-01-02T19:12:50.453849202Z [err]  2026-01-02 19:12:47,959 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-02T19:12:50.453854440Z [err]  2026-01-02 19:12:47,976 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-02T19:12:50.453860131Z [err]  2026-01-02 19:12:48,009 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-02T19:12:50.453865383Z [err]  2026-01-02 19:12:48,024 - server - INFO - ‚úÖ QC agent router loaded
2026-01-02T19:12:50.453870827Z [err]  2026-01-02 19:12:48,049 - server - INFO - ‚úÖ QC agent router loaded
2026-01-02T19:12:50.455324502Z [err]  2026-01-02 19:12:48,229 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-02T19:12:50.455332552Z [err]  2026-01-02 19:12:48,233 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-02T19:12:50.455343670Z [err]  2026-01-02 19:12:48,055 - server - INFO - ‚úÖ QC learning router loaded
2026-01-02T19:12:50.455348566Z [err]  2026-01-02 19:12:48,071 - server - INFO - ‚úÖ QC learning router loaded
2026-01-02T19:12:50.455363576Z [err]  2026-01-02 19:12:48,082 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-02T19:12:50.455368896Z [err]  2026-01-02 19:12:48,141 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-02T19:12:50.455373199Z [err]  2026-01-02 19:12:48,175 - server - INFO - ‚úÖ CRM router loaded
2026-01-02T19:12:50.455378598Z [err]  2026-01-02 19:12:48,186 - server - INFO - ‚úÖ QC agent router loaded
2026-01-02T19:12:50.455383469Z [err]  2026-01-02 19:12:48,192 - server - INFO - ‚úÖ QC test router loaded
2026-01-02T19:12:50.455388909Z [err]  2026-01-02 19:12:48,192 - server - INFO - ‚úÖ CRM router loaded
2026-01-02T19:12:50.455393919Z [err]  2026-01-02 19:12:48,197 - server - INFO - ‚úÖ QC test router loaded
2026-01-02T19:12:50.455399437Z [err]  2026-01-02 19:12:48,206 - server - INFO - ‚úÖ QC learning router loaded
2026-01-02T19:12:50.455405031Z [err]  2026-01-02 19:12:48,214 - server - INFO - ‚úÖ Agent test router loaded
2026-01-02T19:12:50.455410143Z [err]  2026-01-02 19:12:48,219 - server - INFO - ‚úÖ Agent test router loaded
2026-01-02T19:12:50.455415255Z [err]  2026-01-02 19:12:48,227 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-02T19:12:50.455419772Z [err]  2026-01-02 19:12:48,227 - server - INFO - üî• Pre-warming connection libraries...
2026-01-02T19:12:50.455424894Z [err]  2026-01-02 19:12:48,229 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-02T19:12:50.456834614Z [err]  2026-01-02 19:12:48,233 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-02T19:12:50.456845749Z [err]  [2026-01-02 19:12:48 +0000] [6] [INFO] Started server process [6]
2026-01-02T19:12:50.456853191Z [err]  [2026-01-02 19:12:48 +0000] [6] [INFO] Waiting for application startup.
2026-01-02T19:12:50.456860914Z [err]  2026-01-02 19:12:48,252 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-02T19:12:50.456868831Z [err]  [2026-01-02 19:12:48 +0000] [4] [INFO] Started server process [4]
2026-01-02T19:12:50.456875705Z [err]  [2026-01-02 19:12:48 +0000] [4] [INFO] Waiting for application startup.
2026-01-02T19:12:50.456883038Z [err]  2026-01-02 19:12:48,262 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-02T19:12:50.456890162Z [err]  2026-01-02 19:12:48,267 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-02T19:12:50.456897561Z [err]  2026-01-02 19:12:48,315 - server - INFO - ‚úÖ CRM router loaded
2026-01-02T19:12:50.456905048Z [err]  2026-01-02 19:12:48,319 - server - INFO - ‚úÖ QC test router loaded
2026-01-02T19:12:50.456912153Z [err]  2026-01-02 19:12:48,334 - server - INFO - ‚úÖ Agent test router loaded
2026-01-02T19:12:50.456919777Z [err]  2026-01-02 19:12:48,341 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-02T19:12:50.456926657Z [err]  2026-01-02 19:12:48,342 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-02T19:12:50.456934119Z [err]  [2026-01-02 19:12:48 +0000] [3] [INFO] Started server process [3]
2026-01-02T19:12:50.456940998Z [err]  [2026-01-02 19:12:48 +0000] [3] [INFO] Waiting for application startup.
2026-01-02T19:12:50.456947517Z [err]  2026-01-02 19:12:48,363 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-02T19:12:50.456952939Z [err]  2026-01-02 19:12:48,371 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-02T19:12:50.458769431Z [err]  2026-01-02 19:12:48,431 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-02T19:12:50.458776464Z [err]  2026-01-02 19:12:48,474 - server - INFO - ‚úÖ QC agent router loaded
2026-01-02T19:12:50.458780757Z [err]  2026-01-02 19:12:48,495 - server - INFO - ‚úÖ QC learning router loaded
2026-01-02T19:12:50.458785589Z [err]  2026-01-02 19:12:48,605 - server - INFO - ‚úÖ CRM router loaded
2026-01-02T19:12:50.458789544Z [err]  2026-01-02 19:12:48,609 - server - INFO - ‚úÖ QC test router loaded
2026-01-02T19:12:50.458793445Z [err]  2026-01-02 19:12:48,625 - server - INFO - ‚úÖ Agent test router loaded
2026-01-02T19:12:50.458797567Z [err]  2026-01-02 19:12:48,635 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-02T19:12:50.458801219Z [err]  2026-01-02 19:12:48,635 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-02T19:12:50.458806005Z [err]  [2026-01-02 19:12:48 +0000] [5] [INFO] Started server process [5]
2026-01-02T19:12:50.458810292Z [err]  [2026-01-02 19:12:48 +0000] [5] [INFO] Waiting for application startup.
2026-01-02T19:12:50.458814773Z [err]  2026-01-02 19:12:48,663 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-02T19:12:55.666891707Z [err]  2026-01-02 19:12:55,663 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-02T19:12:55.672092078Z [err]  2026-01-02 19:12:55,669 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-02T19:12:55.672102823Z [err]  2026-01-02 19:12:55,669 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-02T19:12:55.672110221Z [err]  2026-01-02 19:12:55,669 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-02T19:12:56.046510109Z [err]  2026-01-02 19:12:56,007 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-02T19:12:56.046536691Z [err]  2026-01-02 19:12:56,012 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-02T19:12:56.046547337Z [err]  2026-01-02 19:12:56,012 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-02T19:12:56.046553089Z [err]  2026-01-02 19:12:56,012 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-02T19:12:56.378063717Z [err]  2026-01-02 19:12:56,372 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-02T19:12:56.378072664Z [err]  2026-01-02 19:12:56,372 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-02T19:12:56.378081746Z [err]  2026-01-02 19:12:56,372 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-02T19:12:56.378091077Z [err]  2026-01-02 19:12:56,372 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-02T19:12:56.463535788Z [err]  2026-01-02 19:12:56,453 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-02T19:12:56.553401845Z [err]  2026-01-02 19:12:56,550 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-02T19:12:56.553408172Z [err]  2026-01-02 19:12:56,551 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-02T19:12:56.553414564Z [err]  [2026-01-02 19:12:56 +0000] [6] [INFO] Application startup complete.
2026-01-02T19:12:56.666829044Z [err]  2026-01-02 19:12:56,664 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-02T19:12:56.666838219Z [err]  2026-01-02 19:12:56,664 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-02T19:12:56.666846395Z [err]  2026-01-02 19:12:56,664 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-02T19:12:56.666851867Z [err]  2026-01-02 19:12:56,664 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-02T19:12:57.094849950Z [err]  2026-01-02 19:12:56,736 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-02T19:12:57.094856406Z [err]  2026-01-02 19:12:56,834 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-02T19:12:57.094863080Z [err]  2026-01-02 19:12:56,835 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-02T19:12:57.094869363Z [err]  [2026-01-02 19:12:56 +0000] [4] [INFO] Application startup complete.
2026-01-02T19:12:57.123092302Z [err]  2026-01-02 19:12:57,114 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-02T19:12:57.243642489Z [err]  2026-01-02 19:12:57,209 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-02T19:12:57.243647812Z [err]  2026-01-02 19:12:57,209 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-02T19:12:57.243653590Z [err]  [2026-01-02 19:12:57 +0000] [3] [INFO] Application startup complete.
2026-01-02T19:12:57.395465871Z [err]  2026-01-02 19:12:57,387 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-02T19:12:57.480708941Z [err]  2026-01-02 19:12:57,477 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-02T19:12:57.480721154Z [err]  2026-01-02 19:12:57,477 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-02T19:12:57.480728087Z [err]  [2026-01-02 19:12:57 +0000] [5] [INFO] Application startup complete.
2026-01-02T19:27:13.164405133Z [inf]  100.64.0.2:59514 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-02T19:27:13.164411320Z [inf]  100.64.0.3:39904 - "POST /api/telnyx/call/outbound HTTP/1.1" 401
2026-01-02T19:27:13.164417773Z [inf]  100.64.0.4:57658 - "POST /api/auth/logout HTTP/1.1" 401
2026-01-02T19:27:13.164424526Z [inf]  100.64.0.5:34996 - "OPTIONS /api/auth/login HTTP/1.1" 200
2026-01-02T19:27:13.440839090Z [inf]  100.64.0.4:57658 - "POST /api/auth/login HTTP/1.1" 200
2026-01-02T19:27:14.463486999Z [inf]  100.64.0.4:57658 - "GET /api/agents HTTP/1.1" 200
2026-01-02T19:27:18.175645731Z [inf]  100.64.0.4:57658 - "GET /api/agents HTTP/1.1" 200
2026-01-02T19:27:37.796497043Z [err]  2026-01-02 19:27:33,667 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-02T19:27:37.796503575Z [err]  2026-01-02 19:27:33,763 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:37.796508205Z [err]  2026-01-02 19:27:33,856 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:37.796512651Z [err]  2026-01-02 19:27:33,879 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:27:37.796516534Z [err]  2026-01-02 19:27:33,879 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2026-01-02T19:27:37.796520154Z [err]  2026-01-02 19:27:33,879 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-02T19:27:37.796524336Z [err]  2026-01-02 19:27:33,879 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-02T19:27:37.796528405Z [err]  2026-01-02 19:27:34,762 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2026-01-02T19:27:37.796533526Z [err]  2026-01-02 19:27:34,765 - telnyx_service - INFO - ‚úÖ Call initiated: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:37.796537267Z [err]  2026-01-02 19:27:34,875 - server - INFO - üìù Created call log: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:37.796540972Z [err]  2026-01-02 19:27:34,875 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-02T19:27:37.796544654Z [err]  2026-01-02 19:27:34,875 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'barge_in_settings': {'enable_verbose_barge_in': True, 'word_count_threshold': 10, 'interruption_prompt': 'The user is speaking for a long time. Interrupt them politely but firmly to acknowledge what they said and guide the conversation back to the goal. start by saying an elongated why whhhhyyyy...'}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2026-01-02T19:27:37.798449009Z [err]  2026-01-02 19:27:35,105 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2026-01-02T19:27:37.798456994Z [err]  2026-01-02 19:27:35,105 - server - INFO -    Client: Address(host='100.64.0.6', port=57920)
2026-01-02T19:27:37.798462117Z [err]  2026-01-02 19:27:35,105 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'PBGrrbgOi5XqlEvrdJMvyw==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'UzaD7AprQbimUByynpoFkQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1767382054879', 'accept-encoding': 'gzip'}
2026-01-02T19:27:37.798472159Z [err]  2026-01-02 19:27:34,875 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-02T19:27:37.798476805Z [err]  2026-01-02 19:27:34,875 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-02T19:27:37.798483359Z [err]  2026-01-02 19:27:34,881 - redis_service - INFO - üì¶ Stored call data in Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (TTL: 3600s)
2026-01-02T19:27:37.798487802Z [err]  2026-01-02 19:27:34,882 - server - INFO - üì¶ Call data stored in Redis and memory
2026-01-02T19:27:37.798492880Z [err]  2026-01-02 19:27:34,882 - server - INFO - üìû Outbound call initiated: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:37.798498086Z [inf]  100.64.0.5:34996 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-02T19:27:37.798502036Z [err]  2026-01-02 19:27:34,948 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-02T19:27:37.798508170Z [err]  2026-01-02 19:27:34,950 - server - WARNING - ‚ö†Ô∏è Call-initiated webhook returned status 530: <!doctype html>
2026-01-02T19:27:37.798512731Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:37.798517555Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:37.798521632Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-02T19:27:37.800610928Z [err]  2026-01-02 19:27:35,105 - server - INFO -    Path: /api/telnyx/audio-stream
2026-01-02T19:27:37.800619131Z [err]  2026-01-02 19:27:35,105 - server - INFO - üîå Incoming Telnyx WebSocket connection
2026-01-02T19:27:37.800624102Z [err]  [2026-01-02 19:27:35 +0000] [6] [INFO] ('100.64.0.6', 57920) - "WebSocket /api/telnyx/audio-stream" [accepted]
2026-01-02T19:27:37.800628453Z [err]  2026-01-02 19:27:35,105 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2026-01-02T19:27:37.800632450Z [err]  [2026-01-02 19:27:35 +0000] [6] [INFO] connection open
2026-01-02T19:27:37.800637280Z [err]  2026-01-02 19:27:35,188 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:37.800641375Z [err]  2026-01-02 19:27:35,188 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '273595cc-4e7c-4154-8653-f5f27f8d4754', 'occurred_at': '2026-01-02T19:27:34.549213Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:37.800645319Z [err]  2026-01-02 19:27:35,188 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:37.800649736Z [err]  2026-01-02 19:27:35,188 - server - INFO - üì® ================================================
2026-01-02T19:27:37.800654293Z [err]  2026-01-02 19:27:35,188 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2026-01-02T19:27:37.800658289Z [inf]  100.64.0.7:61442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:37.802566421Z [err]  2026-01-02 19:27:35,265 - server - INFO - üì¨ Received Telnyx event: connected
2026-01-02T19:27:37.802574150Z [err]  2026-01-02 19:27:35,266 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2026-01-02T19:27:38.774822133Z [err]  2026-01-02 19:27:38,774 - server - INFO - üì¨ Received Telnyx event: start
2026-01-02T19:27:38.774828213Z [err]  2026-01-02 19:27:38,774 - server - INFO - üé¨ Stream started for call: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:38.782896650Z [err]  2026-01-02 19:27:38,776 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:38.782906234Z [err]  2026-01-02 19:27:38,776 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': '5f026c39-3478-4308-8f2a-628c713182c3', 'occurred_at': '2026-01-02T19:27:38.549216Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2026-01-02T19:27:34.549213Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:38.782914914Z [err]  2026-01-02 19:27:38,777 - server - INFO - üéØ Event type: call.answered, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:38.782920098Z [err]  2026-01-02 19:27:38,777 - server - INFO - üì® ================================================
2026-01-02T19:27:38.782926307Z [err]  2026-01-02 19:27:38,777 - server - INFO - ‚úÖ Call answered: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:38.787356391Z [err]  2026-01-02 19:27:38,784 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:38.787364181Z [err]  2026-01-02 19:27:38,785 - server - INFO - ‚úÖ Call data found after 0s wait
2026-01-02T19:27:38.787371355Z [err]  2026-01-02 19:27:38,786 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2026-01-02T19:27:38.787377166Z [err]  2026-01-02 19:27:38,786 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:38.792556347Z [err]  2026-01-02 19:27:38,788 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2026-01-02T19:27:38.792565698Z [err]  2026-01-02 19:27:38,788 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2026-01-02T19:27:39.211870216Z [err]  2026-01-02 19:27:38,899 - server - INFO - ‚úÖ Call log updated
2026-01-02T19:27:39.211882111Z [err]  2026-01-02 19:27:38,900 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-02T19:27:39.211890883Z [err]  2026-01-02 19:27:38,900 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-02T19:27:39.211903064Z [err]  2026-01-02 19:27:38,900 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:27:39.211905601Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:39.211911864Z [err]  2026-01-02 19:27:38,937 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-02T19:27:39.211912079Z [err]  2026-01-02 19:27:38,993 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:39.211916499Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:39.211922510Z [err]  2026-01-02 19:27:38,938 - server - WARNING - ‚ö†Ô∏è Call-started webhook returned status 530: <!doctype html>
2026-01-02T19:27:39.211922621Z [err]  2026-01-02 19:27:39,087 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:39.211927389Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-02T19:27:39.211931687Z [err]  2026-01-02 19:27:39,087 - server - INFO - üîß Creating Telnyx service with user's keys...
2026-01-02T19:27:39.211947228Z [err]  2026-01-02 19:27:39,109 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:27:39.291264877Z [err]  2026-01-02 19:27:39,286 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2026-01-02T19:27:39.291271942Z [err]  2026-01-02 19:27:39,286 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2026-01-02T19:27:39.294561273Z [err]  2026-01-02 19:27:39,292 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:39.297583172Z [err]  2026-01-02 19:27:39,294 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:27:39.297590741Z [err]  2026-01-02 19:27:39,294 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-02T19:27:39.326034230Z [err]  2026-01-02 19:27:39,322 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g/actions/playback_start "HTTP/1.1 200 OK"
2026-01-02T19:27:39.326041949Z [err]  2026-01-02 19:27:39,323 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: q2YBd-nC7A (loop=True, overlay=True)
2026-01-02T19:27:39.326047786Z [err]  2026-01-02 19:27:39,323 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g'
2026-01-02T19:27:39.326054014Z [err]  2026-01-02 19:27:39,323 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:39.392155096Z [err]  2026-01-02 19:27:39,391 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:39.392164731Z [err]  2026-01-02 19:27:39,391 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': '42fc5f74-1b21-4fcd-a2dd-1b2b2e8fb9cb', 'occurred_at': '2026-01-02T19:27:39.009210Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '612615cc-05ad-40bf-a4f7-cca6e8c9de36', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:39.392170775Z [err]  2026-01-02 19:27:39,391 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:39.392176249Z [err]  2026-01-02 19:27:39,391 - server - INFO - üì® ================================================
2026-01-02T19:27:39.394228211Z [inf]  100.64.0.6:12780 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:40.240367615Z [err]  2026-01-02 19:27:40,156 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-02T19:27:40.240372663Z [err]  2026-01-02 19:27:40,156 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-02T19:27:40.240377351Z [err]  2026-01-02 19:27:40,170 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-02T19:27:40.240382200Z [err]  2026-01-02 19:27:40,170 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-02T19:27:40.240388163Z [err]  2026-01-02 19:27:40,171 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-02T19:27:40.263819626Z [err]  2026-01-02 19:27:40,259 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:40.275599214Z [err]  2026-01-02 19:27:40,268 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 96ms
2026-01-02T19:27:40.275606079Z [err]  2026-01-02 19:27:40,268 - server - INFO - ‚úÖ Session created in WebSocket worker
2026-01-02T19:27:40.275610603Z [err]  2026-01-02 19:27:40,268 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2026-01-02T19:27:40.275615007Z [err]  2026-01-02 19:27:40,268 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2026-01-02T19:27:40.275619511Z [err]  2026-01-02 19:27:40,268 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2026-01-02T19:27:40.275623767Z [err]  2026-01-02 19:27:40,270 - server - INFO - ‚úÖ Initialized call_states for v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g with session reference
2026-01-02T19:27:40.283623170Z [err]  2026-01-02 19:27:40,276 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2026-01-02T19:27:40.361747439Z [err]  2026-01-02 19:27:40,358 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2026-01-02T19:27:40.575005752Z [inf]  100.64.0.8:40948 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2026-01-02T19:27:40.830003965Z [err]  2026-01-02 19:27:40,825 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g/actions/record_start "HTTP/1.1 200 OK"
2026-01-02T19:27:40.830011197Z [err]  2026-01-02 19:27:40,827 - server - INFO - üéôÔ∏è Call recording started for v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:40.830016328Z [err]  2026-01-02 19:27:40,827 - server - INFO - üîß Creating call session for v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g...
2026-01-02T19:27:40.830021493Z [err]  2026-01-02 19:27:40,827 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:27:40.830025496Z [err]  2026-01-02 19:27:40,827 - server - INFO - üîß Calling create_call_session() - START
2026-01-02T19:27:40.830029485Z [err]  2026-01-02 19:27:40,827 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-02T19:27:41.265896624Z [err]  2026-01-02 19:27:40,934 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-02T19:27:41.265908359Z [err]  2026-01-02 19:27:40,934 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-02T19:27:41.265921073Z [err]  2026-01-02 19:27:40,883 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:27:41.265937997Z [err]  2026-01-02 19:27:40,884 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:41.265939749Z [err]  2026-01-02 19:27:40,885 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2026-01-02T19:27:41.265951937Z [err]  2026-01-02 19:27:40,885 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:41.265952074Z [err]  2026-01-02 19:27:40,919 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-02T19:27:41.265960990Z [err]  2026-01-02 19:27:40,920 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-02T19:27:41.265971900Z [err]  2026-01-02 19:27:40,934 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-02T19:27:41.265976730Z [err]  2026-01-02 19:27:40,885 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2026-01-02T19:27:41.266036339Z [err]  2026-01-02 19:27:40,862 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2026-01-02T19:27:41.266042292Z [err]  2026-01-02 19:27:40,863 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2026-01-02T19:27:41.266047994Z [err]  2026-01-02 19:27:40,863 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2026-01-02T19:27:41.268457907Z [err]  2026-01-02 19:27:41,027 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:41.268464116Z [err]  2026-01-02 19:27:41,037 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 102ms
2026-01-02T19:27:41.268469935Z [err]  2026-01-02 19:27:41,037 - server - INFO - üîß Calling create_call_session() - COMPLETE
2026-01-02T19:27:41.268476983Z [err]  2026-01-02 19:27:41,037 - server - INFO - ‚úÖ Session object created: CallSession
2026-01-02T19:27:41.268482594Z [err]  2026-01-02 19:27:41,043 - redis_service - INFO - üì¶ Stored call data in Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (TTL: 3600s)
2026-01-02T19:27:41.268487957Z [err]  2026-01-02 19:27:41,043 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2026-01-02T19:27:41.268493494Z [err]  2026-01-02 19:27:41,043 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2026-01-02T19:27:41.268498852Z [err]  2026-01-02 19:27:41,044 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:41.268504423Z [err]  2026-01-02 19:27:41,044 - server - INFO - ü§ñ AI session created for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:41.268510401Z [err]  2026-01-02 19:27:41,044 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': True, 'track_keywords': '', 'expected_commitment': 'not_specified', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2026-01-02T19:27:41.268516476Z [err]  2026-01-02 19:27:41,044 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2026-01-02T19:27:41.268522036Z [err]  2026-01-02 19:27:41,044 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2026-01-02T19:27:41.268527594Z [err]  2026-01-02 19:27:41,044 - server - INFO - üëÇ User speaks first - waiting for user input...
2026-01-02T19:27:41.269152396Z [err]  2026-01-02 19:27:41,044 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2026-01-02T19:27:41.269167170Z [err]  2026-01-02 19:27:41,044 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2026-01-02T19:27:41.269176984Z [err]  2026-01-02 19:27:41,044 - server - INFO - üé§ Voice flow - streaming started via dial command
2026-01-02T19:27:41.269186184Z [err]  2026-01-02 19:27:41,049 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:41.269194258Z [err]  2026-01-02 19:27:41,050 - server - INFO - ü§ê No greeting - waiting for user to speak first
2026-01-02T19:27:41.269200972Z [err]  2026-01-02 19:27:41,050 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2026-01-02T19:27:41.269207132Z [inf]  100.64.0.7:61442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:41.390955079Z [err]  2026-01-02 19:27:41,387 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.347186244Z [err]  2026-01-02 19:27:42,054 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hell' | Generating: False
2026-01-02T19:27:42.347190182Z [err]  2026-01-02 19:27:42,138 - server - INFO - üîç FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2026-01-02T19:27:42.347200833Z [err]  2026-01-02 19:27:42,137 - server - INFO - üî§ RAW TOKENS: ["Hell"‚úì, "o."‚úì, "<end>"‚úì]
2026-01-02T19:27:42.347208837Z [err]  2026-01-02 19:27:42,137 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-02T19:27:42.347216740Z [err]  2026-01-02 19:27:42,137 - server - INFO - üì• FINAL TOKENS: 'Hell o.' (2 tokens)
2026-01-02T19:27:42.347223779Z [err]  2026-01-02 19:27:42,138 - server - INFO - üé§ Soniox final transcript: 'Hell o.'
2026-01-02T19:27:42.347231479Z [err]  2026-01-02 19:27:42,138 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.347265646Z [err]  2026-01-02 19:27:41,889 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.347272264Z [err]  2026-01-02 19:27:42,036 - server - INFO - üî§ RAW TOKENS: ["Hell"?]
2026-01-02T19:27:42.347279056Z [err]  2026-01-02 19:27:42,040 - core_calling_service - INFO - üîä Silence timer reset for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (user started speaking)
2026-01-02T19:27:42.347286305Z [err]  2026-01-02 19:27:42,040 - core_calling_service - INFO - üë§ User started speaking for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.347292849Z [err]  2026-01-02 19:27:42,045 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.347300132Z [err]  2026-01-02 19:27:42,054 - redis_service - INFO - üì¶ Stored call data in Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (TTL: 3600s)
2026-01-02T19:27:42.350389837Z [err]  2026-01-02 19:27:42,138 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.350394384Z [err]  2026-01-02 19:27:42,138 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-02T19:27:42.350399074Z [err]  2026-01-02 19:27:42,139 - server - INFO - ‚è±Ô∏è [19:27:42.139] üìù FINAL TRANSCRIPT RECEIVED: 'Hell o.'
2026-01-02T19:27:42.350403407Z [err]  2026-01-02 19:27:42,139 - server - INFO - ‚è±Ô∏è [19:27:42.139] STT endpoint detection latency: 21ms
2026-01-02T19:27:42.350407633Z [err]  2026-01-02 19:27:42,139 - server - INFO - ‚è±Ô∏è [19:27:42.139] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-02T19:27:42.350411830Z [err]  2026-01-02 19:27:42,139 - server - INFO - ‚è±Ô∏è User spoke at 1767382062.1391132
2026-01-02T19:27:42.350416100Z [err]  2026-01-02 19:27:42,140 - redis_service - INFO - üì¶ Stored call data in Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (TTL: 3600s)
2026-01-02T19:27:42.350420140Z [err]  2026-01-02 19:27:42,140 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-02T19:27:42.350424557Z [err]  2026-01-02 19:27:42,140 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.350428546Z [err]  2026-01-02 19:27:42,140 - server - INFO - ‚úÖ Agent SILENT - User said 2 word(s): 'Hell o.' - Processing...
2026-01-02T19:27:42.350434634Z [err]  2026-01-02 19:27:42,151 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hell o.
2026-01-02T19:27:42.350438537Z [err]  2026-01-02 19:27:42,151 - core_calling_service - INFO - üë§ User stopped speaking for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.350442747Z [err]  2026-01-02 19:27:42,151 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-02T19:27:42.353674259Z [inf]  100.64.0.7:61442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:42.353707621Z [err]  2026-01-02 19:27:42,152 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2026-01-02T19:27:42.353715418Z [err]  2026-01-02 19:27:42,152 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2026-01-02T19:27:42.353720363Z [err]  2026-01-02 19:27:42,152 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-02T19:27:42.353724603Z [err]  2026-01-02 19:27:42,152 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-02T19:27:42.353728740Z [err]  2026-01-02 19:27:42,152 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.353733343Z [err]  2026-01-02 19:27:42,178 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:42.353737699Z [err]  2026-01-02 19:27:42,178 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'a4375fd4-f0d9-408e-8a4c-d3d9295efe92', 'occurred_at': '2026-01-02T19:27:41.729207Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'q2YBd-nC7A', 'start_time': '2026-01-02T19:27:41.729207Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:42.353745713Z [err]  2026-01-02 19:27:42,178 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.353752592Z [err]  2026-01-02 19:27:42,178 - server - INFO - üì® ================================================
2026-01-02T19:27:42.356748451Z [err]  2026-01-02 19:27:42,279 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout: User already spoke, skipping greeting
2026-01-02T19:27:42.356776478Z [err]  2026-01-02 19:27:42,245 - server - INFO - üìù Saved user transcript to database
2026-01-02T19:27:42.356781758Z [err]  2026-01-02 19:27:42,245 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.356785744Z [err]  2026-01-02 19:27:42,246 - core_calling_service - INFO - ‚è±Ô∏è [19:27:42.246] üì• process_user_input() ENTRY - text: 'Hell o....'
2026-01-02T19:27:42.356791070Z [err]  2026-01-02 19:27:42,247 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.356795380Z [err]  2026-01-02 19:27:42,247 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g: User spoke while Silence Greeting was triggering
2026-01-02T19:27:42.356799634Z [err]  2026-01-02 19:27:42,270 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:27:42.356803879Z [err]  2026-01-02 19:27:42,270 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.356807788Z [err]  2026-01-02 19:27:42,279 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.399218454Z [err]  2026-01-02 19:27:42,392 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.399229744Z [err]  2026-01-02 19:27:42,392 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.642990096Z [err]  2026-01-02 19:27:42,635 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-02T19:27:42.642999878Z [err]  2026-01-02 19:27:42,636 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-02T19:27:42.643006983Z [err]  2026-01-02 19:27:42,636 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-02T19:27:42.643012138Z [err]  2026-01-02 19:27:42,636 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-02T19:27:42.643017060Z [err]  2026-01-02 19:27:42,637 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:42.643022254Z [err]  2026-01-02 19:27:42,637 - redis_service - INFO - üì¶ Stored call data in Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (TTL: 3600s)
2026-01-02T19:27:42.643028076Z [err]  2026-01-02 19:27:42,637 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-02T19:27:42.643033391Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - ‚è±Ô∏è [19:27:42.638] ‚è© About to call _process_call_flow_streaming()
2026-01-02T19:27:42.643039021Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - ‚è±Ô∏è [19:27:42.638] üîÄ Agent type: call_flow, calling flow processor...
2026-01-02T19:27:42.643046581Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - ‚è±Ô∏è [19:27:42.638] üîÄ _process_call_flow_streaming() ENTRY
2026-01-02T19:27:42.643052024Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2026-01-02T19:27:42.643058051Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - ‚è±Ô∏è [19:27:42.638] ‚úÖ Node selected, about to process content...
2026-01-02T19:27:42.643063379Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{now}} with Friday, January 2, 2026 at 2:27 PM EST in content
2026-01-02T19:27:42.648760550Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2026-01-02T19:27:42.648770347Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2026-01-02T19:27:42.648775447Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - ‚è±Ô∏è [19:27:42.638] üìÑ About to process content (mode=script, length=1)
2026-01-02T19:27:42.648787095Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{customer_name}} with  in content
2026-01-02T19:27:42.648798773Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-02T19:27:42.648805148Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-02T19:27:42.648812657Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with True in content
2026-01-02T19:27:42.648835805Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-02T19:27:42.648880584Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-02T19:27:42.648888406Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-02T19:27:42.648894041Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-02T19:27:42.648900140Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-02T19:27:42.648905755Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 1 chars) - will return text instantly
2026-01-02T19:27:42.652798146Z [err]  2026-01-02 19:27:42,638 - core_calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2026-01-02T19:27:42.652812605Z [err]  2026-01-02 19:27:42,638 - server - INFO - üì§ Sentence arrived from LLM: ?...
2026-01-02T19:27:42.652823265Z [err]  2026-01-02 19:27:42,638 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 486ms
2026-01-02T19:27:42.652832141Z [err]  2026-01-02 19:27:42,638 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-02T19:27:42.652878700Z [err]  2026-01-02 19:27:42,638 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:42.652886189Z [err]  2026-01-02 19:27:42,639 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2026-01-02T19:27:42.736310191Z [err]  2026-01-02 19:27:42,727 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:42.822955504Z [err]  2026-01-02 19:27:42,814 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:43.458383825Z [err]  2026-01-02 19:27:42,895 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:43.458393432Z [err]  2026-01-02 19:27:42,895 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:W6yNjJUPvV8kFsiND... (active sessions: [])
2026-01-02T19:27:43.458398844Z [err]  2026-01-02 19:27:42,900 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:43.458403756Z [err]  2026-01-02 19:27:42,933 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:27:43.458408471Z [err]  2026-01-02 19:27:42,934 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2026-01-02T19:27:43.458413459Z [err]  2026-01-02 19:27:42,934 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-02T19:27:43.458420102Z [err]  2026-01-02 19:27:42,934 - persistent_tts_service - INFO - üîå [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Establishing persistent TTS WebSocket...
2026-01-02T19:27:43.458424871Z [err]  2026-01-02 19:27:42,934 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-02T19:27:43.458430516Z [err]  2026-01-02 19:27:42,934 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2026-01-02T19:27:43.458435369Z [err]  2026-01-02 19:27:42,934 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2026-01-02T19:27:43.458441486Z [err]  2026-01-02 19:27:43,085 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2026-01-02T19:27:43.464429593Z [err]  2026-01-02 19:27:43,086 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2026-01-02T19:27:43.464437041Z [err]  2026-01-02 19:27:43,086 - persistent_tts_service - INFO - ‚úÖ [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Persistent TTS WebSocket established
2026-01-02T19:27:43.464443542Z [err]  2026-01-02 19:27:43,086 - persistent_tts_service - INFO - üéß [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Audio receiver loop started
2026-01-02T19:27:43.464449250Z [err]  2026-01-02 19:27:43,086 - persistent_tts_service - INFO - üîä [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Comfort noise loop started
2026-01-02T19:27:43.464455279Z [err]  2026-01-02 19:27:43,086 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:43.464461736Z [err]  2026-01-02 19:27:43,086 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2026-01-02T19:27:43.464468373Z [err]  2026-01-02 19:27:43,086 - server - INFO - üîç Persistent TTS lookup: call_id=v3:W6yNjJUPvV8kFsiND..., session=FOUND
2026-01-02T19:27:43.464475330Z [err]  2026-01-02 19:27:43,086 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-02T19:27:43.464481669Z [err]  2026-01-02 19:27:43,086 - server - INFO - üéµ TTS task #1 started at +447ms
2026-01-02T19:27:43.464489353Z [err]  2026-01-02 19:27:43,086 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 934ms
2026-01-02T19:27:43.464496302Z [err]  2026-01-02 19:27:43,086 - core_calling_service - INFO - üì§ Streamed script sentence 1/1: ?...
2026-01-02T19:27:43.464502425Z [err]  2026-01-02 19:27:43,086 - core_calling_service - INFO - üîä Silence tracking reset for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (user responded)
2026-01-02T19:27:43.464508931Z [err]  2026-01-02 19:27:43,086 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-02T19:27:43.466050951Z [err]  2026-01-02 19:27:43,088 - persistent_tts_service - INFO - üé§ [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Streaming sentence #1: ?...
2026-01-02T19:27:43.466064043Z [err]  2026-01-02 19:27:43,089 - persistent_tts_service - INFO - üöÄ [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Sent sentence #1 (NON-BLOCKING) in 0ms
2026-01-02T19:27:43.466089725Z [err]  2026-01-02 19:27:43,086 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2026-01-02T19:27:43.466095579Z [err]  2026-01-02 19:27:43,086 - core_calling_service - INFO - LLM response (0.84s): ?
2026-01-02T19:27:43.466102448Z [err]  2026-01-02 19:27:43,086 - core_calling_service - INFO - Total latency: 0.84s
2026-01-02T19:27:43.466108280Z [err]  2026-01-02 19:27:43,087 - server - INFO - ‚úÖ LLM finished in 935ms, TTS tasks already running in background
2026-01-02T19:27:43.466114999Z [err]  2026-01-02 19:27:43,088 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2026-01-02T19:27:43.466120858Z [err]  2026-01-02 19:27:43,088 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-02T19:27:43.466126796Z [err]  2026-01-02 19:27:43,088 - server - INFO -    1 sentences queued and playing seamlessly
2026-01-02T19:27:43.466133270Z [err]  2026-01-02 19:27:43,088 - persistent_tts_service - INFO - üéµ [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Playback consumer started
2026-01-02T19:27:43.466139042Z [err]  2026-01-02 19:27:43,088 - persistent_tts_service - INFO - üéß [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Audio Receiver Loop STARTED
2026-01-02T19:27:43.466145369Z [err]  2026-01-02 19:27:43,088 - persistent_tts_service - INFO - üíì [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Starting TTS keep-alive loop (every 15s)
2026-01-02T19:27:43.466153713Z [err]  2026-01-02 19:27:43,088 - persistent_tts_service - INFO - üîä [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Starting comfort noise loop
2026-01-02T19:27:43.468657267Z [err]  2026-01-02 19:27:43,089 - persistent_tts_service - INFO - üìä [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2026-01-02T19:27:43.468663249Z [err]  2026-01-02 19:27:43,089 - persistent_tts_service - INFO - üéß [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Receiver processing sentence #1: '?...'
2026-01-02T19:27:43.468669000Z [err]  2026-01-02 19:27:43,089 - persistent_tts_service - INFO - üìä [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] DIAGNOSTIC: queue_latency=0ms, pending_sentences=0, audio_queue=0, interrupted=False
2026-01-02T19:27:43.468674064Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2026-01-02T19:27:43.468678300Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-02T19:27:43.468688968Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 937ms from user stop üöÄ
2026-01-02T19:27:43.468695417Z [err]  2026-01-02 19:27:43,089 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:43.468703358Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-02T19:27:43.468980994Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-02T19:27:43.468999905Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-02T19:27:43.469009069Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2026-01-02T19:27:43.469032497Z [err]  2026-01-02 19:27:43,089 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 935ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-02T19:27:43.472014483Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '?...'
2026-01-02T19:27:43.472027831Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-02T19:27:43.472035662Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-02T19:27:43.472041629Z [err]  2026-01-02 19:27:43,173 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:43.472066717Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 450ms (provider: elevenlabs, websocket: False)
2026-01-02T19:27:43.472072242Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 937ms (user stopped ‚Üí play_audio_url called)
2026-01-02T19:27:43.472078256Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-02T19:27:43.472084597Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-02T19:27:43.472089889Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-02T19:27:43.472096925Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-02T19:27:43.472103140Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-02T19:27:43.472109963Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1237ms estimated
2026-01-02T19:27:43.472117859Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 1 chars, 1 sentences
2026-01-02T19:27:43.472123799Z [err]  2026-01-02 19:27:43,090 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hell o....'
2026-01-02T19:27:43.476592263Z [err]  2026-01-02 19:27:43,280 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-02T19:27:43.476602543Z [err]  2026-01-02 19:27:43,346 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 257ms
2026-01-02T19:27:43.476609301Z [err]  2026-01-02 19:27:43,346 - persistent_tts_service - INFO - üì§ Sending 2956 bytes of audio (19 chunks, 0.4s duration) via WebSocket
2026-01-02T19:27:43.476657932Z [err]  2026-01-02 19:27:43,173 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '5ef1a3c2-cc51-4f50-9539-3c3598c795a5', 'occurred_at': '2026-01-02T19:27:42.629211Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:43.476663748Z [err]  2026-01-02 19:27:43,173 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:43.476670044Z [err]  2026-01-02 19:27:43,173 - server - INFO - üì® ================================================
2026-01-02T19:27:43.476676229Z [inf]  100.64.0.9:44736 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:43.476681948Z [err]  2026-01-02 19:27:43,279 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1395ms)
2026-01-02T19:27:43.476687785Z [err]  2026-01-02 19:27:43,279 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-02T19:27:43.478364662Z [err]  2026-01-02 19:27:43,346 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-02T19:27:43.478369937Z [err]  2026-01-02 19:27:43,346 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.4s (total: 0.4s from now)
2026-01-02T19:27:43.478374891Z [err]  2026-01-02 19:27:43,347 - persistent_tts_service - INFO - ‚úÖ Sent 19 audio chunks via WebSocket
2026-01-02T19:27:43.850434944Z [err]  2026-01-02 19:27:43,848 - persistent_tts_service - INFO - üîá [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] FLOOR RELEASED (is_holding_floor=False)
2026-01-02T19:27:44.334036308Z [err]  2026-01-02 19:27:43,901 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.2s ago), marking agent as done speaking
2026-01-02T19:27:44.334041576Z [err]  2026-01-02 19:27:43,901 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1767382063.9014812 for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:44.334046756Z [err]  2026-01-02 19:27:43,901 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:45.391650032Z [err]  2026-01-02 19:27:45,347 - persistent_tts_service - INFO - ‚úÖ [Call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g] Receiver finished sentence #1: 1 chunks in 2258ms
2026-01-02T19:27:45.391875854Z [inf]  100.64.0.4:57658 - "GET /api/crm/analytics/call/v3%3AW6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g HTTP/1.1" 404
2026-01-02T19:27:45.391881730Z [err]  2026-01-02 19:27:45,347 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2026-01-02T19:27:46.359755902Z [err]  2026-01-02 19:27:45,898 - server - INFO - üì§ Audio flowing: 333 packets sent to Soniox (5s update)
2026-01-02T19:27:50.496855654Z [err]  2026-01-02 19:27:50,425 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=6.5s, checkin_count=0/2
2026-01-02T19:27:51.353343296Z [err]  2026-01-02 19:27:50,902 - server - INFO - üì§ Audio flowing: 583 packets sent to Soniox (5s update)
2026-01-02T19:27:51.353355865Z [err]  2026-01-02 19:27:50,930 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:51.353361423Z [err]  2026-01-02 19:27:50,930 - telnyx_service - INFO - üîä Speaking text on call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g: Are you still there?...
2026-01-02T19:27:51.353367690Z [err]  2026-01-02 19:27:50,930 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-02T19:27:51.353376087Z [err]  2026-01-02 19:27:50,930 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-02T19:27:51.353385959Z [err]  2026-01-02 19:27:50,931 - server - INFO - ‚è±Ô∏è [19:27:50.930] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2026-01-02T19:27:51.353387764Z [err]  2026-01-02 19:27:50,929 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=7.0s, checkin_count=0/2
2026-01-02T19:27:51.353394870Z [err]  2026-01-02 19:27:50,929 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2026-01-02T19:27:51.353402254Z [err]  2026-01-02 19:27:50,930 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-02T19:27:51.353410077Z [err]  2026-01-02 19:27:50,931 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2026-01-02T19:27:51.353412262Z [err]  2026-01-02 19:27:50,930 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2026-01-02T19:27:51.353421800Z [err]  2026-01-02 19:27:50,931 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2026-01-02T19:27:51.353429595Z [err]  2026-01-02 19:27:50,930 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-02T19:27:51.353443796Z [err]  2026-01-02 19:27:50,930 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-02T19:27:51.357591718Z [err]  2026-01-02 19:27:51,017 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:51.357603287Z [err]  2026-01-02 19:27:51,017 - server - INFO - üì¶ ElevenLabs Request Payload:
2026-01-02T19:27:51.357610329Z [err]  2026-01-02 19:27:51,017 - server - INFO -    Text length: 20 chars
2026-01-02T19:27:51.357616913Z [err]  2026-01-02 19:27:51,017 - server - INFO -    Text content: 'Are you still there?'
2026-01-02T19:27:51.357623335Z [err]  2026-01-02 19:27:51,017 - server - INFO -    Text bytes: b'Are you still there?'
2026-01-02T19:27:51.357630682Z [err]  2026-01-02 19:27:51,017 - server - INFO -    Model: eleven_turbo_v2_5
2026-01-02T19:27:51.357637332Z [err]  2026-01-02 19:27:51,017 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2026-01-02T19:27:51.357644619Z [err]  2026-01-02 19:27:51,017 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2026-01-02T19:27:51.357652555Z [err]  2026-01-02 19:27:51,017 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2026-01-02T19:27:51.357660397Z [err]  2026-01-02 19:27:51,017 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2026-01-02T19:27:51.357667762Z [err]  2026-01-02 19:27:51,018 - server - INFO -    Timeout: 10.0s
2026-01-02T19:27:51.357674608Z [err]  2026-01-02 19:27:51,026 - server - INFO -    ‚úì HTTP client created (0.009s)
2026-01-02T19:27:51.357681528Z [err]  2026-01-02 19:27:51,027 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2026-01-02T19:27:51.389489342Z [err]  2026-01-02 19:27:51,385 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2026-01-02T19:27:51.389495570Z [err]  2026-01-02 19:27:51,385 - server - INFO -    ‚úì Connection established (0.367s) [TARGET: <200ms]
2026-01-02T19:27:51.389501404Z [err]  2026-01-02 19:27:51,385 - server - INFO -    ‚úì Response status: 200
2026-01-02T19:27:51.389507604Z [err]  2026-01-02 19:27:51,385 - server - INFO -    ‚Üí Streaming audio chunks...
2026-01-02T19:27:51.407776034Z [err]  2026-01-02 19:27:51,397 - server - INFO -    ‚úì FIRST CHUNK received (0.380s, 1098 bytes) [TARGET: <300ms]
2026-01-02T19:27:51.407780514Z [err]  2026-01-02 19:27:51,399 - server - INFO -    ‚úì ALL CHUNKS received: 33 chunks (0.382s)
2026-01-02T19:27:51.407789187Z [err]  2026-01-02 19:27:51,399 - server - INFO -    ‚úì Total audio size: 17599 bytes
2026-01-02T19:27:51.407794298Z [err]  2026-01-02 19:27:51,399 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2026-01-02T19:27:51.407798834Z [err]  2026-01-02 19:27:51,399 - server - INFO -       - Connection: 367ms
2026-01-02T19:27:51.407803650Z [err]  2026-01-02 19:27:51,399 - server - INFO -       - First chunk: 380ms
2026-01-02T19:27:51.407808897Z [err]  2026-01-02 19:27:51,399 - server - INFO -       - All chunks: 382ms
2026-01-02T19:27:51.407813837Z [err]  2026-01-02 19:27:51,399 - server - INFO -       - Audio generation only: 12ms
2026-01-02T19:27:51.407818594Z [err]  2026-01-02 19:27:51,399 - server - INFO - ‚è±Ô∏è [19:27:51.399] üîä TTS COMPLETE: 468ms, audio_size=17599 bytes
2026-01-02T19:27:51.407823304Z [err]  2026-01-02 19:27:51,400 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2026-01-02T19:27:51.407828945Z [err]  2026-01-02 19:27:51,400 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.47s
2026-01-02T19:27:51.407833098Z [err]  2026-01-02 19:27:51,400 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2026-01-02T19:27:51.407837805Z [err]  2026-01-02 19:27:51,400 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2026-01-02T19:27:51.639181651Z [err]  2026-01-02 19:27:51,634 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g/actions/playback_start "HTTP/1.1 200 OK"
2026-01-02T19:27:51.639201890Z [err]  2026-01-02 19:27:51,635 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.23s
2026-01-02T19:27:51.639213305Z [err]  2026-01-02 19:27:51,635 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.70s
2026-01-02T19:27:51.639221543Z [err]  2026-01-02 19:27:51,635 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2026-01-02T19:27:51.639232538Z [err]  2026-01-02 19:27:51,635 - telnyx_service - INFO - üé¨ Playback ID: hzMMoa0tbA
2026-01-02T19:27:51.639241225Z [err]  2026-01-02 19:27:51,636 - redis_service - INFO - ‚ûï Added playback hzMMoa0tbA to Redis for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:51.639249297Z [err]  2026-01-02 19:27:51,636 - server - INFO - üé¨ Check-in playback ID: hzMMoa0tbA (expected duration: 2.6s)
2026-01-02T19:27:51.639256154Z [err]  2026-01-02 19:27:51,636 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-02T19:27:51.813609391Z [inf]  100.64.0.9:44736 - "GET /api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3 HTTP/1.1" 200
2026-01-02T19:27:52.400681055Z [err]  2026-01-02 19:27:51,885 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2026-01-02T19:27:52.449634496Z [err]  2026-01-02 19:27:52,446 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 650 total packets
2026-01-02T19:27:52.449644843Z [err]  [2026-01-02 19:27:52 +0000] [6] [INFO] connection closed
2026-01-02T19:27:52.459867474Z [err]  2026-01-02 19:27:52,451 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:52.459876450Z [err]  2026-01-02 19:27:52,452 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '2e4006a7-7587-4f22-9227-e842554aaa5a', 'occurred_at': '2026-01-02T19:27:52.229218Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-02T19:27:52.229218Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'q2YBd-nC7A', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:52.459883877Z [err]  2026-01-02 19:27:52,452 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:52.459890739Z [err]  2026-01-02 19:27:52,452 - server - INFO - üì® ================================================
2026-01-02T19:27:52.459896388Z [err]  2026-01-02 19:27:52,453 - redis_service - INFO - ‚ûñ Removed playback q2YBd-nC7A, 1 remaining for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:52.459904443Z [err]  2026-01-02 19:27:52,454 - server - INFO - üîä Redis: Removed playback q2YBd-nC7A, 1 remaining
2026-01-02T19:27:52.459910285Z [inf]  100.64.0.9:44736 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:52.678818065Z [err]  2026-01-02 19:27:52,672 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:52.678823888Z [err]  2026-01-02 19:27:52,672 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '65d56c1a-f12e-408a-8771-f511e9b5c12a', 'occurred_at': '2026-01-02T19:27:52.377133Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '612615cc-05ad-40bf-a4f7-cca6e8c9de36', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:52.678829324Z [err]  2026-01-02 19:27:52,672 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:52.678835397Z [err]  2026-01-02 19:27:52,672 - server - INFO - üì® ================================================
2026-01-02T19:27:52.678841555Z [inf]  100.64.0.7:61442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:52.782447985Z [err]  2026-01-02 19:27:52,776 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:52.782454787Z [err]  2026-01-02 19:27:52,776 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': 'baf1a28f-ddce-41ba-94e4-355b4e2a5011', 'occurred_at': '2026-01-02T19:27:52.189221Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '32.00', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '678', 'skip_packet_count': '16'}, 'outbound': {'packet_count': '658', 'skip_packet_count': '0'}}, 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-02T19:27:52.189221Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2026-01-02T19:27:34.549213Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:52.782460844Z [err]  2026-01-02 19:27:52,776 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:52.782470262Z [err]  2026-01-02 19:27:52,776 - server - INFO - üì® ================================================
2026-01-02T19:27:52.782477395Z [err]  2026-01-02 19:27:52,776 - server - INFO - üìû Call ended: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:52.782483497Z [err]  2026-01-02 19:27:52,776 - server - INFO - üìû Hangup cause: normal_clearing
2026-01-02T19:27:53.751415059Z [err]  2026-01-02 19:27:53,750 - server - INFO - üìù Updated call log: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:53.845847546Z [err]  2026-01-02 19:27:53,844 - server - INFO - ‚úÖ Finalized call log: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g (duration=14s, status=completed)
2026-01-02T19:27:54.508564060Z [err]  2026-01-02 19:27:54,505 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:54.508571764Z [err]  2026-01-02 19:27:54,506 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'accd7d52-3ef2-4ca3-b60a-f59c84492706', 'occurred_at': '2026-01-02T19:27:54.210125Z', 'payload': {'call_control_id': 'v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g', 'call_leg_id': '16c052b8-e811-11f0-b03c-02420aef991f', 'call_session_id': '16bd6b8e-e811-11f0-9395-02420aef991f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-02T19:27:52.292573Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2026-01-02T19:27:52.292573Z', 'recording_id': '5b1e47c3-15a6-4c80-a628-9c7eb63ec797', 'recording_started_at': '2026-01-02T19:27:40.575563Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-02/16c052b8-e811-11f0-b03c-02420aef991f-1767382059660099.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260102%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260102T192754Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=d6213276aa8f0643ae4a27c79ad33c015eb49ccbe66fe43cdf39588953c89816'}, 'start_time': '2026-01-02T19:27:40.575563Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:54.508576099Z [err]  2026-01-02 19:27:54,506 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:54.508580335Z [err]  2026-01-02 19:27:54,506 - server - INFO - üì® ================================================
2026-01-02T19:27:54.508584158Z [err]  2026-01-02 19:27:54,506 - server - INFO - üéôÔ∏è Recording saved for call: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:54.512218072Z [err]  2026-01-02 19:27:54,507 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:54.512226376Z [err]  2026-01-02 19:27:54,509 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=5b1e47c3-15a6-4c80-a628-9c7eb63ec797, call_data=True
2026-01-02T19:27:54.551427739Z [err]  2026-01-02 19:27:54,546 - server - INFO - üìä Auto-added call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2026-01-02T19:27:54.732168828Z [err]  2026-01-02 19:27:54,727 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-02T19:27:54.732177003Z [err]  2026-01-02 19:27:54,729 - redis_service - INFO - üì• Retrieved call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:54.732185345Z [err]  2026-01-02 19:27:54,729 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2026-01-02T19:27:54.732193528Z [err]  2026-01-02 19:27:54,730 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2026-01-02T19:27:54.778464862Z [err]  2026-01-02 19:27:54,775 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-02T19:27:54.778478388Z [err]  2026-01-02 19:27:54,776 - server - WARNING - ‚ö†Ô∏è Post-call webhook returned status 530: <!doctype html>
2026-01-02T19:27:54.778485771Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:54.778491320Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:54.778497506Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-02T19:27:54.828619730Z [err]  2026-01-02 19:27:54,823 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2026-01-02T19:27:55.410414170Z [err]  2026-01-02 19:27:54,912 - redis_service - INFO - üßπ Deleted call data from Redis: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.410429458Z [err]  2026-01-02 19:27:54,912 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.410441462Z [inf]  100.64.0.10:19732 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:55.410450369Z [err]  2026-01-02 19:27:54,913 - server - INFO - üîç Starting QC analysis for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.410458821Z [err]  2026-01-02 19:27:54,914 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2026-01-02T19:27:55.410691570Z [err]  2026-01-02 19:27:54,910 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2026-01-02T19:27:55.410697429Z [err]  2026-01-02 19:27:54,910 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2026-01-02T19:27:55.410701276Z [err]  2026-01-02 19:27:54,910 - server - INFO - üìá [HANGUP] Agent info keys: None
2026-01-02T19:27:55.410705800Z [err]  2026-01-02 19:27:54,911 - server - INFO - üöÄ Triggered QC analysis for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.410709862Z [err]  2026-01-02 19:27:54,911 - server - INFO - üìä Triggered Campaign QC for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.410713961Z [err]  2026-01-02 19:27:54,911 - server - INFO - üìá Triggered CRM update for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.410717591Z [err]  2026-01-02 19:27:54,911 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.414305995Z [err]  2026-01-02 19:27:54,916 - server - INFO - üìá CRM update starting for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:27:55.414318686Z [err]  2026-01-02 19:27:54,916 - server - INFO - üìá Normalized phone: +17708336397
2026-01-02T19:27:55.414325456Z [err]  2026-01-02 19:27:55,016 - server - INFO - üìù Converted transcript from 2 messages to 26 characters
2026-01-02T19:27:55.414331044Z [err]  2026-01-02 19:27:55,105 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:55.414336782Z [err]  2026-01-02 19:27:55,193 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2026-01-02T19:27:55.414342847Z [err]  2026-01-02 19:27:55,280 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2026-01-02T19:27:55.414348129Z [err]  2026-01-02 19:27:55,280 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:27:55.414354613Z [err]  2026-01-02 19:27:55,280 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:55.414361406Z [err]  2026-01-02 19:27:55,293 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-02T19:27:55.414367532Z [err]  2026-01-02 19:27:55,376 - server - INFO - üíæ Saved recording URL and ID to database: 5b1e47c3-15a6-4c80-a628-9c7eb63ec797
2026-01-02T19:27:55.414372968Z [err]  2026-01-02 19:27:55,376 - server - INFO - ‚úÖ Entering dual-channel processing
2026-01-02T19:27:55.414378770Z [err]  2026-01-02 19:27:55,376 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2026-01-02T19:27:55.414384313Z [err]  2026-01-02 19:27:55,391 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:55.473431078Z [err]  2026-01-02 19:27:55,469 - server - INFO - üìá CRM: Total variables collected: []
2026-01-02T19:27:55.489942901Z [err]  2026-01-02 19:27:55,484 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:27:55.498079742Z [err]  2026-01-02 19:27:55,495 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=2, logs_count=4, status=completed
2026-01-02T19:27:55.516813220Z [err]  2026-01-02 19:27:55,510 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:27:55.516819299Z [err]  2026-01-02 19:27:55,511 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2026-01-02T19:27:55.516825616Z [err]  2026-01-02 19:27:55,511 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-02T19:27:55.516831386Z [err]  2026-01-02 19:27:55,511 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-02T19:27:55.555126646Z [inf]  100.64.0.11:33300 - "GET /api/crm/analytics/call/v3%3AW6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g HTTP/1.1" 404
2026-01-02T19:27:55.654410190Z [err]  2026-01-02 19:27:55,645 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2026-01-02T19:27:55.772801719Z [err]  2026-01-02 19:27:55,760 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-02/16c052b8-e811-11f0-b03c-02420aef991f-1767382059660099.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260102%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260102T192754Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=d6213276aa8f0643ae4a27c79ad33c015eb49ccbe66fe43cdf39588953c89816 "HTTP/1.1 200 OK"
2026-01-02T19:27:55.854856030Z [err]  2026-01-02 19:27:55,844 - server - INFO - ‚úÖ Downloaded 47063 bytes
2026-01-02T19:27:56.422754264Z [err]  2026-01-02 19:27:55,934 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2026-01-02T19:27:56.422762177Z [err]  2026-01-02 19:27:56,024 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2026-01-02T19:27:56.422768731Z [err]  2026-01-02 19:27:56,024 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2026-01-02T19:27:56.422775102Z [err]  2026-01-02 19:27:56,024 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-02T19:27:56.422800712Z [err]  2026-01-02 19:27:56,027 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2026-01-02T19:27:56.422807407Z [err]    File "/app/backend/server.py", line 9803, in trigger_campaign_qc_for_call
2026-01-02T19:27:56.422814300Z [err]      await run_full_qc_analysis(
2026-01-02T19:27:56.422821457Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2026-01-02T19:27:56.422828349Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-02T19:27:56.422834863Z [err]  
2026-01-02T19:27:56.422842119Z [err]  2026-01-02 19:27:56,092 - server - INFO - ‚úÖ Split into 2 channels
2026-01-02T19:27:56.425304864Z [err]  2026-01-02 19:27:56,093 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2026-01-02T19:27:56.425317436Z [err]  2026-01-02 19:27:56,094 - server - INFO - üìä Channel 0: 255244 bytes
2026-01-02T19:27:56.425323154Z [err]  2026-01-02 19:27:56,094 - server - ERROR - ‚ùå No Soniox API key available
2026-01-02T19:27:56.425329731Z [err]  2026-01-02 19:27:56,095 - server - INFO - ‚ùå Channel 0: No speech
2026-01-02T19:27:56.426860808Z [err]  2026-01-02 19:27:56,095 - server - INFO - üìä Channel 1: 255244 bytes
2026-01-02T19:27:56.426871430Z [err]  2026-01-02 19:27:56,096 - server - ERROR - ‚ùå No Soniox API key available
2026-01-02T19:27:56.426877897Z [err]  2026-01-02 19:27:56,097 - server - INFO - ‚ùå Channel 1: No speech
2026-01-02T19:27:56.426884560Z [err]  2026-01-02 19:27:56,098 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2026-01-02T19:27:56.426891238Z [inf]  100.64.0.8:40948 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:56.426898074Z [err]  2026-01-02 19:27:56,201 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2026-01-02T19:27:56.426904477Z [err]  2026-01-02 19:27:56,202 - telnyx_service - INFO - ‚úÖ Call initiated: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:27:56.426912233Z [err]  2026-01-02 19:27:56,299 - server - INFO - üìù Created call log: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:27:56.426919071Z [err]  2026-01-02 19:27:56,299 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-02T19:27:56.426943536Z [err]  2026-01-02 19:27:56,299 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'barge_in_settings': {'enable_verbose_barge_in': True, 'word_count_threshold': 10, 'interruption_prompt': 'The user is speaking for a long time. Interrupt them politely but firmly to acknowledge what they said and guide the conversation back to the goal. start by saying an elongated why whhhhyyyy...'}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2026-01-02T19:27:56.427246740Z [err]  2026-01-02 19:27:56,299 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-02T19:27:56.427253647Z [err]  2026-01-02 19:27:56,299 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-02T19:27:56.427259993Z [err]  2026-01-02 19:27:56,306 - redis_service - INFO - üì¶ Stored call data in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (TTL: 3600s)
2026-01-02T19:27:56.427266137Z [err]  2026-01-02 19:27:56,306 - server - INFO - üì¶ Call data stored in Redis and memory
2026-01-02T19:27:56.427272561Z [err]  2026-01-02 19:27:56,306 - server - INFO - üìû Outbound call initiated: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:27:56.427279947Z [inf]  100.64.0.11:33296 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-02T19:27:56.427285956Z [err]  2026-01-02 19:27:56,339 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-02T19:27:56.427292805Z [err]  2026-01-02 19:27:56,340 - server - WARNING - ‚ö†Ô∏è Call-initiated webhook returned status 530: <!doctype html>
2026-01-02T19:27:56.427299092Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:56.427305301Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:27:56.427310871Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-02T19:27:56.427316764Z [inf]  100.64.0.9:44736 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:27:56.427322487Z [err]  2026-01-02 19:27:56,363 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:27:56.427328191Z [err]  2026-01-02 19:27:56,363 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '565418c0-26a1-4167-9dbc-8f8ff45bcf50', 'occurred_at': '2026-01-02T19:27:56.103970Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:27:56.428782357Z [err]  [2026-01-02 19:27:56 +0000] [5] [INFO] ('100.64.0.8', 56908) - "WebSocket /api/telnyx/audio-stream" [accepted]
2026-01-02T19:27:56.428793016Z [err]  2026-01-02 19:27:56,411 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2026-01-02T19:27:56.428794220Z [err]  2026-01-02 19:27:56,363 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:27:56.428800424Z [err]  [2026-01-02 19:27:56 +0000] [5] [INFO] connection open
2026-01-02T19:27:56.428804880Z [err]  2026-01-02 19:27:56,363 - server - INFO - üì® ================================================
2026-01-02T19:27:56.428811645Z [err]  2026-01-02 19:27:56,363 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2026-01-02T19:27:56.428817947Z [err]  2026-01-02 19:27:56,411 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2026-01-02T19:27:56.428825725Z [err]  2026-01-02 19:27:56,411 - server - INFO -    Client: Address(host='100.64.0.8', port=56908)
2026-01-02T19:27:56.428836987Z [err]  2026-01-02 19:27:56,411 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '6QqRIUbsQv6TiR1dBBeBEw==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'Iro4OgT8RLmVRalz0_TJvA', 'x-real-ip': '192.76.120.151', 'x-request-start': '1767382076177', 'accept-encoding': 'gzip'}
2026-01-02T19:27:56.428843452Z [err]  2026-01-02 19:27:56,411 - server - INFO -    Path: /api/telnyx/audio-stream
2026-01-02T19:27:56.428850064Z [err]  2026-01-02 19:27:56,411 - server - INFO - üîå Incoming Telnyx WebSocket connection
2026-01-02T19:27:56.530872857Z [err]  2026-01-02 19:27:56,528 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-02T19:27:56.534935359Z [err]  2026-01-02 19:27:56,531 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:27:56.534941849Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:27:56.534948300Z [err]  2026-01-02 19:27:56,531 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:27:56.534955678Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-02T19:27:56.536718051Z [err]  2026-01-02 19:27:56,533 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:56.583918261Z [err]  2026-01-02 19:27:56,578 - server - INFO - üì¨ Received Telnyx event: connected
2026-01-02T19:27:56.583928143Z [err]  2026-01-02 19:27:56,579 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2026-01-02T19:27:57.852849085Z [err]  2026-01-02 19:27:57,787 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-02T19:27:57.852856562Z [err]  2026-01-02 19:27:57,788 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:27:57.852864015Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:27:57.852870845Z [err]  2026-01-02 19:27:57,788 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:27:57.852878016Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-02T19:27:57.852885829Z [err]  2026-01-02 19:27:57,788 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:58.541246607Z [err]  2026-01-02 19:27:58,536 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-02T19:27:58.541256377Z [err]  2026-01-02 19:27:58,536 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:27:58.541262760Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:27:58.541269157Z [err]  2026-01-02 19:27:58,537 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:27:58.541275313Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:27:58.639031453Z [err]  2026-01-02 19:27:58,631 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:58.639041143Z [err]  2026-01-02 19:27:58,631 - server - INFO - ‚úÖ QC analysis completed for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:58.639047314Z [err]  2026-01-02 19:27:58,631 - server - INFO - üìä Scores: Commitment=50, Conversion=0, Excellence=50
2026-01-02T19:27:58.837854988Z [err]  2026-01-02 19:27:58,820 - server - INFO - üìä Updated campaign_calls with QC scores for v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:27:59.307238743Z [err]  2026-01-02 19:27:59,000 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2026-01-02T19:27:59.307245442Z [err]  2026-01-02 19:27:59,089 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2026-01-02T19:27:59.307251607Z [err]  2026-01-02 19:27:59,089 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g: 'str' object has no attribute 'get'
2026-01-02T19:28:00.655852079Z [err]  2026-01-02 19:28:00,183 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:00.655858676Z [err]  2026-01-02 19:28:00,454 - server - INFO - üì¨ Received Telnyx event: start
2026-01-02T19:28:00.655865300Z [err]  2026-01-02 19:28:00,454 - server - INFO - üé¨ Stream started for call: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:00.655872872Z [err]  2026-01-02 19:28:00,462 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:00.655879501Z [err]  2026-01-02 19:28:00,463 - server - INFO - ‚úÖ Call data found after 0s wait
2026-01-02T19:28:00.655929775Z [err]  2026-01-02 19:28:00,463 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2026-01-02T19:28:00.655952575Z [err]  2026-01-02 19:28:00,473 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:00.655967384Z [err]  2026-01-02 19:28:00,473 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'cd7c444d-eeb2-4f5e-9413-ee7947ea0938', 'occurred_at': '2026-01-02T19:28:00.223970Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2026-01-02T19:27:56.103970Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:00.655978263Z [err]  2026-01-02 19:28:00,473 - server - INFO - üéØ Event type: call.answered, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:00.656003808Z [err]  2026-01-02 19:28:00,473 - server - INFO - üì® ================================================
2026-01-02T19:28:00.659470943Z [err]  2026-01-02 19:28:00,473 - server - INFO - ‚úÖ Call answered: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:00.659491172Z [err]  2026-01-02 19:28:00,479 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:00.659497535Z [err]  2026-01-02 19:28:00,481 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2026-01-02T19:28:00.659502963Z [err]  2026-01-02 19:28:00,481 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2026-01-02T19:28:00.659507863Z [err]  2026-01-02 19:28:00,581 - server - INFO - ‚úÖ Call log updated
2026-01-02T19:28:00.659513108Z [err]  2026-01-02 19:28:00,581 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-02T19:28:00.659517474Z [err]  2026-01-02 19:28:00,581 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-02T19:28:00.659522203Z [err]  2026-01-02 19:28:00,581 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:28:00.659526676Z [err]  2026-01-02 19:28:00,623 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-02T19:28:00.659531758Z [err]  2026-01-02 19:28:00,624 - server - WARNING - ‚ö†Ô∏è Call-started webhook returned status 530: <!doctype html>
2026-01-02T19:28:00.659536232Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:28:00.659541808Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:28:00.659548624Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-02T19:28:00.677190817Z [err]  2026-01-02 19:28:00,674 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:00.695336546Z [err]  2026-01-02 19:28:00,686 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:00.773331746Z [err]  2026-01-02 19:28:00,767 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:00.773338205Z [err]  2026-01-02 19:28:00,767 - server - INFO - üîß Creating Telnyx service with user's keys...
2026-01-02T19:28:00.813223672Z [err]  2026-01-02 19:28:00,807 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:28:00.904547769Z [err]  2026-01-02 19:28:00,892 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:00.904557461Z [err]  2026-01-02 19:28:00,892 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': '5cee8db8-192c-419e-bbe5-e3578e779994', 'occurred_at': '2026-01-02T19:28:00.603963Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '574b9b21-163d-400c-8adb-5f28efa1ae58', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:00.904563260Z [err]  2026-01-02 19:28:00,892 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:00.904568690Z [err]  2026-01-02 19:28:00,892 - server - INFO - üì® ================================================
2026-01-02T19:28:00.904574391Z [inf]  100.64.0.7:29836 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:01.548569569Z [err]  2026-01-02 19:28:00,963 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2026-01-02T19:28:01.548579804Z [err]  2026-01-02 19:28:01,283 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:01.548581215Z [err]  2026-01-02 19:28:00,963 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2026-01-02T19:28:01.548586987Z [err]  2026-01-02 19:28:01,283 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'ee25fa25-d554-4a08-bd75-91bc663859c3', 'occurred_at': '2026-01-02T19:28:01.003965Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'W4f2SKoDiA', 'start_time': '2026-01-02T19:28:01.003965Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:01.548591054Z [err]  2026-01-02 19:28:00,988 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.548598191Z [err]  2026-01-02 19:28:00,990 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:28:01.548605008Z [err]  2026-01-02 19:28:00,990 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-02T19:28:01.548616932Z [err]  2026-01-02 19:28:01,032 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA/actions/playback_start "HTTP/1.1 200 OK"
2026-01-02T19:28:01.548626157Z [err]  2026-01-02 19:28:01,032 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: W4f2SKoDiA (loop=True, overlay=True)
2026-01-02T19:28:01.548632327Z [err]  2026-01-02 19:28:01,033 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA'
2026-01-02T19:28:01.548637245Z [err]  2026-01-02 19:28:01,033 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.552056095Z [err]  2026-01-02 19:28:01,283 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.552061091Z [err]  2026-01-02 19:28:01,283 - server - INFO - üì® ================================================
2026-01-02T19:28:01.552066207Z [inf]  100.64.0.8:40948 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:01.552073505Z [err]  2026-01-02 19:28:01,523 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA/actions/record_start "HTTP/1.1 200 OK"
2026-01-02T19:28:01.552078921Z [err]  2026-01-02 19:28:01,525 - server - INFO - üéôÔ∏è Call recording started for v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.552084071Z [err]  2026-01-02 19:28:01,525 - server - INFO - üîß Creating call session for v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA...
2026-01-02T19:28:01.552090181Z [err]  2026-01-02 19:28:01,525 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:28:01.552095018Z [err]  2026-01-02 19:28:01,525 - server - INFO - üîß Calling create_call_session() - START
2026-01-02T19:28:01.552100370Z [err]  2026-01-02 19:28:01,525 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-02T19:28:01.552105735Z [err]  2026-01-02 19:28:01,526 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-02T19:28:01.552110826Z [err]  2026-01-02 19:28:01,526 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-02T19:28:01.552119413Z [err]  2026-01-02 19:28:01,526 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-02T19:28:01.552125141Z [err]  2026-01-02 19:28:01,526 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-02T19:28:01.552762520Z [err]  2026-01-02 19:28:01,526 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-02T19:28:01.620716030Z [err]  2026-01-02 19:28:01,618 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-02T19:28:01.620721601Z [err]  2026-01-02 19:28:01,618 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-02T19:28:01.620725593Z [err]  2026-01-02 19:28:01,618 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-02T19:28:01.620729473Z [err]  2026-01-02 19:28:01,618 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-02T19:28:01.620735094Z [err]  2026-01-02 19:28:01,618 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-02T19:28:01.729320378Z [err]  2026-01-02 19:28:01,727 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:01.743010531Z [err]  2026-01-02 19:28:01,740 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 122ms
2026-01-02T19:28:01.743015850Z [err]  2026-01-02 19:28:01,740 - server - INFO - üîß Calling create_call_session() - COMPLETE
2026-01-02T19:28:01.743113695Z [err]  2026-01-02 19:28:01,740 - server - INFO - ‚úÖ Session object created: CallSession
2026-01-02T19:28:01.748719565Z [err]  2026-01-02 19:28:01,747 - redis_service - INFO - üì¶ Stored call data in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (TTL: 3600s)
2026-01-02T19:28:01.748730315Z [err]  2026-01-02 19:28:01,747 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2026-01-02T19:28:01.752568970Z [err]  2026-01-02 19:28:01,748 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2026-01-02T19:28:01.752577448Z [err]  2026-01-02 19:28:01,749 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.752583200Z [err]  2026-01-02 19:28:01,749 - server - INFO - ü§ñ AI session created for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.752599597Z [err]  2026-01-02 19:28:01,749 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': True, 'track_keywords': '', 'expected_commitment': 'not_specified', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2026-01-02T19:28:01.752607083Z [err]  2026-01-02 19:28:01,749 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2026-01-02T19:28:01.752613108Z [err]  2026-01-02 19:28:01,749 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2026-01-02T19:28:01.752619627Z [err]  2026-01-02 19:28:01,749 - server - INFO - üëÇ User speaks first - waiting for user input...
2026-01-02T19:28:01.752625270Z [err]  2026-01-02 19:28:01,749 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2026-01-02T19:28:01.752630841Z [err]  2026-01-02 19:28:01,749 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2026-01-02T19:28:01.752638910Z [err]  2026-01-02 19:28:01,749 - server - INFO - üé§ Voice flow - streaming started via dial command
2026-01-02T19:28:01.759499149Z [err]  2026-01-02 19:28:01,754 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:01.759505740Z [err]  2026-01-02 19:28:01,756 - server - INFO - ü§ê No greeting - waiting for user to speak first
2026-01-02T19:28:01.759511656Z [err]  2026-01-02 19:28:01,756 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2026-01-02T19:28:01.759517293Z [inf]  100.64.0.7:61442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:02.533309420Z [err]  2026-01-02 19:28:02,219 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2026-01-02T19:28:02.533322599Z [err]  2026-01-02 19:28:02,105 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:02.533331433Z [err]  2026-01-02 19:28:02,120 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 593ms
2026-01-02T19:28:02.533340376Z [err]  2026-01-02 19:28:02,120 - server - INFO - ‚úÖ Session created in WebSocket worker
2026-01-02T19:28:02.533348257Z [err]  2026-01-02 19:28:02,120 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2026-01-02T19:28:02.533356368Z [err]  2026-01-02 19:28:02,120 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2026-01-02T19:28:02.533363954Z [err]  2026-01-02 19:28:02,120 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2026-01-02T19:28:02.533369597Z [err]  2026-01-02 19:28:02,121 - server - INFO - ‚úÖ Initialized call_states for v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA with session reference
2026-01-02T19:28:02.533380450Z [err]  2026-01-02 19:28:02,121 - server - INFO - ‚úÖ Stored Telnyx WebSocket in call_data for audio streaming
2026-01-02T19:28:02.533385282Z [err]  2026-01-02 19:28:02,121 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found to update for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:02.533391031Z [err]  2026-01-02 19:28:02,122 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2026-01-02T19:28:02.754455975Z [err]  2026-01-02 19:28:02,746 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2026-01-02T19:28:02.754466317Z [err]  2026-01-02 19:28:02,747 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2026-01-02T19:28:02.754473160Z [err]  2026-01-02 19:28:02,747 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2026-01-02T19:28:02.776102503Z [err]  2026-01-02 19:28:02,774 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:28:02.776107660Z [err]  2026-01-02 19:28:02,774 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:02.779272322Z [err]  2026-01-02 19:28:02,775 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:02.779279832Z [err]  2026-01-02 19:28:02,775 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2026-01-02T19:28:03.374373532Z [err]  2026-01-02 19:28:03,278 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.605542935Z [err]  2026-01-02 19:28:03,591 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:03.605550675Z [err]  2026-01-02 19:28:03,591 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '51e4829f-6834-48a7-9c67-a4059e02e631', 'occurred_at': '2026-01-02T19:28:03.463970Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:03.605558404Z [err]  2026-01-02 19:28:03,591 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:03.605566918Z [err]  2026-01-02 19:28:03,591 - server - INFO - üì® ================================================
2026-01-02T19:28:03.605575035Z [inf]  100.64.0.10:19732 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:03.605581537Z [err]  2026-01-02 19:28:03,599 - server - INFO - üî§ RAW TOKENS: ["H"?]
2026-01-02T19:28:03.605587959Z [err]  2026-01-02 19:28:03,603 - core_calling_service - INFO - üîä Silence timer reset for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (user started speaking)
2026-01-02T19:28:03.605595583Z [err]  2026-01-02 19:28:03,604 - core_calling_service - INFO - üë§ User started speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:03.615060967Z [err]  2026-01-02 19:28:03,609 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:03.618125897Z [err]  2026-01-02 19:28:03,616 - redis_service - INFO - üì¶ Stored call data in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (TTL: 3600s)
2026-01-02T19:28:03.618134536Z [err]  2026-01-02 19:28:03,616 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2026-01-02T19:28:03.695186166Z [err]  2026-01-02 19:28:03,691 - redis_service - INFO - üì¶ Stored call data in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (TTL: 3600s)
2026-01-02T19:28:03.695193390Z [err]  2026-01-02 19:28:03,690 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2026-01-02T19:28:03.695200025Z [err]  2026-01-02 19:28:03,689 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2026-01-02T19:28:03.695206355Z [err]  2026-01-02 19:28:03,690 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.695210915Z [err]  2026-01-02 19:28:03,689 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-02T19:28:03.695215410Z [err]  2026-01-02 19:28:03,690 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-02T19:28:03.695219174Z [err]  2026-01-02 19:28:03,689 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2026-01-02T19:28:03.695222582Z [err]  2026-01-02 19:28:03,690 - server - INFO - ‚è±Ô∏è [19:28:03.690] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2026-01-02T19:28:03.695226319Z [err]  2026-01-02 19:28:03,689 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2026-01-02T19:28:03.695229207Z [err]  2026-01-02 19:28:03,690 - server - INFO - ‚è±Ô∏è [19:28:03.690] STT endpoint detection latency: 3ms
2026-01-02T19:28:03.695233301Z [err]  2026-01-02 19:28:03,689 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2026-01-02T19:28:03.695236184Z [err]  2026-01-02 19:28:03,690 - server - INFO - ‚è±Ô∏è [19:28:03.690] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-02T19:28:03.695240262Z [err]  2026-01-02 19:28:03,690 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.695242701Z [err]  2026-01-02 19:28:03,690 - server - INFO - ‚è±Ô∏è User spoke at 1767382083.6909637
2026-01-02T19:28:03.697404714Z [err]  2026-01-02 19:28:03,692 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-02T19:28:03.697411926Z [err]  2026-01-02 19:28:03,692 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.697418368Z [err]  2026-01-02 19:28:03,692 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2026-01-02T19:28:03.706606400Z [err]  2026-01-02 19:28:03,703 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2026-01-02T19:28:03.706606417Z [err]  2026-01-02 19:28:03,704 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2026-01-02T19:28:03.706616759Z [err]  2026-01-02 19:28:03,703 - core_calling_service - INFO - üë§ User stopped speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:03.706617228Z [err]  2026-01-02 19:28:03,704 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2026-01-02T19:28:03.706623568Z [err]  2026-01-02 19:28:03,703 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-02T19:28:03.706623785Z [err]  2026-01-02 19:28:03,704 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-02T19:28:03.706629281Z [err]  2026-01-02 19:28:03,704 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-02T19:28:03.706635254Z [err]  2026-01-02 19:28:03,704 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:03.785032599Z [err]  2026-01-02 19:28:03,781 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.785041226Z [err]  2026-01-02 19:28:03,781 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.806909862Z [err]  2026-01-02 19:28:03,804 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:03.806922235Z [err]  2026-01-02 19:28:03,804 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA: User spoke while Silence Greeting was triggering
2026-01-02T19:28:03.807023909Z [err]  2026-01-02 19:28:03,803 - server - INFO - üìù Saved user transcript to database
2026-01-02T19:28:03.807034180Z [err]  2026-01-02 19:28:03,803 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:03.807041369Z [err]  2026-01-02 19:28:03,803 - core_calling_service - INFO - ‚è±Ô∏è [19:28:03.803] üì• process_user_input() ENTRY - text: 'Hello?...'
2026-01-02T19:28:03.838851057Z [err]  2026-01-02 19:28:03,837 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:28:03.838861585Z [err]  2026-01-02 19:28:03,837 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:04.410025346Z [err]  2026-01-02 19:28:04,108 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-02T19:28:04.410031716Z [err]  2026-01-02 19:28:04,109 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-02T19:28:04.410036535Z [err]  2026-01-02 19:28:04,109 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-02T19:28:04.410041230Z [err]  2026-01-02 19:28:04,109 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-02T19:28:04.410046304Z [err]  2026-01-02 19:28:04,111 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:04.410051669Z [err]  2026-01-02 19:28:04,112 - redis_service - INFO - üì¶ Stored call data in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (TTL: 3600s)
2026-01-02T19:28:04.410056670Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-02T19:28:04.410061233Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚è±Ô∏è [19:28:04.112] ‚è© About to call _process_call_flow_streaming()
2026-01-02T19:28:04.410067156Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚è±Ô∏è [19:28:04.112] üîÄ Agent type: call_flow, calling flow processor...
2026-01-02T19:28:04.410072830Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚è±Ô∏è [19:28:04.112] üîÄ _process_call_flow_streaming() ENTRY
2026-01-02T19:28:04.410077628Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2026-01-02T19:28:04.410082040Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚è±Ô∏è [19:28:04.112] ‚úÖ Node selected, about to process content...
2026-01-02T19:28:04.410086711Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{now}} with Friday, January 2, 2026 at 2:28 PM EST in content
2026-01-02T19:28:04.413459413Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{customer_name}} with  in content
2026-01-02T19:28:04.413469413Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-02T19:28:04.413474595Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-02T19:28:04.413479198Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with True in content
2026-01-02T19:28:04.413483718Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-02T19:28:04.413488197Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-02T19:28:04.413493421Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-02T19:28:04.413498358Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-02T19:28:04.413502354Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-02T19:28:04.413508236Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 1 chars) - will return text instantly
2026-01-02T19:28:04.413514031Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2026-01-02T19:28:04.413520180Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2026-01-02T19:28:04.413525823Z [err]  2026-01-02 19:28:04,112 - core_calling_service - INFO - ‚è±Ô∏è [19:28:04.112] üìÑ About to process content (mode=script, length=1)
2026-01-02T19:28:04.413577398Z [err]  2026-01-02 19:28:04,113 - core_calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2026-01-02T19:28:04.413583112Z [err]  2026-01-02 19:28:04,113 - server - INFO - üì§ Sentence arrived from LLM: ?...
2026-01-02T19:28:04.413589968Z [err]  2026-01-02 19:28:04,113 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 409ms
2026-01-02T19:28:04.413595186Z [err]  2026-01-02 19:28:04,113 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-02T19:28:04.413600558Z [err]  2026-01-02 19:28:04,113 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:04.413604702Z [err]  2026-01-02 19:28:04,113 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2026-01-02T19:28:04.413608945Z [err]  2026-01-02 19:28:04,126 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:04.413614273Z [err]  2026-01-02 19:28:04,126 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout: User already spoke, skipping greeting
2026-01-02T19:28:04.413619809Z [err]  2026-01-02 19:28:04,205 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:04.413625217Z [err]  2026-01-02 19:28:04,283 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:04.413637295Z [err]  2026-01-02 19:28:04,283 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:04.413647072Z [err]  2026-01-02 19:28:04,297 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:04.413652993Z [err]  2026-01-02 19:28:04,390 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:04.415038995Z [err]  2026-01-02 19:28:04,414 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-02T19:28:04.415049770Z [err]  2026-01-02 19:28:04,414 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2026-01-02T19:28:04.415055649Z [err]  2026-01-02 19:28:04,414 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-02T19:28:04.421419993Z [err]  2026-01-02 19:28:04,414 - persistent_tts_service - INFO - üîå [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Establishing persistent TTS WebSocket...
2026-01-02T19:28:04.421429123Z [err]  2026-01-02 19:28:04,414 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-02T19:28:04.421434486Z [err]  2026-01-02 19:28:04,414 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2026-01-02T19:28:04.421440365Z [err]  2026-01-02 19:28:04,414 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2026-01-02T19:28:04.552810662Z [err]  2026-01-02 19:28:04,549 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2026-01-02T19:28:04.552818154Z [err]  2026-01-02 19:28:04,551 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 847ms
2026-01-02T19:28:04.552822581Z [err]  2026-01-02 19:28:04,550 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2026-01-02T19:28:04.552830285Z [err]  2026-01-02 19:28:04,550 - persistent_tts_service - INFO - ‚úÖ [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Persistent TTS WebSocket established
2026-01-02T19:28:04.552833588Z [err]  2026-01-02 19:28:04,551 - core_calling_service - INFO - üì§ Streamed script sentence 1/1: ?...
2026-01-02T19:28:04.552841300Z [err]  2026-01-02 19:28:04,550 - persistent_tts_service - INFO - üéß [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Audio receiver loop started
2026-01-02T19:28:04.552844227Z [err]  2026-01-02 19:28:04,551 - core_calling_service - INFO - üîä Silence tracking reset for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (user responded)
2026-01-02T19:28:04.552849736Z [err]  2026-01-02 19:28:04,550 - persistent_tts_service - INFO - üîä [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Comfort noise loop started
2026-01-02T19:28:04.552855989Z [err]  2026-01-02 19:28:04,550 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:04.552863036Z [err]  2026-01-02 19:28:04,550 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2026-01-02T19:28:04.552868992Z [err]  2026-01-02 19:28:04,550 - server - INFO - üîç Persistent TTS lookup: call_id=v3:18fssInbJv6sktuj-..., session=FOUND
2026-01-02T19:28:04.552874928Z [err]  2026-01-02 19:28:04,550 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-02T19:28:04.552880600Z [err]  2026-01-02 19:28:04,551 - server - INFO - üéµ TTS task #1 started at +437ms
2026-01-02T19:28:04.555559024Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üîä [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Starting comfort noise loop
2026-01-02T19:28:04.555559793Z [err]  2026-01-02 19:28:04,551 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-02T19:28:04.555571183Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üé§ [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Streaming sentence #1: ?...
2026-01-02T19:28:04.555571623Z [err]  2026-01-02 19:28:04,551 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2026-01-02T19:28:04.555579392Z [err]  2026-01-02 19:28:04,551 - core_calling_service - INFO - LLM response (0.75s): ?
2026-01-02T19:28:04.555586493Z [err]  2026-01-02 19:28:04,551 - core_calling_service - INFO - Total latency: 0.75s
2026-01-02T19:28:04.555592857Z [err]  2026-01-02 19:28:04,552 - server - INFO - ‚úÖ LLM finished in 848ms, TTS tasks already running in background
2026-01-02T19:28:04.555599201Z [err]  2026-01-02 19:28:04,552 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2026-01-02T19:28:04.555605252Z [err]  2026-01-02 19:28:04,552 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-02T19:28:04.555611045Z [err]  2026-01-02 19:28:04,552 - server - INFO -    1 sentences queued and playing seamlessly
2026-01-02T19:28:04.555617177Z [err]  2026-01-02 19:28:04,552 - persistent_tts_service - INFO - üéµ [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Playback consumer started
2026-01-02T19:28:04.555728850Z [err]  2026-01-02 19:28:04,552 - persistent_tts_service - INFO - üéß [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Audio Receiver Loop STARTED
2026-01-02T19:28:04.555741741Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üíì [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Starting TTS keep-alive loop (every 15s)
2026-01-02T19:28:04.559623121Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üöÄ [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Sent sentence #1 (NON-BLOCKING) in 0ms
2026-01-02T19:28:04.559632335Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üìä [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2026-01-02T19:28:04.559637000Z [err]  2026-01-02 19:28:04,554 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:04.559640069Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üéß [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Receiver processing sentence #1: '?...'
2026-01-02T19:28:04.559648016Z [err]  2026-01-02 19:28:04,553 - persistent_tts_service - INFO - üìä [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] DIAGNOSTIC: queue_latency=0ms, pending_sentences=0, audio_queue=0, interrupted=False
2026-01-02T19:28:04.559650087Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-02T19:28:04.559657025Z [err]  2026-01-02 19:28:04,553 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2026-01-02T19:28:04.559659607Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-02T19:28:04.559666437Z [err]  2026-01-02 19:28:04,553 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-02T19:28:04.559669207Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-02T19:28:04.559674039Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 849ms from user stop üöÄ
2026-01-02T19:28:04.561980305Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2026-01-02T19:28:04.561991654Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 848ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-02T19:28:04.561998872Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 440ms (provider: elevenlabs, websocket: False)
2026-01-02T19:28:04.562005195Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 850ms (user stopped ‚Üí play_audio_url called)
2026-01-02T19:28:04.562011401Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-02T19:28:04.562017831Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-02T19:28:04.562024042Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-02T19:28:04.562030170Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-02T19:28:04.562039529Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-02T19:28:04.562046104Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1150ms estimated
2026-01-02T19:28:04.562113123Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 1 chars, 1 sentences
2026-01-02T19:28:04.562121147Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2026-01-02T19:28:04.562127244Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '?...'
2026-01-02T19:28:04.562133531Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-02T19:28:04.562139863Z [err]  2026-01-02 19:28:04,554 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-02T19:28:04.758408332Z [err]  2026-01-02 19:28:04,752 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1298ms)
2026-01-02T19:28:04.758420317Z [err]  2026-01-02 19:28:04,752 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-02T19:28:04.758426862Z [err]  2026-01-02 19:28:04,752 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-02T19:28:04.969992424Z [err]  2026-01-02 19:28:04,914 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 361ms
2026-01-02T19:28:04.970001569Z [err]  2026-01-02 19:28:04,914 - persistent_tts_service - INFO - üì§ Sending 3328 bytes of audio (21 chunks, 0.4s duration) via WebSocket
2026-01-02T19:28:04.970007478Z [err]  2026-01-02 19:28:04,914 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-02T19:28:04.970013129Z [err]  2026-01-02 19:28:04,914 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.4s (total: 0.4s from now)
2026-01-02T19:28:04.970018476Z [err]  2026-01-02 19:28:04,915 - persistent_tts_service - INFO - ‚úÖ Sent 21 audio chunks via WebSocket
2026-01-02T19:28:05.435494812Z [err]  2026-01-02 19:28:05,416 - persistent_tts_service - INFO - üîá [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] FLOOR RELEASED (is_holding_floor=False)
2026-01-02T19:28:05.794311224Z [err]  2026-01-02 19:28:05,790 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.5s ago), marking agent as done speaking
2026-01-02T19:28:05.794322999Z [err]  2026-01-02 19:28:05,790 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1767382085.7908852 for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:05.794329752Z [err]  2026-01-02 19:28:05,790 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:05.880558878Z [inf]  100.64.0.11:33296 - "GET /api/crm/analytics/call/v3%3AW6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g HTTP/1.1" 200
2026-01-02T19:28:06.539613542Z [inf]  100.64.0.11:33296 - "GET /api/crm/analytics/call/v3%3A18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA HTTP/1.1" 404
2026-01-02T19:28:06.923176538Z [err]  2026-01-02 19:28:06,914 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2026-01-02T19:28:06.923184668Z [err]  2026-01-02 19:28:06,915 - persistent_tts_service - INFO - ‚úÖ [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Receiver finished sentence #1: 1 chunks in 2361ms
2026-01-02T19:28:07.787434608Z [err]  2026-01-02 19:28:07,779 - server - INFO - üì§ Audio flowing: 347 packets sent to Soniox (5s update)
2026-01-02T19:28:10.476759178Z [err]  2026-01-02 19:28:10,221 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:10.476765921Z [err]  2026-01-02 19:28:10,300 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=4.5s, checkin_count=0/2
2026-01-02T19:28:10.725049909Z [err]  2026-01-02 19:28:10,724 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:10.809632405Z [err]  2026-01-02 19:28:10,801 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.0s, checkin_count=0/2
2026-01-02T19:28:12.514888591Z [err]  2026-01-02 19:28:12,453 - server - INFO - üé§ Soniox receiver alive - 1 messages received in last 10s
2026-01-02T19:28:12.514894127Z [err]  2026-01-02 19:28:12,453 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 6600, 'total_audio_proc_ms': 12360, 'error_code': 408, 'error_message': 'Request timeout.'}
2026-01-02T19:28:12.514898710Z [err]  2026-01-02 19:28:12,453 - server - INFO - ‚úÖ Soniox receive loop ended normally
2026-01-02T19:28:12.514903876Z [err]  2026-01-02 19:28:12,453 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:28:12.514908598Z [err]  2026-01-02 19:28:12,453 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:W6yNjJUPvV8kFsiNDA7pH9XGxfzFGNsYU4vJKx3XeTs84K1FYwGK0g
2026-01-02T19:28:12.514916828Z [err]  2026-01-02 19:28:12,453 - server - INFO - üîá Dead air monitoring task cancelled
2026-01-02T19:28:12.796253470Z [err]  2026-01-02 19:28:12,793 - server - INFO - üì§ Audio flowing: 598 packets sent to Soniox (5s update)
2026-01-02T19:28:12.818054169Z [err]  2026-01-02 19:28:12,806 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2026-01-02T19:28:12.818059331Z [err]  2026-01-02 19:28:12,809 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-02T19:28:12.818064799Z [err]  2026-01-02 19:28:12,809 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2026-01-02T19:28:12.818070556Z [err]  2026-01-02 19:28:12,809 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:12.818075415Z [err]  2026-01-02 19:28:12,809 - telnyx_service - INFO - üîä Speaking text on call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA: Are you still there?...
2026-01-02T19:28:12.818080263Z [err]  2026-01-02 19:28:12,809 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-02T19:28:12.818084618Z [err]  2026-01-02 19:28:12,809 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-02T19:28:12.818090078Z [err]  2026-01-02 19:28:12,809 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-02T19:28:12.818095094Z [err]  2026-01-02 19:28:12,809 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-02T19:28:12.818101071Z [err]  2026-01-02 19:28:12,809 - server - INFO - ‚è±Ô∏è [19:28:12.809] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2026-01-02T19:28:12.818105722Z [err]  2026-01-02 19:28:12,810 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2026-01-02T19:28:12.818110559Z [err]  2026-01-02 19:28:12,810 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2026-01-02T19:28:12.906100598Z [err]  2026-01-02 19:28:12,901 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:12.906111644Z [err]  2026-01-02 19:28:12,902 - server - INFO - üì¶ ElevenLabs Request Payload:
2026-01-02T19:28:12.906117507Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Text length: 20 chars
2026-01-02T19:28:12.906122368Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Text content: 'Are you still there?'
2026-01-02T19:28:12.906127884Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Text bytes: b'Are you still there?'
2026-01-02T19:28:12.906136829Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Model: eleven_turbo_v2_5
2026-01-02T19:28:12.906143327Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2026-01-02T19:28:12.906149861Z [err]  2026-01-02 19:28:12,902 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2026-01-02T19:28:12.906162511Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2026-01-02T19:28:12.906169946Z [err]  2026-01-02 19:28:12,902 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2026-01-02T19:28:12.906177023Z [err]  2026-01-02 19:28:12,902 - server - INFO -    Timeout: 10.0s
2026-01-02T19:28:12.923164806Z [err]  2026-01-02 19:28:12,918 - server - INFO -    ‚úì HTTP client created (0.016s)
2026-01-02T19:28:12.923175073Z [err]  2026-01-02 19:28:12,918 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2026-01-02T19:28:13.532875579Z [err]  2026-01-02 19:28:13,345 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2026-01-02T19:28:13.532887362Z [err]  2026-01-02 19:28:13,345 - server - INFO -    ‚úì Connection established (0.443s) [TARGET: <200ms]
2026-01-02T19:28:13.532894753Z [err]  2026-01-02 19:28:13,345 - server - INFO -    ‚úì Response status: 200
2026-01-02T19:28:13.532901759Z [err]  2026-01-02 19:28:13,345 - server - INFO -    ‚Üí Streaming audio chunks...
2026-01-02T19:28:13.532911905Z [err]  2026-01-02 19:28:13,409 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2026-01-02T19:28:13.532919222Z [err]  2026-01-02 19:28:13,411 - server - INFO -    ‚úì FIRST CHUNK received (0.509s, 1020 bytes) [TARGET: <300ms]
2026-01-02T19:28:13.532927190Z [err]  2026-01-02 19:28:13,417 - server - INFO -    ‚úì ALL CHUNKS received: 85 chunks (0.515s)
2026-01-02T19:28:13.532936596Z [err]  2026-01-02 19:28:13,417 - server - INFO -    ‚úì Total audio size: 17599 bytes
2026-01-02T19:28:13.532945650Z [err]  2026-01-02 19:28:13,418 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2026-01-02T19:28:13.532952985Z [err]  2026-01-02 19:28:13,418 - server - INFO -       - Connection: 443ms
2026-01-02T19:28:13.532960052Z [err]  2026-01-02 19:28:13,418 - server - INFO -       - First chunk: 509ms
2026-01-02T19:28:13.532966819Z [err]  2026-01-02 19:28:13,418 - server - INFO -       - All chunks: 515ms
2026-01-02T19:28:13.532974047Z [err]  2026-01-02 19:28:13,418 - server - INFO -       - Audio generation only: 66ms
2026-01-02T19:28:13.532980964Z [err]  2026-01-02 19:28:13,418 - server - INFO - ‚è±Ô∏è [19:28:13.418] üîä TTS COMPLETE: 608ms, audio_size=17599 bytes
2026-01-02T19:28:13.532989028Z [err]  2026-01-02 19:28:13,418 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2026-01-02T19:28:13.532995095Z [err]  2026-01-02 19:28:13,418 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.61s
2026-01-02T19:28:13.533146196Z [err]  2026-01-02 19:28:13,418 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2026-01-02T19:28:13.533154060Z [err]  2026-01-02 19:28:13,418 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2026-01-02T19:28:13.650127883Z [err]  2026-01-02 19:28:13,639 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA/actions/playback_start "HTTP/1.1 200 OK"
2026-01-02T19:28:13.650133671Z [err]  2026-01-02 19:28:13,640 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2026-01-02T19:28:13.650139266Z [err]  2026-01-02 19:28:13,640 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.83s
2026-01-02T19:28:13.650145501Z [err]  2026-01-02 19:28:13,640 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2026-01-02T19:28:13.650152532Z [err]  2026-01-02 19:28:13,640 - telnyx_service - INFO - üé¨ Playback ID: gCNMby7qdw
2026-01-02T19:28:13.650158489Z [err]  2026-01-02 19:28:13,642 - redis_service - INFO - ‚ûï Added playback gCNMby7qdw to Redis for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:13.650164265Z [err]  2026-01-02 19:28:13,643 - server - INFO - üé¨ Check-in playback ID: gCNMby7qdw (expected duration: 2.6s)
2026-01-02T19:28:13.650170278Z [err]  2026-01-02 19:28:13,643 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-02T19:28:14.000199348Z [inf]  100.64.0.12:59612 - "GET /api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3 HTTP/1.1" 200
2026-01-02T19:28:14.576391713Z [err]  2026-01-02 19:28:14,108 - server - INFO - üî§ RAW TOKENS: [" H"?]
2026-01-02T19:28:14.576396612Z [err]  2026-01-02 19:28:14,108 - core_calling_service - INFO - üîä Silence timer reset for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (user started speaking)
2026-01-02T19:28:14.576401631Z [err]  2026-01-02 19:28:14,108 - core_calling_service - INFO - üë§ User started speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.576406796Z [err]  2026-01-02 19:28:14,109 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.576425329Z [err]  2026-01-02 19:28:14,110 - redis_service - INFO - üì¶ Stored call data in Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (TTL: 3600s)
2026-01-02T19:28:14.576430203Z [err]  2026-01-02 19:28:14,110 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2026-01-02T19:28:14.576434946Z [err]  2026-01-02 19:28:14,110 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (2.1s left): 1 words - 'H'
2026-01-02T19:28:14.576444928Z [err]  2026-01-02 19:28:14,172 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 660 total packets
2026-01-02T19:28:14.576455711Z [err]  [2026-01-02 19:28:14 +0000] [5] [INFO] connection closed
2026-01-02T19:28:14.576462106Z [err]  2026-01-02 19:28:14,174 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:14.576468205Z [err]  2026-01-02 19:28:14,174 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '80c4a94d-3479-4e80-a469-140225b1afc2', 'occurred_at': '2026-01-02T19:28:13.983964Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '3.65', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '715', 'skip_packet_count': '16'}, 'outbound': {'packet_count': '664', 'skip_packet_count': '0'}}, 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-02T19:28:13.983964Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2026-01-02T19:27:56.103970Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:14.576635873Z [err]  2026-01-02 19:28:14,174 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.576648108Z [err]  2026-01-02 19:28:14,174 - server - INFO - üì® ================================================
2026-01-02T19:28:14.576692098Z [err]  2026-01-02 19:28:14,174 - server - INFO - üìû Call ended: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.576701400Z [err]  2026-01-02 19:28:14,174 - server - INFO - üìû Hangup cause: normal_clearing
2026-01-02T19:28:14.576708973Z [err]  2026-01-02 19:28:14,348 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:14.576718420Z [err]  2026-01-02 19:28:14,348 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '82df8274-4e92-4351-bcc6-7d47d2bb46b0', 'occurred_at': '2026-01-02T19:28:14.102901Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '574b9b21-163d-400c-8adb-5f28efa1ae58', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:14.576725043Z [err]  2026-01-02 19:28:14,348 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.576732171Z [err]  2026-01-02 19:28:14,348 - server - INFO - üì® ================================================
2026-01-02T19:28:14.576739630Z [inf]  100.64.0.9:60178 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:14.576747694Z [err]  2026-01-02 19:28:14,369 - server - INFO - üìù Updated call log: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.579175369Z [err]  2026-01-02 19:28:14,463 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2026-01-02T19:28:14.579180301Z [err]  2026-01-02 19:28:14,463 - server - INFO - üîå Telnyx WebSocket disconnected
2026-01-02T19:28:14.579185050Z [err]  2026-01-02 19:28:14,467 - server - INFO - ‚úÖ Finalized call log: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA (duration=13s, status=completed)
2026-01-02T19:28:14.579191352Z [err]  2026-01-02 19:28:14,505 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:14.579195969Z [err]  2026-01-02 19:28:14,505 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'f558d558-9486-41f0-a3ee-52fa460ca640', 'occurred_at': '2026-01-02T19:28:14.063969Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-02T19:28:14.063969Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'W4f2SKoDiA', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:14.579201209Z [err]  2026-01-02 19:28:14,505 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.579205940Z [err]  2026-01-02 19:28:14,505 - server - INFO - üì® ================================================
2026-01-02T19:28:14.579210319Z [err]  2026-01-02 19:28:14,507 - redis_service - INFO - ‚ûñ Removed playback W4f2SKoDiA, 1 remaining for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.579226224Z [err]  2026-01-02 19:28:14,507 - server - INFO - üîä Redis: Removed playback W4f2SKoDiA, 1 remaining
2026-01-02T19:28:14.582768716Z [inf]  100.64.0.7:61442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:14.582774905Z [err]  2026-01-02 19:28:14,560 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:14.582780955Z [err]  2026-01-02 19:28:14,560 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '2c34cf39-7019-4579-82ea-9af6f59044b8', 'occurred_at': '2026-01-02T19:28:14.249905Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3', 'overlay': False, 'playback_id': 'gCNMby7qdw', 'status': 'cancelled', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:14.582786030Z [err]  2026-01-02 19:28:14,560 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.582792079Z [err]  2026-01-02 19:28:14,560 - server - INFO - üì® ================================================
2026-01-02T19:28:14.582797621Z [err]  2026-01-02 19:28:14,562 - redis_service - INFO - ‚ûñ Removed playback gCNMby7qdw, 0 remaining for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:14.582802484Z [err]  2026-01-02 19:28:14,562 - server - INFO - üîä Redis: Removed playback gCNMby7qdw, 0 remaining
2026-01-02T19:28:14.582808442Z [err]  2026-01-02 19:28:14,562 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-02T19:28:14.582815415Z [err]  2026-01-02 19:28:14,562 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-02T19:28:14.585276656Z [err]  2026-01-02 19:28:14,562 - server - INFO - üí° Session not on this worker - Redis flag set for WebSocket worker to handle
2026-01-02T19:28:14.585287973Z [inf]  100.64.0.6:12780 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:14.585294323Z [err]  2026-01-02 19:28:14,565 - server - INFO - üì¶ Saved 10 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2026-01-02T19:28:14.676259503Z [err]  2026-01-02 19:28:14,649 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-02T19:28:14.676265505Z [err]  2026-01-02 19:28:14,649 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.561290482Z [err]  2026-01-02 19:28:15,151 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.1s left)
2026-01-02T19:28:15.561298562Z [err]  2026-01-02 19:28:15,301 - server - INFO - üìä Auto-added call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2026-01-02T19:28:15.561314060Z [err]  2026-01-02 19:28:15,440 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-02T19:28:15.561320023Z [err]  2026-01-02 19:28:15,440 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'c18668d5-6d17-43d9-bd5c-904e7709b0af', 'occurred_at': '2026-01-02T19:28:15.123348Z', 'payload': {'call_control_id': 'v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA', 'call_leg_id': '239a5bc8-e811-11f0-9f8f-02420aef99a0', 'call_session_id': '2398434c-e811-11f0-8b34-02420aef99a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-02T19:28:14.072788Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2026-01-02T19:28:14.072788Z', 'recording_id': 'b9f0970d-5dd1-4900-842e-4c96a99d389f', 'recording_started_at': '2026-01-02T19:28:01.414864Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-02/239a5bc8-e811-11f0-9f8f-02420aef99a0-1767382081390619.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260102%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260102T192815Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=bbae799733eace51019e199cc3633fbd5afe83983f36a08a50c07ff8a2335bcc'}, 'start_time': '2026-01-02T19:28:01.414864Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-02T19:28:15.561325242Z [err]  2026-01-02 19:28:15,440 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.565173816Z [err]  2026-01-02 19:28:15,440 - server - INFO - üì® ================================================
2026-01-02T19:28:15.565179286Z [err]  2026-01-02 19:28:15,440 - server - INFO - üéôÔ∏è Recording saved for call: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.565184980Z [err]  2026-01-02 19:28:15,441 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.565190960Z [err]  2026-01-02 19:28:15,441 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=b9f0970d-5dd1-4900-842e-4c96a99d389f, call_data=True
2026-01-02T19:28:15.565197092Z [err]  2026-01-02 19:28:15,495 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-02T19:28:15.565202888Z [err]  2026-01-02 19:28:15,497 - redis_service - INFO - üì• Retrieved call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.565209033Z [err]  2026-01-02 19:28:15,497 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=Yes
2026-01-02T19:28:15.565214521Z [err]  2026-01-02 19:28:15,497 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2026-01-02T19:28:15.565221490Z [err]  2026-01-02 19:28:15,533 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-02T19:28:15.565226682Z [err]  2026-01-02 19:28:15,534 - server - WARNING - ‚ö†Ô∏è Post-call webhook returned status 530: <!doctype html>
2026-01-02T19:28:15.565232653Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:28:15.565336903Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-02T19:28:15.565342964Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-02T19:28:15.565491924Z [err]  2026-01-02 19:28:15,534 - server - INFO - üíæ Saved recording URL and ID to database: b9f0970d-5dd1-4900-842e-4c96a99d389f
2026-01-02T19:28:15.565498701Z [err]  2026-01-02 19:28:15,534 - server - INFO - ‚úÖ Entering dual-channel processing
2026-01-02T19:28:15.565504950Z [err]  2026-01-02 19:28:15,534 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2026-01-02T19:28:15.597569131Z [err]  2026-01-02 19:28:15,594 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2026-01-02T19:28:15.660880748Z [err]  2026-01-02 19:28:15,653 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (0.6s left)
2026-01-02T19:28:15.690147403Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2026-01-02T19:28:15.690154760Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2026-01-02T19:28:15.690162690Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìá [HANGUP] Agent info keys: None
2026-01-02T19:28:15.690168595Z [err]  2026-01-02 19:28:15,686 - server - INFO - üöÄ Triggered QC analysis for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.690174260Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìä Triggered Campaign QC for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.690180465Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìá Triggered CRM update for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.690185971Z [err]  2026-01-02 19:28:15,686 - persistent_tts_service - INFO - üîå [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Closing persistent TTS WebSocket...
2026-01-02T19:28:15.690191218Z [err]  2026-01-02 19:28:15,686 - server - INFO - üîç Starting QC analysis for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:15.690195844Z [err]  2026-01-02 19:28:15,686 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2026-01-02T19:28:15.690202017Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìá CRM update starting for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:28:15.693239912Z [err]  2026-01-02 19:28:15,686 - server - INFO - üìá Normalized phone: +17708336397
2026-01-02T19:28:15.693247953Z [err]  2026-01-02 19:28:15,687 - server - INFO - üìá CRM: Got 10 variables from active session
2026-01-02T19:28:15.693258268Z [err]  2026-01-02 19:28:15,688 - persistent_tts_service - INFO - üõë [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Audio Receiver Loop CANCELLED
2026-01-02T19:28:15.693266399Z [err]  2026-01-02 19:28:15,688 - persistent_tts_service - INFO - üëã [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Audio Receiver Loop STOPPED
2026-01-02T19:28:15.693272705Z [err]  2026-01-02 19:28:15,689 - persistent_tts_service - INFO - üõë [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Playback consumer shutting down
2026-01-02T19:28:15.785290434Z [err]  2026-01-02 19:28:15,782 - server - INFO - üìù Converted transcript from 2 messages to 25 characters
2026-01-02T19:28:15.785299288Z [err]  2026-01-02 19:28:15,784 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=2, logs_count=4, status=completed
2026-01-02T19:28:15.879637261Z [err]  2026-01-02 19:28:15,877 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-02T19:28:15.941045157Z [err]  2026-01-02 19:28:15,935 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-02/239a5bc8-e811-11f0-9f8f-02420aef99a0-1767382081390619.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260102%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260102T192815Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=bbae799733eace51019e199cc3633fbd5afe83983f36a08a50c07ff8a2335bcc "HTTP/1.1 200 OK"
2026-01-02T19:28:15.971958385Z [err]  2026-01-02 19:28:15,969 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2026-01-02T19:28:16.573864035Z [err]  2026-01-02 19:28:16,028 - server - INFO - ‚úÖ Downloaded 51034 bytes
2026-01-02T19:28:16.573867900Z [err]  2026-01-02 19:28:16,061 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2026-01-02T19:28:16.573872646Z [err]  2026-01-02 19:28:16,061 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-02T19:28:16.573876717Z [err]  2026-01-02 19:28:16,061 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:16.573880572Z [err]  2026-01-02 19:28:16,235 - server - INFO - ‚úÖ Split into 2 channels
2026-01-02T19:28:16.573885500Z [err]  2026-01-02 19:28:16,235 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2026-01-02T19:28:16.573889361Z [err]  2026-01-02 19:28:16,235 - server - INFO - üìä Channel 0: 277244 bytes
2026-01-02T19:28:16.573893231Z [err]  2026-01-02 19:28:16,235 - server - ERROR - ‚ùå No Soniox API key available
2026-01-02T19:28:16.573897731Z [err]  2026-01-02 19:28:16,235 - server - INFO - ‚ùå Channel 0: No speech
2026-01-02T19:28:16.573901959Z [err]  2026-01-02 19:28:16,235 - server - INFO - üìä Channel 1: 277244 bytes
2026-01-02T19:28:16.573906552Z [err]  2026-01-02 19:28:16,235 - server - ERROR - ‚ùå No Soniox API key available
2026-01-02T19:28:16.573911911Z [err]  2026-01-02 19:28:16,235 - server - INFO - ‚ùå Channel 1: No speech
2026-01-02T19:28:16.573916721Z [err]  2026-01-02 19:28:16,235 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2026-01-02T19:28:16.573921133Z [inf]  100.64.0.13:44112 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:16.573925163Z [err]  2026-01-02 19:28:16,550 - server - INFO - üìá CRM: Got 10 extracted variables
2026-01-02T19:28:16.573929152Z [err]  2026-01-02 19:28:16,550 - server - INFO - üìá CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2026-01-02T19:28:16.574089484Z [err]  2026-01-02 19:28:16,559 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2026-01-02T19:28:16.670599061Z [err]  2026-01-02 19:28:16,665 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2026-01-02T19:28:16.670607409Z [err]  2026-01-02 19:28:16,665 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2026-01-02T19:28:16.670613165Z [err]  2026-01-02 19:28:16,665 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-02T19:28:16.670618694Z [err]  2026-01-02 19:28:16,666 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2026-01-02T19:28:16.670623858Z [err]    File "/app/backend/server.py", line 9803, in trigger_campaign_qc_for_call
2026-01-02T19:28:16.670630862Z [err]      await run_full_qc_analysis(
2026-01-02T19:28:16.670636064Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2026-01-02T19:28:16.670640603Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-02T19:28:16.670645074Z [err]  
2026-01-02T19:28:16.747046692Z [err]  2026-01-02 19:28:16,743 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2026-01-02T19:28:16.798977106Z [err]  2026-01-02 19:28:16,796 - elevenlabs_ws_service - INFO - üîå Closed ElevenLabs WebSocket connection
2026-01-02T19:28:16.798987254Z [err]  2026-01-02 19:28:16,797 - persistent_tts_service - INFO - ‚úÖ [Call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA] Persistent TTS WebSocket closed
2026-01-02T19:28:16.798995969Z [err]  2026-01-02 19:28:16,797 - persistent_tts_service - INFO - ‚úÖ Closed persistent TTS session for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:16.799005976Z [err]  2026-01-02 19:28:16,797 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:16.801390768Z [err]  2026-01-02 19:28:16,798 - redis_service - INFO - üßπ Deleted call data from Redis: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:16.801398506Z [err]  2026-01-02 19:28:16,798 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:16.801404119Z [inf]  100.64.0.9:44736 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-02T19:28:16.996703579Z [inf]  100.64.0.5:34996 - "GET /api/crm/analytics/call/v3%3A18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA HTTP/1.1" 404
2026-01-02T19:28:17.480365878Z [err]  2026-01-02 19:28:17,158 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:17.480380725Z [err]  2026-01-02 19:28:17,425 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-02T19:28:17.480392152Z [err]  2026-01-02 19:28:17,426 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:28:17.480542093Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:28:17.480550166Z [err]  2026-01-02 19:28:17,426 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:28:17.480557191Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-02T19:28:17.480563320Z [err]  2026-01-02 19:28:17,428 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:17.638441921Z [err]  2026-01-02 19:28:17,636 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-02T19:28:17.645737296Z [err]  2026-01-02 19:28:17,641 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:28:17.645751147Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:28:17.645759862Z [err]  2026-01-02 19:28:17,641 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:28:17.645772256Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-02T19:28:17.645779276Z [err]  2026-01-02 19:28:17,642 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:17.664886239Z [err]  2026-01-02 19:28:17,660 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:17.853525137Z [err]  2026-01-02 19:28:17,849 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-02T19:28:17.853529596Z [err]  2026-01-02 19:28:17,850 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:28:17.853533944Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:28:17.853539124Z [err]  2026-01-02 19:28:17,850 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-02T19:28:17.853544839Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-02T19:28:17.946521051Z [err]  2026-01-02 19:28:17,944 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:17.946530507Z [err]  2026-01-02 19:28:17,944 - server - INFO - ‚úÖ QC analysis completed for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:17.946537600Z [err]  2026-01-02 19:28:17,944 - server - INFO - üìä Scores: Commitment=50, Conversion=0, Excellence=50
2026-01-02T19:28:18.522144165Z [err]  2026-01-02 19:28:18,134 - server - INFO - üìä Updated campaign_calls with QC scores for v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:18.522160386Z [err]  2026-01-02 19:28:18,162 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:18.522168285Z [err]  2026-01-02 19:28:18,318 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2026-01-02T19:28:18.522179192Z [err]  2026-01-02 19:28:18,409 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2026-01-02T19:28:18.522189659Z [err]  2026-01-02 19:28:18,409 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA: 'str' object has no attribute 'get'
2026-01-02T19:28:18.665310159Z [err]  2026-01-02 19:28:18,664 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:19.398244342Z [err]  2026-01-02 19:28:19,165 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:19.675834873Z [err]  2026-01-02 19:28:19,669 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:20.446128550Z [err]  2026-01-02 19:28:20,175 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:20.446136447Z [err]  2026-01-02 19:28:20,175 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:20.700708771Z [err]  2026-01-02 19:28:20,685 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:20.700717577Z [err]  2026-01-02 19:28:20,685 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:21.401369842Z [err]  2026-01-02 19:28:21,186 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:21.696792988Z [err]  2026-01-02 19:28:21,687 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:22.444326342Z [err]  2026-01-02 19:28:22,189 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:22.691653149Z [err]  2026-01-02 19:28:22,690 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:23.470428157Z [err]  2026-01-02 19:28:23,191 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:23.700141824Z [err]  2026-01-02 19:28:23,693 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:24.614803083Z [err]  2026-01-02 19:28:24,195 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:24.697152395Z [err]  2026-01-02 19:28:24,696 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:25.532929300Z [err]  2026-01-02 19:28:25,197 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:25.703716086Z [err]  2026-01-02 19:28:25,698 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:26.544654608Z [err]  2026-01-02 19:28:26,199 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:26.710886588Z [err]  2026-01-02 19:28:26,700 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:27.513386451Z [err]  2026-01-02 19:28:27,202 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:27.714873274Z [err]  2026-01-02 19:28:27,703 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:28.704019362Z [err]  2026-01-02 19:28:28,204 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:28.704025391Z [inf]  100.64.0.14:38480 - "GET /api/crm/analytics/call/v3%3A18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA HTTP/1.1" 200
2026-01-02T19:28:28.707671083Z [err]  2026-01-02 19:28:28,705 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:29.609598126Z [err]  2026-01-02 19:28:29,206 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:29.714697836Z [err]  2026-01-02 19:28:29,709 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:30.562088493Z [err]  2026-01-02 19:28:30,210 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:30.562096905Z [err]  2026-01-02 19:28:30,210 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:30.722483283Z [err]  2026-01-02 19:28:30,712 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:30.722488952Z [err]  2026-01-02 19:28:30,712 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2026-01-02T19:28:31.381136443Z [err]  2026-01-02 19:28:31,213 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:31.717888058Z [err]  2026-01-02 19:28:31,714 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:32.432224651Z [err]  2026-01-02 19:28:32,215 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:32.724250649Z [err]  2026-01-02 19:28:32,717 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:33.468272411Z [err]  2026-01-02 19:28:33,219 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:33.724477485Z [err]  2026-01-02 19:28:33,720 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:34.435103276Z [err]  2026-01-02 19:28:34,222 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:18fssInbJv6sktuj-... (active sessions: [])
2026-01-02T19:28:34.435125324Z [err]  2026-01-02 19:28:34,271 - server - INFO - üé§ Soniox receiver alive - 2 messages received in last 10s
2026-01-02T19:28:34.435133286Z [err]  2026-01-02 19:28:34,271 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 7800, 'total_audio_proc_ms': 12960, 'error_code': 408, 'error_message': 'Request timeout.'}
2026-01-02T19:28:34.435140214Z [err]  2026-01-02 19:28:34,271 - server - INFO - ‚úÖ Soniox receive loop ended normally
2026-01-02T19:28:34.435147920Z [err]  2026-01-02 19:28:34,271 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:34.435156630Z [err]  2026-01-02 19:28:34,271 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:18fssInbJv6sktuj-ZXfIBrYxDoPUM47lKrgCbpgCE0h31JHJbHzsA
2026-01-02T19:28:34.435164529Z [err]  2026-01-02 19:28:34,271 - server - INFO - üîá Dead air monitoring task cancelled
2026-01-02T19:28:36.465241964Z [err]  2026-01-02 19:28:36,268 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2026-01-02T19:28:36.465257118Z [err]  2026-01-02 19:28:36,268 - server - INFO - üîå Telnyx WebSocket disconnected