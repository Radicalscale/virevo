2025-12-18T03:00:35.166933693Z [err]  2025-12-18 03:00:33,634 - redis_service - INFO - ‚ûñ Removed playback pUThLEPvGw, 0 remaining for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:35.167642659Z [err]  2025-12-18 03:00:33,634 - server - INFO - üîä Redis: Removed playback pUThLEPvGw, 0 remaining
2025-12-18T03:00:36.182717161Z [err]  2025-12-18 03:00:33,701 - server - INFO - üìû Call ended: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:36.182724210Z [err]  2025-12-18 03:00:33,701 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:36.182738388Z [err]  2025-12-18 03:00:33,701 - server - INFO - üì® ================================================
2025-12-18T03:00:36.182837494Z [inf]  100.64.0.8:10214 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:36.182839127Z [err]  2025-12-18 03:00:33,634 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-18T03:00:36.182850919Z [err]  2025-12-18 03:00:33,637 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-18T03:00:36.182851481Z [err]  2025-12-18 03:00:33,700 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:36.182861385Z [err]  2025-12-18 03:00:33,701 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '1b7490a9-de10-4d14-b863-03d44d8d0232', 'occurred_at': '2025-12-18T03:00:33.249208Z', 'payload': {'call_control_id': 'v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg', 'call_leg_id': 'a97d0340-dbbd-11f0-8c36-02420aef961f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '52.56', 'jitter_packet_count': '0', 'mos': '4.49', 'packet_count': '1065', 'skip_packet_count': '20'}, 'outbound': {'packet_count': '1045', 'skip_packet_count': '0'}}, 'call_session_id': 'a97a4cb8-dbbd-11f0-98b1-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-18T03:00:33.249208Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'caller', 'sip_hangup_cause': 'unspecified', 'start_time': '2025-12-18T03:00:08.889211Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:37.342371617Z [err]  2025-12-18 03:00:33,701 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-18T03:00:37.342379678Z [err]  2025-12-18 03:00:34,697 - server - INFO - üìù Updated call log: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:37.342387134Z [err]  2025-12-18 03:00:34,729 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:37.342393865Z [err]  2025-12-18 03:00:34,729 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '214b564c-5200-4e5c-8b81-2e7071b104d8', 'occurred_at': '2025-12-18T03:00:34.615370Z', 'payload': {'call_control_id': 'v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg', 'call_leg_id': 'a97d0340-dbbd-11f0-8c36-02420aef961f', 'call_session_id': 'a97a4cb8-dbbd-11f0-98b1-02420aef961f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-18T03:00:33.376234Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-18T03:00:33.376234Z', 'recording_id': 'd4c73e97-c616-496c-9fba-a821525be94c', 'recording_started_at': '2025-12-18T03:00:13.792155Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-18/a97d0340-dbbd-11f0-8c36-02420aef961f-1766026812892054.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251218%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251218T030034Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=649aaaaebdb746617eb4ea1debcba19022570e536c5d2bdad8d2927161b0b405'}, 'start_time': '2025-12-18T03:00:13.792155Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:37.342400494Z [err]  2025-12-18 03:00:34,729 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:37.342407276Z [err]  2025-12-18 03:00:34,729 - server - INFO - üì® ================================================
2025-12-18T03:00:38.313641852Z [err]  2025-12-18 03:00:34,729 - server - INFO - üéôÔ∏è Recording saved for call: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.313723110Z [err]  2025-12-18 03:00:34,744 - redis_service - INFO - üì• Retrieved call data from Redis: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.313733451Z [err]  2025-12-18 03:00:34,744 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=d4c73e97-c616-496c-9fba-a821525be94c, call_data=True
2025-12-18T03:00:38.313743012Z [err]  2025-12-18 03:00:34,796 - server - INFO - ‚úÖ Finalized call log: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg (duration=22s, status=completed)
2025-12-18T03:00:38.313789495Z [err]  2025-12-18 03:00:34,835 - server - INFO - üíæ Saved recording URL and ID to database: d4c73e97-c616-496c-9fba-a821525be94c
2025-12-18T03:00:38.313800136Z [err]  2025-12-18 03:00:34,835 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-18T03:00:38.313810060Z [err]  2025-12-18 03:00:34,835 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-18T03:00:38.314390218Z [err]  2025-12-18 03:00:35,150 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-18/a97d0340-dbbd-11f0-8c36-02420aef961f-1766026812892054.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251218%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251218T030034Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=649aaaaebdb746617eb4ea1debcba19022570e536c5d2bdad8d2927161b0b405 "HTTP/1.1 200 OK"
2025-12-18T03:00:38.314404178Z [err]  2025-12-18 03:00:35,323 - server - INFO - ‚úÖ Downloaded 78410 bytes
2025-12-18T03:00:38.314415914Z [err]  2025-12-18 03:00:35,552 - server - INFO - üìä Auto-added call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-18T03:00:38.317191013Z [err]  2025-12-18 03:00:35,582 - server - INFO - ‚úÖ Split into 2 channels
2025-12-18T03:00:38.317201719Z [err]  2025-12-18 03:00:35,582 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-18T03:00:38.317209973Z [err]  2025-12-18 03:00:35,582 - server - INFO - üìä Channel 0: 427724 bytes
2025-12-18T03:00:38.317217448Z [err]  2025-12-18 03:00:35,582 - server - ERROR - ‚ùå No Soniox API key available
2025-12-18T03:00:38.317224697Z [err]  2025-12-18 03:00:35,583 - server - INFO - ‚ùå Channel 0: No speech
2025-12-18T03:00:38.317231710Z [err]  2025-12-18 03:00:35,583 - server - INFO - üìä Channel 1: 427724 bytes
2025-12-18T03:00:38.317261045Z [err]  2025-12-18 03:00:35,583 - server - ERROR - ‚ùå No Soniox API key available
2025-12-18T03:00:38.317268587Z [err]  2025-12-18 03:00:35,583 - server - INFO - ‚ùå Channel 1: No speech
2025-12-18T03:00:38.317276516Z [err]  2025-12-18 03:00:35,583 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-18T03:00:38.317284742Z [inf]  100.64.0.9:36618 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:38.317292476Z [err]  2025-12-18 03:00:35,745 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-18T03:00:38.317300468Z [err]  2025-12-18 03:00:35,749 - redis_service - INFO - üì• Retrieved call data from Redis: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.317308933Z [err]  2025-12-18 03:00:35,750 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2025-12-18T03:00:38.317318304Z [err]  2025-12-18 03:00:35,750 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-18T03:00:38.317326338Z [err]  2025-12-18 03:00:35,846 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-18T03:00:38.317334317Z [err]  2025-12-18 03:00:35,940 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-18T03:00:38.324175476Z [err]  2025-12-18 03:00:35,940 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-18T03:00:38.324184472Z [err]  2025-12-18 03:00:35,940 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-18T03:00:38.324193539Z [err]  2025-12-18 03:00:35,940 - server - INFO - üöÄ Triggered QC analysis for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324200534Z [err]  2025-12-18 03:00:35,941 - server - INFO - üìä Triggered Campaign QC for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324213262Z [err]  2025-12-18 03:00:35,941 - server - INFO - üìá Triggered CRM update for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324216539Z [err]  2025-12-18 03:00:36,311 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:38.324216932Z [err]  2025-12-18 03:00:35,948 - server - INFO - üìá CRM update starting for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:00:38.324226233Z [err]  2025-12-18 03:00:36,340 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:00:38.324227886Z [err]  2025-12-18 03:00:35,941 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324228111Z [err]  2025-12-18 03:00:35,948 - server - INFO - üìá Normalized phone: +17708336397
2025-12-18T03:00:38.324230973Z [err]  2025-12-18 03:00:36,340 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-18T03:00:38.324237152Z [err]  2025-12-18 03:00:36,340 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324239575Z [err]  2025-12-18 03:00:35,951 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-18T03:00:38.324240607Z [err]  2025-12-18 03:00:35,945 - redis_service - INFO - üßπ Deleted call data from Redis: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324249729Z [err]  2025-12-18 03:00:35,952 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-18T03:00:38.324250679Z [err]  2025-12-18 03:00:36,152 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:38.324251464Z [err]  2025-12-18 03:00:35,946 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324262872Z [err]  2025-12-18 03:00:36,216 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:38.324262883Z [inf]  100.64.0.12:20794 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:38.324264439Z [err]  2025-12-18 03:00:36,042 - server - INFO - üìù Converted transcript from 3 messages to 156 characters
2025-12-18T03:00:38.324273810Z [err]  2025-12-18 03:00:35,946 - server - INFO - üîç Starting QC analysis for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:38.324277161Z [err]  2025-12-18 03:00:36,122 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-18T03:00:38.324277532Z [err]  2025-12-18 03:00:36,247 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-18T03:00:38.324284612Z [err]  2025-12-18 03:00:35,947 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-18T03:00:39.388117016Z [err]  2025-12-18 03:00:36,341 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-18T03:00:39.388125707Z [err]  2025-12-18 03:00:36,341 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-18T03:00:39.388133022Z [err]  2025-12-18 03:00:36,341 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-18T03:00:39.388141119Z [err]  2025-12-18 03:00:36,341 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-18T03:00:39.388147781Z [err]  2025-12-18 03:00:36,456 - calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2025-12-18T03:00:39.388153564Z [err]  2025-12-18 03:00:36,458 - calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-18T03:00:39.388160891Z [err]  2025-12-18 03:00:36,458 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2025-12-18T03:00:39.388168542Z [err]  2025-12-18 03:00:36,458 - calling_service - INFO - ü§ñ Agent started speaking for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:39.388176018Z [err]  2025-12-18 03:00:36,458 - telnyx_service - INFO - üîä Speaking text on call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg: Are you still there?...
2025-12-18T03:00:39.388183146Z [err]  2025-12-18 03:00:36,458 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-18T03:00:39.388190302Z [err]  2025-12-18 03:00:36,458 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-18T03:00:39.388197658Z [err]  2025-12-18 03:00:36,458 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-18T03:00:39.388204634Z [err]  2025-12-18 03:00:36,458 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-18T03:00:39.388211865Z [err]  2025-12-18 03:00:36,458 - server - INFO - ‚è±Ô∏è [03:00:36.458] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-18T03:00:40.955523525Z [err]  2025-12-18 03:00:36,458 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-18T03:00:40.955571008Z [err]  2025-12-18 03:00:36,458 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-18T03:00:40.955581108Z [err]  2025-12-18 03:00:36,505 - server - INFO - üìá CRM: Total variables collected: []
2025-12-18T03:00:40.955587627Z [err]  2025-12-18 03:00:36,541 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=3, logs_count=4, status=completed
2025-12-18T03:00:40.955593994Z [err]  2025-12-18 03:00:36,542 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:40.955600050Z [err]  2025-12-18 03:00:36,542 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-18T03:00:40.955607509Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Text length: 20 chars
2025-12-18T03:00:40.955612613Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Text content: 'Are you still there?'
2025-12-18T03:00:40.955619678Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-18T03:00:40.955626289Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-18T03:00:40.955631864Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-18T03:00:40.955641787Z [err]  2025-12-18 03:00:36,542 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-18T03:00:40.955650906Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-18T03:00:40.955656512Z [err]  2025-12-18 03:00:36,542 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-18T03:00:42.403289287Z [err]  2025-12-18 03:00:36,680 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-18T03:00:42.403301075Z [err]  2025-12-18 03:00:36,897 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-18T03:00:42.403307326Z [err]  2025-12-18 03:00:36,897 - server - INFO -    ‚úì Connection established (0.355s) [TARGET: <200ms]
2025-12-18T03:00:42.403312543Z [err]  2025-12-18 03:00:36,897 - server - INFO -    ‚úì Response status: 200
2025-12-18T03:00:42.403317742Z [err]  2025-12-18 03:00:36,897 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-18T03:00:42.403323378Z [err]  2025-12-18 03:00:36,909 - server - INFO -    ‚úì FIRST CHUNK received (0.366s, 1026 bytes) [TARGET: <300ms]
2025-12-18T03:00:42.403328150Z [err]  2025-12-18 03:00:36,911 - server - INFO -    ‚úì ALL CHUNKS received: 31 chunks (0.368s)
2025-12-18T03:00:42.403335589Z [err]  2025-12-18 03:00:36,911 - server - INFO -    ‚úì Total audio size: 16345 bytes
2025-12-18T03:00:42.403340063Z [err]  2025-12-18 03:00:36,911 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-18T03:00:42.403346155Z [err]  2025-12-18 03:00:36,911 - server - INFO -       - Connection: 355ms
2025-12-18T03:00:42.403353175Z [err]  2025-12-18 03:00:36,911 - server - INFO -       - First chunk: 366ms
2025-12-18T03:00:42.403402209Z [err]  2025-12-18 03:00:36,912 - server - INFO -       - All chunks: 368ms
2025-12-18T03:00:42.404866131Z [err]  2025-12-18 03:00:36,542 - server - INFO -    Timeout: 10.0s
2025-12-18T03:00:42.404878476Z [err]  2025-12-18 03:00:36,553 - server - INFO -    ‚úì HTTP client created (0.011s)
2025-12-18T03:00:42.404886273Z [err]  2025-12-18 03:00:36,553 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-18T03:00:44.125258408Z [err]  2025-12-18 03:00:36,912 - server - INFO -       - Audio generation only: 11ms
2025-12-18T03:00:44.125269851Z [err]  2025-12-18 03:00:36,912 - server - INFO - ‚è±Ô∏è [03:00:36.912] üîä TTS COMPLETE: 453ms, audio_size=16345 bytes
2025-12-18T03:00:44.125288665Z [err]  2025-12-18 03:00:36,912 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (16345 bytes)
2025-12-18T03:00:44.125297805Z [err]  2025-12-18 03:00:36,912 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.45s
2025-12-18T03:00:44.125305971Z [err]  2025-12-18 03:00:36,913 - telnyx_service - INFO - ‚úÖ Generated 16345 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:00:44.125316126Z [err]  2025-12-18 03:00:36,913 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:00:44.125325161Z [err]  2025-12-18 03:00:37,003 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-18T03:00:44.125327789Z [err]  2025-12-18 03:00:37,097 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-18T03:00:44.125334413Z [err]  2025-12-18 03:00:37,019 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-18T03:00:44.125337448Z [err]  2025-12-18 03:00:37,097 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-18T03:00:44.125345266Z [err]  2025-12-18 03:00:37,097 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-18T03:00:44.125412242Z [err]  2025-12-18 03:00:37,021 - telnyx_service - INFO - ‚úÖ Call initiated: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:45.617313203Z [err]  2025-12-18 03:00:37,098 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-18T03:00:45.617321309Z [err]    File "/app/backend/server.py", line 9683, in trigger_campaign_qc_for_call
2025-12-18T03:00:45.617328853Z [err]      await run_full_qc_analysis(
2025-12-18T03:00:45.617336339Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-18T03:00:45.617344218Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-18T03:00:45.617351734Z [err]  
2025-12-18T03:00:45.617358152Z [err]  2025-12-18 03:00:37,120 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:00:45.617365751Z [err]  2025-12-18 03:00:37,121 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.21s
2025-12-18T03:00:45.617374604Z [err]  2025-12-18 03:00:37,122 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-18T03:00:45.617381907Z [err]    "errors": [
2025-12-18T03:00:45.617390224Z [err]      {
2025-12-18T03:00:45.617396874Z [err]        "code": "90018",
2025-12-18T03:00:45.617403838Z [err]        "title": "Call has already ended",
2025-12-18T03:00:45.617410358Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-18T03:00:45.617418295Z [err]      }
2025-12-18T03:00:45.617425891Z [err]    ]
2025-12-18T03:00:45.617432969Z [err]  }
2025-12-18T03:00:45.617440288Z [err]  2025-12-18 03:00:37,123 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-18T03:00:45.617447483Z [err]  2025-12-18 03:00:37,125 - server - INFO - üìù Created call log: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:45.617455256Z [err]  2025-12-18 03:00:37,125 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-18T03:00:46.833453856Z [err]  2025-12-18 03:00:37,125 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-18T03:00:47.911172873Z [err]  2025-12-18 03:00:37,125 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-18T03:00:47.911179426Z [err]  2025-12-18 03:00:37,125 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-18T03:00:47.911184881Z [err]  2025-12-18 03:00:37,148 - redis_service - INFO - üì¶ Stored call data in Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (TTL: 3600s)
2025-12-18T03:00:47.911191514Z [err]  2025-12-18 03:00:37,148 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-18T03:00:47.911198634Z [err]  2025-12-18 03:00:37,148 - server - INFO - üìû Outbound call initiated: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:47.911207459Z [inf]  100.64.0.3:32056 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-18T03:00:47.911214570Z [err]  2025-12-18 03:00:37,340 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-18T03:00:47.911221871Z [err]  2025-12-18 03:00:37,340 - server - INFO -    Client: Address(host='100.64.0.13', port=29100)
2025-12-18T03:00:47.911228166Z [err]  2025-12-18 03:00:37,340 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '2HXns81mYBbO45JGLUJwVg==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': '_OGDh5rGRXa6yKqALPU1MQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766026837111', 'accept-encoding': 'gzip'}
2025-12-18T03:00:47.911234801Z [err]  2025-12-18 03:00:37,340 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-18T03:00:47.911242910Z [err]  2025-12-18 03:00:37,340 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-18T03:00:48.770244961Z [err]  [2025-12-18 03:00:37 +0000] [4] [INFO] ('100.64.0.13', 29100) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-18T03:00:48.770250030Z [err]  2025-12-18 03:00:37,340 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-18T03:00:48.770261806Z [err]  [2025-12-18 03:00:37 +0000] [4] [INFO] connection open
2025-12-18T03:00:48.770266791Z [err]  2025-12-18 03:00:37,353 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:00:48.770271636Z [err]  2025-12-18 03:00:37,358 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-18T03:00:48.770276908Z [err]  2025-12-18 03:00:37,358 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-18T03:00:48.770284586Z [err]  2025-12-18 03:00:37,360 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.770289751Z [err]  2025-12-18 03:00:37,360 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '86103aed-02d9-4a7f-bb23-4e239db5262c', 'occurred_at': '2025-12-18T03:00:36.820569Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.770294914Z [err]  2025-12-18 03:00:37,361 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.772997893Z [err]  2025-12-18 03:00:37,361 - server - INFO - üì® ================================================
2025-12-18T03:00:48.773005909Z [err]  2025-12-18 03:00:37,361 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-18T03:00:48.773010885Z [inf]  100.64.0.5:56636 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.773016440Z [err]  2025-12-18 03:00:37,497 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-18T03:00:48.773021379Z [err]  2025-12-18 03:00:37,497 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-18T03:00:48.773027668Z [err]  2025-12-18 03:00:37,542 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-18T03:00:48.773032400Z [err]  2025-12-18 03:00:37,543 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-18T03:00:48.773040413Z [err]  2025-12-18 03:00:37,860 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-18T03:00:48.773045030Z [err]  2025-12-18 03:00:37,860 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766026837.860888 for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:48.773049665Z [err]  2025-12-18 03:00:37,860 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:48.773054231Z [err]  2025-12-18 03:00:39,741 - server - INFO - üì¨ Received Telnyx event: start
2025-12-18T03:00:48.773058507Z [err]  2025-12-18 03:00:39,741 - server - INFO - üé¨ Stream started for call: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.773063034Z [err]  2025-12-18 03:00:39,752 - redis_service - INFO - üì• Retrieved call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.784301192Z [err]  2025-12-18 03:00:39,754 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-18T03:00:48.784312149Z [err]  2025-12-18 03:00:39,754 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-18T03:00:48.784320997Z [err]  2025-12-18 03:00:39,755 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.784330447Z [err]  2025-12-18 03:00:39,755 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': '1d3e5c5a-2476-4162-bf90-53a03c903003', 'occurred_at': '2025-12-18T03:00:39.440567Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-18T03:00:36.820569Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.784342927Z [err]  2025-12-18 03:00:39,755 - server - INFO - üéØ Event type: call.answered, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.784352637Z [err]  2025-12-18 03:00:39,755 - server - INFO - üì® ================================================
2025-12-18T03:00:48.784362540Z [err]  2025-12-18 03:00:39,755 - server - INFO - ‚úÖ Call answered: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.784371486Z [err]  2025-12-18 03:00:39,778 - redis_service - INFO - üì• Retrieved call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.784381995Z [err]  2025-12-18 03:00:39,782 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-18T03:00:48.784391591Z [err]  2025-12-18 03:00:39,784 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-18T03:00:48.784727776Z [err]  2025-12-18 03:00:39,881 - server - INFO - ‚úÖ Call log updated
2025-12-18T03:00:48.784734898Z [err]  2025-12-18 03:00:39,881 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-18T03:00:48.784762538Z [err]  2025-12-18 03:00:39,881 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-18T03:00:48.784771720Z [err]  2025-12-18 03:00:39,881 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:00:48.784778540Z [err]  2025-12-18 03:00:39,893 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:00:48.784785948Z [err]  2025-12-18 03:00:39,897 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-18T03:00:48.784792853Z [err]  2025-12-18 03:00:39,900 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:48.784802722Z [err]  2025-12-18 03:00:39,980 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.784809106Z [err]  2025-12-18 03:00:40,075 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.784816443Z [err]  2025-12-18 03:00:40,075 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-18T03:00:48.784823933Z [err]  2025-12-18 03:00:40,113 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-18T03:00:48.784831374Z [err]  2025-12-18 03:00:40,254 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-18T03:00:48.784838270Z [err]  2025-12-18 03:00:40,254 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-18T03:00:48.789620096Z [err]  2025-12-18 03:00:40,318 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/playback_start "HTTP/1.1 200 OK"
2025-12-18T03:00:48.789633395Z [err]  2025-12-18 03:00:40,319 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: RwQbnSaLwQ (loop=True, overlay=True)
2025-12-18T03:00:48.789643962Z [err]  2025-12-18 03:00:40,319 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w'
2025-12-18T03:00:48.789653654Z [err]  2025-12-18 03:00:40,319 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.789662704Z [err]  2025-12-18 03:00:40,438 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.789683225Z [err]  2025-12-18 03:00:40,438 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'f25a7630-ce58-4045-bc8f-2e3587c713ee', 'occurred_at': '2025-12-18T03:00:39.980565Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '037a6a71-0523-462e-a345-b824f0bc462f', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.789993046Z [err]  2025-12-18 03:00:40,267 - redis_service - INFO - üì• Retrieved call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.789999091Z [err]  2025-12-18 03:00:40,269 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:00:48.790006514Z [err]  2025-12-18 03:00:40,269 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-18T03:00:48.793723036Z [err]  2025-12-18 03:00:40,438 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.793729552Z [err]  2025-12-18 03:00:40,438 - server - INFO - üì® ================================================
2025-12-18T03:00:48.793736133Z [inf]  100.64.0.8:55940 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.793742580Z [err]  2025-12-18 03:00:40,478 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=2.6s, checkin_count=1/2
2025-12-18T03:00:48.793749947Z [err]  2025-12-18 03:00:40,800 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.793755028Z [err]  2025-12-18 03:00:40,800 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'ec31cb4c-69db-4f36-b052-2d0f4ec11cd6', 'occurred_at': '2025-12-18T03:00:40.500566Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'RwQbnSaLwQ', 'start_time': '2025-12-18T03:00:40.500566Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.793774092Z [err]  2025-12-18 03:00:40,800 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.793779973Z [err]  2025-12-18 03:00:40,800 - server - INFO - üì® ================================================
2025-12-18T03:00:48.793787258Z [inf]  100.64.0.6:10768 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.793794167Z [err]  2025-12-18 03:00:40,979 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=3.1s, checkin_count=1/2
2025-12-18T03:00:48.794470402Z [err]  2025-12-18 03:00:41,882 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/record_start "HTTP/1.1 200 OK"
2025-12-18T03:00:48.794477043Z [err]  2025-12-18 03:00:41,886 - server - INFO - üéôÔ∏è Call recording started for v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.794483942Z [err]  2025-12-18 03:00:41,886 - server - INFO - üîß Creating call session for v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w...
2025-12-18T03:00:48.794490642Z [err]  2025-12-18 03:00:41,886 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:00:48.794497362Z [err]  2025-12-18 03:00:41,886 - server - INFO - üîß Calling create_call_session() - START
2025-12-18T03:00:48.794508334Z [err]  2025-12-18 03:00:41,886 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-18T03:00:48.794516066Z [err]  2025-12-18 03:00:41,890 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-18T03:00:48.794522956Z [err]  2025-12-18 03:00:41,891 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-18T03:00:48.794530333Z [err]  2025-12-18 03:00:41,891 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-18T03:00:48.794537125Z [err]  2025-12-18 03:00:41,891 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-18T03:00:48.794547124Z [err]  2025-12-18 03:00:41,905 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-18T03:00:48.794554142Z [err]  2025-12-18 03:00:41,905 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-18T03:00:48.797595881Z [err]  2025-12-18 03:00:41,905 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-18T03:00:48.797608091Z [err]  2025-12-18 03:00:41,983 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-18T03:00:48.797616032Z [err]  2025-12-18 03:00:41,983 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-18T03:00:48.797622588Z [err]  2025-12-18 03:00:41,983 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-18T03:00:48.797782708Z [err]  2025-12-18 03:00:41,983 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-18T03:00:48.797788874Z [err]  2025-12-18 03:00:41,983 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-18T03:00:48.797815537Z [err]  2025-12-18 03:00:42,084 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.797821649Z [err]  2025-12-18 03:00:42,095 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 111ms
2025-12-18T03:00:48.797827147Z [err]  2025-12-18 03:00:42,095 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-18T03:00:48.798270443Z [err]  2025-12-18 03:00:42,095 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-18T03:00:48.798289552Z [err]  2025-12-18 03:00:42,113 - redis_service - INFO - üì¶ Stored call data in Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (TTL: 3600s)
2025-12-18T03:00:48.798301013Z [err]  2025-12-18 03:00:42,113 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-18T03:00:48.798313967Z [err]  2025-12-18 03:00:42,113 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-18T03:00:48.798327066Z [err]  2025-12-18 03:00:42,116 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.801365904Z [err]  2025-12-18 03:00:42,116 - server - INFO - ü§ñ AI session created for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.801373322Z [err]  2025-12-18 03:00:42,116 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-18T03:00:48.801379801Z [err]  2025-12-18 03:00:42,116 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-18T03:00:48.801385962Z [err]  2025-12-18 03:00:42,116 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-18T03:00:48.801398691Z [err]  2025-12-18 03:00:42,116 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-18T03:00:48.801404451Z [err]  2025-12-18 03:00:42,116 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-18T03:00:48.801411091Z [err]  2025-12-18 03:00:42,116 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-18T03:00:48.801417048Z [err]  2025-12-18 03:00:42,116 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-18T03:00:48.801423558Z [err]  2025-12-18 03:00:42,116 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-18T03:00:48.801430747Z [err]  2025-12-18 03:00:42,116 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-18T03:00:48.801437591Z [inf]  100.64.0.8:10214 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.801444957Z [err]  2025-12-18 03:00:42,493 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.801453169Z [err]  2025-12-18 03:00:42,504 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 598ms
2025-12-18T03:00:48.804465484Z [err]  2025-12-18 03:00:42,504 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-18T03:00:48.804472632Z [err]  2025-12-18 03:00:42,504 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-18T03:00:48.804478040Z [err]  2025-12-18 03:00:42,504 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-18T03:00:48.804486827Z [err]  2025-12-18 03:00:42,504 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-18T03:00:48.804493649Z [err]  2025-12-18 03:00:42,504 - server - INFO - ‚úÖ Initialized call_states for v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w with session reference
2025-12-18T03:00:48.804500441Z [err]  2025-12-18 03:00:42,504 - server - INFO - ‚úÖ Stored Telnyx WebSocket in call_data for audio streaming
2025-12-18T03:00:48.804505914Z [err]  2025-12-18 03:00:42,504 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found to update for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.804512047Z [err]  2025-12-18 03:00:42,514 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-18T03:00:48.804517490Z [err]  2025-12-18 03:00:42,605 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-18T03:00:48.804522729Z [err]  2025-12-18 03:00:43,114 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-18T03:00:48.804528469Z [err]  2025-12-18 03:00:43,117 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-18T03:00:48.804536643Z [err]  2025-12-18 03:00:43,117 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-18T03:00:48.804543143Z [err]  2025-12-18 03:00:43,189 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-18T03:00:48.804550154Z [err]  2025-12-18 03:00:43,189 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.807652999Z [err]  2025-12-18 03:00:43,200 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.807662241Z [err]  2025-12-18 03:00:43,201 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-18T03:00:48.807671306Z [err]  2025-12-18 03:00:43,708 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.807680700Z [err]  2025-12-18 03:00:44,233 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.807689256Z [err]  2025-12-18 03:00:44,535 - redis_service - INFO - üì• Retrieved call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.807696851Z [err]  2025-12-18 03:00:44,573 - redis_service - INFO - üì¶ Stored call data in Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (TTL: 3600s)
2025-12-18T03:00:48.807705516Z [err]  2025-12-18 03:00:44,573 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-18T03:00:48.807713341Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - ‚è±Ô∏è [03:00:44.573] üì• process_user_input() ENTRY - text: '...'
2025-12-18T03:00:48.807721599Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - ‚è±Ô∏è [03:00:44.573] ‚è© About to call _process_call_flow_streaming()
2025-12-18T03:00:48.807728881Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - ‚è±Ô∏è [03:00:44.573] üîÄ Agent type: call_flow, calling flow processor...
2025-12-18T03:00:48.807735885Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - ‚è±Ô∏è [03:00:44.573] üîÄ _process_call_flow_streaming() ENTRY
2025-12-18T03:00:48.807746370Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-18T03:00:48.809309684Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - ‚è±Ô∏è [03:00:44.573] ‚úÖ Node selected, about to process content...
2025-12-18T03:00:48.809318102Z [err]  2025-12-18 03:00:44,573 - calling_service - INFO - üîß Replaced {{now}} with Wednesday, December 17, 2025 at 10:00 PM EST in content
2025-12-18T03:00:48.809327740Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-18T03:00:48.809335626Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-18T03:00:48.809343204Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-18T03:00:48.809351108Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-18T03:00:48.809358833Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-18T03:00:48.809368160Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-18T03:00:48.809377195Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-18T03:00:48.809386155Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-18T03:00:48.809396993Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-18T03:00:48.809404077Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-18T03:00:48.809410113Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-18T03:00:48.809417171Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-18T03:00:48.811486072Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - ‚è±Ô∏è [03:00:44.574] üìÑ About to process content (mode=script, length=9)
2025-12-18T03:00:48.811492785Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üîä Silence tracking reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user responded)
2025-12-18T03:00:48.811499570Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-18T03:00:48.811507011Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-18T03:00:48.811515001Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - LLM response (0.00s): Kendrick?
2025-12-18T03:00:48.811522205Z [err]  2025-12-18 03:00:44,574 - calling_service - INFO - Total latency: 0.00s
2025-12-18T03:00:48.811533674Z [err]  2025-12-18 03:00:44,574 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-18T03:00:48.811540357Z [err]  2025-12-18 03:00:44,670 - telnyx_service - INFO - üîä Speaking text on call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w: Kendrick?...
2025-12-18T03:00:48.811546298Z [err]  2025-12-18 03:00:44,670 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-18T03:00:48.811552736Z [err]  2025-12-18 03:00:44,670 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-18T03:00:48.811558191Z [err]  2025-12-18 03:00:44,670 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-18T03:00:48.811582713Z [err]  2025-12-18 03:00:44,670 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-18T03:00:48.811591411Z [err]  2025-12-18 03:00:44,670 - server - INFO - ‚è±Ô∏è [03:00:44.670] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-18T03:00:48.811597772Z [err]  2025-12-18 03:00:44,670 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-18T03:00:48.817903118Z [err]  2025-12-18 03:00:44,763 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.817912793Z [err]  2025-12-18 03:00:44,763 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-18T03:00:48.817920663Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Text length: 9 chars
2025-12-18T03:00:48.817924723Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-18T03:00:48.817929667Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Text content: 'Kendrick?'
2025-12-18T03:00:48.817939727Z [err]  2025-12-18 03:00:44,763 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-18T03:00:48.817942886Z [err]  2025-12-18 03:00:44,670 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-18T03:00:48.817945902Z [err]  2025-12-18 03:00:44,763 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-18T03:00:48.817951431Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-18T03:00:48.817960088Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Timeout: 10.0s
2025-12-18T03:00:48.817961875Z [err]  2025-12-18 03:00:44,757 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.817968651Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-18T03:00:48.817972064Z [err]  2025-12-18 03:00:44,775 - server - INFO -    ‚úì HTTP client created (0.011s)
2025-12-18T03:00:48.817978392Z [err]  2025-12-18 03:00:44,763 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-18T03:00:48.819722802Z [err]  2025-12-18 03:00:44,775 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-18T03:00:48.819730371Z [err]  2025-12-18 03:00:45,026 - server - INFO - üî§ RAW TOKENS: ["Hell"?]
2025-12-18T03:00:48.819737637Z [err]  2025-12-18 03:00:45,034 - calling_service - INFO - üîä Silence timer reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user started speaking)
2025-12-18T03:00:48.819745441Z [err]  2025-12-18 03:00:45,034 - calling_service - INFO - üë§ User started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.819759899Z [err]  2025-12-18 03:00:45,034 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hell' | Generating: False
2025-12-18T03:00:48.819766700Z [err]  2025-12-18 03:00:45,054 - calling_service - INFO - ‚è∞ Check-in triggered after 7.2s silence (threshold: 7s)
2025-12-18T03:00:48.819774699Z [err]  2025-12-18 03:00:45,076 - calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2025-12-18T03:00:48.819781181Z [err]  2025-12-18 03:00:45,076 - calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2025-12-18T03:00:48.819787297Z [err]  2025-12-18 03:00:45,076 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.2s silence: Are you still there?
2025-12-18T03:00:48.819793575Z [err]  2025-12-18 03:00:45,076 - calling_service - INFO - ü§ñ Agent started speaking for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:48.819800776Z [err]  2025-12-18 03:00:45,076 - telnyx_service - INFO - üîä Speaking text on call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg: Are you still there?...
2025-12-18T03:00:48.819808613Z [err]  2025-12-18 03:00:45,076 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-18T03:00:48.819815271Z [err]  2025-12-18 03:00:45,076 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-18T03:00:48.820964218Z [err]  2025-12-18 03:00:45,086 - server - INFO - üì• FINAL TOKENS: 'Hell o.' (2 tokens)
2025-12-18T03:00:48.820979417Z [err]  2025-12-18 03:00:45,086 - server - INFO - üé§ Soniox final transcript: 'Hell o.'
2025-12-18T03:00:48.820989866Z [err]  2025-12-18 03:00:45,077 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-18T03:00:48.820990674Z [err]  2025-12-18 03:00:45,087 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.820998904Z [err]  2025-12-18 03:00:45,087 - server - INFO - üîç FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-18T03:00:48.821002201Z [err]  2025-12-18 03:00:45,077 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-18T03:00:48.821009628Z [err]  2025-12-18 03:00:45,087 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.821012654Z [err]  2025-12-18 03:00:45,077 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (16345 bytes)
2025-12-18T03:00:48.821016877Z [err]  2025-12-18 03:00:45,077 - telnyx_service - INFO - ‚úÖ Generated 16345 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:00:48.821019944Z [err]  2025-12-18 03:00:45,087 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-18T03:00:48.821024267Z [err]  2025-12-18 03:00:45,077 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-18T03:00:48.821026451Z [err]  2025-12-18 03:00:45,077 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:00:48.821040165Z [err]  2025-12-18 03:00:45,085 - server - INFO - üî§ RAW TOKENS: ["Hell"‚úì, "o."‚úì, "<end>"‚úì]
2025-12-18T03:00:48.821047678Z [err]  2025-12-18 03:00:45,085 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-18T03:00:48.826826421Z [err]  2025-12-18 03:00:45,088 - server - INFO - ‚è±Ô∏è [03:00:45.088] üìù FINAL TRANSCRIPT RECEIVED: 'Hell o.'
2025-12-18T03:00:48.826887234Z [err]  2025-12-18 03:00:45,099 - server - INFO -    ‚úì Response status: 200
2025-12-18T03:00:48.826896637Z [err]  2025-12-18 03:00:45,101 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hell o.
2025-12-18T03:00:48.826907331Z [err]  2025-12-18 03:00:45,099 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-18T03:00:48.826910594Z [err]  2025-12-18 03:00:45,101 - calling_service - INFO - üë§ User stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.826941737Z [err]  2025-12-18 03:00:45,088 - server - INFO - ‚è±Ô∏è [03:00:45.088] STT endpoint detection latency: 3ms
2025-12-18T03:00:48.826951620Z [err]  2025-12-18 03:00:45,091 - server - INFO - ‚úÖ Agent SILENT - User said 2 word(s): 'Hell o.' - Processing...
2025-12-18T03:00:48.826952564Z [err]  2025-12-18 03:00:45,088 - server - INFO - ‚è±Ô∏è [03:00:45.088] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-18T03:00:48.826962631Z [err]  2025-12-18 03:00:45,091 - redis_service - INFO - üì¶ Stored call data in Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (TTL: 3600s)
2025-12-18T03:00:48.826968619Z [err]  2025-12-18 03:00:45,099 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-18T03:00:48.826973539Z [err]  2025-12-18 03:00:45,091 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-18T03:00:48.826979088Z [err]  2025-12-18 03:00:45,099 - server - INFO -    ‚úì Connection established (0.336s) [TARGET: <200ms]
2025-12-18T03:00:48.826987571Z [err]  2025-12-18 03:00:45,091 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.832901227Z [err]  2025-12-18 03:00:45,114 - server - INFO -       - Connection: 336ms
2025-12-18T03:00:48.832920263Z [err]  2025-12-18 03:00:45,108 - server - INFO -    ‚úì FIRST CHUNK received (0.345s, 1046 bytes) [TARGET: <300ms]
2025-12-18T03:00:48.832928577Z [err]  2025-12-18 03:00:45,113 - server - INFO -    ‚úì ALL CHUNKS received: 49 chunks (0.350s)
2025-12-18T03:00:48.832929299Z [err]  2025-12-18 03:00:45,101 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-18T03:00:48.832941584Z [err]  2025-12-18 03:00:45,101 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-18T03:00:48.832942101Z [err]  2025-12-18 03:00:45,113 - server - INFO -    ‚úì Total audio size: 14673 bytes
2025-12-18T03:00:48.832950909Z [err]  2025-12-18 03:00:45,101 - calling_service - INFO - ü§ñ Agent started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.832954070Z [err]  2025-12-18 03:00:45,114 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-18T03:00:48.832969683Z [err]  2025-12-18 03:00:45,101 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-18T03:00:48.832975808Z [err]  2025-12-18 03:00:45,101 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+16ms
2025-12-18T03:00:48.832981225Z [err]  2025-12-18 03:00:45,101 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 16ms (Soniox model: stt-rt-v3)
2025-12-18T03:00:48.834098386Z [err]  2025-12-18 03:00:45,114 - server - INFO -       - First chunk: 345ms
2025-12-18T03:00:48.834112468Z [err]  2025-12-18 03:00:45,114 - server - INFO -       - All chunks: 350ms
2025-12-18T03:00:48.834121416Z [err]  2025-12-18 03:00:45,114 - server - INFO -       - Audio generation only: 9ms
2025-12-18T03:00:48.834129569Z [err]  2025-12-18 03:00:45,115 - server - INFO - ‚è±Ô∏è [03:00:45.115] üîä TTS COMPLETE: 444ms, audio_size=14673 bytes
2025-12-18T03:00:48.834152644Z [err]  2025-12-18 03:00:45,115 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (14673 bytes)
2025-12-18T03:00:48.837107648Z [err]  2025-12-18 03:00:45,115 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.44s
2025-12-18T03:00:48.837113810Z [err]  2025-12-18 03:00:45,116 - telnyx_service - INFO - ‚úÖ Generated 14673 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-18T03:00:48.837120425Z [err]  2025-12-18 03:00:45,116 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-18T03:00:48.837126741Z [err]  2025-12-18 03:00:45,197 - server - INFO - üìù Saved user transcript to database
2025-12-18T03:00:48.837133190Z [err]  2025-12-18 03:00:45,197 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.837139550Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - ‚è±Ô∏è [03:00:45.198] üì• process_user_input() ENTRY - text: 'Hell o....'
2025-12-18T03:00:48.837146022Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - ‚è±Ô∏è [03:00:45.198] ‚è© About to call _process_call_flow_streaming()
2025-12-18T03:00:48.837151870Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - ‚è±Ô∏è [03:00:45.198] üîÄ Agent type: call_flow, calling flow processor...
2025-12-18T03:00:48.837157502Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - ‚è±Ô∏è [03:00:45.198] üîÄ _process_call_flow_streaming() ENTRY
2025-12-18T03:00:48.837163298Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-18T03:00:48.837168936Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-18T03:00:48.837180447Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - ‚è±Ô∏è [03:00:45.198] üîÄ About to call _follow_transition() for: Hell o....
2025-12-18T03:00:48.837186686Z [err]  2025-12-18 03:00:45,198 - calling_service - INFO - Evaluating transitions from Greeting for message: Hell o.
2025-12-18T03:00:48.839283478Z [err]  2025-12-18 03:00:45,211 - calling_service - INFO - ‚è±Ô∏è [03:00:45.211] üîÄ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-18T03:00:48.839297174Z [err]  2025-12-18 03:00:45,341 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.839303058Z [err]  2025-12-18 03:00:45,340 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.839315598Z [err]  2025-12-18 03:00:45,341 - server - INFO - üì® ================================================
2025-12-18T03:00:48.839317430Z [err]  2025-12-18 03:00:45,341 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'f35bf688-c070-494d-9cf2-ff6dc74392a8', 'occurred_at': '2025-12-18T03:00:44.980562Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.839322082Z [err]  2025-12-18 03:00:45,344 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-18T03:00:48.839329773Z [inf]  100.64.0.9:36618 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.839337226Z [err]  2025-12-18 03:00:45,341 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:00:48.839342021Z [err]    "errors": [
2025-12-18T03:00:48.839346658Z [err]  2025-12-18 03:00:45,344 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.27s
2025-12-18T03:00:48.843044990Z [err]  2025-12-18 03:00:45,477 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/playback_start "HTTP/1.1 200 OK"
2025-12-18T03:00:48.843054745Z [err]  2025-12-18 03:00:45,491 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-18T03:00:48.843062909Z [err]  2025-12-18 03:00:45,492 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:48.843070411Z [err]  2025-12-18 03:00:45,493 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.843247959Z [err]  2025-12-18 03:00:45,493 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.843257355Z [err]  2025-12-18 03:00:45,497 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.38s
2025-12-18T03:00:48.843264260Z [err]  2025-12-18 03:00:45,497 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.83s
2025-12-18T03:00:48.843271971Z [err]      {
2025-12-18T03:00:48.843278364Z [err]        "code": "90018",
2025-12-18T03:00:48.843284770Z [err]        "title": "Call has already ended",
2025-12-18T03:00:48.843291203Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-18T03:00:48.843297092Z [err]      }
2025-12-18T03:00:48.843304164Z [err]    ]
2025-12-18T03:00:48.843310174Z [err]  }
2025-12-18T03:00:48.843315528Z [err]  2025-12-18 03:00:45,345 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-18T03:00:48.843320630Z [err]  2025-12-18 03:00:45,458 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:00:48.848858591Z [err]  2025-12-18 03:00:45,497 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-18T03:00:48.848865861Z [err]  2025-12-18 03:00:45,497 - telnyx_service - INFO - üé¨ Playback ID: NYa-OihI-A
2025-12-18T03:00:48.848873949Z [err]  2025-12-18 03:00:45,498 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-18T03:00:48.848882002Z [err]  2025-12-18 03:00:45,498 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-18T03:00:48.848890547Z [err]  2025-12-18 03:00:45,606 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:00:48.848902056Z [err]  2025-12-18 03:00:45,607 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-18T03:00:48.848912527Z [err]  2025-12-18 03:00:45,607 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-18T03:00:48.848919351Z [err]  2025-12-18 03:00:45,778 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.848927368Z [err]  2025-12-18 03:00:45,778 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '44159def-678a-4fd0-a28d-07e096e7918f', 'occurred_at': '2025-12-18T03:00:45.560567Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'NYa-OihI-A'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.851921247Z [err]  2025-12-18 03:00:45,778 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.851927687Z [err]  2025-12-18 03:00:45,778 - server - INFO - üì® ================================================
2025-12-18T03:00:48.851935374Z [inf]  100.64.0.8:10214 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.851942110Z [err]  2025-12-18 03:00:45,992 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:00:48.851947564Z [err]  2025-12-18 03:00:46,033 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.851954093Z [err]  2025-12-18 03:00:46,033 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.851959910Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - ‚è±Ô∏è [03:00:46.034] üîÄ TRANSITION EVALUATION COMPLETE - took 823ms
2025-12-18T03:00:48.851965363Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - ü§ñ AI transition decision: '-1'
2025-12-18T03:00:48.851972258Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc) - don...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-18T03:00:48.851981152Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - Selected transition index: -1
2025-12-18T03:00:48.851986915Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-18T03:00:48.851993474Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - ‚ö†Ô∏è No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-18T03:00:48.856061942Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-18T03:00:48.856071416Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-18T03:00:48.856085989Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-18T03:00:48.856086053Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-18T03:00:48.856089756Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 836ms
2025-12-18T03:00:48.856094942Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-18T03:00:48.856102716Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-18T03:00:48.856108408Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - ‚è±Ô∏è [03:00:46.034] ‚úÖ Node selected, about to process content...
2025-12-18T03:00:48.856112287Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-18T03:00:48.856120004Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{now}} with Wednesday, December 17, 2025 at 10:00 PM EST in content
2025-12-18T03:00:48.856124881Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-18T03:00:48.856129556Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-18T03:00:48.856131579Z [err]  2025-12-18 03:00:46,034 - calling_service - INFO - üéØ Goal: Say the customer's name...
2025-12-18T03:00:48.856144226Z [err]  2025-12-18 03:00:46,035 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-18T03:00:48.859397128Z [err]  2025-12-18 03:00:46,036 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-18T03:00:48.859405152Z [err]  2025-12-18 03:00:46,036 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-18T03:00:48.859411956Z [err]  2025-12-18 03:00:46,036 - calling_service - INFO - ‚è±Ô∏è [03:00:46.036] üìÑ About to process content (mode=script, length=9)
2025-12-18T03:00:48.859418839Z [err]  2025-12-18 03:00:46,036 - calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2025-12-18T03:00:48.859425292Z [err]  2025-12-18 03:00:46,036 - server - INFO - üì§ Sentence arrived from LLM: Kendrick?...
2025-12-18T03:00:48.859432206Z [err]  2025-12-18 03:00:46,036 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 934ms
2025-12-18T03:00:48.859439419Z [err]  2025-12-18 03:00:46,036 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-18T03:00:48.859446268Z [err]  2025-12-18 03:00:46,036 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:00:48.859453024Z [err]  2025-12-18 03:00:46,036 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-18T03:00:48.859459045Z [err]  2025-12-18 03:00:46,132 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.859466529Z [err]  2025-12-18 03:00:46,225 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.859473992Z [err]  2025-12-18 03:00:46,318 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:00:48.859480860Z [err]  2025-12-18 03:00:46,357 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-18T03:00:48.859487712Z [err]  2025-12-18 03:00:46,357 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-18T03:00:48.861414589Z [err]  2025-12-18 03:00:46,358 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-18T03:00:48.861421702Z [err]  2025-12-18 03:00:46,358 - persistent_tts_service - INFO - üîå [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Establishing persistent TTS WebSocket...
2025-12-18T03:00:48.861428104Z [err]  2025-12-18 03:00:46,358 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-18T03:00:48.861435923Z [err]  2025-12-18 03:00:46,358 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-18T03:00:48.861442362Z [err]  2025-12-18 03:00:46,358 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-18T03:00:48.861451202Z [err]  2025-12-18 03:00:46,495 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-18T03:00:48.861457361Z [err]  2025-12-18 03:00:46,496 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-18T03:00:48.861463049Z [err]  2025-12-18 03:00:46,496 - persistent_tts_service - INFO - ‚úÖ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Persistent TTS WebSocket established
2025-12-18T03:00:48.861468483Z [err]  2025-12-18 03:00:46,496 - persistent_tts_service - INFO - üîä [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Comfort noise loop started
2025-12-18T03:00:48.861473285Z [err]  2025-12-18 03:00:46,496 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.861479060Z [err]  2025-12-18 03:00:46,496 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-18T03:00:48.868624874Z [err]  2025-12-18 03:00:46,496 - server - INFO - üîç Persistent TTS lookup: call_id=v3:j8ausWMipxI4MwivP..., session=FOUND
2025-12-18T03:00:48.868631454Z [err]  2025-12-18 03:00:46,496 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-18T03:00:48.868640580Z [err]  2025-12-18 03:00:46,496 - server - INFO - üéµ TTS task #1 started at +460ms
2025-12-18T03:00:48.868648304Z [err]  2025-12-18 03:00:46,496 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1395ms
2025-12-18T03:00:48.868654131Z [err]  2025-12-18 03:00:46,496 - calling_service - INFO - üì§ Streamed script sentence 1/1: Kendrick?...
2025-12-18T03:00:48.868660680Z [err]  2025-12-18 03:00:46,496 - calling_service - INFO - üîä Silence tracking reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user responded)
2025-12-18T03:00:48.868667514Z [err]  2025-12-18 03:00:46,496 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-18T03:00:48.868676899Z [err]  2025-12-18 03:00:46,496 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-18T03:00:48.868683523Z [err]  2025-12-18 03:00:46,496 - calling_service - INFO - LLM response (1.30s): Kendrick?
2025-12-18T03:00:48.868689666Z [err]  2025-12-18 03:00:46,496 - calling_service - INFO - Total latency: 1.30s
2025-12-18T03:00:48.868695918Z [err]  2025-12-18 03:00:46,496 - server - INFO - ‚úÖ LLM finished in 1395ms, TTS tasks already running in background
2025-12-18T03:00:48.868703235Z [err]  2025-12-18 03:00:46,496 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2025-12-18T03:00:48.868723997Z [err]  2025-12-18 03:00:46,496 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-18T03:00:48.868732126Z [err]  2025-12-18 03:00:46,497 - server - INFO -    1 sentences queued and playing seamlessly
2025-12-18T03:00:48.868738659Z [err]  2025-12-18 03:00:46,497 - persistent_tts_service - INFO - üéµ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Playback consumer started
2025-12-18T03:00:48.871776331Z [err]  2025-12-18 03:00:46,639 - server - INFO - üì® ================================================
2025-12-18T03:00:48.871794800Z [err]  2025-12-18 03:00:46,654 - redis_service - INFO - ‚ûñ Removed playback NYa-OihI-A, 0 remaining for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.871831741Z [err]  2025-12-18 03:00:46,497 - persistent_tts_service - INFO - üíì [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Starting TTS keep-alive loop (every 15s)
2025-12-18T03:00:48.871840998Z [err]  2025-12-18 03:00:46,497 - persistent_tts_service - INFO - üîä [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Starting comfort noise loop
2025-12-18T03:00:48.871847877Z [err]  2025-12-18 03:00:46,497 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-18T03:00:48.871857606Z [err]  2025-12-18 03:00:46,639 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:00:48.871865642Z [err]  2025-12-18 03:00:46,639 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'ab1904bf-e574-4be0-86e6-ad62179bb181', 'occurred_at': '2025-12-18T03:00:46.400566Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'NYa-OihI-A', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:00:48.871872071Z [err]  2025-12-18 03:00:46,639 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.875093922Z [err]  2025-12-18 03:00:46,654 - server - INFO - üîä Redis: Removed playback NYa-OihI-A, 0 remaining
2025-12-18T03:00:48.875101024Z [err]  2025-12-18 03:00:46,654 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-18T03:00:48.875107889Z [err]  2025-12-18 03:00:46,662 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-18T03:00:48.875119220Z [err]  2025-12-18 03:00:46,664 - server - INFO - üí° Session not on this worker - Redis flag set for WebSocket worker to handle
2025-12-18T03:00:48.875126081Z [inf]  100.64.0.7:26932 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:00:48.875134901Z [err]  2025-12-18 03:00:47,425 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-18T03:00:48.875141821Z [err]  2025-12-18 03:00:47,540 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-18T03:00:48.875148947Z [err]  2025-12-18 03:00:47,541 - persistent_tts_service - INFO - üé§ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Streaming sentence #1: Kendrick?...
2025-12-18T03:00:48.875155054Z [err]  2025-12-18 03:00:47,544 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-18T03:00:48.875161764Z [err]  2025-12-18 03:00:47,544 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766026847.5444608 for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.875168439Z [err]  2025-12-18 03:00:47,544 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.875175408Z [err]  2025-12-18 03:00:47,778 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-18T03:00:48.875182807Z [err]  2025-12-18 03:00:47,778 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTS_TTFB: First audio chunk at T+236ms
2025-12-18T03:00:48.877874115Z [err]  2025-12-18 03:00:47,778 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 236ms
2025-12-18T03:00:48.877879840Z [err]  2025-12-18 03:00:47,778 - persistent_tts_service - INFO - üì§ Sending 6671 bytes of audio (42 chunks, 0.8s duration) via WebSocket
2025-12-18T03:00:48.877885336Z [err]  2025-12-18 03:00:47,778 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-18T03:00:48.877890878Z [err]  2025-12-18 03:00:47,778 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2025-12-18T03:00:48.877896476Z [err]  2025-12-18 03:00:47,779 - persistent_tts_service - INFO - ‚úÖ Sent 42 audio chunks via WebSocket
2025-12-18T03:00:48.877902875Z [err]  2025-12-18 03:00:48,205 - server - INFO - üì§ Audio flowing: 394 packets sent to Soniox (5s update)
2025-12-18T03:00:48.877908620Z [err]  2025-12-18 03:00:48,781 - persistent_tts_service - INFO - üîá [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] FLOOR RELEASED (is_holding_floor=False)
2025-12-18T03:00:48.877914653Z [err]  2025-12-18 03:00:48,817 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2025-12-18T03:00:48.877921774Z [err]  2025-12-18 03:00:48,818 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.877927356Z [err]  2025-12-18 03:00:48,818 - calling_service - INFO - üîä Silence timer reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user started speaking)
2025-12-18T03:00:48.877932493Z [err]  2025-12-18 03:00:48,818 - calling_service - INFO - üë§ User started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:48.877937089Z [err]  2025-12-18 03:00:48,818 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: True
2025-12-18T03:00:48.880638454Z [err]  2025-12-18 03:00:48,818 - server - INFO - üö¶ BARGE-IN CHECK during response generation: 1 words - 'Ye'
2025-12-18T03:00:49.886142656Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-18T03:00:49.886159714Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-18T03:00:49.886191213Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-18T03:00:49.886203843Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 16ms (provider: soniox, model: stt-rt-v3)
2025-12-18T03:00:49.886215845Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1395ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-18T03:00:49.886239869Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-18T03:00:49.886240247Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 3743ms (provider: elevenlabs, websocket: False)
2025-12-18T03:00:49.886266725Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 4678ms (user stopped ‚Üí play_audio_url called)
2025-12-18T03:00:49.886317676Z [err]  2025-12-18 03:00:48,938 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2025-12-18T03:00:49.886326532Z [err]  2025-12-18 03:00:48,939 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: True
2025-12-18T03:00:49.886349671Z [err]  2025-12-18 03:00:48,939 - server - INFO - üö¶ BARGE-IN CHECK during response generation: 1 words - 'Ye'
2025-12-18T03:00:49.886363898Z [err]  2025-12-18 03:00:49,076 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2025-12-18T03:00:49.886373198Z [err]  2025-12-18 03:00:49,076 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-18T03:00:49.886379223Z [err]  2025-12-18 03:00:49,077 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2025-12-18T03:00:49.886389934Z [err]  2025-12-18 03:00:49,077 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-18T03:00:49.886398485Z [err]  2025-12-18 03:00:49,077 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2025-12-18T03:00:49.886404845Z [err]  2025-12-18 03:00:49,077 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.5s, generating=True, playbacks=0, is_active=True
2025-12-18T03:00:49.886411865Z [err]  2025-12-18 03:00:49,077 - server - INFO - üîï FILTERING 1-word/filler 'Yeah.' - NOT calling on_final_transcript
2025-12-18T03:00:49.886418197Z [err]  2025-12-18 03:00:49,077 - server - INFO - üîï SKIPPING endpoint for 1-word/filler 'Yeah.' (tts_speaking=False, is_active=True)
2025-12-18T03:00:49.886429192Z [err]  2025-12-18 03:00:49,077 - calling_service - INFO - üë§ User stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:49.886436291Z [err]  2025-12-18 03:00:49,077 - server - INFO - üë§ Marked user stopped speaking (filtered utterance)
2025-12-18T03:00:49.886442719Z [err]  2025-12-18 03:00:49,778 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-18T03:00:49.886485815Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-18T03:00:49.886495337Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-18T03:00:49.886508794Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 4978ms estimated
2025-12-18T03:00:49.886511111Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-18T03:00:49.886520998Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-18T03:00:49.886521278Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2025-12-18T03:00:49.886530578Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hell o....'
2025-12-18T03:00:49.886551600Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Kendrick?...'
2025-12-18T03:00:49.886561251Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-18T03:00:49.886574650Z [err]  2025-12-18 03:00:49,780 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-18T03:00:49.886912906Z [err]  2025-12-18 03:00:49,779 - persistent_tts_service - INFO - ‚úÖ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Finished streaming sentence #1: 1 chunks received
2025-12-18T03:00:49.886919907Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2025-12-18T03:00:49.886931390Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-18T03:00:49.886940138Z [err]  2025-12-18 03:00:49,779 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 4678ms from user stop üöÄ
2025-12-18T03:00:49.887025891Z [err]  2025-12-18 03:00:49,779 - calling_service - INFO - ü§ñ Agent started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:50.790374361Z [err]  2025-12-18 03:00:49,971 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1911ms)
2025-12-18T03:00:50.790381221Z [err]  2025-12-18 03:00:49,971 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-18T03:00:50.790387056Z [err]  2025-12-18 03:00:49,971 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-18T03:00:50.790393081Z [err]  2025-12-18 03:00:50,069 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (1.5s ago), marking agent as done speaking
2025-12-18T03:00:50.790400659Z [err]  2025-12-18 03:00:50,069 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766026850.0699718 for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:50.790405850Z [err]  2025-12-18 03:00:50,070 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:50.790424725Z [err]  2025-12-18 03:00:50,070 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-18T03:00:50.790429914Z [err]  2025-12-18 03:00:50,245 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-18T03:00:50.790435820Z [err]  2025-12-18 03:00:50,573 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=0/2
2025-12-18T03:00:50.790442529Z [err]  2025-12-18 03:00:50,758 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-18T03:00:51.980482551Z [err]  2025-12-18 03:00:51,719 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:00:51.980490414Z [err]  2025-12-18 03:00:51,722 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-18T03:00:51.980496203Z [err]  2025-12-18 03:00:51,818 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:51.980502301Z [err]  2025-12-18 03:00:51,819 - server - INFO - ‚úÖ QC analysis completed for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:51.980507056Z [err]  2025-12-18 03:00:51,819 - server - INFO - üìä Scores: Commitment=50, Conversion=20, Excellence=50
2025-12-18T03:00:52.942731504Z [err]  2025-12-18 03:00:52,007 - server - INFO - üìä Updated campaign_calls with QC scores for v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:52.942739166Z [err]  2025-12-18 03:00:52,196 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-18T03:00:52.942754221Z [err]  2025-12-18 03:00:52,289 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-18T03:00:52.942761763Z [err]  2025-12-18 03:00:52,289 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg: 'str' object has no attribute 'get'
2025-12-18T03:00:54.002139340Z [err]  2025-12-18 03:00:53,230 - server - INFO - üì§ Audio flowing: 645 packets sent to Soniox (5s update)
2025-12-18T03:00:54.002144545Z [err]  2025-12-18 03:00:53,352 - server - INFO - üé§ Soniox receiver alive - 13 messages received in last 10s
2025-12-18T03:00:54.002149507Z [err]  2025-12-18 03:00:53,810 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2025-12-18T03:00:54.002154707Z [err]  2025-12-18 03:00:53,811 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 15840, 'total_audio_proc_ms': 20160, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-18T03:00:54.002159757Z [err]  2025-12-18 03:00:53,811 - server - INFO - ‚úÖ Soniox receive loop ended normally
2025-12-18T03:00:54.002167251Z [err]  2025-12-18 03:00:53,812 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:54.002172814Z [err]  2025-12-18 03:00:53,812 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:opsH8IgTo8YPgq6vqQiI87E_SQNwtU6cNrLQBj0OR5Hoko-f7XpGLg
2025-12-18T03:00:54.002179103Z [err]  2025-12-18 03:00:53,812 - server - INFO - üîá Dead air monitoring task cancelled
2025-12-18T03:00:56.452434460Z [err]  2025-12-18 03:00:55,812 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-18T03:00:56.452441592Z [err]  2025-12-18 03:00:55,812 - server - INFO - üîå Telnyx WebSocket disconnected
2025-12-18T03:00:56.452449404Z [err]  2025-12-18 03:00:56,177 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2025-12-18T03:00:56.452456131Z [err]  2025-12-18 03:00:56,178 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:56.452463555Z [err]  2025-12-18 03:00:56,178 - calling_service - INFO - üîä Silence timer reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user started speaking)
2025-12-18T03:00:56.452472487Z [err]  2025-12-18 03:00:56,178 - calling_service - INFO - üë§ User started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:56.452481888Z [err]  2025-12-18 03:00:56,178 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2025-12-18T03:00:57.645270679Z [err]  2025-12-18 03:00:56,447 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2025-12-18T03:00:57.645283373Z [err]  2025-12-18 03:00:56,447 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-18T03:00:57.645293750Z [err]  2025-12-18 03:00:56,447 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-18T03:00:57.645302313Z [err]  2025-12-18 03:00:56,447 - server - INFO - ‚è±Ô∏è [03:00:56.447] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-18T03:00:57.645310007Z [err]  2025-12-18 03:00:56,447 - server - INFO - ‚è±Ô∏è [03:00:56.447] STT endpoint detection latency: 2ms
2025-12-18T03:00:57.645448236Z [err]  2025-12-18 03:00:56,446 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2025-12-18T03:00:57.645459096Z [err]  2025-12-18 03:00:56,446 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-18T03:00:57.645467953Z [err]  2025-12-18 03:00:56,447 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2025-12-18T03:00:57.645476443Z [err]  2025-12-18 03:00:56,447 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-18T03:00:57.645700828Z [err]  2025-12-18 03:00:56,447 - server - INFO - ‚è±Ô∏è [03:00:56.447] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-18T03:00:57.645716506Z [err]  2025-12-18 03:00:56,449 - redis_service - INFO - üì¶ Stored call data in Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (TTL: 3600s)
2025-12-18T03:00:57.645726829Z [err]  2025-12-18 03:00:56,449 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-18T03:00:57.645737960Z [err]  2025-12-18 03:00:56,449 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-18T03:00:57.645744498Z [err]  2025-12-18 03:00:56,460 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-18T03:00:58.956371644Z [err]  2025-12-18 03:00:56,465 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+20ms
2025-12-18T03:00:58.956387577Z [err]  2025-12-18 03:00:56,465 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 20ms (Soniox model: stt-rt-v3)
2025-12-18T03:00:58.956405295Z [err]  2025-12-18 03:00:56,465 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-18T03:00:58.956412476Z [err]  2025-12-18 03:00:56,465 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-18T03:00:58.956419167Z [err]  2025-12-18 03:00:56,465 - calling_service - INFO - ü§ñ Agent started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:58.956442578Z [err]  2025-12-18 03:00:56,460 - calling_service - INFO - üë§ User stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:00:58.956454211Z [err]  2025-12-18 03:00:56,465 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2025-12-18T03:00:58.956459566Z [err]  2025-12-18 03:00:56,562 - server - INFO - üìù Saved user transcript to database
2025-12-18T03:00:58.956463087Z [err]  2025-12-18 03:00:56,465 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-18T03:00:58.956483268Z [err]  2025-12-18 03:00:56,563 - calling_service - INFO - ‚è±Ô∏è [03:00:56.563] üì• process_user_input() ENTRY - text: 'Yeah....'
2025-12-18T03:00:58.956492449Z [err]  2025-12-18 03:00:56,563 - calling_service - INFO - ‚è±Ô∏è [03:00:56.563] ‚è© About to call _process_call_flow_streaming()
2025-12-18T03:00:58.956501634Z [err]  2025-12-18 03:00:56,563 - calling_service - INFO - ‚è±Ô∏è [03:00:56.563] üîÄ Agent type: call_flow, calling flow processor...
2025-12-18T03:00:58.956509817Z [err]  2025-12-18 03:00:56,563 - calling_service - INFO - ‚è±Ô∏è [03:00:56.563] üîÄ _process_call_flow_streaming() ENTRY
2025-12-18T03:00:58.956560429Z [err]  2025-12-18 03:00:56,563 - calling_service - INFO - Flow processing - History length: 5, Is first: False
2025-12-18T03:01:00.431515881Z [err]  2025-12-18 03:00:56,564 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-18T03:01:00.431525716Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - ‚è±Ô∏è [03:00:57.129] üîÄ TRANSITION EVALUATION COMPLETE - took 552ms
2025-12-18T03:01:00.431544258Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - ü§ñ AI transition decision: '0'
2025-12-18T03:01:00.431547036Z [err]  2025-12-18 03:00:56,576 - calling_service - INFO - ‚è±Ô∏è [03:00:56.576] üîÄ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-18T03:01:00.431564870Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc) - don...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-18T03:01:00.431568775Z [err]  2025-12-18 03:00:57,126 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:01:00.431583656Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - Selected transition index: 0
2025-12-18T03:01:00.431595723Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-18T03:01:00.431608419Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 565ms
2025-12-18T03:01:00.431666204Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - ‚è±Ô∏è [03:00:57.129] ‚úÖ Node selected, about to process content...
2025-12-18T03:01:00.431675680Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{now}} with Wednesday, December 17, 2025 at 10:00 PM EST in content
2025-12-18T03:01:00.433014203Z [err]  2025-12-18 03:00:56,563 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-18T03:01:00.433021493Z [err]  2025-12-18 03:00:56,564 - calling_service - INFO - ‚è±Ô∏è [03:00:56.564] üîÄ About to call _follow_transition() for: Yeah....
2025-12-18T03:01:02.173831479Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - ‚è±Ô∏è [03:00:57.129] üìÑ About to process content (mode=script, length=89)
2025-12-18T03:01:02.173845670Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2025-12-18T03:01:02.173877114Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-18T03:01:02.174654471Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-18T03:01:02.174660143Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-18T03:01:02.174666924Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-18T03:01:02.174677134Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-18T03:01:02.174686368Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-18T03:01:02.174693563Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-18T03:01:02.174701052Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-18T03:01:02.174707543Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-18T03:01:02.174714045Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-18T03:01:02.174721186Z [err]  2025-12-18 03:00:57,129 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-18T03:01:03.577959375Z [err]  2025-12-18 03:00:57,130 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-18T03:01:03.578886514Z [err]  2025-12-18 03:00:57,130 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2025-12-18T03:01:03.578894582Z [err]  2025-12-18 03:00:57,130 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 664ms
2025-12-18T03:01:03.578901201Z [err]  2025-12-18 03:00:57,130 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-18T03:01:03.578910402Z [err]  2025-12-18 03:00:57,130 - server - INFO - üîç Persistent TTS lookup: call_id=v3:j8ausWMipxI4MwivP..., session=FOUND
2025-12-18T03:01:03.578918808Z [err]  2025-12-18 03:00:57,130 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-18T03:01:03.578931157Z [err]  2025-12-18 03:00:57,130 - server - INFO - üéµ TTS task #1 started at +0ms
2025-12-18T03:01:03.578943004Z [err]  2025-12-18 03:00:57,130 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 664ms
2025-12-18T03:01:03.578951227Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2025-12-18T03:01:03.580067323Z [err]  2025-12-18 03:00:57,130 - server - INFO - üîç Persistent TTS lookup: call_id=v3:j8ausWMipxI4MwivP..., session=FOUND
2025-12-18T03:01:03.580080620Z [err]  2025-12-18 03:00:57,130 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-18T03:01:03.580088779Z [err]  2025-12-18 03:00:57,130 - server - INFO - üéµ TTS task #2 started at +0ms
2025-12-18T03:01:03.580096131Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-18T03:01:03.580102410Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - üîä Silence tracking reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user responded)
2025-12-18T03:01:04.755786262Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-18T03:01:04.755792227Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2025-12-18T03:01:04.755800425Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - LLM response (0.57s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-18T03:01:04.755807011Z [err]  2025-12-18 03:00:57,130 - calling_service - INFO - Total latency: 0.57s
2025-12-18T03:01:04.755813560Z [err]  2025-12-18 03:00:57,130 - server - INFO - ‚úÖ LLM finished in 665ms, TTS tasks already running in background
2025-12-18T03:01:04.755820930Z [err]  2025-12-18 03:00:57,130 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2025-12-18T03:01:04.755828188Z [err]  2025-12-18 03:00:57,130 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-18T03:01:04.755835008Z [err]  2025-12-18 03:00:57,130 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-18T03:01:04.755841336Z [err]  2025-12-18 03:00:57,130 - persistent_tts_service - INFO - üé§ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Streaming sentence #2: This is Jake......
2025-12-18T03:01:04.755847933Z [err]  2025-12-18 03:00:57,403 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-18T03:01:04.755853340Z [err]  2025-12-18 03:00:57,403 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTS_TTFB: First audio chunk at T+273ms
2025-12-18T03:01:04.755858050Z [err]  2025-12-18 03:00:57,403 - persistent_tts_service - INFO - üì§ Sending 8545 bytes of audio (54 chunks, 1.1s duration) via WebSocket
2025-12-18T03:01:04.755904856Z [err]  2025-12-18 03:00:57,403 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-18T03:01:06.132012478Z [err]  2025-12-18 03:00:59,733 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2025-12-18T03:01:06.132023979Z [err]  2025-12-18 03:00:58,248 - server - INFO - üì§ Audio flowing: 894 packets sent to Soniox (5s update)
2025-12-18T03:01:06.132030655Z [err]  2025-12-18 03:00:59,737 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-18T03:01:06.132039543Z [err]  2025-12-18 03:00:59,732 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTS_TTFB: First audio chunk at T+326ms
2025-12-18T03:01:06.132040753Z [err]  2025-12-18 03:00:59,404 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-18T03:01:06.132055010Z [err]  2025-12-18 03:00:59,732 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-18T03:01:06.132066358Z [err]  2025-12-18 03:00:59,732 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-18T03:01:06.132066703Z [err]  2025-12-18 03:00:57,403 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-18T03:01:06.132074341Z [err]  2025-12-18 03:00:57,405 - persistent_tts_service - INFO - ‚úÖ Sent 54 audio chunks via WebSocket
2025-12-18T03:01:06.132089304Z [err]  2025-12-18 03:00:59,405 - persistent_tts_service - INFO - ‚úÖ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Finished streaming sentence #2: 1 chunks received
2025-12-18T03:01:06.132097757Z [err]  2025-12-18 03:00:59,405 - persistent_tts_service - INFO - üé§ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2025-12-18T03:01:06.132106172Z [err]  2025-12-18 03:00:59,732 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-18T03:01:07.367679926Z [err]  2025-12-18 03:00:59,738 - persistent_tts_service - INFO - üì§ Sending 3669 bytes of audio (23 chunks, 0.5s duration) via WebSocket
2025-12-18T03:01:07.367689427Z [err]  2025-12-18 03:00:59,738 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-18T03:01:07.367694717Z [err]  2025-12-18 03:00:59,738 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.5s (total: 2.2s from now)
2025-12-18T03:01:07.367700241Z [err]  2025-12-18 03:00:59,740 - persistent_tts_service - INFO - ‚úÖ Sent 23 audio chunks via WebSocket
2025-12-18T03:01:07.367705884Z [err]  2025-12-18 03:00:59,912 - persistent_tts_service - INFO - üì§ Sending 17833 bytes of audio (112 chunks, 2.2s duration) via WebSocket
2025-12-18T03:01:07.367710598Z [err]  2025-12-18 03:00:59,912 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-18T03:01:07.367716316Z [err]  2025-12-18 03:00:59,912 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.2s (total: 4.2s from now)
2025-12-18T03:01:07.367723158Z [err]  2025-12-18 03:00:59,915 - persistent_tts_service - INFO - ‚úÖ Sent 112 audio chunks via WebSocket
2025-12-18T03:01:07.367729582Z [err]  2025-12-18 03:01:00,272 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - response generation still in progress
2025-12-18T03:01:07.367735972Z [err]  2025-12-18 03:01:00,290 - server - INFO - üî§ RAW TOKENS: [" Ban"?]
2025-12-18T03:01:07.367742707Z [err]  2025-12-18 03:01:00,291 - calling_service - INFO - üîä Silence timer reset for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (user started speaking)
2025-12-18T03:01:07.367749350Z [err]  2025-12-18 03:01:00,291 - calling_service - INFO - üë§ User started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:08.459915941Z [err]  2025-12-18 03:01:00,291 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ban' | Generating: True
2025-12-18T03:01:08.459923065Z [err]  2025-12-18 03:01:00,291 - server - INFO - üö¶ BARGE-IN CHECK during response generation: 1 words - 'Ban'
2025-12-18T03:01:08.459930041Z [err]  2025-12-18 03:01:00,666 - server - INFO - üî§ RAW TOKENS: [" Ban"‚úì, "ana."‚úì, "<end>"‚úì]
2025-12-18T03:01:08.459936445Z [err]  2025-12-18 03:01:00,667 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-18T03:01:08.459943125Z [err]  2025-12-18 03:01:00,667 - server - INFO - üßπ Cleaned transcript: ' Ban ana.' -> 'Ban ana.'
2025-12-18T03:01:08.459949807Z [err]  2025-12-18 03:01:00,667 - server - INFO - üì• FINAL TOKENS: 'Ban ana.' (2 tokens)
2025-12-18T03:01:08.459957279Z [err]  2025-12-18 03:01:00,667 - server - INFO - üé§ Soniox final transcript: 'Ban ana.'
2025-12-18T03:01:08.459964409Z [err]  2025-12-18 03:01:00,667 - server - INFO - üéØ User speaking while TTS is_speaking=True - INTERRUPTION POSSIBLE
2025-12-18T03:01:08.459970821Z [err]  2025-12-18 03:01:00,667 - server - INFO - üîç FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=True, time_until_done=3.5s, generating=True, playbacks=0, is_active=True
2025-12-18T03:01:08.459977776Z [err]  2025-12-18 03:01:00,667 - server - INFO - üîï FILTERING 2-word/filler 'Ban ana.' - NOT calling on_final_transcript
2025-12-18T03:01:08.459984681Z [err]  2025-12-18 03:01:00,667 - server - INFO - üîï SKIPPING endpoint for 2-word/filler 'Ban ana.' (tts_speaking=True, is_active=True)
2025-12-18T03:01:08.459991233Z [err]  2025-12-18 03:01:00,667 - calling_service - INFO - üë§ User stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:08.459998077Z [err]  2025-12-18 03:01:00,667 - server - INFO - üë§ Marked user stopped speaking (filtered utterance)
2025-12-18T03:01:08.460005455Z [err]  2025-12-18 03:01:00,775 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - response generation still in progress
2025-12-18T03:01:09.733129010Z [err]  2025-12-18 03:01:01,914 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-18T03:01:09.733136406Z [err]  2025-12-18 03:01:01,914 - persistent_tts_service - INFO - ‚úÖ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Finished streaming sentence #3: 3 chunks received
2025-12-18T03:01:09.733143880Z [err]  2025-12-18 03:01:01,914 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2025-12-18T03:01:09.733151882Z [err]  2025-12-18 03:01:01,914 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-18T03:01:09.733161357Z [err]  2025-12-18 03:01:01,914 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 5449ms from user stop üöÄ
2025-12-18T03:01:09.733169103Z [err]  2025-12-18 03:01:01,914 - calling_service - INFO - ü§ñ Agent started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:09.733176245Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-18T03:01:09.733182990Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-18T03:01:09.733191199Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-18T03:01:09.733199198Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 20ms (provider: soniox, model: stt-rt-v3)
2025-12-18T03:01:09.733206806Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 665ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-18T03:01:09.733219453Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 4785ms (provider: elevenlabs, websocket: False)
2025-12-18T03:01:09.733228946Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 5449ms (user stopped ‚Üí play_audio_url called)
2025-12-18T03:01:10.809764646Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-18T03:01:10.809770209Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-18T03:01:10.809775634Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-18T03:01:10.809781150Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-18T03:01:10.809788022Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-18T03:01:10.809795304Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 5749ms estimated
2025-12-18T03:01:10.809802210Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-18T03:01:10.809808926Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2025-12-18T03:01:10.809816097Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-18T03:01:10.809822667Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-18T03:01:10.809829787Z [err]  2025-12-18 03:01:01,915 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-18T03:01:10.809836082Z [err]  2025-12-18 03:01:02,113 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1185ms)
2025-12-18T03:01:10.809842350Z [err]  2025-12-18 03:01:02,113 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-18T03:01:11.976947432Z [err]  2025-12-18 03:01:02,113 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-18T03:01:11.976954686Z [err]  2025-12-18 03:01:03,253 - server - INFO - üì§ Audio flowing: 1144 packets sent to Soniox (5s update)
2025-12-18T03:01:11.976965613Z [err]  2025-12-18 03:01:03,506 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 1149 total packets
2025-12-18T03:01:11.976972575Z [err]  [2025-12-18 03:01:03 +0000] [4] [INFO] connection closed
2025-12-18T03:01:11.976980207Z [err]  2025-12-18 03:01:03,522 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:01:11.976986684Z [err]  2025-12-18 03:01:03,522 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '06e79522-94c5-4919-8637-c7962800eb6f', 'occurred_at': '2025-12-18T03:01:03.436774Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '037a6a71-0523-462e-a345-b824f0bc462f', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:01:11.976995470Z [err]  2025-12-18 03:01:03,522 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:11.977002108Z [err]  2025-12-18 03:01:03,522 - server - INFO - üì® ================================================
2025-12-18T03:01:11.977008362Z [inf]  100.64.0.8:10214 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:01:11.977014653Z [err]  2025-12-18 03:01:03,605 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:01:13.145811385Z [err]  2025-12-18 03:01:03,605 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '5b60aae9-32fa-49c2-a2d1-1de3e4000f8a', 'occurred_at': '2025-12-18T03:01:03.300572Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-18T03:01:03.300572Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'RwQbnSaLwQ', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:01:13.145816539Z [err]  2025-12-18 03:01:03,605 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:13.145822154Z [err]  2025-12-18 03:01:03,605 - server - INFO - üì® ================================================
2025-12-18T03:01:13.145827086Z [err]  2025-12-18 03:01:03,608 - redis_service - INFO - ‚ûñ Removed playback RwQbnSaLwQ, 0 remaining for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:13.145832583Z [err]  2025-12-18 03:01:03,609 - server - INFO - üîä Redis: Removed playback RwQbnSaLwQ, 0 remaining
2025-12-18T03:01:13.145839625Z [err]  2025-12-18 03:01:03,609 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-18T03:01:13.145848469Z [err]  2025-12-18 03:01:03,611 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-18T03:01:13.145855752Z [err]  2025-12-18 03:01:03,611 - server - INFO - üí° Session not on this worker - Redis flag set for WebSocket worker to handle
2025-12-18T03:01:13.145861855Z [inf]  100.64.0.12:20794 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:01:14.641497931Z [err]  2025-12-18 03:01:03,804 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:01:14.641504556Z [err]  2025-12-18 03:01:03,804 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': 'da43d234-58a1-4068-9531-36357a337404', 'occurred_at': '2025-12-18T03:01:03.260565Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '32.00', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '1175', 'skip_packet_count': '24'}, 'outbound': {'packet_count': '1158', 'skip_packet_count': '0'}}, 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-18T03:01:03.260565Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-18T03:00:36.820569Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:01:14.641511575Z [err]  2025-12-18 03:01:03,804 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:14.641518211Z [err]  2025-12-18 03:01:03,804 - server - INFO - üì® ================================================
2025-12-18T03:01:14.641525073Z [err]  2025-12-18 03:01:03,804 - server - INFO - üìû Call ended: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:14.641532735Z [err]  2025-12-18 03:01:03,804 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-18T03:01:14.641539006Z [err]  2025-12-18 03:01:03,894 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-18T03:01:14.641545367Z [err]  2025-12-18 03:01:03,894 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766026863.8942842 for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:16.206618189Z [err]  2025-12-18 03:01:03,894 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:16.212167147Z [err]  2025-12-18 03:01:03,996 - server - INFO - üìù Updated call log: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:16.212181602Z [err]  2025-12-18 03:01:04,092 - server - INFO - ‚úÖ Finalized call log: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w (duration=24s, status=completed)
2025-12-18T03:01:16.212189052Z [err]  2025-12-18 03:01:04,189 - server - INFO - üì¶ Saved 10 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-18T03:01:16.212195704Z [err]  2025-12-18 03:01:04,402 - persistent_tts_service - INFO - üîá [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] FLOOR RELEASED (is_holding_floor=False)
2025-12-18T03:01:16.212203141Z [err]  2025-12-18 03:01:04,933 - server - INFO - üìä Auto-added call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-18T03:01:16.212211249Z [err]  2025-12-18 03:01:05,098 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-18T03:01:16.212223439Z [err]  2025-12-18 03:01:05,098 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '9bcf0a0c-a804-4e43-af7d-e75e4c7f4a8b', 'occurred_at': '2025-12-18T03:01:04.885537Z', 'payload': {'call_control_id': 'v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w', 'call_leg_id': 'ba21c794-dbbd-11f0-8684-02420aef96a0', 'call_session_id': 'ba1f3ca4-dbbd-11f0-b7c2-02420aef96a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-18T03:01:03.357192Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-18T03:01:03.357192Z', 'recording_id': '05af1772-13ca-4ff5-a424-280a0501cf97', 'recording_started_at': '2025-12-18T03:00:41.634672Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-18/ba21c794-dbbd-11f0-8684-02420aef96a0-1766026840717529.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251218%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251218T030104Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=fb8b7fdb765f94f417a064dea9db77a736d4244de490fc4760ba6111884de889'}, 'start_time': '2025-12-18T03:00:41.634672Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-18T03:01:17.538908769Z [err]  2025-12-18 03:01:05,098 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:17.538915671Z [err]  2025-12-18 03:01:05,098 - server - INFO - üì® ================================================
2025-12-18T03:01:17.538923309Z [err]  2025-12-18 03:01:05,098 - server - INFO - üéôÔ∏è Recording saved for call: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:17.538931110Z [err]  2025-12-18 03:01:05,107 - redis_service - INFO - üì• Retrieved call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:17.538939666Z [err]  2025-12-18 03:01:05,107 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=05af1772-13ca-4ff5-a424-280a0501cf97, call_data=True
2025-12-18T03:01:17.538947676Z [err]  2025-12-18 03:01:05,135 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-18T03:01:17.538955698Z [err]  2025-12-18 03:01:05,139 - redis_service - INFO - üì• Retrieved call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:17.538962213Z [err]  2025-12-18 03:01:05,140 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-18T03:01:17.538969047Z [err]  2025-12-18 03:01:05,140 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-18T03:01:17.538976796Z [err]  2025-12-18 03:01:05,200 - server - INFO - üíæ Saved recording URL and ID to database: 05af1772-13ca-4ff5-a424-280a0501cf97
2025-12-18T03:01:17.538985061Z [err]  2025-12-18 03:01:05,200 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-18T03:01:17.538992339Z [err]  2025-12-18 03:01:05,200 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-18T03:01:17.538999413Z [err]  2025-12-18 03:01:05,242 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-18T03:01:18.494618263Z [err]  2025-12-18 03:01:05,354 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-18T03:01:18.494626469Z [err]  2025-12-18 03:01:05,354 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-18T03:01:18.494634989Z [err]  2025-12-18 03:01:05,354 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-18T03:01:18.494643515Z [err]  2025-12-18 03:01:05,354 - server - INFO - üöÄ Triggered QC analysis for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.494650908Z [err]  2025-12-18 03:01:05,354 - server - INFO - üìä Triggered Campaign QC for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.494658476Z [err]  2025-12-18 03:01:05,354 - server - INFO - üìá Triggered CRM update for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.494666190Z [err]  2025-12-18 03:01:05,354 - persistent_tts_service - INFO - üîå [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Closing persistent TTS WebSocket...
2025-12-18T03:01:18.494705568Z [err]  2025-12-18 03:01:05,354 - server - INFO - üîç Starting QC analysis for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.494714228Z [err]  2025-12-18 03:01:05,355 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-18T03:01:18.494722062Z [err]  2025-12-18 03:01:05,355 - server - INFO - üìá CRM update starting for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:01:18.503471660Z [err]  2025-12-18 03:01:05,355 - server - INFO - üìá Normalized phone: +17708336397
2025-12-18T03:01:18.503478064Z [err]  2025-12-18 03:01:05,355 - server - INFO - üìá CRM: Got 10 variables from active session
2025-12-18T03:01:18.503484994Z [err]  2025-12-18 03:01:05,358 - persistent_tts_service - INFO - üõë [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Playback consumer shutting down
2025-12-18T03:01:18.503551917Z [err]  2025-12-18 03:01:05,448 - server - INFO - üìù Converted transcript from 5 messages to 168 characters
2025-12-18T03:01:18.503562655Z [err]  2025-12-18 03:01:05,451 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=5, logs_count=6, status=completed
2025-12-18T03:01:18.503569103Z [err]  2025-12-18 03:01:05,470 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-18T03:01:18.503577973Z [err]  2025-12-18 03:01:05,471 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-18T03:01:18.503584930Z [err]  2025-12-18 03:01:05,517 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-18/ba21c794-dbbd-11f0-8684-02420aef96a0-1766026840717529.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251218%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251218T030104Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=fb8b7fdb765f94f417a064dea9db77a736d4244de490fc4760ba6111884de889 "HTTP/1.1 200 OK"
2025-12-18T03:01:18.503592067Z [err]  2025-12-18 03:01:05,550 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:01:18.503613584Z [err]  2025-12-18 03:01:05,643 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-18T03:01:18.503623356Z [err]  2025-12-18 03:01:05,689 - server - INFO - ‚úÖ Downloaded 87187 bytes
2025-12-18T03:01:18.506590718Z [err]  2025-12-18 03:01:05,738 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-18T03:01:18.506596806Z [err]  2025-12-18 03:01:05,738 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-18T03:01:18.506604377Z [err]  2025-12-18 03:01:05,738 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.506611999Z [err]  2025-12-18 03:01:05,926 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-18T03:01:18.506618926Z [err]  2025-12-18 03:01:05,936 - server - INFO - üìá CRM: Got 10 extracted variables
2025-12-18T03:01:18.506627168Z [err]  2025-12-18 03:01:05,936 - server - INFO - üìá CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-18T03:01:18.506639700Z [err]  2025-12-18 03:01:05,951 - server - INFO - ‚úÖ Split into 2 channels
2025-12-18T03:01:18.506641921Z [err]  2025-12-18 03:01:06,469 - persistent_tts_service - INFO - ‚úÖ [Call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w] Persistent TTS WebSocket closed
2025-12-18T03:01:18.506649551Z [err]  2025-12-18 03:01:05,951 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-18T03:01:18.506657043Z [err]  2025-12-18 03:01:05,951 - server - INFO - üìä Channel 0: 476124 bytes
2025-12-18T03:01:18.506664310Z [err]  2025-12-18 03:01:05,951 - server - ERROR - ‚ùå No Soniox API key available
2025-12-18T03:01:18.506671792Z [err]  2025-12-18 03:01:05,951 - server - INFO - ‚ùå Channel 0: No speech
2025-12-18T03:01:18.506679328Z [err]  2025-12-18 03:01:05,952 - server - INFO - üìä Channel 1: 476124 bytes
2025-12-18T03:01:18.506688568Z [err]  2025-12-18 03:01:05,952 - server - ERROR - ‚ùå No Soniox API key available
2025-12-18T03:01:18.506695700Z [err]  2025-12-18 03:01:05,952 - server - INFO - ‚ùå Channel 1: No speech
2025-12-18T03:01:18.506702845Z [err]  2025-12-18 03:01:05,952 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-18T03:01:18.506789820Z [inf]  100.64.0.7:26932 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:01:18.506798494Z [err]  2025-12-18 03:01:06,023 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-18T03:01:18.506812090Z [err]  2025-12-18 03:01:06,023 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-18T03:01:18.506812464Z [err]  2025-12-18 03:01:06,024 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-18T03:01:18.506827344Z [err]    File "/app/backend/server.py", line 9683, in trigger_campaign_qc_for_call
2025-12-18T03:01:18.506828005Z [err]  2025-12-18 03:01:06,023 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-18T03:01:18.506832923Z [err]  2025-12-18 03:01:06,469 - elevenlabs_ws_service - INFO - üîå Closed ElevenLabs WebSocket connection
2025-12-18T03:01:18.506839678Z [err]      await run_full_qc_analysis(
2025-12-18T03:01:18.506847425Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-18T03:01:18.506854422Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-18T03:01:18.506863069Z [err]  
2025-12-18T03:01:18.506869683Z [err]  2025-12-18 03:01:06,117 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-18T03:01:18.507376792Z [err]  2025-12-18 03:01:06,469 - persistent_tts_service - INFO - ‚úÖ Closed persistent TTS session for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.511732794Z [err]  2025-12-18 03:01:06,470 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.511739995Z [err]  2025-12-18 03:01:06,473 - redis_service - INFO - üßπ Deleted call data from Redis: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.511748783Z [err]  2025-12-18 03:01:06,473 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.511755674Z [inf]  100.64.0.10:38710 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-18T03:01:18.511762280Z [err]  2025-12-18 03:01:06,921 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.511770409Z [err]  2025-12-18 03:01:07,422 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.511777877Z [err]  2025-12-18 03:01:07,926 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.511785114Z [err]  2025-12-18 03:01:08,429 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.511792551Z [err]  2025-12-18 03:01:08,930 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.511800892Z [err]  2025-12-18 03:01:09,433 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.511808137Z [err]  2025-12-18 03:01:09,936 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.513462010Z [err]  2025-12-18 03:01:10,945 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-18T03:01:18.513463233Z [err]  2025-12-18 03:01:10,438 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.513470940Z [err]  2025-12-18 03:01:10,438 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=6.5s, checkin_count=0/2
2025-12-18T03:01:18.513476666Z [err]  2025-12-18 03:01:10,943 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.513482698Z [err]  2025-12-18 03:01:10,943 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=7.0s, checkin_count=0/2
2025-12-18T03:01:18.513487564Z [err]  2025-12-18 03:01:10,943 - calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2025-12-18T03:01:18.513493177Z [err]  2025-12-18 03:01:10,945 - calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-18T03:01:18.513498157Z [err]  2025-12-18 03:01:10,945 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2025-12-18T03:01:18.513504398Z [err]  2025-12-18 03:01:10,945 - calling_service - INFO - ü§ñ Agent started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.513510007Z [err]  2025-12-18 03:01:10,945 - telnyx_service - INFO - üîä Speaking text on call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w: Are you still there?...
2025-12-18T03:01:18.513515444Z [err]  2025-12-18 03:01:10,945 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-18T03:01:18.513523013Z [err]  2025-12-18 03:01:10,945 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-18T03:01:18.513528541Z [err]  2025-12-18 03:01:10,945 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-18T03:01:18.518886472Z [err]  2025-12-18 03:01:11,034 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-18T03:01:18.518896435Z [err]  2025-12-18 03:01:10,945 - server - INFO - ‚è±Ô∏è [03:01:10.945] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-18T03:01:18.518910367Z [err]  2025-12-18 03:01:10,946 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-18T03:01:18.518911035Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-18T03:01:18.518924379Z [err]  2025-12-18 03:01:10,946 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-18T03:01:18.518927289Z [err]  2025-12-18 03:01:11,034 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-18T03:01:18.518933820Z [err]  2025-12-18 03:01:11,033 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-18T03:01:18.518939580Z [err]  2025-12-18 03:01:11,034 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-18T03:01:18.518946478Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Text length: 20 chars
2025-12-18T03:01:18.518965603Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Text content: 'Are you still there?'
2025-12-18T03:01:18.518979302Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-18T03:01:18.518990192Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-18T03:01:18.518999720Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-18T03:01:18.522495716Z [err]  2025-12-18 03:01:11,034 - server - INFO -    Timeout: 10.0s
2025-12-18T03:01:18.522504825Z [err]  2025-12-18 03:01:11,060 - server - INFO -    ‚úì HTTP client created (0.026s)
2025-12-18T03:01:18.522512297Z [err]  2025-12-18 03:01:11,060 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-18T03:01:18.522520959Z [err]  2025-12-18 03:01:11,424 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-18T03:01:18.522548427Z [err]  2025-12-18 03:01:11,425 - server - INFO -    ‚úì Connection established (0.391s) [TARGET: <200ms]
2025-12-18T03:01:18.522556622Z [err]  2025-12-18 03:01:11,425 - server - INFO -    ‚úì Response status: 200
2025-12-18T03:01:18.522563693Z [err]  2025-12-18 03:01:11,425 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-18T03:01:18.522569884Z [err]  2025-12-18 03:01:11,437 - server - INFO -    ‚úì FIRST CHUNK received (0.403s, 964 bytes) [TARGET: <300ms]
2025-12-18T03:01:18.522575801Z [err]  2025-12-18 03:01:11,440 - server - INFO -    ‚úì ALL CHUNKS received: 43 chunks (0.406s)
2025-12-18T03:01:18.522592630Z [err]  2025-12-18 03:01:11,440 - server - INFO -    ‚úì Total audio size: 18435 bytes
2025-12-18T03:01:18.522613171Z [err]  2025-12-18 03:01:11,440 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-18T03:01:18.522621140Z [err]  2025-12-18 03:01:11,440 - server - INFO -       - Connection: 391ms
2025-12-18T03:01:18.522626916Z [err]  2025-12-18 03:01:11,440 - server - INFO -       - First chunk: 403ms
2025-12-18T03:01:18.522639613Z [err]  2025-12-18 03:01:11,440 - server - INFO -       - All chunks: 406ms
2025-12-18T03:01:18.522645796Z [err]  2025-12-18 03:01:11,440 - server - INFO -       - Audio generation only: 12ms
2025-12-18T03:01:18.522654007Z [err]  2025-12-18 03:01:11,440 - server - INFO - ‚è±Ô∏è [03:01:11.440] üîä TTS COMPLETE: 494ms, audio_size=18435 bytes
2025-12-18T03:01:18.526719136Z [err]  2025-12-18 03:01:13,942 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.526728347Z [err]  2025-12-18 03:01:14,458 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.526729665Z [err]  2025-12-18 03:01:12,432 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766026872.4323182 for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.526737135Z [err]  2025-12-18 03:01:12,432 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:18.526750765Z [err]  2025-12-18 03:01:11,920 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-18T03:01:18.526755121Z [err]  2025-12-18 03:01:12,432 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.526757850Z [err]  2025-12-18 03:01:12,934 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.526760121Z [err]  2025-12-18 03:01:11,921 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-18T03:01:18.526768274Z [err]  2025-12-18 03:01:13,437 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.526772851Z [err]  2025-12-18 03:01:12,432 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.526779497Z [err]  2025-12-18 03:01:12,432 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (8.3s ago), marking agent as done speaking
2025-12-18T03:01:18.526876544Z [err]  2025-12-18 03:01:11,440 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (18435 bytes)
2025-12-18T03:01:18.526883140Z [err]  2025-12-18 03:01:11,441 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.50s
2025-12-18T03:01:18.526890691Z [err]  2025-12-18 03:01:11,441 - telnyx_service - INFO - ‚úÖ Generated 18435 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:01:18.526897923Z [err]  2025-12-18 03:01:11,441 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:01:18.526913038Z [err]  2025-12-18 03:01:11,660 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:01:18.526922443Z [err]  2025-12-18 03:01:11,661 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2025-12-18T03:01:18.526929328Z [err]  2025-12-18 03:01:11,661 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-18T03:01:18.526936901Z [err]    "errors": [
2025-12-18T03:01:18.526943807Z [err]      {
2025-12-18T03:01:18.526950133Z [err]        "code": "90018",
2025-12-18T03:01:18.526956057Z [err]        "title": "Call has already ended",
2025-12-18T03:01:18.526963352Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-18T03:01:18.527011689Z [err]      }
2025-12-18T03:01:18.527020530Z [err]    ]
2025-12-18T03:01:18.527026695Z [err]  }
2025-12-18T03:01:18.527034296Z [err]  2025-12-18 03:01:11,662 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-18T03:01:18.527041016Z [err]  2025-12-18 03:01:11,920 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:01:18.536583944Z [err]  2025-12-18 03:01:14,960 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536590737Z [err]  2025-12-18 03:01:15,463 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536599976Z [err]  2025-12-18 03:01:15,966 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536632694Z [err]  2025-12-18 03:01:16,470 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536639117Z [err]  2025-12-18 03:01:16,972 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536647710Z [err]  2025-12-18 03:01:17,476 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536658624Z [err]  2025-12-18 03:01:17,977 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:18.536667460Z [err]  2025-12-18 03:01:18,479 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:19.415018898Z [err]  2025-12-18 03:01:18,984 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:19.489579320Z [err]  2025-12-18 03:01:19,486 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:19.489587324Z [err]  2025-12-18 03:01:19,487 - calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-18T03:01:19.495070531Z [err]  2025-12-18 03:01:19,488 - calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2025-12-18T03:01:19.495120600Z [err]  2025-12-18 03:01:19,488 - calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2025-12-18T03:01:19.495130194Z [err]  2025-12-18 03:01:19,488 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2025-12-18T03:01:19.495151088Z [err]  2025-12-18 03:01:19,488 - calling_service - INFO - ü§ñ Agent started speaking for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:19.495157875Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - üîä Speaking text on call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w: Are you still there?...
2025-12-18T03:01:19.495165402Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-18T03:01:19.495173616Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-18T03:01:19.495179599Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-18T03:01:19.495185771Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-18T03:01:19.495192260Z [err]  2025-12-18 03:01:19,489 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (18435 bytes)
2025-12-18T03:01:19.495198151Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-18T03:01:19.495207076Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - ‚úÖ Generated 18435 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:01:19.495212617Z [err]  2025-12-18 03:01:19,489 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-18T03:01:19.509691525Z [err]  2025-12-18 03:01:19,506 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:01:19.509701808Z [err]  2025-12-18 03:01:19,507 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-18T03:01:19.515535614Z [err]  2025-12-18 03:01:19,509 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:20.469655326Z [err]  2025-12-18 03:01:19,778 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:01:20.469663635Z [err]  2025-12-18 03:01:19,780 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.29s
2025-12-18T03:01:20.469676706Z [err]  2025-12-18 03:01:19,780 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-18T03:01:20.469684407Z [err]    "errors": [
2025-12-18T03:01:20.469691996Z [err]      {
2025-12-18T03:01:20.469700262Z [err]        "code": "90018",
2025-12-18T03:01:20.469709385Z [err]        "title": "Call has already ended",
2025-12-18T03:01:20.469717924Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-18T03:01:20.469726080Z [err]      }
2025-12-18T03:01:20.469733763Z [err]    ]
2025-12-18T03:01:20.469740449Z [err]  }
2025-12-18T03:01:20.469749362Z [err]  2025-12-18 03:01:19,780 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-18T03:01:20.469771832Z [err]  2025-12-18 03:01:19,979 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-18T03:01:20.469778039Z [err]  2025-12-18 03:01:19,980 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-18T03:01:20.469783428Z [err]  2025-12-18 03:01:19,980 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-18T03:01:20.486871059Z [err]  2025-12-18 03:01:20,482 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:20.486878128Z [err]  2025-12-18 03:01:20,482 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:20.486884279Z [err]  2025-12-18 03:01:20,482 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-18T03:01:21.514402400Z [err]  2025-12-18 03:01:20,990 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:21.514410902Z [err]  2025-12-18 03:01:20,990 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:21.515610357Z [err]  2025-12-18 03:01:20,990 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-18T03:01:21.515642304Z [err]  2025-12-18 03:01:21,494 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:21.515652998Z [err]  2025-12-18 03:01:21,494 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:22.411369506Z [err]  2025-12-18 03:01:21,997 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:22.411376281Z [err]  2025-12-18 03:01:21,997 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:22.515996381Z [err]  2025-12-18 03:01:22,513 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:22.516006463Z [err]  2025-12-18 03:01:22,513 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:23.442185172Z [err]  2025-12-18 03:01:23,018 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:23.442192500Z [err]  2025-12-18 03:01:23,018 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:23.528292520Z [err]  2025-12-18 03:01:23,526 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:23.528297982Z [err]  2025-12-18 03:01:23,526 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:j8ausWMipxI4MwivP... (active sessions: [])
2025-12-18T03:01:24.491839444Z [err]  2025-12-18 03:01:23,611 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2025-12-18T03:01:24.491845490Z [err]  2025-12-18 03:01:23,612 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 19920, 'total_audio_proc_ms': 22080, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-18T03:01:24.491853313Z [err]  2025-12-18 03:01:23,612 - server - INFO - ‚úÖ Soniox receive loop ended normally
2025-12-18T03:01:24.491864802Z [err]  2025-12-18 03:01:23,614 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:24.491871318Z [err]  2025-12-18 03:01:23,615 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:24.491878843Z [err]  2025-12-18 03:01:23,615 - server - INFO - üîá Dead air monitoring task cancelled
2025-12-18T03:01:24.491886585Z [err]  2025-12-18 03:01:24,457 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:01:24.491892924Z [err]  2025-12-18 03:01:24,462 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-18T03:01:24.491900134Z [err]  2025-12-18 03:01:24,463 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:26.656891024Z [err]  2025-12-18 03:01:25,614 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-18T03:01:26.656897377Z [err]  2025-12-18 03:01:25,614 - server - INFO - üîå Telnyx WebSocket disconnected
2025-12-18T03:01:47.122347279Z [err]  2025-12-18 03:01:38,459 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18T03:01:47.122357209Z [err]  2025-12-18 03:01:38,463 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-18T03:01:47.122369100Z [err]  2025-12-18 03:01:38,562 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:47.122378007Z [err]  2025-12-18 03:01:38,562 - server - INFO - ‚úÖ QC analysis completed for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:47.122397948Z [err]  2025-12-18 03:01:38,562 - server - INFO - üìä Scores: Commitment=50, Conversion=20, Excellence=50
2025-12-18T03:01:47.122405525Z [err]  2025-12-18 03:01:38,738 - server - INFO - üìä Updated campaign_calls with QC scores for v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w
2025-12-18T03:01:47.122414115Z [err]  2025-12-18 03:01:38,916 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-18T03:01:47.122419816Z [err]  2025-12-18 03:01:39,003 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-18T03:01:47.122425389Z [err]  2025-12-18 03:01:39,003 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:j8ausWMipxI4MwivPqbv8_TvASqbzwFbkrggRFk_ZeBF2eqmy5Rg2w: 'str' object has no attribute 'get'