2025-12-27T08:19:45.000000000Z [inf]  Starting Container
2025-12-27T08:19:46.036446629Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2025-12-27T08:19:46.036453990Z [inf]  =========================================
2025-12-27T08:19:46.036503385Z [inf]  =========================================
2025-12-27T08:19:46.036512215Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2025-12-27T08:19:46.036520050Z [inf]  =========================================
2025-12-27T08:19:46.036527865Z [inf]  üìç Working directory: /app/backend
2025-12-27T08:19:46.036535350Z [inf]  üîç Python path: /app/backend
2025-12-27T08:19:46.547979602Z [err]  [2025-12-27 08:19:46 +0000] [1] [INFO] Starting gunicorn 22.0.0
2025-12-27T08:19:46.547987304Z [err]  [2025-12-27 08:19:46 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2025-12-27T08:19:46.547992873Z [err]  [2025-12-27 08:19:46 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-27T08:19:46.547998470Z [err]  [2025-12-27 08:19:46 +0000] [3] [INFO] Booting worker with pid: 3
2025-12-27T08:19:46.548510602Z [err]  [2025-12-27 08:19:46 +0000] [4] [INFO] Booting worker with pid: 4
2025-12-27T08:19:46.617774289Z [err]  [2025-12-27 08:19:46 +0000] [5] [INFO] Booting worker with pid: 5
2025-12-27T08:19:46.672004345Z [err]  [2025-12-27 08:19:46 +0000] [6] [INFO] Booting worker with pid: 6
2025-12-27T08:20:06.705320777Z [err]  2025-12-27 08:20:02,010 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-27T08:20:06.705329254Z [err]  2025-12-27 08:20:02,010 - server - INFO - üî• Pre-warming connection libraries...
2025-12-27T08:20:06.705334165Z [err]  2025-12-27 08:20:02,273 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-27T08:20:06.705341042Z [err]  2025-12-27 08:20:02,035 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-27T08:20:06.705343032Z [err]  2025-12-27 08:20:02,276 - server - INFO - ‚úÖ QC agent router loaded
2025-12-27T08:20:06.705350057Z [err]  2025-12-27 08:20:02,078 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-27T08:20:06.705350136Z [err]  2025-12-27 08:20:02,282 - server - INFO - ‚úÖ QC agent router loaded
2025-12-27T08:20:06.705359158Z [err]  2025-12-27 08:20:02,298 - server - INFO - ‚úÖ QC learning router loaded
2025-12-27T08:20:06.705360568Z [err]  2025-12-27 08:20:02,363 - server - INFO - ‚úÖ QC agent router loaded
2025-12-27T08:20:06.705363003Z [err]  2025-12-27 08:20:02,078 - server - INFO - üî• Pre-warming connection libraries...
2025-12-27T08:20:06.705366326Z [err]  2025-12-27 08:20:02,300 - server - INFO - ‚úÖ QC learning router loaded
2025-12-27T08:20:06.705372365Z [err]  2025-12-27 08:20:02,382 - server - INFO - ‚úÖ QC learning router loaded
2025-12-27T08:20:06.705372748Z [err]  2025-12-27 08:20:02,408 - server - INFO - ‚úÖ QC learning router loaded
2025-12-27T08:20:06.705373652Z [err]  2025-12-27 08:20:02,302 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-27T08:20:06.705395895Z [err]  2025-12-27 08:20:02,099 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-27T08:20:06.705397802Z [err]  2025-12-27 08:20:02,414 - server - INFO - ‚úÖ QC test router loaded
2025-12-27T08:20:06.705404606Z [err]  2025-12-27 08:20:02,390 - server - INFO - ‚úÖ QC agent router loaded
2025-12-27T08:20:06.705412861Z [err]  2025-12-27 08:20:02,402 - server - INFO - ‚úÖ CRM router loaded
2025-12-27T08:20:06.705416135Z [err]  [2025-12-27 08:20:02 +0000] [5] [INFO] Started server process [5]
2025-12-27T08:20:06.705416615Z [err]  2025-12-27 08:20:02,141 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-27T08:20:06.705423132Z [err]  2025-12-27 08:20:02,403 - server - INFO - ‚úÖ CRM router loaded
2025-12-27T08:20:06.705424231Z [err]  2025-12-27 08:20:02,415 - server - INFO - ‚úÖ QC test router loaded
2025-12-27T08:20:06.705427794Z [err]  2025-12-27 08:20:02,145 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-27T08:20:06.705427966Z [err]  2025-12-27 08:20:02,499 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-27T08:20:06.705428141Z [err]  [2025-12-27 08:20:02 +0000] [5] [INFO] Waiting for application startup.
2025-12-27T08:20:06.705437486Z [err]  2025-12-27 08:20:02,432 - server - INFO - ‚úÖ Agent test router loaded
2025-12-27T08:20:06.705438061Z [err]  2025-12-27 08:20:02,145 - server - INFO - üî• Pre-warming connection libraries...
2025-12-27T08:20:06.705439235Z [err]  2025-12-27 08:20:02,477 - server - INFO - ‚úÖ CRM router loaded
2025-12-27T08:20:06.705441565Z [err]  2025-12-27 08:20:02,322 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-27T08:20:06.705442178Z [err]  2025-12-27 08:20:02,509 - server - INFO - ‚úÖ QC test router loaded
2025-12-27T08:20:06.705447993Z [err]  2025-12-27 08:20:02,350 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-27T08:20:06.705450029Z [err]  2025-12-27 08:20:02,481 - server - INFO - ‚úÖ QC test router loaded
2025-12-27T08:20:06.705450231Z [err]  2025-12-27 08:20:02,155 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-27T08:20:06.705451533Z [err]  2025-12-27 08:20:02,500 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-27T08:20:06.705453766Z [err]  [2025-12-27 08:20:02 +0000] [4] [INFO] Started server process [4]
2025-12-27T08:20:06.705458094Z [err]  2025-12-27 08:20:02,522 - server - INFO - ‚úÖ Agent test router loaded
2025-12-27T08:20:06.705460712Z [err]  2025-12-27 08:20:02,493 - server - INFO - ‚úÖ Agent test router loaded
2025-12-27T08:20:06.705461882Z [err]  2025-12-27 08:20:02,502 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-27T08:20:06.705462446Z [err]  2025-12-27 08:20:02,155 - server - INFO - üî• Pre-warming connection libraries...
2025-12-27T08:20:06.705463086Z [err]  [2025-12-27 08:20:02 +0000] [6] [INFO] Waiting for application startup.
2025-12-27T08:20:06.705465188Z [err]  [2025-12-27 08:20:02 +0000] [4] [INFO] Waiting for application startup.
2025-12-27T08:20:06.705470149Z [err]  2025-12-27 08:20:02,432 - server - INFO - ‚úÖ Agent test router loaded
2025-12-27T08:20:06.705471872Z [err]  2025-12-27 08:20:02,502 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-27T08:20:06.705473780Z [err]  2025-12-27 08:20:02,546 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-27T08:20:06.705475436Z [err]  2025-12-27 08:20:02,519 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-27T08:20:06.705475638Z [err]  2025-12-27 08:20:02,168 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-27T08:20:06.705479694Z [err]  2025-12-27 08:20:02,527 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-27T08:20:06.705480493Z [err]  2025-12-27 08:20:02,442 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-27T08:20:06.705482713Z [err]  2025-12-27 08:20:02,506 - server - INFO - ‚úÖ CRM router loaded
2025-12-27T08:20:06.705487023Z [err]  2025-12-27 08:20:02,183 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-27T08:20:06.705488662Z [err]  2025-12-27 08:20:02,442 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-27T08:20:06.705490443Z [err]  2025-12-27 08:20:02,528 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-27T08:20:06.705495594Z [err]  2025-12-27 08:20:02,444 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-27T08:20:06.705497498Z [err]  [2025-12-27 08:20:02 +0000] [6] [INFO] Started server process [6]
2025-12-27T08:20:06.705497829Z [err]  2025-12-27 08:20:02,195 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-27T08:20:06.705502828Z [err]  2025-12-27 08:20:02,444 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-27T08:20:06.705507166Z [err]  2025-12-27 08:20:02,236 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-27T08:20:06.705510592Z [err]  [2025-12-27 08:20:02 +0000] [3] [INFO] Started server process [3]
2025-12-27T08:20:06.705517806Z [err]  2025-12-27 08:20:02,240 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-27T08:20:06.705518001Z [err]  [2025-12-27 08:20:02 +0000] [3] [INFO] Waiting for application startup.
2025-12-27T08:20:10.952842617Z [err]  2025-12-27 08:20:10,946 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-27T08:20:10.952851669Z [err]  2025-12-27 08:20:10,946 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-27T08:20:10.952859052Z [err]  2025-12-27 08:20:10,946 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-27T08:20:10.952865547Z [err]  2025-12-27 08:20:10,946 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-27T08:20:10.952872055Z [err]  2025-12-27 08:20:10,947 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-27T08:20:10.952878333Z [err]  2025-12-27 08:20:10,947 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-27T08:20:10.952885412Z [err]  2025-12-27 08:20:10,947 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-27T08:20:10.952891620Z [err]  2025-12-27 08:20:10,948 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-27T08:20:10.952898177Z [err]  2025-12-27 08:20:10,950 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-27T08:20:10.958261394Z [err]  2025-12-27 08:20:10,954 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-27T08:20:10.958269944Z [err]  2025-12-27 08:20:10,954 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-27T08:20:10.958276978Z [err]  2025-12-27 08:20:10,954 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-27T08:20:10.993055775Z [err]  2025-12-27 08:20:10,990 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-27T08:20:10.994984933Z [err]  2025-12-27 08:20:10,993 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-27T08:20:10.994990907Z [err]  2025-12-27 08:20:10,993 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-27T08:20:10.994994624Z [err]  2025-12-27 08:20:10,993 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-27T08:20:11.637090302Z [err]  2025-12-27 08:20:11,632 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-27T08:20:11.649457550Z [err]  2025-12-27 08:20:11,646 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-27T08:20:11.703585606Z [err]  2025-12-27 08:20:11,660 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-27T08:20:11.703589431Z [err]  2025-12-27 08:20:11,686 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-27T08:20:11.788792361Z [err]  2025-12-27 08:20:11,763 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-27T08:20:11.788796152Z [err]  2025-12-27 08:20:11,764 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-27T08:20:11.788806463Z [err]  2025-12-27 08:20:11,765 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-27T08:20:11.788810838Z [err]  [2025-12-27 08:20:11 +0000] [6] [INFO] Application startup complete.
2025-12-27T08:20:11.788814617Z [err]  2025-12-27 08:20:11,767 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-27T08:20:11.788819603Z [err]  [2025-12-27 08:20:11 +0000] [3] [INFO] Application startup complete.
2025-12-27T08:20:11.831645775Z [err]  2025-12-27 08:20:11,795 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-27T08:20:11.831650915Z [err]  2025-12-27 08:20:11,815 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-27T08:20:11.831655260Z [err]  [2025-12-27 08:20:11 +0000] [5] [INFO] Application startup complete.
2025-12-27T08:20:11.852796558Z [err]  2025-12-27 08:20:11,844 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-27T08:20:11.852802198Z [err]  2025-12-27 08:20:11,844 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-27T08:20:11.852806610Z [err]  [2025-12-27 08:20:11 +0000] [4] [INFO] Application startup complete.
2025-12-27T08:22:11.899181291Z [inf]  100.64.0.2:45394 - "POST /api/auth/logout HTTP/1.1" 200
2025-12-27T08:22:11.899185937Z [inf]  100.64.0.3:24672 - "OPTIONS /api/auth/login HTTP/1.1" 200
2025-12-27T08:22:11.899189925Z [inf]  100.64.0.2:45394 - "POST /api/auth/login HTTP/1.1" 200
2025-12-27T08:22:11.899195612Z [inf]  100.64.0.2:45394 - "GET /api/agents HTTP/1.1" 200
2025-12-27T08:22:11.899199958Z [inf]  100.64.0.2:45394 - "GET /api/agents HTTP/1.1" 200
2025-12-27T08:22:41.860833414Z [err]  2025-12-27 08:22:34,881 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-27T08:22:41.860843747Z [inf]  100.64.0.3:24672 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-27T08:22:41.860846059Z [err]  2025-12-27 08:22:35,453 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-27T08:22:41.860850866Z [err]  2025-12-27 08:22:34,684 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-27T08:22:41.860855534Z [err]  2025-12-27 08:22:35,455 - telnyx_service - INFO - ‚úÖ Call initiated: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:41.860857482Z [err]  2025-12-27 08:22:34,774 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:41.860862834Z [err]  2025-12-27 08:22:34,861 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:41.860865560Z [err]  2025-12-27 08:22:35,557 - server - INFO - üìù Created call log: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:41.860868642Z [err]  2025-12-27 08:22:34,881 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:22:41.860873153Z [err]  2025-12-27 08:22:34,881 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-27T08:22:41.860876606Z [err]  2025-12-27 08:22:35,557 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:22:41.860880003Z [err]  2025-12-27 08:22:34,881 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-27T08:22:41.860883330Z [err]  2025-12-27 08:22:35,557 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-27T08:22:41.861436776Z [err]  2025-12-27 08:22:35,557 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:22:41.861441890Z [err]  2025-12-27 08:22:35,557 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:22:41.861449056Z [err]  2025-12-27 08:22:35,588 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:41.861455014Z [err]  2025-12-27 08:22:35,588 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-27T08:22:41.861461139Z [err]  2025-12-27 08:22:35,588 - server - INFO - üìû Outbound call initiated: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:41.861467073Z [inf]  100.64.0.2:45394 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-27T08:22:41.861472786Z [err]  2025-12-27 08:22:35,716 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:41.861479240Z [err]  2025-12-27 08:22:35,716 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '6a69667d-9ec3-4014-a675-1ce1a3dd2477', 'occurred_at': '2025-12-27T08:22:35.339119Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:41.861485458Z [err]  2025-12-27 08:22:35,716 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:41.862261085Z [err]  2025-12-27 08:22:35,716 - server - INFO - üì® ================================================
2025-12-27T08:22:41.862272468Z [err]  2025-12-27 08:22:35,716 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-27T08:22:41.862280433Z [inf]  100.64.0.4:37354 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:41.862287868Z [err]  2025-12-27 08:22:35,786 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-27T08:22:41.862298730Z [err]  2025-12-27 08:22:35,786 - server - INFO -    Client: Address(host='100.64.0.5', port=30538)
2025-12-27T08:22:41.862307416Z [err]  2025-12-27 08:22:35,786 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'hdv2qW99M/RBLtX2Aj46cg==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'CY9hKWJrQc-2mGrg2prcFg', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766823755551', 'accept-encoding': 'gzip'}
2025-12-27T08:22:41.862315201Z [err]  2025-12-27 08:22:35,787 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-27T08:22:41.862324581Z [err]  2025-12-27 08:22:35,787 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-27T08:22:41.862331871Z [err]  [2025-12-27 08:22:35 +0000] [5] [INFO] ('100.64.0.5', 30538) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-27T08:22:41.862339079Z [err]  2025-12-27 08:22:35,787 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-27T08:22:41.862346403Z [err]  [2025-12-27 08:22:35 +0000] [5] [INFO] connection open
2025-12-27T08:22:41.862353634Z [err]  2025-12-27 08:22:35,946 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-27T08:22:41.862361503Z [err]  2025-12-27 08:22:35,946 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-27T08:22:41.862710995Z [err]  2025-12-27 08:22:36,014 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:22:41.862720856Z [err]  2025-12-27 08:22:36,015 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-27T08:22:41.893653901Z [err]  2025-12-27 08:22:41,888 - server - INFO - üì¨ Received Telnyx event: start
2025-12-27T08:22:41.893659268Z [err]  2025-12-27 08:22:41,888 - server - INFO - üé¨ Stream started for call: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:41.930048289Z [err]  2025-12-27 08:22:41,919 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:41.930054480Z [err]  2025-12-27 08:22:41,920 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-27T08:22:41.930058556Z [err]  2025-12-27 08:22:41,920 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-27T08:22:42.138148518Z [err]  2025-12-27 08:22:42,087 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:42.138154332Z [err]  2025-12-27 08:22:42,087 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'de033c55-f91c-4a91-b6fa-0712daa5002d', 'occurred_at': '2025-12-27T08:22:41.699109Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-27T08:22:35.339119Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:42.138158999Z [err]  2025-12-27 08:22:42,087 - server - INFO - üéØ Event type: call.answered, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:42.138163017Z [err]  2025-12-27 08:22:42,087 - server - INFO - üì® ================================================
2025-12-27T08:22:42.138167398Z [err]  2025-12-27 08:22:42,087 - server - INFO - ‚úÖ Call answered: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:42.138171683Z [err]  2025-12-27 08:22:42,097 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:42.138176129Z [err]  2025-12-27 08:22:42,098 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-27T08:22:42.138180044Z [err]  2025-12-27 08:22:42,098 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-27T08:22:42.352367857Z [err]  2025-12-27 08:22:42,348 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:42.352376835Z [err]  2025-12-27 08:22:42,348 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': '3b6d7ec8-d3d6-4c20-9e5b-3fff1645f84f', 'occurred_at': '2025-12-27T08:22:42.059115Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '0e4315a6-640f-4417-8024-b271dba1008f', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:42.352381363Z [err]  2025-12-27 08:22:42,348 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:42.352385671Z [err]  2025-12-27 08:22:42,348 - server - INFO - üì® ================================================
2025-12-27T08:22:42.352390284Z [inf]  100.64.0.4:37368 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:42.423489273Z [err]  2025-12-27 08:22:42,420 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-27T08:22:42.423498695Z [err]  2025-12-27 08:22:42,420 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-27T08:22:42.435001140Z [err]  2025-12-27 08:22:42,431 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:42.435008601Z [err]  2025-12-27 08:22:42,432 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:22:42.435014147Z [err]  2025-12-27 08:22:42,432 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-27T08:22:42.973117294Z [err]  2025-12-27 08:22:42,968 - server - INFO - ‚úÖ Call log updated
2025-12-27T08:22:42.973123081Z [err]  2025-12-27 08:22:42,968 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:22:42.973127362Z [err]  2025-12-27 08:22:42,968 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:22:42.973131713Z [err]  2025-12-27 08:22:42,969 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:22:43.007727116Z [err]  2025-12-27 08:22:43,004 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-27T08:22:43.007734304Z [err]  2025-12-27 08:22:43,004 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-27T08:22:43.133076720Z [err]  2025-12-27 08:22:43,018 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-27T08:22:43.133108348Z [err]  2025-12-27 08:22:43,018 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-27T08:22:43.133118198Z [err]  2025-12-27 08:22:43,019 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-27T08:22:43.133495282Z [err]  2025-12-27 08:22:43,057 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:43.133499907Z [err]  2025-12-27 08:22:43,107 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:43.133503914Z [err]  2025-12-27 08:22:43,115 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 95ms
2025-12-27T08:22:43.133507767Z [err]  2025-12-27 08:22:43,115 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-27T08:22:43.133511602Z [err]  2025-12-27 08:22:43,115 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-27T08:22:43.133515420Z [err]  2025-12-27 08:22:43,115 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-27T08:22:43.133518818Z [err]  2025-12-27 08:22:43,115 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-27T08:22:43.133522296Z [err]  2025-12-27 08:22:43,116 - server - INFO - ‚úÖ Initialized call_states for v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw with session reference
2025-12-27T08:22:43.133526245Z [err]  2025-12-27 08:22:43,117 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-27T08:22:43.153327998Z [err]  2025-12-27 08:22:43,144 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:43.153332839Z [err]  2025-12-27 08:22:43,144 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-27T08:22:43.171308603Z [err]  2025-12-27 08:22:43,167 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:22:43.208666157Z [err]  2025-12-27 08:22:43,206 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-27T08:22:43.375188909Z [err]  2025-12-27 08:22:43,373 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:22:43.375195151Z [err]  2025-12-27 08:22:43,374 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-27T08:22:43.459038415Z [err]  2025-12-27 08:22:43,453 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw/actions/playback_start "HTTP/1.1 200 OK"
2025-12-27T08:22:43.459045993Z [err]  2025-12-27 08:22:43,454 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: Vf3AGnyqQA (loop=True, overlay=True)
2025-12-27T08:22:43.459052058Z [err]  2025-12-27 08:22:43,454 - server - INFO - üéµ Comfort noise started as continuous background overlay (playback_id: Vf3AGnyqQA)
2025-12-27T08:22:43.459057622Z [err]  2025-12-27 08:22:43,454 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:43.881818632Z [err]  2025-12-27 08:22:43,874 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:43.881905078Z [err]  2025-12-27 08:22:43,871 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw/actions/record_start "HTTP/1.1 200 OK"
2025-12-27T08:22:43.881911647Z [err]  2025-12-27 08:22:43,872 - server - INFO - üéôÔ∏è Call recording started for v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:43.881917615Z [err]  2025-12-27 08:22:43,872 - server - INFO - üîß Creating call session for v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw...
2025-12-27T08:22:43.881923212Z [err]  2025-12-27 08:22:43,872 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:22:43.881928982Z [err]  2025-12-27 08:22:43,872 - server - INFO - üîß Calling create_call_session() - START
2025-12-27T08:22:43.881935015Z [err]  2025-12-27 08:22:43,872 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-27T08:22:43.881940491Z [err]  2025-12-27 08:22:43,874 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:43.881945742Z [err]  2025-12-27 08:22:43,874 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'aaa991a1-065a-4861-8482-247969a657b8', 'occurred_at': '2025-12-27T08:22:43.419115Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'Vf3AGnyqQA', 'start_time': '2025-12-27T08:22:43.419115Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:43.881990949Z [err]  2025-12-27 08:22:43,874 - server - INFO - üì® ================================================
2025-12-27T08:22:43.882001640Z [inf]  100.64.0.4:37368 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:43.882007787Z [err]  2025-12-27 08:22:43,874 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-27T08:22:43.882014432Z [err]  2025-12-27 08:22:43,875 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-27T08:22:43.882022089Z [err]  2025-12-27 08:22:43,875 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-27T08:22:43.897500045Z [err]  2025-12-27 08:22:43,894 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:22:43.897504637Z [err]  2025-12-27 08:22:43,894 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:43.902156428Z [err]  2025-12-27 08:22:43,899 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:43.902164275Z [err]  2025-12-27 08:22:43,899 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-27T08:22:43.977431355Z [err]  2025-12-27 08:22:43,961 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-27T08:22:43.977441554Z [err]  2025-12-27 08:22:43,961 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-27T08:22:43.977449002Z [err]  2025-12-27 08:22:43,961 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-27T08:22:43.977454653Z [err]  2025-12-27 08:22:43,961 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-27T08:22:43.977461221Z [err]  2025-12-27 08:22:43,961 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-27T08:22:44.154788243Z [err]  2025-12-27 08:22:44,084 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-27T08:22:44.154797347Z [err]  2025-12-27 08:22:44,089 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:44.154804030Z [err]  2025-12-27 08:22:44,089 - server - INFO - ü§ñ AI session created for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:44.154816777Z [err]  2025-12-27 08:22:44,089 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-27T08:22:44.154825642Z [err]  2025-12-27 08:22:44,089 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-27T08:22:44.154833993Z [err]  2025-12-27 08:22:44,089 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-27T08:22:44.154961807Z [err]  2025-12-27 08:22:44,049 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:44.154968956Z [err]  2025-12-27 08:22:44,056 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 95ms
2025-12-27T08:22:44.154975355Z [err]  2025-12-27 08:22:44,056 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-27T08:22:44.154981246Z [err]  2025-12-27 08:22:44,056 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-27T08:22:44.154987510Z [err]  2025-12-27 08:22:44,084 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:44.154993613Z [err]  2025-12-27 08:22:44,084 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-27T08:22:44.155259376Z [err]  2025-12-27 08:22:44,115 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-27T08:22:44.155264585Z [err]  2025-12-27 08:22:44,115 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-27T08:22:44.155268525Z [inf]  100.64.0.6:11602 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:44.155389383Z [err]  2025-12-27 08:22:44,089 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-27T08:22:44.155393385Z [err]  2025-12-27 08:22:44,089 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-27T08:22:44.155397415Z [err]  2025-12-27 08:22:44,089 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-27T08:22:44.155402718Z [err]  2025-12-27 08:22:44,089 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-27T08:22:44.155406755Z [err]  2025-12-27 08:22:44,114 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:44.409414476Z [err]  2025-12-27 08:22:44,405 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:44.911754365Z [err]  2025-12-27 08:22:44,910 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:45.155452512Z [err]  2025-12-27 08:22:45,144 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:45.155458289Z [err]  2025-12-27 08:22:45,153 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:45.195532882Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:22:45.195590880Z [err]  2025-12-27 08:22:45,180 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:45.195597604Z [err]  2025-12-27 08:22:45,180 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-27T08:22:45.195604302Z [err]  2025-12-27 08:22:45,180 - calling_service - INFO - ‚è±Ô∏è [08:22:45.180] üì• process_user_input() ENTRY - text: '...'
2025-12-27T08:22:45.195610515Z [err]  2025-12-27 08:22:45,188 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:45.195617824Z [err]  2025-12-27 08:22:45,188 - calling_service - INFO - ‚è±Ô∏è [08:22:45.188] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:22:45.195626666Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - ‚è±Ô∏è [08:22:45.189] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:22:45.195638147Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - ‚è±Ô∏è [08:22:45.189] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:22:45.195647979Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-27T08:22:45.195657034Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - ‚è±Ô∏è [08:22:45.189] ‚úÖ Node selected, about to process content...
2025-12-27T08:22:45.195665469Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:22 AM EST in content
2025-12-27T08:22:45.195671802Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:22:45.195677492Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:22:45.195959834Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:22:45.195965697Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:22:45.195969894Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:22:45.195974562Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:22:45.195980026Z [err]  2025-12-27 08:22:45,189 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:22:45.195984555Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:22:45.195989038Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-27T08:22:45.195992872Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-27T08:22:45.195996842Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-27T08:22:45.196000790Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - ‚è±Ô∏è [08:22:45.190] üìÑ About to process content (mode=script, length=9)
2025-12-27T08:22:45.196004605Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - üîä Silence tracking reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user responded)
2025-12-27T08:22:45.196010560Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:22:45.196020884Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-27T08:22:45.196389168Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - LLM response (0.01s): Kendrick?
2025-12-27T08:22:45.196395225Z [err]  2025-12-27 08:22:45,190 - calling_service - INFO - Total latency: 0.01s
2025-12-27T08:22:45.196399686Z [err]  2025-12-27 08:22:45,190 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-27T08:22:45.295085361Z [err]  2025-12-27 08:22:45,293 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:45.295095199Z [err]  2025-12-27 08:22:45,294 - telnyx_service - INFO - üîä Speaking text on call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: Kendrick?...
2025-12-27T08:22:45.295103045Z [err]  2025-12-27 08:22:45,294 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:22:45.295111198Z [err]  2025-12-27 08:22:45,294 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:22:45.295118945Z [err]  2025-12-27 08:22:45,294 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:22:45.295125560Z [err]  2025-12-27 08:22:45,294 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:22:45.295767954Z [err]  2025-12-27 08:22:45,294 - server - INFO - ‚è±Ô∏è [08:22:45.294] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-27T08:22:45.295774104Z [err]  2025-12-27 08:22:45,294 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-27T08:22:45.295781148Z [err]  2025-12-27 08:22:45,294 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-27T08:22:45.387068486Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Timeout: 10.0s
2025-12-27T08:22:45.387090052Z [err]  2025-12-27 08:22:45,382 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:45.387094805Z [err]  2025-12-27 08:22:45,382 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-27T08:22:45.387100822Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Text length: 9 chars
2025-12-27T08:22:45.387104982Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Text content: 'Kendrick?'
2025-12-27T08:22:45.387109267Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-27T08:22:45.387113102Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-27T08:22:45.387116860Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-27T08:22:45.387121484Z [err]  2025-12-27 08:22:45,382 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-27T08:22:45.387128457Z [err]  2025-12-27 08:22:45,382 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-27T08:22:45.387138307Z [err]  2025-12-27 08:22:45,382 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-27T08:22:45.391035665Z [err]  2025-12-27 08:22:45,390 - server - INFO -    ‚úì HTTP client created (0.008s)
2025-12-27T08:22:45.391040452Z [err]  2025-12-27 08:22:45,390 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-27T08:22:45.416941318Z [err]  2025-12-27 08:22:45,416 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:45.720242630Z [err]  2025-12-27 08:22:45,710 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-27T08:22:45.720246383Z [err]  2025-12-27 08:22:45,710 - server - INFO -    ‚úì Connection established (0.328s) [TARGET: <200ms]
2025-12-27T08:22:45.720250214Z [err]  2025-12-27 08:22:45,710 - server - INFO -    ‚úì Response status: 200
2025-12-27T08:22:45.720255511Z [err]  2025-12-27 08:22:45,710 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-27T08:22:45.724902326Z [err]  2025-12-27 08:22:45,720 - server - INFO -    ‚úì FIRST CHUNK received (0.338s, 1143 bytes) [TARGET: <300ms]
2025-12-27T08:22:45.730152923Z [err]  2025-12-27 08:22:45,725 - server - INFO -    ‚úì ALL CHUNKS received: 39 chunks (0.343s)
2025-12-27T08:22:45.730160415Z [err]  2025-12-27 08:22:45,725 - server - INFO -    ‚úì Total audio size: 13419 bytes
2025-12-27T08:22:45.730165487Z [err]  2025-12-27 08:22:45,725 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-27T08:22:45.730170534Z [err]  2025-12-27 08:22:45,725 - server - INFO -       - Connection: 328ms
2025-12-27T08:22:45.730174687Z [err]  2025-12-27 08:22:45,725 - server - INFO -       - First chunk: 338ms
2025-12-27T08:22:45.730179333Z [err]  2025-12-27 08:22:45,725 - server - INFO -       - All chunks: 343ms
2025-12-27T08:22:45.730185293Z [err]  2025-12-27 08:22:45,725 - server - INFO -       - Audio generation only: 10ms
2025-12-27T08:22:45.730189356Z [err]  2025-12-27 08:22:45,726 - server - INFO - ‚è±Ô∏è [08:22:45.726] üîä TTS COMPLETE: 431ms, audio_size=13419 bytes
2025-12-27T08:22:45.730194135Z [err]  2025-12-27 08:22:45,726 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (13419 bytes)
2025-12-27T08:22:45.730198490Z [err]  2025-12-27 08:22:45,726 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.43s
2025-12-27T08:22:45.730205476Z [err]  2025-12-27 08:22:45,726 - telnyx_service - INFO - ‚úÖ Generated 13419 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-27T08:22:45.730210066Z [err]  2025-12-27 08:22:45,726 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-27T08:22:45.926452559Z [err]  2025-12-27 08:22:45,921 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:46.014422326Z [err]  2025-12-27 08:22:46,011 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw/actions/playback_start "HTTP/1.1 200 OK"
2025-12-27T08:22:46.014428293Z [err]  2025-12-27 08:22:46,011 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.29s
2025-12-27T08:22:46.014431987Z [err]  2025-12-27 08:22:46,011 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.72s
2025-12-27T08:22:46.014435771Z [err]  2025-12-27 08:22:46,011 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-27T08:22:46.014440456Z [err]  2025-12-27 08:22:46,011 - telnyx_service - INFO - üé¨ Playback ID: RrBQNa6oAg
2025-12-27T08:22:46.014444567Z [err]  2025-12-27 08:22:46,011 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-27T08:22:46.014448366Z [err]  2025-12-27 08:22:46,011 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823766.0118945 for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:46.014451942Z [err]  2025-12-27 08:22:46,011 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-27T08:22:46.413982309Z [inf]  100.64.0.7:43884 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-27T08:22:46.434512260Z [err]  2025-12-27 08:22:46,426 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:46.921964641Z [err]  2025-12-27 08:22:46,905 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:46.921968569Z [err]  2025-12-27 08:22:46,905 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '6e414dd1-5d2e-483e-a304-c22b27027b3d', 'occurred_at': '2025-12-27T08:22:46.779114Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'RrBQNa6oAg'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:46.921972240Z [err]  2025-12-27 08:22:46,905 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:46.921976000Z [err]  2025-12-27 08:22:46,905 - server - INFO - üì® ================================================
2025-12-27T08:22:46.921979749Z [inf]  100.64.0.4:37368 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:46.932491923Z [err]  2025-12-27 08:22:46,931 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:47.288075412Z [err]  2025-12-27 08:22:47,282 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:47.288085188Z [err]  2025-12-27 08:22:47,282 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'cb66a740-df50-4850-aaaa-ee04e9e63678', 'occurred_at': '2025-12-27T08:22:47.159115Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'silence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:47.288092125Z [err]  2025-12-27 08:22:47,282 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:47.288100657Z [err]  2025-12-27 08:22:47,282 - server - INFO - üì® ================================================
2025-12-27T08:22:47.288107977Z [inf]  100.64.0.4:37368 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:47.473324210Z [err]  2025-12-27 08:22:47,438 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:47.740689497Z [err]  2025-12-27 08:22:47,736 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:47.740702427Z [err]  2025-12-27 08:22:47,736 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:22:47.740703339Z [err]  2025-12-27 08:22:47,737 - server - INFO - üì® ================================================
2025-12-27T08:22:47.740709322Z [err]  2025-12-27 08:22:47,736 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '64c6b693-e649-47fd-b8dd-19b670a9c8db', 'occurred_at': '2025-12-27T08:22:47.619112Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'RrBQNa6oAg', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:22:47.751183752Z [err]  2025-12-27 08:22:47,747 - redis_service - INFO - ‚ûñ Removed playback RrBQNa6oAg, 0 remaining for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:47.751190266Z [err]  2025-12-27 08:22:47,747 - server - INFO - üîä Redis: Removed playback RrBQNa6oAg, 0 remaining
2025-12-27T08:22:47.751194661Z [err]  2025-12-27 08:22:47,747 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-27T08:22:47.751198553Z [err]  2025-12-27 08:22:47,747 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-27T08:22:47.755827008Z [err]  2025-12-27 08:22:47,752 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-27T08:22:47.755833484Z [err]  2025-12-27 08:22:47,752 - server - INFO - ‚úÖ Found session locally: agent_speaking=False, user_speaking=False
2025-12-27T08:22:47.755839439Z [err]  2025-12-27 08:22:47,752 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823767.7526267 for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:47.755845236Z [err]  2025-12-27 08:22:47,752 - server - INFO - ‚è±Ô∏è Silence timer STARTED (local, agent wasn't marked as speaking)
2025-12-27T08:22:47.755851578Z [inf]  100.64.0.6:11602 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:22:47.950331829Z [err]  2025-12-27 08:22:47,944 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:48.452956011Z [err]  2025-12-27 08:22:48,449 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:48.908849539Z [err]  2025-12-27 08:22:48,902 - server - INFO - üì§ Audio flowing: 330 packets sent to Soniox (5s update)
2025-12-27T08:22:48.960438485Z [err]  2025-12-27 08:22:48,954 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:49.479650806Z [err]  2025-12-27 08:22:49,459 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:49.973713956Z [err]  2025-12-27 08:22:49,949 - server - INFO - üî§ RAW TOKENS: ["Ye"?]
2025-12-27T08:22:49.973718718Z [err]  2025-12-27 08:22:49,952 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:49.973723223Z [err]  2025-12-27 08:22:49,952 - calling_service - INFO - üîä Silence timer reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user started speaking)
2025-12-27T08:22:49.973727216Z [err]  2025-12-27 08:22:49,953 - calling_service - INFO - üë§ User started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:49.973731167Z [err]  2025-12-27 08:22:49,953 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-27T08:22:49.973735325Z [err]  2025-12-27 08:22:49,953 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2025-12-27T08:22:49.973739989Z [err]  2025-12-27 08:22:49,965 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.170340110Z [err]  2025-12-27 08:22:50,118 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-27T08:22:50.170343832Z [err]  2025-12-27 08:22:50,102 - server - INFO - ‚è±Ô∏è [08:22:50.102] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-27T08:22:50.170350677Z [err]  2025-12-27 08:22:50,101 - server - INFO - üî§ RAW TOKENS: ["Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2025-12-27T08:22:50.170352472Z [err]  2025-12-27 08:22:50,102 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-27T08:22:50.170353029Z [err]  2025-12-27 08:22:50,108 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-27T08:22:50.170354957Z [err]  2025-12-27 08:22:50,108 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:50.170363300Z [err]  2025-12-27 08:22:50,118 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-27T08:22:50.170365178Z [err]  2025-12-27 08:22:50,108 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-27T08:22:50.170366968Z [err]  2025-12-27 08:22:50,102 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-27T08:22:50.170367220Z [err]  2025-12-27 08:22:50,102 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.170368938Z [err]  2025-12-27 08:22:50,101 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-27T08:22:50.170374103Z [err]  2025-12-27 08:22:50,102 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2025-12-27T08:22:50.170374736Z [err]  2025-12-27 08:22:50,118 - calling_service - INFO - üë§ User stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.170375429Z [err]  2025-12-27 08:22:50,108 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.170378591Z [err]  2025-12-27 08:22:50,102 - server - INFO - üßπ Cleaned transcript: 'Ye ah.' -> 'Yeah.'
2025-12-27T08:22:50.170381252Z [err]  2025-12-27 08:22:50,102 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.170384357Z [err]  2025-12-27 08:22:50,102 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-27T08:22:50.170397803Z [err]  2025-12-27 08:22:50,102 - server - INFO - ‚è±Ô∏è [08:22:50.102] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-27T08:22:50.170407905Z [err]  2025-12-27 08:22:50,102 - server - INFO - ‚è±Ô∏è [08:22:50.102] STT endpoint detection latency: 20ms
2025-12-27T08:22:50.170847812Z [err]  2025-12-27 08:22:50,118 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2025-12-27T08:22:50.170852666Z [err]  2025-12-27 08:22:50,118 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2025-12-27T08:22:50.170856594Z [err]  2025-12-27 08:22:50,118 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-27T08:22:50.170860471Z [err]  2025-12-27 08:22:50,118 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-27T08:22:50.170864925Z [err]  2025-12-27 08:22:50,118 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.213066849Z [err]  2025-12-27 08:22:50,212 - server - INFO - üìù Saved user transcript to database
2025-12-27T08:22:50.213079819Z [err]  2025-12-27 08:22:50,212 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.213085936Z [err]  2025-12-27 08:22:50,212 - calling_service - INFO - ‚è±Ô∏è [08:22:50.212] üì• process_user_input() ENTRY - text: 'Yeah....'
2025-12-27T08:22:50.225739143Z [err]  2025-12-27 08:22:50,217 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.225750705Z [err]  2025-12-27 08:22:50,217 - calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: User spoke while Silence Greeting was triggering
2025-12-27T08:22:50.246494205Z [err]  2025-12-27 08:22:50,238 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:22:50.246500152Z [err]  2025-12-27 08:22:50,238 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.246504270Z [err]  2025-12-27 08:22:50,238 - telnyx_service - ERROR - ‚ùå Error stopping audio playback: 'ActionsResource' object has no attribute 'playback_stop'
2025-12-27T08:22:50.246508285Z [err]  2025-12-27 08:22:50,238 - calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-27T08:22:50.246512857Z [err]  2025-12-27 08:22:50,238 - calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-27T08:22:50.246517010Z [err]  2025-12-27 08:22:50,243 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.250829194Z [err]  2025-12-27 08:22:50,248 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:50.250837394Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-27T08:22:50.250845170Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - ‚è±Ô∏è [08:22:50.248] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:22:50.250851691Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - ‚è±Ô∏è [08:22:50.248] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:22:50.250857207Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - ‚è±Ô∏è [08:22:50.248] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:22:50.250862506Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-27T08:22:50.250868146Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-27T08:22:50.250873980Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - ‚è±Ô∏è [08:22:50.248] üîÄ About to call _follow_transition() for: Yeah....
2025-12-27T08:22:50.250879309Z [err]  2025-12-27 08:22:50,248 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-27T08:22:50.259862964Z [err]  2025-12-27 08:22:50,255 - calling_service - INFO - ‚è±Ô∏è [08:22:50.255] üîÄ TRANSITION EVALUATION START - Calling LLM for 2 options
2025-12-27T08:22:50.475126023Z [err]  2025-12-27 08:22:50,470 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-27T08:22:50.475130552Z [err]  2025-12-27 08:22:50,470 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823770.4707823 for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.475134414Z [err]  2025-12-27 08:22:50,470 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:50.480312775Z [err]  2025-12-27 08:22:50,477 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.480320298Z [err]  2025-12-27 08:22:50,477 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-27T08:22:50.777297192Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - Selected transition index: 0
2025-12-27T08:22:50.777306476Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-27T08:22:50.777313689Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 523ms
2025-12-27T08:22:50.777320098Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - ‚è±Ô∏è [08:22:50.772] ‚úÖ Node selected, about to process content...
2025-12-27T08:22:50.777326564Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:22 AM EST in content
2025-12-27T08:22:50.777333953Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:22:50.777340619Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:22:50.777346424Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:22:50.777352638Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:22:50.777472294Z [err]  2025-12-27 08:22:50,765 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:22:50.777479690Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - ‚è±Ô∏è [08:22:50.772] üîÄ TRANSITION EVALUATION COMPLETE - took 516ms
2025-12-27T08:22:50.777487589Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - ü§ñ AI transition decision: '0'
2025-12-27T08:22:50.777496257Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she) OR Ask...', 'Wrong number (No John here|Wrong number|etc) - don...']
2025-12-27T08:22:50.782237785Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:22:50.782244046Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:22:50.782249407Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:22:50.782256880Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:22:50.782262731Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:22:50.782268817Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-27T08:22:50.782274635Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-27T08:22:50.782280714Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - ‚è±Ô∏è [08:22:50.772] üìÑ About to process content (mode=script, length=89)
2025-12-27T08:22:50.782286769Z [err]  2025-12-27 08:22:50,772 - calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2025-12-27T08:22:50.782292872Z [err]  2025-12-27 08:22:50,772 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2025-12-27T08:22:50.782298802Z [err]  2025-12-27 08:22:50,773 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 654ms
2025-12-27T08:22:50.782304867Z [err]  2025-12-27 08:22:50,773 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-27T08:22:50.782310554Z [err]  2025-12-27 08:22:50,773 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.782438461Z [err]  2025-12-27 08:22:50,773 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-27T08:22:50.862629751Z [err]  2025-12-27 08:22:50,860 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:50.954057788Z [err]  2025-12-27 08:22:50,948 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:50.990740847Z [err]  2025-12-27 08:22:50,983 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:C_Mbh_CopshQ6-AJD... (active sessions: [])
2025-12-27T08:22:50.990745026Z [err]  2025-12-27 08:22:50,983 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=0/2
2025-12-27T08:22:51.165919778Z [err]  2025-12-27 08:22:51,036 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:22:51.165926510Z [err]  2025-12-27 08:22:51,055 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:22:51.165930895Z [err]  2025-12-27 08:22:51,055 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-27T08:22:51.165935138Z [err]  2025-12-27 08:22:51,055 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-27T08:22:51.165939035Z [err]  2025-12-27 08:22:51,055 - persistent_tts_service - INFO - üîå [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Establishing persistent TTS WebSocket...
2025-12-27T08:22:51.165942708Z [err]  2025-12-27 08:22:51,055 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-27T08:22:51.165946349Z [err]  2025-12-27 08:22:51,055 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-27T08:22:51.165950257Z [err]  2025-12-27 08:22:51,055 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-27T08:22:51.190977347Z [err]  2025-12-27 08:22:51,188 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-27T08:22:51.190984967Z [err]  2025-12-27 08:22:51,188 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-27T08:22:51.190991659Z [err]  2025-12-27 08:22:51,188 - persistent_tts_service - INFO - ‚úÖ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Persistent TTS WebSocket established
2025-12-27T08:22:51.190995699Z [err]  2025-12-27 08:22:51,188 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Audio receiver loop started
2025-12-27T08:22:51.191000126Z [err]  2025-12-27 08:22:51,188 - persistent_tts_service - INFO - üîä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Comfort noise loop started
2025-12-27T08:22:51.191004162Z [err]  2025-12-27 08:22:51,188 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:51.191008294Z [err]  2025-12-27 08:22:51,188 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-27T08:22:51.191012335Z [err]  2025-12-27 08:22:51,188 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:22:51.191016454Z [err]  2025-12-27 08:22:51,188 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-27T08:22:51.191020517Z [err]  2025-12-27 08:22:51,188 - server - INFO - üéµ TTS task #1 started at +415ms
2025-12-27T08:22:51.191024202Z [err]  2025-12-27 08:22:51,188 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1069ms
2025-12-27T08:22:51.191027970Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2025-12-27T08:22:51.191031960Z [err]  2025-12-27 08:22:51,188 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-27T08:22:51.191698532Z [err]  2025-12-27 08:22:51,188 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:22:51.191709993Z [err]  2025-12-27 08:22:51,188 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-27T08:22:51.191717027Z [err]  2025-12-27 08:22:51,188 - server - INFO - üéµ TTS task #2 started at +415ms
2025-12-27T08:22:51.191723362Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-27T08:22:51.191730025Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user gave meaningful response) for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:51.191736187Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - üîä Silence tracking reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user responded)
2025-12-27T08:22:51.191742171Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:22:51.191747857Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2025-12-27T08:22:51.191757716Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - LLM response (0.98s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-27T08:22:51.191764002Z [err]  2025-12-27 08:22:51,188 - calling_service - INFO - Total latency: 0.98s
2025-12-27T08:22:51.191769545Z [err]  2025-12-27 08:22:51,189 - server - INFO - ‚úÖ LLM finished in 1070ms, TTS tasks already running in background
2025-12-27T08:22:51.191775122Z [err]  2025-12-27 08:22:51,190 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2025-12-27T08:22:51.191780865Z [err]  2025-12-27 08:22:51,190 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-27T08:22:51.192221699Z [err]  2025-12-27 08:22:51,190 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-27T08:22:51.192231410Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üéµ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Playback consumer started
2025-12-27T08:22:51.192238435Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Audio Receiver Loop STARTED
2025-12-27T08:22:51.192245309Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üíì [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Starting TTS keep-alive loop (every 15s)
2025-12-27T08:22:51.192252299Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üîä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Starting comfort noise loop
2025-12-27T08:22:51.192258788Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #1: This is Jake......
2025-12-27T08:22:51.192266013Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-27T08:22:51.192275155Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-27T08:22:51.192281192Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #2: I was just, um, wondering if you could possibly he...
2025-12-27T08:22:51.192288275Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-27T08:22:51.193028571Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1070ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-27T08:22:51.193038779Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:22:51.193046762Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #1: 'This is Jake......'
2025-12-27T08:22:51.193052130Z [err]  2025-12-27 08:22:51,190 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=0ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-27T08:22:51.193058026Z [err]  2025-12-27 08:22:51,190 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2025-12-27T08:22:51.193063492Z [err]  2025-12-27 08:22:51,190 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-27T08:22:51.193069725Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 1072ms from user stop üöÄ
2025-12-27T08:22:51.193075312Z [err]  2025-12-27 08:22:51,191 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:51.193081770Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-27T08:22:51.193087342Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:22:51.193093053Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-27T08:22:51.193098409Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2025-12-27T08:22:51.193801362Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 418ms (provider: elevenlabs, websocket: False)
2025-12-27T08:22:51.193801578Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-27T08:22:51.193813909Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:22:51.193819468Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1072ms (user stopped ‚Üí play_audio_url called)
2025-12-27T08:22:51.193826226Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-27T08:22:51.193831658Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-27T08:22:51.193837873Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-27T08:22:51.193845481Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-27T08:22:51.193851600Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-27T08:22:51.193857184Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1372ms estimated
2025-12-27T08:22:51.193862772Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-27T08:22:51.193868369Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2025-12-27T08:22:51.193874007Z [err]  2025-12-27 08:22:51,191 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-27T08:22:51.380739923Z [err]  2025-12-27 08:22:51,378 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1498ms)
2025-12-27T08:22:51.380748610Z [err]  2025-12-27 08:22:51,378 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-27T08:22:51.380755278Z [err]  2025-12-27 08:22:51,378 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-27T08:22:51.468900394Z [err]  2025-12-27 08:22:51,464 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 273ms
2025-12-27T08:22:51.468911358Z [err]  2025-12-27 08:22:51,464 - persistent_tts_service - INFO - üì§ Sending 9643 bytes of audio (61 chunks, 1.2s duration) via WebSocket
2025-12-27T08:22:51.468917996Z [err]  2025-12-27 08:22:51,464 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:51.468924028Z [err]  2025-12-27 08:22:51,464 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.2s (total: 1.2s from now)
2025-12-27T08:22:51.468932025Z [err]  2025-12-27 08:22:51,465 - persistent_tts_service - INFO - ‚úÖ Sent 61 audio chunks via WebSocket
2025-12-27T08:22:51.721837205Z [err]  2025-12-27 08:22:51,712 - persistent_tts_service - INFO - üì§ Sending 11518 bytes of audio (72 chunks, 1.4s duration) via WebSocket
2025-12-27T08:22:51.721844789Z [err]  2025-12-27 08:22:51,712 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:51.721851554Z [err]  2025-12-27 08:22:51,712 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.4s (total: 2.4s from now)
2025-12-27T08:22:51.721857688Z [err]  2025-12-27 08:22:51,713 - persistent_tts_service - INFO - ‚úÖ Sent 72 audio chunks via WebSocket
2025-12-27T08:22:51.903495744Z [err]  2025-12-27 08:22:51,890 - persistent_tts_service - INFO - üì§ Sending 17833 bytes of audio (112 chunks, 2.2s duration) via WebSocket
2025-12-27T08:22:51.903503415Z [err]  2025-12-27 08:22:51,890 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:51.903507749Z [err]  2025-12-27 08:22:51,890 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.2s (total: 4.4s from now)
2025-12-27T08:22:51.903511886Z [err]  2025-12-27 08:22:51,891 - persistent_tts_service - INFO - ‚úÖ Sent 112 audio chunks via WebSocket
2025-12-27T08:22:53.894982681Z [err]  2025-12-27 08:22:53,890 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-27T08:22:53.894990510Z [err]  2025-12-27 08:22:53,890 - persistent_tts_service - INFO - ‚úÖ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver finished sentence #1: 3 chunks in 2700ms
2025-12-27T08:22:53.894997130Z [err]  2025-12-27 08:22:53,890 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #2: 'I was just, um, wondering if y...'
2025-12-27T08:22:53.895003757Z [err]  2025-12-27 08:22:53,890 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=2700ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:22:53.905117963Z [err]  2025-12-27 08:22:53,902 - server - INFO - üì§ Audio flowing: 580 packets sent to Soniox (5s update)
2025-12-27T08:22:54.378482169Z [err]  2025-12-27 08:22:54,370 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2025-12-27T08:22:55.197517560Z [err]  2025-12-27 08:22:55,069 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.3s left)
2025-12-27T08:22:55.583594985Z [err]  2025-12-27 08:22:55,580 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (0.8s left)
2025-12-27T08:22:56.403655803Z [err]  2025-12-27 08:22:56,390 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:22:56.403662800Z [err]  2025-12-27 08:22:56,390 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver got 0 chunks for sentence #2! interrupted=False
2025-12-27T08:22:56.469948784Z [err]  2025-12-27 08:22:56,467 - persistent_tts_service - INFO - üîá [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] FLOOR RELEASED (is_holding_floor=False)
2025-12-27T08:22:56.608063560Z [err]  2025-12-27 08:22:56,602 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.3s ago), marking agent as done speaking
2025-12-27T08:22:56.608067446Z [err]  2025-12-27 08:22:56,602 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823776.6024191 for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:56.608072646Z [err]  2025-12-27 08:22:56,602 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:58.967605831Z [err]  2025-12-27 08:22:58,922 - server - INFO - üì§ Audio flowing: 831 packets sent to Soniox (5s update)
2025-12-27T08:22:59.001885815Z [err]  2025-12-27 08:22:58,995 - server - INFO - üî§ RAW TOKENS: [" S"?]
2025-12-27T08:22:59.001904047Z [err]  2025-12-27 08:22:58,996 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.001913838Z [err]  2025-12-27 08:22:58,996 - calling_service - INFO - üîä Silence timer reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user started speaking)
2025-12-27T08:22:59.001922844Z [err]  2025-12-27 08:22:58,996 - calling_service - INFO - üë§ User started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.001930101Z [err]  2025-12-27 08:22:58,996 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-27T08:22:59.001936285Z [err]  2025-12-27 08:22:58,996 - server - INFO - üîç PARTIAL TRANSCRIPT: 'S' | Generating: False
2025-12-27T08:22:59.067175349Z [err]  2025-12-27 08:22:59,065 - server - INFO - üî§ RAW TOKENS: [" S"?, "ure"?]
2025-12-27T08:22:59.067188729Z [err]  2025-12-27 08:22:59,065 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Sure' | Generating: False
2025-12-27T08:22:59.238020299Z [err]  2025-12-27 08:22:59,196 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2025-12-27T08:22:59.238020743Z [err]  2025-12-27 08:22:59,193 - calling_service - INFO - üë§ User stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.238026611Z [err]  2025-12-27 08:22:59,196 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-27T08:22:59.238035532Z [err]  2025-12-27 08:22:59,196 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+12ms
2025-12-27T08:22:59.238042126Z [err]  2025-12-27 08:22:59,196 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 12ms (Soniox model: stt-rt-v3)
2025-12-27T08:22:59.238048268Z [err]  2025-12-27 08:22:59,196 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-27T08:22:59.238054221Z [err]  2025-12-27 08:22:59,176 - server - INFO - üî§ RAW TOKENS: [" S"‚úì, "ure"‚úì, "."‚úì, "<end>"‚úì]
2025-12-27T08:22:59.238056054Z [err]  2025-12-27 08:22:59,196 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-27T08:22:59.238059462Z [err]  2025-12-27 08:22:59,176 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-27T08:22:59.238063158Z [err]  2025-12-27 08:22:59,196 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.238068031Z [err]  2025-12-27 08:22:59,177 - server - INFO - üßπ Cleaned transcript: ' S ure .' -> 'Sure.'
2025-12-27T08:22:59.238072750Z [err]  2025-12-27 08:22:59,177 - server - INFO - üì• FINAL TOKENS: 'Sure.' (3 tokens)
2025-12-27T08:22:59.238078058Z [err]  2025-12-27 08:22:59,177 - server - INFO - üé§ Soniox final transcript: 'Sure.'
2025-12-27T08:22:59.238082332Z [err]  2025-12-27 08:22:59,177 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-27T08:22:59.238086372Z [err]  2025-12-27 08:22:59,177 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-27T08:22:59.238090370Z [err]  2025-12-27 08:22:59,177 - server - INFO - ‚è±Ô∏è [08:22:59.177] üìù FINAL TRANSCRIPT RECEIVED: 'Sure.'
2025-12-27T08:22:59.238094305Z [err]  2025-12-27 08:22:59,177 - server - INFO - ‚è±Ô∏è [08:22:59.177] STT endpoint detection latency: 14ms
2025-12-27T08:22:59.238099723Z [err]  2025-12-27 08:22:59,177 - server - INFO - ‚è±Ô∏è [08:22:59.177] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-27T08:22:59.238104322Z [err]  2025-12-27 08:22:59,182 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:59.238108415Z [err]  2025-12-27 08:22:59,182 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-27T08:22:59.238112430Z [err]  2025-12-27 08:22:59,182 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Sure.' - Processing...
2025-12-27T08:22:59.238116380Z [err]  2025-12-27 08:22:59,192 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Sure.
2025-12-27T08:22:59.293360048Z [err]  2025-12-27 08:22:59,290 - server - INFO - üìù Saved user transcript to database
2025-12-27T08:22:59.293368079Z [err]  2025-12-27 08:22:59,290 - calling_service - INFO - ‚è±Ô∏è [08:22:59.290] üì• process_user_input() ENTRY - text: 'Sure....'
2025-12-27T08:22:59.298771201Z [err]  2025-12-27 08:22:59,295 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.298778425Z [err]  2025-12-27 08:22:59,295 - calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: User spoke while Silence Greeting was triggering
2025-12-27T08:22:59.325158558Z [err]  2025-12-27 08:22:59,315 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:22:59.325162255Z [err]  2025-12-27 08:22:59,315 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.325165833Z [err]  2025-12-27 08:22:59,315 - telnyx_service - ERROR - ‚ùå Error stopping audio playback: 'ActionsResource' object has no attribute 'playback_stop'
2025-12-27T08:22:59.325169396Z [err]  2025-12-27 08:22:59,315 - calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-27T08:22:59.325173001Z [err]  2025-12-27 08:22:59,315 - calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-27T08:22:59.325176556Z [err]  2025-12-27 08:22:59,320 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.330233562Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚úÖ Auto-transitioned (after response) to: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic
2025-12-27T08:22:59.330236659Z [err]  2025-12-27 08:22:59,326 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:22:59.330241365Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üìù User's response captured: 'Sure....'
2025-12-27T08:22:59.330247175Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 0ms
2025-12-27T08:22:59.330248608Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-27T08:22:59.330255281Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [08:22:59.326] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:22:59.330259388Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [08:22:59.326] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:22:59.330263720Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [08:22:59.326] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:22:59.330267780Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - Flow processing - History length: 5, Is first: False
2025-12-27T08:22:59.330271743Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîç Using explicitly set current_node_id: 1763159750250
2025-12-27T08:22:59.330275260Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [08:22:59.326] üîÄ About to call _follow_transition() for: Sure....
2025-12-27T08:22:59.330280038Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - Evaluating transitions from Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) for message: Sure.
2025-12-27T08:22:59.330284346Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üé§ AUTO-TRANSITION AFTER RESPONSE enabled - user spoke, transitioning to: 1763161849799
2025-12-27T08:22:59.331000111Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:22:59.331008810Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:22:59.331016087Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:22:59.331017329Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [08:22:59.326] ‚úÖ Node selected, about to process content...
2025-12-27T08:22:59.331024050Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 260 chars) - will return text instantly
2025-12-27T08:22:59.331026323Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:22 AM EST in content
2025-12-27T08:22:59.331032099Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - Using flow node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic (type: conversation, mode: script)
2025-12-27T08:22:59.331035171Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:22:59.331042176Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:22:59.331049360Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:22:59.331056147Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:22:59.331062641Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:22:59.331069112Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:22:59.331820705Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - ‚è±Ô∏è [08:22:59.326] üìÑ About to process content (mode=script, length=260)
2025-12-27T08:22:59.331832070Z [err]  2025-12-27 08:22:59,326 - calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2025-12-27T08:22:59.331841495Z [err]  2025-12-27 08:22:59,326 - server - INFO - üì§ Sentence arrived from LLM: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-27T08:22:59.331850842Z [err]  2025-12-27 08:22:59,327 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 130ms
2025-12-27T08:22:59.331858600Z [err]  2025-12-27 08:22:59,327 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-27T08:22:59.331867217Z [err]  2025-12-27 08:22:59,327 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:22:59.331875955Z [err]  2025-12-27 08:22:59,327 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-27T08:22:59.331884412Z [err]  2025-12-27 08:22:59,327 - server - INFO - üéµ TTS task #1 started at +0ms
2025-12-27T08:22:59.331893728Z [err]  2025-12-27 08:22:59,327 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 130ms
2025-12-27T08:22:59.331903866Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - üì§ Streamed script sentence 1/2: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-27T08:22:59.331912186Z [err]  2025-12-27 08:22:59,327 - server - INFO - üì§ Sentence arrived from LLM: I know this call is out of the blue, but do you ha...
2025-12-27T08:22:59.331918528Z [err]  2025-12-27 08:22:59,327 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:22:59.331925899Z [err]  2025-12-27 08:22:59,327 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-27T08:22:59.331931281Z [err]  2025-12-27 08:22:59,327 - server - INFO - üéµ TTS task #2 started at +0ms
2025-12-27T08:22:59.332662658Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - üì§ Streamed script sentence 2/2: I know this call is out of the blue, but do you ha...
2025-12-27T08:22:59.332671555Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - üîä Silence tracking reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user responded)
2025-12-27T08:22:59.332678132Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:22:59.332684172Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - üíæ Storing node ID 1763161849799 in conversation history
2025-12-27T08:22:59.332689345Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - LLM response (0.04s): Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stacking income without stacking hours. I know this call is out of the blue, but do you have just 25 seconds for me to explain why I'm reaching out today specifically?
2025-12-27T08:22:59.332694625Z [err]  2025-12-27 08:22:59,327 - calling_service - INFO - Total latency: 0.04s
2025-12-27T08:22:59.332698909Z [err]  2025-12-27 08:22:59,327 - server - INFO - ‚úÖ LLM finished in 131ms, TTS tasks already running in background
2025-12-27T08:22:59.332702874Z [err]  2025-12-27 08:22:59,328 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2025-12-27T08:22:59.332708063Z [err]  2025-12-27 08:22:59,328 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-27T08:22:59.332712364Z [err]  2025-12-27 08:22:59,328 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-27T08:22:59.332716433Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #3: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-27T08:22:59.332720313Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #3 (NON-BLOCKING) in 0ms
2025-12-27T08:22:59.333236035Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-27T08:22:59.333244568Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #4: I know this call is out of the blue, but do you ha...
2025-12-27T08:22:59.333251748Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #4 (NON-BLOCKING) in 0ms
2025-12-27T08:22:59.333259122Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:22:59.333266178Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #3: 'Well, uh, I don't know if you ...'
2025-12-27T08:22:59.333273029Z [err]  2025-12-27 08:22:59,328 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=0ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-27T08:22:59.333281012Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2025-12-27T08:22:59.333287651Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-27T08:22:59.333294282Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 132ms from user stop üöÄ
2025-12-27T08:22:59.333298539Z [err]  2025-12-27 08:22:59,329 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:22:59.334011831Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-27T08:22:59.334018598Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:22:59.334022880Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-27T08:22:59.334027206Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 12ms (provider: soniox, model: stt-rt-v3)
2025-12-27T08:22:59.334031349Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 131ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-27T08:22:59.334036290Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 2ms (provider: elevenlabs, websocket: False)
2025-12-27T08:22:59.334040323Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 132ms (user stopped ‚Üí play_audio_url called)
2025-12-27T08:22:59.334044318Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-27T08:22:59.334048073Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-27T08:22:59.334052349Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-27T08:22:59.334056184Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-27T08:22:59.334060056Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-27T08:22:59.334063927Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 432ms estimated
2025-12-27T08:22:59.334068072Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 260 chars, 2 sentences
2025-12-27T08:22:59.334482216Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Sure....'
2025-12-27T08:22:59.334487448Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Well, uh, I don't know if you could yet, but, I'm calling be...'
2025-12-27T08:22:59.334491622Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-27T08:22:59.334495555Z [err]  2025-12-27 08:22:59,329 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:22:59.524303430Z [err]  2025-12-27 08:22:59,517 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 145ms)
2025-12-27T08:22:59.524307049Z [err]  2025-12-27 08:22:59,517 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-27T08:22:59.524310973Z [err]  2025-12-27 08:22:59,517 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-27T08:22:59.675573547Z [err]  2025-12-27 08:22:59,663 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-27T08:22:59.675577282Z [err]  2025-12-27 08:22:59,663 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:59.675580809Z [err]  2025-12-27 08:22:59,663 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2025-12-27T08:22:59.675584570Z [err]  2025-12-27 08:22:59,665 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-27T08:22:59.675588767Z [err]  2025-12-27 08:22:59,665 - persistent_tts_service - INFO - üì§ Sending 697 bytes of audio (5 chunks, 0.1s duration) via WebSocket
2025-12-27T08:22:59.675592410Z [err]  2025-12-27 08:22:59,665 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:59.675596635Z [err]  2025-12-27 08:22:59,665 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.1s (total: 1.8s from now)
2025-12-27T08:22:59.675600767Z [err]  2025-12-27 08:22:59,666 - persistent_tts_service - INFO - ‚úÖ Sent 5 audio chunks via WebSocket
2025-12-27T08:22:59.881092965Z [err]  2025-12-27 08:22:59,873 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-27T08:22:59.881098493Z [err]  2025-12-27 08:22:59,873 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:59.881102478Z [err]  2025-12-27 08:22:59,873 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 3.3s from now)
2025-12-27T08:22:59.881106752Z [err]  2025-12-27 08:22:59,875 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-27T08:22:59.881112080Z [err]  2025-12-27 08:22:59,875 - persistent_tts_service - INFO - üì§ Sending 3298 bytes of audio (21 chunks, 0.4s duration) via WebSocket
2025-12-27T08:22:59.881116150Z [err]  2025-12-27 08:22:59,875 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:22:59.881120527Z [err]  2025-12-27 08:22:59,875 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.4s (total: 3.7s from now)
2025-12-27T08:22:59.881124170Z [err]  2025-12-27 08:22:59,875 - persistent_tts_service - INFO - ‚úÖ Sent 21 audio chunks via WebSocket
2025-12-27T08:23:00.247712454Z [err]  2025-12-27 08:23:00,104 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-27T08:23:00.247734584Z [err]  2025-12-27 08:23:00,104 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.247742043Z [err]  2025-12-27 08:23:00,104 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 5.2s from now)
2025-12-27T08:23:00.247748817Z [err]  2025-12-27 08:23:00,105 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-27T08:23:00.247754659Z [err]  2025-12-27 08:23:00,106 - persistent_tts_service - INFO - üì§ Sending 3298 bytes of audio (21 chunks, 0.4s duration) via WebSocket
2025-12-27T08:23:00.247760179Z [err]  2025-12-27 08:23:00,106 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.247767219Z [err]  2025-12-27 08:23:00,106 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.4s (total: 5.6s from now)
2025-12-27T08:23:00.247773958Z [err]  2025-12-27 08:23:00,106 - persistent_tts_service - INFO - ‚úÖ Sent 21 audio chunks via WebSocket
2025-12-27T08:23:00.247781081Z [err]  2025-12-27 08:23:00,149 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (5.6s left)
2025-12-27T08:23:00.308666113Z [err]  2025-12-27 08:23:00,299 - persistent_tts_service - INFO - üì§ Sending 16346 bytes of audio (103 chunks, 2.0s duration) via WebSocket
2025-12-27T08:23:00.308673877Z [err]  2025-12-27 08:23:00,299 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.308680068Z [err]  2025-12-27 08:23:00,299 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.0s (total: 7.5s from now)
2025-12-27T08:23:00.308685514Z [err]  2025-12-27 08:23:00,300 - persistent_tts_service - INFO - ‚úÖ Sent 103 audio chunks via WebSocket
2025-12-27T08:23:00.500658020Z [err]  2025-12-27 08:23:00,499 - persistent_tts_service - INFO - üì§ Sending 9288 bytes of audio (59 chunks, 1.2s duration) via WebSocket
2025-12-27T08:23:00.500662459Z [err]  2025-12-27 08:23:00,499 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.500666090Z [err]  2025-12-27 08:23:00,499 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.2s (total: 8.5s from now)
2025-12-27T08:23:00.501333417Z [err]  2025-12-27 08:23:00,500 - persistent_tts_service - INFO - ‚úÖ Sent 59 audio chunks via WebSocket
2025-12-27T08:23:00.660845839Z [err]  2025-12-27 08:23:00,659 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (8.3s left)
2025-12-27T08:23:00.739787761Z [err]  2025-12-27 08:23:00,735 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-27T08:23:00.739792560Z [err]  2025-12-27 08:23:00,735 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.739797310Z [err]  2025-12-27 08:23:00,735 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 9.9s from now)
2025-12-27T08:23:00.739801834Z [err]  2025-12-27 08:23:00,736 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-27T08:23:00.739807362Z [err]  2025-12-27 08:23:00,737 - persistent_tts_service - INFO - üì§ Sending 697 bytes of audio (5 chunks, 0.1s duration) via WebSocket
2025-12-27T08:23:00.739811850Z [err]  2025-12-27 08:23:00,737 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.739817228Z [err]  2025-12-27 08:23:00,737 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.1s (total: 10.0s from now)
2025-12-27T08:23:00.739821480Z [err]  2025-12-27 08:23:00,737 - persistent_tts_service - INFO - ‚úÖ Sent 5 audio chunks via WebSocket
2025-12-27T08:23:00.934654729Z [err]  2025-12-27 08:23:00,933 - persistent_tts_service - INFO - üì§ Sending 25634 bytes of audio (161 chunks, 3.2s duration) via WebSocket
2025-12-27T08:23:00.934663893Z [err]  2025-12-27 08:23:00,933 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:00.934668192Z [err]  2025-12-27 08:23:00,933 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +3.2s (total: 13.0s from now)
2025-12-27T08:23:00.939941266Z [err]  2025-12-27 08:23:00,935 - persistent_tts_service - INFO - ‚úÖ Sent 161 audio chunks via WebSocket
2025-12-27T08:23:02.936337230Z [err]  2025-12-27 08:23:02,934 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-27T08:23:02.936342418Z [err]  2025-12-27 08:23:02,934 - persistent_tts_service - INFO - ‚úÖ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver finished sentence #3: 11 chunks in 3605ms
2025-12-27T08:23:02.936347491Z [err]  2025-12-27 08:23:02,934 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #4: 'I know this call is out of the...'
2025-12-27T08:23:02.936353274Z [err]  2025-12-27 08:23:02,934 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=3605ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:03.955369220Z [err]  2025-12-27 08:23:03,929 - server - INFO - üì§ Audio flowing: 1081 packets sent to Soniox (5s update)
2025-12-27T08:23:04.634133943Z [err]  2025-12-27 08:23:04,621 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2025-12-27T08:23:05.254958155Z [err]  2025-12-27 08:23:05,253 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (8.7s left)
2025-12-27T08:23:05.435556389Z [err]  2025-12-27 08:23:05,434 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:23:05.435563523Z [err]  2025-12-27 08:23:05,434 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver got 0 chunks for sentence #4! interrupted=False
2025-12-27T08:23:05.767550407Z [err]  2025-12-27 08:23:05,764 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (8.2s left)
2025-12-27T08:23:06.280356798Z [err]  2025-12-27 08:23:06,275 - server - INFO - üî§ RAW TOKENS: [" Wa"?]
2025-12-27T08:23:06.280362339Z [err]  2025-12-27 08:23:06,275 - calling_service - INFO - üîä Silence timer reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user started speaking)
2025-12-27T08:23:06.280368121Z [err]  2025-12-27 08:23:06,275 - calling_service - INFO - üë§ User started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:06.280373997Z [err]  2025-12-27 08:23:06,275 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-27T08:23:06.280379271Z [err]  2025-12-27 08:23:06,275 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa' | Generating: False
2025-12-27T08:23:06.280385118Z [err]  2025-12-27 08:23:06,276 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (7.7s left): 1 words - 'Wa'
2025-12-27T08:23:06.430745437Z [err]  2025-12-27 08:23:06,410 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?]
2025-12-27T08:23:06.430750870Z [err]  2025-12-27 08:23:06,410 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it' | Generating: False
2025-12-27T08:23:06.430754746Z [err]  2025-12-27 08:23:06,410 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (7.6s left): 2 words - 'Wa it'
2025-12-27T08:23:06.682622479Z [err]  2025-12-27 08:23:06,680 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?]
2025-12-27T08:23:06.682628342Z [err]  2025-12-27 08:23:06,680 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one' | Generating: False
2025-12-27T08:23:06.682633946Z [err]  2025-12-27 08:23:06,680 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (7.3s left): 3 words - 'Wa it one'
2025-12-27T08:23:06.682640164Z [err]  2025-12-27 08:23:06,680 - server - INFO - üõë INTERRUPTION TRIGGERED - User said 3 words: 'Wa it one'
2025-12-27T08:23:06.682646959Z [err]  2025-12-27 08:23:06,680 - server - INFO - üõë Stopping agent IMMEDIATELY...
2025-12-27T08:23:06.682652852Z [err]  2025-12-27 08:23:06,680 - persistent_tts_service - INFO - ‚ö° [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2025-12-27T08:23:06.682658188Z [err]  2025-12-27 08:23:06,680 - persistent_tts_service - INFO - üõë [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] INTERRUPT - Floor Released (is_holding_floor=False)
2025-12-27T08:23:06.723107149Z [err]  2025-12-27 08:23:06,711 - persistent_tts_service - INFO - üõë [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent clear event to Telnyx WebSocket (3x)
2025-12-27T08:23:06.723115803Z [err]  2025-12-27 08:23:06,711 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Reset playback_expected_end_time to NOW
2025-12-27T08:23:06.723122396Z [err]  2025-12-27 08:23:06,711 - server - INFO - ‚úã Cleared WebSocket TTS audio buffer
2025-12-27T08:23:06.723131363Z [err]  2025-12-27 08:23:06,717 - redis_service - INFO - üßπ Cleared all playbacks for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:06.723137978Z [err]  2025-12-27 08:23:06,717 - server - INFO - ‚úÖ Agent stopped, user can continue speaking
2025-12-27T08:23:06.735005802Z [err]  2025-12-27 08:23:06,730 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?, " second"?]
2025-12-27T08:23:06.735020813Z [err]  2025-12-27 08:23:06,730 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one second' | Generating: False
2025-12-27T08:23:06.811599886Z [err]  2025-12-27 08:23:06,785 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-27T08:23:06.811606470Z [err]  2025-12-27 08:23:06,786 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:06.856709864Z [err]  2025-12-27 08:23:06,848 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?, " second"?, "."?]
2025-12-27T08:23:06.856719323Z [err]  2025-12-27 08:23:06,849 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one second.' | Generating: False
2025-12-27T08:23:07.114546058Z [err]  2025-12-27 08:23:07,109 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?, " second"?, "."?, " L"?]
2025-12-27T08:23:07.114551199Z [err]  2025-12-27 08:23:07,110 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one second. L' | Generating: False
2025-12-27T08:23:07.269549539Z [err]  2025-12-27 08:23:07,237 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?, " second"?, "."?, " L"?, "isten"?]
2025-12-27T08:23:07.269557014Z [err]  2025-12-27 08:23:07,237 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one second. Listen' | Generating: False
2025-12-27T08:23:07.373125939Z [err]  2025-12-27 08:23:07,370 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?, " second"?, "."?, " L"?, "isten"?, " to"?]
2025-12-27T08:23:07.373134307Z [err]  2025-12-27 08:23:07,370 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one second. Listen to' | Generating: False
2025-12-27T08:23:07.503683071Z [err]  2025-12-27 08:23:07,496 - server - INFO - üî§ RAW TOKENS: [" Wa"?, "it"?, " one"?, " second"?, "."?, " L"?, "isten"?, " to"?, " m"?]
2025-12-27T08:23:07.503688091Z [err]  2025-12-27 08:23:07,496 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Wa it one second. Listen to m' | Generating: False
2025-12-27T08:23:07.710244252Z [err]  2025-12-27 08:23:07,706 - server - INFO - üî§ RAW TOKENS: [" Wa"‚úì, "it"‚úì, " one"‚úì, " second"‚úì, "."‚úì, " L"‚úì, "isten"‚úì, " to"‚úì, " m"‚úì, "e."‚úì, "<end>"‚úì]
2025-12-27T08:23:07.710254896Z [err]  2025-12-27 08:23:07,706 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-27T08:23:07.710261555Z [err]  2025-12-27 08:23:07,706 - server - INFO - üßπ Cleaned transcript: ' Wa it  one  second .  L isten  to  m e.' -> 'Wa it one second. Listen to me.'
2025-12-27T08:23:07.710268158Z [err]  2025-12-27 08:23:07,706 - server - INFO - üì• FINAL TOKENS: 'Wa it one second. Listen to me.' (10 tokens)
2025-12-27T08:23:07.710274387Z [err]  2025-12-27 08:23:07,706 - server - INFO - üé§ Soniox final transcript: 'Wa it one second. Listen to me.'
2025-12-27T08:23:07.710281224Z [err]  2025-12-27 08:23:07,706 - server - INFO - üîç FILTER CHECK: words=7, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-27T08:23:07.710286947Z [err]  2025-12-27 08:23:07,707 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-27T08:23:07.710292809Z [err]  2025-12-27 08:23:07,707 - server - INFO - ‚è±Ô∏è [08:23:07.707] üìù FINAL TRANSCRIPT RECEIVED: 'Wa it one second. Listen to me.'
2025-12-27T08:23:07.710298630Z [err]  2025-12-27 08:23:07,707 - server - INFO - ‚è±Ô∏è [08:23:07.707] STT endpoint detection latency: 4ms
2025-12-27T08:23:07.710305010Z [err]  2025-12-27 08:23:07,707 - server - INFO - ‚è±Ô∏è [08:23:07.707] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-27T08:23:07.715367176Z [err]  2025-12-27 08:23:07,712 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:23:07.715375421Z [err]  2025-12-27 08:23:07,712 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-27T08:23:07.715381131Z [err]  2025-12-27 08:23:07,712 - server - INFO - ‚úÖ Agent SILENT - User said 7 word(s): 'Wa it one second. Listen to me.' - Processing...
2025-12-27T08:23:07.727368504Z [err]  2025-12-27 08:23:07,722 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Wa it one second. Listen to me.
2025-12-27T08:23:07.727376139Z [err]  2025-12-27 08:23:07,722 - calling_service - INFO - üë§ User stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:07.727382117Z [err]  2025-12-27 08:23:07,722 - server - INFO - ‚è∏Ô∏è 'Hold on' phrase detected - using longer timeout
2025-12-27T08:23:07.727387016Z [err]  2025-12-27 08:23:07,723 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-27T08:23:07.727391698Z [err]  2025-12-27 08:23:07,723 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+21ms
2025-12-27T08:23:07.727401010Z [err]  2025-12-27 08:23:07,723 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 21ms (Soniox model: stt-rt-v3)
2025-12-27T08:23:07.727405516Z [err]  2025-12-27 08:23:07,723 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-27T08:23:07.727410551Z [err]  2025-12-27 08:23:07,723 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-27T08:23:07.727414978Z [err]  2025-12-27 08:23:07,723 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:07.824493142Z [err]  2025-12-27 08:23:07,817 - server - INFO - üìù Saved user transcript to database
2025-12-27T08:23:07.824498868Z [err]  2025-12-27 08:23:07,817 - persistent_tts_service - INFO - üîÑ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Interrupt flag reset - ready for new audio
2025-12-27T08:23:07.824503135Z [err]  2025-12-27 08:23:07,817 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2025-12-27T08:23:07.824507300Z [err]  2025-12-27 08:23:07,817 - calling_service - INFO - ‚è±Ô∏è [08:23:07.817] üì• process_user_input() ENTRY - text: 'Wa it one second. Listen to me....'
2025-12-27T08:23:07.824511303Z [err]  2025-12-27 08:23:07,822 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:07.824515000Z [err]  2025-12-27 08:23:07,822 - calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: User spoke while Silence Greeting was triggering
2025-12-27T08:23:08.272922579Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - ‚è±Ô∏è [08:23:08.177] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:23:08.272923480Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - Evaluating transitions from Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic for message: Wa it one second. Listen to me.
2025-12-27T08:23:08.272930734Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - ‚è±Ô∏è [08:23:08.177] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:23:08.272931035Z [err]  2025-12-27 08:23:08,166 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.272933661Z [err]  2025-12-27 08:23:08,184 - calling_service - INFO - ‚è±Ô∏è [08:23:08.184] üîÄ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-27T08:23:08.272939686Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - Flow processing - History length: 7, Is first: False
2025-12-27T08:23:08.272943054Z [err]  2025-12-27 08:23:08,166 - telnyx_service - ERROR - ‚ùå Error stopping audio playback: 'ActionsResource' object has no attribute 'playback_stop'
2025-12-27T08:23:08.272949504Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - üîç Using explicitly set current_node_id: 1763161849799
2025-12-27T08:23:08.272955686Z [err]  2025-12-27 08:23:08,166 - calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-27T08:23:08.272959211Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - ‚è±Ô∏è [08:23:08.177] üîÄ About to call _follow_transition() for: Wa it one second. Listen to me...
2025-12-27T08:23:08.272960640Z [err]  2025-12-27 08:23:08,171 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.272966018Z [err]  2025-12-27 08:23:08,166 - calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-27T08:23:08.272969503Z [err]  2025-12-27 08:23:08,176 - redis_service - INFO - üì¶ Stored call data in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (TTL: 3600s)
2025-12-27T08:23:08.272976096Z [err]  2025-12-27 08:23:08,166 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:08.272976199Z [err]  2025-12-27 08:23:08,176 - calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-27T08:23:08.272982479Z [err]  2025-12-27 08:23:08,177 - calling_service - INFO - ‚è±Ô∏è [08:23:08.176] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:23:08.481104778Z [err]  2025-12-27 08:23:08,472 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 1298 total packets
2025-12-27T08:23:08.481117576Z [err]  [2025-12-27 08:23:08 +0000] [5] [INFO] connection closed
2025-12-27T08:23:08.625907428Z [err]  2025-12-27 08:23:08,620 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:08.625914678Z [err]  2025-12-27 08:23:08,621 - calling_service - INFO - ‚è±Ô∏è [08:23:08.621] üîÄ TRANSITION EVALUATION COMPLETE - took 437ms
2025-12-27T08:23:08.625919755Z [err]  2025-12-27 08:23:08,621 - calling_service - INFO - ü§ñ AI transition decision: '1'
2025-12-27T08:23:08.625937126Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üìä Available transitions: ['Agrees|consents (yes|sure|okay|hear more|call cons...', 'Any objection or non compliance that isn\'t a "I do...', 'NO (flat out)|No recall (done quickly) AND no othe...', "I'm Busy, or requests to call back responses from ..."]
2025-12-27T08:23:08.625941316Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - Selected transition index: 1
2025-12-27T08:23:08.625945607Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - Transition: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic -> Node ID: N003B_DeframeInitialObjection_V7_GoalOriented
2025-12-27T08:23:08.625949708Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 444ms
2025-12-27T08:23:08.625953263Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - ‚è±Ô∏è [08:23:08.622] ‚úÖ Node selected, about to process content...
2025-12-27T08:23:08.625960825Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:23 AM EST in content
2025-12-27T08:23:08.625967157Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:23:08.625971654Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:23:08.625975642Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:23:08.626913440Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:23:08.626920108Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:23:08.626925121Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:23:08.626929068Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:23:08.626934660Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:23:08.626938878Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:23:08.626942723Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - Using flow node: Node ID: N003B_DeframeInitialObjection_V7_GoalOriented (type: conversation, mode: prompt)
2025-12-27T08:23:08.626946384Z [err]  2025-12-27 08:23:08,622 - calling_service - INFO - ‚è±Ô∏è [08:23:08.622] üìÑ About to process content (mode=prompt, length=5407)
2025-12-27T08:23:08.633362903Z [err]  2025-12-27 08:23:08,629 - calling_service - INFO - ‚ö° PARALLEL MODE: Running KB + analysis simultaneously
2025-12-27T08:23:08.633368219Z [err]  2025-12-27 08:23:08,631 - kb_router - INFO - üö¶ KB Router: SKIP (short message: 7 words)
2025-12-27T08:23:08.633372035Z [err]  2025-12-27 08:23:08,632 - calling_service - INFO - ‚ö° Skipping KB (reason: short_message)
2025-12-27T08:23:08.633400788Z [err]  2025-12-27 08:23:08,632 - calling_service - INFO - ‚ö° Parallel operations completed in 1ms
2025-12-27T08:23:08.633405117Z [err]  2025-12-27 08:23:08,632 - calling_service - INFO - üîç Node 'Node ID: N003B_DeframeInitialObjection_V7_GoalOriented': use_parallel_llm=True
2025-12-27T08:23:08.634863091Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - ‚ö° Parallel mode: Using condensed history (7/7 messages)
2025-12-27T08:23:08.634869333Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - ‚è±Ô∏è [08:23:08.634] üí¨ LLM REQUEST START: 7 conversation turns, 12902 system chars (KB cached)
2025-12-27T08:23:08.634875251Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LLM PROMPT BREAKDOWN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:08.634875635Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-27T08:23:08.634877287Z [err]  
2025-12-27T08:23:08.634882038Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù [SYSTEM MSG 1 - GLOBAL PROMPT] (6467 chars):
2025-12-27T08:23:08.634886197Z [err]  If user asks to repeat info, rephrase naturally‚Äînever exact repeat.
2025-12-27T08:23:08.634887121Z [err]  
2025-12-27T08:23:08.634889247Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-27T08:23:08.634894043Z [err]  
2025-12-27T08:23:08.634895490Z [err]  
2025-12-27T08:23:08.634896654Z [err]  If explaining ends in peri...
2025-12-27T08:23:08.634901124Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-27T08:23:08.634901750Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-27T08:23:08.634904470Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù [SYSTEM MSG 2 - DYNAMIC CONTEXT] (6435 chars):
2025-12-27T08:23:08.634907387Z [err]  
2025-12-27T08:23:08.634907675Z [err]  
2025-12-27T08:23:08.634913223Z [err]  If asked about call number: "Company number."
2025-12-27T08:23:08.634914905Z [err]  If user says a name, don't assume it's theirs‚Äîwait for explicit correction.
2025-12-27T08:23:08.634918718Z [err]  
2025-12-27T08:23:08.635976747Z [err]  # CURRENT CONTEXT
2025-12-27T08:23:08.635982137Z [err]  This context is provided to help you focus. You still need to:
2025-12-27T08:23:08.635983094Z [err]  Customer: Kendrick
2025-12-27T08:23:08.635989382Z [err]  Variables: {"now": "Saturday, December 27, 2025 at 3:23 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment"...
2025-12-27T08:23:08.635989785Z [err]  1. Generate a natural, contextual response
2025-12-27T08:23:08.635994540Z [err]  2. Evaluate transitions per your node instructions
2025-12-27T08:23:08.635998902Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù   Preview: 
2025-12-27T08:23:08.635999407Z [err]  
2025-12-27T08:23:08.636004389Z [err]  
2025-12-27T08:23:08.636005188Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-27T08:23:08.636010087Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-27T08:23:08.636011121Z [err]  
2025-12-27T08:23:08.636014552Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-27T08:23:08.636018591Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-27T08:23:08.636022680Z [err]  
2025-12-27T08:23:08.636026892Z [err]  USER COMMUNICATION STYLE: S type - adjust your response accordingly
2025-12-27T08:23:08.636030516Z [err]  CONVERSATION STATUS: Turn 4, objection handling phase
2025-12-27T08:23:08.636034085Z [err]  
2025-12-27T08:23:08.636598210Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù [CONVERSATION HISTORY] (7 messages)
2025-12-27T08:23:08.636602428Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù   assistant: Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stackin...
2025-12-27T08:23:08.636606123Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù   user: Wa it one second. Listen to me....
2025-12-27T08:23:08.636609647Z [err]  2025-12-27 08:23:08,634 - calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:08.642251786Z [err]  2025-12-27 08:23:08,639 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:08.642261854Z [err]  2025-12-27 08:23:08,639 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '44225d5f-07a8-4ab4-9136-5a7fc39d5382', 'occurred_at': '2025-12-27T08:23:08.403099Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '0e4315a6-640f-4417-8024-b271dba1008f', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:08.642268621Z [err]  2025-12-27 08:23:08,639 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.642274469Z [err]  2025-12-27 08:23:08,639 - server - INFO - üì® ================================================
2025-12-27T08:23:08.642280085Z [inf]  100.64.0.6:23342 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:08.654250544Z [err]  2025-12-27 08:23:08,650 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:08.654258651Z [err]  2025-12-27 08:23:08,650 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '984023eb-3c63-4be3-b3c6-befc226ffc40', 'occurred_at': '2025-12-27T08:23:08.359116Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:08.359116Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'Vf3AGnyqQA', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:08.654265195Z [err]  2025-12-27 08:23:08,650 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.654270924Z [err]  2025-12-27 08:23:08,650 - server - INFO - üì® ================================================
2025-12-27T08:23:08.667226819Z [err]  2025-12-27 08:23:08,666 - redis_service - INFO - ‚ûñ Removed playback Vf3AGnyqQA, 0 remaining for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.667232021Z [err]  2025-12-27 08:23:08,666 - server - INFO - üîä Redis: Removed playback Vf3AGnyqQA, 0 remaining
2025-12-27T08:23:08.667236578Z [err]  2025-12-27 08:23:08,666 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-27T08:23:08.672502530Z [err]  2025-12-27 08:23:08,671 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-27T08:23:08.672512667Z [inf]  100.64.0.4:35016 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:08.753555790Z [err]  2025-12-27 08:23:08,748 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:08.753562791Z [err]  2025-12-27 08:23:08,749 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '0e57bf57-4bfd-4832-8fb9-5eec85e6202b', 'occurred_at': '2025-12-27T08:23:08.219108Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '20.63', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '1361', 'skip_packet_count': '18'}, 'outbound': {'packet_count': '1298', 'skip_packet_count': '0'}}, 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:08.219108Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-27T08:22:35.339119Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:08.753569014Z [err]  2025-12-27 08:23:08,749 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.753573816Z [err]  2025-12-27 08:23:08,749 - server - INFO - üì® ================================================
2025-12-27T08:23:08.753577926Z [err]  2025-12-27 08:23:08,749 - server - INFO - üìû Call ended: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.753582086Z [err]  2025-12-27 08:23:08,749 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-27T08:23:08.850465323Z [err]  2025-12-27 08:23:08,818 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-27T08:23:08.850471104Z [err]  2025-12-27 08:23:08,818 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823788.8185215 for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.850476848Z [err]  2025-12-27 08:23:08,818 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:08.937478109Z [err]  2025-12-27 08:23:08,934 - server - INFO - üìù Updated call log: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:09.035020431Z [err]  2025-12-27 08:23:09,027 - server - INFO - ‚úÖ Finalized call log: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (duration=26s, status=completed)
2025-12-27T08:23:09.105264982Z [err]  2025-12-27 08:23:09,103 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:09.417483649Z [err]  2025-12-27 08:23:09,398 - calling_service - INFO - ‚è±Ô∏è [08:23:09.398] üí¨ LLM FIRST TOKEN: 764ms (grok grok-4-1-fast-non-reasoning)
2025-12-27T08:23:09.481799076Z [err]  2025-12-27 08:23:09,464 - server - INFO - üì§ Sentence arrived from LLM: [S] Sure,...
2025-12-27T08:23:09.481810275Z [err]  2025-12-27 08:23:09,464 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 1740ms
2025-12-27T08:23:09.481816622Z [err]  2025-12-27 08:23:09,464 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-27T08:23:09.481822405Z [err]  2025-12-27 08:23:09,464 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:23:09.481828878Z [err]  2025-12-27 08:23:09,464 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-27T08:23:09.481834590Z [err]  2025-12-27 08:23:09,464 - server - INFO - üéµ TTS task #1 started at +0ms
2025-12-27T08:23:09.481840175Z [err]  2025-12-27 08:23:09,464 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1741ms
2025-12-27T08:23:09.481845915Z [err]  2025-12-27 08:23:09,464 - calling_service - INFO - üì§ Streamed sentence: [S] Sure,...
2025-12-27T08:23:09.481853520Z [err]  2025-12-27 08:23:09,464 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #5: [S] Sure,...
2025-12-27T08:23:09.481859478Z [err]  2025-12-27 08:23:09,465 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #5 (NON-BLOCKING) in 0ms
2025-12-27T08:23:09.481863688Z [err]  2025-12-27 08:23:09,465 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-27T08:23:09.481867978Z [err]  2025-12-27 08:23:09,465 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #5: '[S] Sure,...'
2025-12-27T08:23:09.481871899Z [err]  2025-12-27 08:23:09,465 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=0ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:09.493484137Z [err]  2025-12-27 08:23:09,489 - server - INFO - üì§ Sentence arrived from LLM: I'm listening....
2025-12-27T08:23:09.493494260Z [err]  2025-12-27 08:23:09,489 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:23:09.493502985Z [err]  2025-12-27 08:23:09,489 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-27T08:23:09.493510124Z [err]  2025-12-27 08:23:09,489 - server - INFO - üéµ TTS task #2 started at +25ms
2025-12-27T08:23:09.493515653Z [err]  2025-12-27 08:23:09,489 - calling_service - INFO - üì§ Streamed sentence: I'm listening....
2025-12-27T08:23:09.493521042Z [err]  2025-12-27 08:23:09,490 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #6: I'm listening....
2025-12-27T08:23:09.493528159Z [err]  2025-12-27 08:23:09,490 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #6 (NON-BLOCKING) in 0ms
2025-12-27T08:23:09.493533683Z [err]  2025-12-27 08:23:09,490 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:23:09.534077661Z [err]  2025-12-27 08:23:09,516 - server - INFO - üì§ Sentence arrived from LLM: What's up?...
2025-12-27T08:23:09.534079988Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - Total latency: 1.70s
2025-12-27T08:23:09.534086985Z [err]  2025-12-27 08:23:09,516 - server - INFO - üîç Persistent TTS lookup: call_id=v3:C_Mbh_CopshQ6-AJD..., session=FOUND
2025-12-27T08:23:09.534089945Z [err]  2025-12-27 08:23:09,517 - server - INFO - ‚úÖ LLM finished in 1793ms, TTS tasks already running in background
2025-12-27T08:23:09.534094607Z [err]  2025-12-27 08:23:09,516 - server - INFO - üöÄ Streaming sentence #3 via persistent WebSocket
2025-12-27T08:23:09.534096950Z [err]  2025-12-27 08:23:09,517 - server - INFO - üéµ Streaming 3 TTS chunks as they complete...
2025-12-27T08:23:09.534100821Z [err]  2025-12-27 08:23:09,516 - server - INFO - üéµ TTS task #3 started at +51ms
2025-12-27T08:23:09.534106065Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - üì§ Streamed final fragment: What's up?...
2025-12-27T08:23:09.534111565Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - ‚è±Ô∏è [TIMING] LLM_TOTAL: 881ms for 35 chars (grok grok-4-1-fast-non-reasoning)
2025-12-27T08:23:09.534117079Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user gave meaningful response) for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:09.534123016Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - üîä Silence tracking reset for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw (user responded)
2025-12-27T08:23:09.534128783Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:23:09.534134073Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - üíæ Storing node ID 1763161961589 in conversation history
2025-12-27T08:23:09.534139351Z [err]  2025-12-27 08:23:09,516 - calling_service - INFO - LLM response (1.70s): [S] Sure, I'm listening. What's up?
2025-12-27T08:23:09.534800751Z [err]  2025-12-27 08:23:09,517 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-27T08:23:09.534807309Z [err]  2025-12-27 08:23:09,517 - server - INFO -    3 sentences queued and playing seamlessly
2025-12-27T08:23:09.534813224Z [err]  2025-12-27 08:23:09,518 - persistent_tts_service - INFO - üé§ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Streaming sentence #7: What's up?...
2025-12-27T08:23:09.534818791Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 1794ms from user stop üöÄ
2025-12-27T08:23:09.534819154Z [err]  2025-12-27 08:23:09,518 - persistent_tts_service - INFO - üöÄ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Sent sentence #7 (NON-BLOCKING) in 0ms
2025-12-27T08:23:09.534825458Z [err]  2025-12-27 08:23:09,518 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:23:09.534831073Z [err]  2025-12-27 08:23:09,518 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:09.534832208Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-27T08:23:09.534833366Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚úÖ All 3 persistent TTS streams completed
2025-12-27T08:23:09.534839208Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-27T08:23:09.534843411Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-27T08:23:09.534846146Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:09.535798947Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 21ms (provider: soniox, model: stt-rt-v3)
2025-12-27T08:23:09.535805955Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1793ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-27T08:23:09.535811689Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 54ms (provider: elevenlabs, websocket: False)
2025-12-27T08:23:09.535818317Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1795ms (user stopped ‚Üí play_audio_url called)
2025-12-27T08:23:09.535825187Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-27T08:23:09.535832157Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-27T08:23:09.535838096Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-27T08:23:09.535844656Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-27T08:23:09.535851928Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-27T08:23:09.535860445Z [err]  2025-12-27 08:23:09,518 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2095ms estimated
2025-12-27T08:23:09.535865503Z [err]  2025-12-27 08:23:09,519 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 35 chars, 3 sentences
2025-12-27T08:23:09.535869433Z [err]  2025-12-27 08:23:09,519 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Wa it one second. Listen to me....'
2025-12-27T08:23:09.535873470Z [err]  2025-12-27 08:23:09,519 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '[S] Sure, I'm listening. What's up?...'
2025-12-27T08:23:09.535878298Z [err]  2025-12-27 08:23:09,519 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-27T08:23:09.536646243Z [err]  2025-12-27 08:23:09,519 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:09.727389550Z [err]  2025-12-27 08:23:09,706 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node ID: N003B_DeframeInitialObjection_V7_GoalOriented, Dead Air: 1868ms)
2025-12-27T08:23:09.727393828Z [err]  2025-12-27 08:23:09,706 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-27T08:23:09.727398079Z [err]  2025-12-27 08:23:09,706 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-27T08:23:09.738848254Z [err]  2025-12-27 08:23:09,734 - server - INFO - üìä Auto-added call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-27T08:23:09.750875688Z [err]  2025-12-27 08:23:09,744 - persistent_tts_service - INFO - üì§ Sending 6316 bytes of audio (40 chunks, 0.8s duration) via WebSocket
2025-12-27T08:23:09.750881550Z [err]  2025-12-27 08:23:09,744 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:09.750885913Z [err]  2025-12-27 08:23:09,744 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2025-12-27T08:23:09.750893879Z [err]  2025-12-27 08:23:09,745 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-12-27T08:23:09.936005354Z [err]  2025-12-27 08:23:09,915 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:09.936011539Z [err]  2025-12-27 08:23:09,921 - redis_service - INFO - üì• Retrieved call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:09.936015767Z [err]  2025-12-27 08:23:09,921 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-27T08:23:09.936020869Z [err]  2025-12-27 08:23:09,921 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-27T08:23:09.936025975Z [err]  2025-12-27 08:23:09,927 - persistent_tts_service - INFO - üì§ Sending 7059 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2025-12-27T08:23:09.936029695Z [err]  2025-12-27 08:23:09,927 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:09.936033969Z [err]  2025-12-27 08:23:09,927 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.9s (total: 1.5s from now)
2025-12-27T08:23:09.936037912Z [err]  2025-12-27 08:23:09,927 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-12-27T08:23:10.015976848Z [err]  2025-12-27 08:23:10,012 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-27T08:23:10.105822766Z [err]  2025-12-27 08:23:10,095 - persistent_tts_service - INFO - üì§ Sending 6316 bytes of audio (40 chunks, 0.8s duration) via WebSocket
2025-12-27T08:23:10.105826892Z [err]  2025-12-27 08:23:10,095 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:10.105832872Z [err]  2025-12-27 08:23:10,095 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.8s (total: 2.1s from now)
2025-12-27T08:23:10.105836854Z [err]  2025-12-27 08:23:10,095 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-12-27T08:23:10.105840318Z [err]  2025-12-27 08:23:10,101 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-27T08:23:10.105844149Z [err]  2025-12-27 08:23:10,101 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-27T08:23:10.105847820Z [err]  2025-12-27 08:23:10,101 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-27T08:23:10.105852810Z [err]  2025-12-27 08:23:10,101 - server - INFO - üöÄ Triggered QC analysis for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.105856498Z [err]  2025-12-27 08:23:10,101 - server - INFO - üìä Triggered Campaign QC for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.105867350Z [err]  2025-12-27 08:23:10,102 - server - INFO - üìá Triggered CRM update for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.105871388Z [err]  2025-12-27 08:23:10,102 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.111395862Z [err]  2025-12-27 08:23:10,107 - redis_service - INFO - üßπ Deleted call data from Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.111402486Z [err]  2025-12-27 08:23:10,107 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.111406929Z [inf]  100.64.0.6:23350 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:10.111410865Z [err]  2025-12-27 08:23:10,107 - server - INFO - üîç Starting QC analysis for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.111415339Z [err]  2025-12-27 08:23:10,108 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-27T08:23:10.111419326Z [err]  2025-12-27 08:23:10,109 - server - INFO - üìá CRM update starting for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:10.111423477Z [err]  2025-12-27 08:23:10,109 - server - INFO - üìá Normalized phone: +17708336397
2025-12-27T08:23:10.301025864Z [err]  2025-12-27 08:23:10,199 - server - INFO - üìù Converted transcript from 7 messages to 502 characters
2025-12-27T08:23:10.301033670Z [err]  2025-12-27 08:23:10,286 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:10.351850852Z [err]  2025-12-27 08:23:10,349 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.9s left)
2025-12-27T08:23:10.373841764Z [err]  2025-12-27 08:23:10,363 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:10.373847178Z [err]  2025-12-27 08:23:10,363 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-27T08:23:10.379985645Z [err]  2025-12-27 08:23:10,378 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-27T08:23:10.467140896Z [err]  2025-12-27 08:23:10,465 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-27T08:23:10.467149816Z [err]  2025-12-27 08:23:10,466 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:10.467156760Z [err]  2025-12-27 08:23:10,466 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:10.559199778Z [err]  2025-12-27 08:23:10,555 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-27T08:23:10.644364560Z [err]  2025-12-27 08:23:10,642 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:10.690338138Z [err]  2025-12-27 08:23:10,686 - server - INFO - üìá CRM: Total variables collected: []
2025-12-27T08:23:10.702345810Z [err]  2025-12-27 08:23:10,697 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=7, logs_count=8, status=completed
2025-12-27T08:23:10.743408352Z [err]  2025-12-27 08:23:10,729 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:10.754672222Z [err]  2025-12-27 08:23:10,748 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:10.754677791Z [err]  2025-12-27 08:23:10,748 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-27T08:23:10.754682478Z [err]  2025-12-27 08:23:10,748 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-27T08:23:10.754686117Z [err]  2025-12-27 08:23:10,748 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-27T08:23:10.870358843Z [err]  2025-12-27 08:23:10,859 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.3s left)
2025-12-27T08:23:11.440287483Z [err]  2025-12-27 08:23:11,430 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-27T08:23:11.440292465Z [err]  2025-12-27 08:23:11,430 - telnyx_service - INFO - ‚úÖ Call initiated: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:11.440297091Z [err]  2025-12-27 08:23:11,432 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:11.440301332Z [err]  2025-12-27 08:23:11,432 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '1739cf19-2ecf-46e5-8e1a-19a8bde8da09', 'occurred_at': '2025-12-27T08:23:10.537279Z', 'payload': {'call_control_id': 'v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw', 'call_leg_id': '329e9aee-e2fd-11f0-8c49-02420aef96a0', 'call_session_id': '329ac3f6-e2fd-11f0-aeab-02420aef96a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:08.376741Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-27T08:23:08.376741Z', 'recording_id': 'b847858b-2dcd-4e81-830b-30a6a004c470', 'recording_started_at': '2025-12-27T08:22:43.769204Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-27/329e9aee-e2fd-11f0-8c49-02420aef96a0-1766823763702002.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251227%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251227T082310Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=9dc7a76cc4bdebeeb54d4ba4ff3f3a5a0a00a95f728d05ed79b63c3a0441cc3b'}, 'start_time': '2025-12-27T08:22:43.769204Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:11.440305546Z [err]  2025-12-27 08:23:11,432 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:11.440310783Z [err]  2025-12-27 08:23:11,432 - server - INFO - üì® ================================================
2025-12-27T08:23:11.441034107Z [err]  2025-12-27 08:23:11,432 - server - INFO - üéôÔ∏è Recording saved for call: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:11.441038124Z [err]  2025-12-27 08:23:11,437 - redis_service - WARNING - ‚ö†Ô∏è Call data not found in Redis: v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:11.441042078Z [err]  2025-12-27 08:23:11,437 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=b847858b-2dcd-4e81-830b-30a6a004c470, call_data=False
2025-12-27T08:23:11.441045553Z [err]  2025-12-27 08:23:11,437 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-27T08:23:11.523194419Z [err]  2025-12-27 08:23:11,519 - server - INFO - üìù Created call log: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:11.523206556Z [err]  2025-12-27 08:23:11,520 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:23:11.523212867Z [err]  2025-12-27 08:23:11,520 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-27T08:23:11.523772437Z [err]  2025-12-27 08:23:11,520 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:23:11.523780307Z [err]  2025-12-27 08:23:11,520 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:11.546629117Z [err]  2025-12-27 08:23:11,546 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (TTL: 3600s)
2025-12-27T08:23:11.546634680Z [err]  2025-12-27 08:23:11,546 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-27T08:23:11.546640961Z [err]  2025-12-27 08:23:11,546 - server - INFO - üìû Outbound call initiated: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:11.547607750Z [inf]  100.64.0.2:45394 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-27T08:23:11.558209082Z [err]  2025-12-27 08:23:11,555 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-27T08:23:11.558218308Z [err]  2025-12-27 08:23:11,555 - server - INFO - üíæ Saved recording URL and ID to database: b847858b-2dcd-4e81-830b-30a6a004c470
2025-12-27T08:23:11.558225554Z [err]  2025-12-27 08:23:11,555 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-27T08:23:11.558231951Z [err]  2025-12-27 08:23:11,555 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-27T08:23:11.650108833Z [err]  2025-12-27 08:23:11,632 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:11.650114659Z [err]  2025-12-27 08:23:11,632 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '5fbbe402-7200-437e-b8e9-907201bb9df8', 'occurred_at': '2025-12-27T08:23:11.319110Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:11.650120773Z [err]  2025-12-27 08:23:11,632 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:11.650126814Z [err]  2025-12-27 08:23:11,632 - server - INFO - üì® ================================================
2025-12-27T08:23:11.650131977Z [err]  2025-12-27 08:23:11,632 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-27T08:23:11.650137320Z [inf]  100.64.0.8:35320 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:11.767117414Z [err]  2025-12-27 08:23:11,751 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-27T08:23:11.767126047Z [err]  2025-12-27 08:23:11,751 - server - INFO -    Client: Address(host='100.64.0.9', port=51548)
2025-12-27T08:23:11.767132684Z [err]  2025-12-27 08:23:11,751 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '0nvLM6eXWuireeWSozutQg==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': '5-Kdl0_TRiqlvlRh-_9nXA', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766823791520', 'accept-encoding': 'gzip'}
2025-12-27T08:23:11.767136899Z [err]  2025-12-27 08:23:11,751 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-27T08:23:11.767141156Z [err]  2025-12-27 08:23:11,751 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-27T08:23:11.767145554Z [err]  [2025-12-27 08:23:11 +0000] [4] [INFO] ('100.64.0.9', 51548) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-27T08:23:11.767150407Z [err]  2025-12-27 08:23:11,751 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-27T08:23:11.767155358Z [err]  [2025-12-27 08:23:11 +0000] [4] [INFO] connection open
2025-12-27T08:23:11.864766574Z [err]  2025-12-27 08:23:11,857 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-27/329e9aee-e2fd-11f0-8c49-02420aef96a0-1766823763702002.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251227%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251227T082310Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=9dc7a76cc4bdebeeb54d4ba4ff3f3a5a0a00a95f728d05ed79b63c3a0441cc3b "HTTP/1.1 200 OK"
2025-12-27T08:23:11.940193505Z [err]  2025-12-27 08:23:11,910 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-27T08:23:11.940200361Z [err]  2025-12-27 08:23:11,910 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-27T08:23:12.009230880Z [err]  2025-12-27 08:23:11,994 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-27T08:23:12.009242219Z [err]  2025-12-27 08:23:11,994 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-27T08:23:12.009250093Z [err]    File "/app/backend/server.py", line 9758, in trigger_campaign_qc_for_call
2025-12-27T08:23:12.009256782Z [err]      await run_full_qc_analysis(
2025-12-27T08:23:12.009264225Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:12.009272856Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-27T08:23:12.009280565Z [err]  
2025-12-27T08:23:12.009287375Z [err]  2025-12-27 08:23:11,997 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:12.009294485Z [err]  2025-12-27 08:23:11,997 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-27T08:23:12.009301480Z [err]  2025-12-27 08:23:11,994 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-27T08:23:12.009308462Z [err]  2025-12-27 08:23:11,994 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-27T08:23:12.048225716Z [err]  2025-12-27 08:23:12,031 - server - INFO - ‚úÖ Downloaded 98472 bytes
2025-12-27T08:23:12.122649207Z [err]  2025-12-27 08:23:12,094 - persistent_tts_service - INFO - ‚úÖ [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver finished sentence #5: 3 chunks in 2629ms
2025-12-27T08:23:12.122657566Z [err]  2025-12-27 08:23:12,094 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #6: 'I'm listening....'
2025-12-27T08:23:12.122663580Z [err]  2025-12-27 08:23:12,094 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=2604ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-27T08:23:12.122712371Z [err]  2025-12-27 08:23:12,094 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-27T08:23:12.287130139Z [inf]  100.64.0.4:35016 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:12.287184001Z [err]  2025-12-27 08:23:12,200 - server - INFO - ‚úÖ Split into 2 channels
2025-12-27T08:23:12.287191885Z [err]  2025-12-27 08:23:12,201 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-27T08:23:12.287197903Z [err]  2025-12-27 08:23:12,201 - server - INFO - üìä Channel 0: 538604 bytes
2025-12-27T08:23:12.287203206Z [err]  2025-12-27 08:23:12,201 - server - ERROR - ‚ùå No Soniox API key available
2025-12-27T08:23:12.287208617Z [err]  2025-12-27 08:23:12,201 - server - INFO - ‚ùå Channel 0: No speech
2025-12-27T08:23:12.287214075Z [err]  2025-12-27 08:23:12,201 - server - INFO - üìä Channel 1: 538604 bytes
2025-12-27T08:23:12.287220580Z [err]  2025-12-27 08:23:12,201 - server - ERROR - ‚ùå No Soniox API key available
2025-12-27T08:23:12.287226361Z [err]  2025-12-27 08:23:12,201 - server - INFO - ‚ùå Channel 1: No speech
2025-12-27T08:23:12.287232230Z [err]  2025-12-27 08:23:12,201 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-27T08:23:12.394409491Z [err]  2025-12-27 08:23:12,388 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.2s ago), marking agent as done speaking
2025-12-27T08:23:12.394415293Z [err]  2025-12-27 08:23:12,388 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823792.3887436 for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:12.394419282Z [err]  2025-12-27 08:23:12,388 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:14.472464414Z [err]  2025-12-27 08:23:14,469 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:14.472469661Z [err]  2025-12-27 08:23:14,471 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-27T08:23:14.473813436Z [err]  2025-12-27 08:23:14,473 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:14.500479473Z [err]  2025-12-27 08:23:14,491 - server - INFO - üì¨ Received Telnyx event: start
2025-12-27T08:23:14.500484423Z [err]  2025-12-27 08:23:14,491 - server - INFO - üé¨ Stream started for call: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:14.527658395Z [err]  2025-12-27 08:23:14,517 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:14.527665862Z [err]  2025-12-27 08:23:14,518 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-27T08:23:14.527671435Z [err]  2025-12-27 08:23:14,518 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-27T08:23:14.596699512Z [err]  2025-12-27 08:23:14,594 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:23:14.596706361Z [err]  2025-12-27 08:23:14,594 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver got 0 chunks for sentence #6! interrupted=False
2025-12-27T08:23:14.596712899Z [err]  2025-12-27 08:23:14,594 - persistent_tts_service - INFO - üéß [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver processing sentence #7: 'What's up?...'
2025-12-27T08:23:14.596720401Z [err]  2025-12-27 08:23:14,594 - persistent_tts_service - INFO - üìä [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] DIAGNOSTIC: queue_latency=5076ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:14.657040996Z [err]  2025-12-27 08:23:14,652 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:14.657046100Z [err]  2025-12-27 08:23:14,652 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'd337eab0-41db-4b33-89ca-8524eed4d3bc', 'occurred_at': '2025-12-27T08:23:14.359111Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-27T08:23:11.299116Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:14.657050227Z [err]  2025-12-27 08:23:14,652 - server - INFO - üéØ Event type: call.answered, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:14.657055695Z [err]  2025-12-27 08:23:14,652 - server - INFO - üì® ================================================
2025-12-27T08:23:14.657060220Z [err]  2025-12-27 08:23:14,652 - server - INFO - ‚úÖ Call answered: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:14.668114716Z [err]  2025-12-27 08:23:14,663 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:14.668123201Z [err]  2025-12-27 08:23:14,666 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-27T08:23:14.668131479Z [err]  2025-12-27 08:23:14,666 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-27T08:23:14.766107542Z [err]  2025-12-27 08:23:14,760 - server - INFO - ‚úÖ Call log updated
2025-12-27T08:23:14.766113356Z [err]  2025-12-27 08:23:14,760 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:23:14.766119784Z [err]  2025-12-27 08:23:14,760 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:14.766123862Z [err]  2025-12-27 08:23:14,760 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:14.783569528Z [err]  2025-12-27 08:23:14,781 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:14.783577205Z [err]  2025-12-27 08:23:14,781 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'a7bb82ce-3c67-4e84-8498-62dd93ee324d', 'occurred_at': '2025-12-27T08:23:14.659109Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '0e3ea073-b8b6-456f-b6a0-0db05583f867', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:14.783582865Z [err]  2025-12-27 08:23:14,781 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:14.783588324Z [err]  2025-12-27 08:23:14,781 - server - INFO - üì® ================================================
2025-12-27T08:23:14.783593919Z [inf]  100.64.0.4:35016 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:14.849764523Z [err]  2025-12-27 08:23:14,848 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:14.932462896Z [err]  2025-12-27 08:23:14,931 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:14.933198671Z [err]  2025-12-27 08:23:14,932 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-27T08:23:14.938278779Z [err]  2025-12-27 08:23:14,935 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:14.938285453Z [err]  2025-12-27 08:23:14,935 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-27T08:23:14.964226809Z [err]  2025-12-27 08:23:14,955 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:15.026574720Z [err]  2025-12-27 08:23:15,018 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-27T08:23:15.026582811Z [err]  2025-12-27 08:23:15,018 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-27T08:23:15.031336890Z [err]  2025-12-27 08:23:15,030 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.032072375Z [err]  2025-12-27 08:23:15,031 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:15.032079695Z [err]  2025-12-27 08:23:15,031 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-27T08:23:15.130271597Z [err]  2025-12-27 08:23:15,119 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-27T08:23:15.130277485Z [err]  2025-12-27 08:23:15,119 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-27T08:23:15.131914028Z [err]  2025-12-27 08:23:15,131 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-27T08:23:15.131920156Z [err]  2025-12-27 08:23:15,131 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-27T08:23:15.132610610Z [err]  2025-12-27 08:23:15,131 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-27T08:23:15.310309288Z [err]  2025-12-27 08:23:15,220 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA/actions/playback_start "HTTP/1.1 200 OK"
2025-12-27T08:23:15.310316682Z [err]  2025-12-27 08:23:15,220 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: d020-i308A (loop=True, overlay=True)
2025-12-27T08:23:15.310322126Z [err]  2025-12-27 08:23:15,220 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'
2025-12-27T08:23:15.310327879Z [err]  2025-12-27 08:23:15,221 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.595536891Z [err]  2025-12-27 08:23:15,593 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA/actions/record_start "HTTP/1.1 200 OK"
2025-12-27T08:23:15.596423368Z [err]  2025-12-27 08:23:15,595 - server - INFO - üéôÔ∏è Call recording started for v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.596429153Z [err]  2025-12-27 08:23:15,595 - server - INFO - üîß Creating call session for v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA...
2025-12-27T08:23:15.596433309Z [err]  2025-12-27 08:23:15,595 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:15.596437330Z [err]  2025-12-27 08:23:15,595 - server - INFO - üîß Calling create_call_session() - START
2025-12-27T08:23:15.596441777Z [err]  2025-12-27 08:23:15,595 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-27T08:23:15.597163302Z [err]  2025-12-27 08:23:15,596 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:15.597168182Z [err]  2025-12-27 08:23:15,596 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '1bf1ec12-f423-424b-9c48-4758a46c41a7', 'occurred_at': '2025-12-27T08:23:15.199110Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'd020-i308A', 'start_time': '2025-12-27T08:23:15.199110Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:15.597171857Z [err]  2025-12-27 08:23:15,596 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.597175612Z [err]  2025-12-27 08:23:15,596 - server - INFO - üì® ================================================
2025-12-27T08:23:15.597179327Z [inf]  100.64.0.4:35016 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:15.597953443Z [err]  2025-12-27 08:23:15,596 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:15.609148105Z [err]  2025-12-27 08:23:15,604 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 472ms
2025-12-27T08:23:15.609158526Z [err]  2025-12-27 08:23:15,604 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-27T08:23:15.609167074Z [err]  2025-12-27 08:23:15,604 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-27T08:23:15.609174043Z [err]  2025-12-27 08:23:15,604 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-27T08:23:15.609180762Z [err]  2025-12-27 08:23:15,604 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-27T08:23:15.609187271Z [err]  2025-12-27 08:23:15,604 - server - INFO - ‚úÖ Initialized call_states for v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA with session reference
2025-12-27T08:23:15.609191947Z [err]  2025-12-27 08:23:15,604 - server - INFO - ‚úÖ Stored Telnyx WebSocket in call_data for audio streaming
2025-12-27T08:23:15.609197544Z [err]  2025-12-27 08:23:15,604 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found to update for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.609201497Z [err]  2025-12-27 08:23:15,605 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-27T08:23:15.689247262Z [err]  2025-12-27 08:23:15,683 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-27T08:23:15.689252137Z [err]  2025-12-27 08:23:15,683 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-27T08:23:15.689256515Z [err]  2025-12-27 08:23:15,683 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-27T08:23:15.689260739Z [err]  2025-12-27 08:23:15,683 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-27T08:23:15.689265160Z [err]  2025-12-27 08:23:15,683 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-27T08:23:15.700250341Z [err]  2025-12-27 08:23:15,693 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-27T08:23:15.773056551Z [err]  2025-12-27 08:23:15,770 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:15.784271609Z [err]  2025-12-27 08:23:15,778 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 94ms
2025-12-27T08:23:15.784281354Z [err]  2025-12-27 08:23:15,778 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-27T08:23:15.784285628Z [err]  2025-12-27 08:23:15,778 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-27T08:23:15.805663996Z [err]  2025-12-27 08:23:15,804 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (TTL: 3600s)
2025-12-27T08:23:15.805671535Z [err]  2025-12-27 08:23:15,804 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-27T08:23:15.805676602Z [err]  2025-12-27 08:23:15,804 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-27T08:23:15.811136020Z [err]  2025-12-27 08:23:15,809 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.811145010Z [err]  2025-12-27 08:23:15,809 - server - INFO - ü§ñ AI session created for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.811149668Z [err]  2025-12-27 08:23:15,809 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-27T08:23:15.811154728Z [err]  2025-12-27 08:23:15,809 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-27T08:23:15.811159244Z [err]  2025-12-27 08:23:15,809 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-27T08:23:15.811163732Z [err]  2025-12-27 08:23:15,809 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-27T08:23:15.811167920Z [err]  2025-12-27 08:23:15,809 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-27T08:23:15.811172371Z [err]  2025-12-27 08:23:15,809 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-27T08:23:15.811176788Z [err]  2025-12-27 08:23:15,809 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-27T08:23:15.832285455Z [err]  2025-12-27 08:23:15,825 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:15.832291104Z [err]  2025-12-27 08:23:15,826 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-27T08:23:15.832295482Z [err]  2025-12-27 08:23:15,826 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-27T08:23:15.832299484Z [inf]  100.64.0.6:23364 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:16.307512236Z [err]  2025-12-27 08:23:16,253 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-27T08:23:16.307525849Z [err]  2025-12-27 08:23:16,228 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-27T08:23:16.307527650Z [err]  2025-12-27 08:23:16,248 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:16.307533599Z [err]  2025-12-27 08:23:16,253 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:16.307535029Z [err]  2025-12-27 08:23:16,228 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-27T08:23:16.307542298Z [err]  2025-12-27 08:23:16,247 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:16.307543468Z [err]  2025-12-27 08:23:16,228 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-27T08:23:16.694777154Z [err]  2025-12-27 08:23:16,648 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:16.694787077Z [err]  2025-12-27 08:23:16,652 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-27T08:23:16.694794115Z [err]  2025-12-27 08:23:16,653 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:16.779356567Z [err]  2025-12-27 08:23:16,759 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.120686081Z [err]  2025-12-27 08:23:17,094 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:23:17.120695779Z [err]  2025-12-27 08:23:17,094 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw] Receiver got 0 chunks for sentence #7! interrupted=False
2025-12-27T08:23:17.327924913Z [err]  2025-12-27 08:23:17,183 - server - INFO - üî§ RAW TOKENS: ["H"?]
2025-12-27T08:23:17.327935306Z [err]  2025-12-27 08:23:17,187 - calling_service - INFO - üîä Silence timer reset for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (user started speaking)
2025-12-27T08:23:17.327953481Z [err]  2025-12-27 08:23:17,187 - calling_service - INFO - üë§ User started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.327965083Z [err]  2025-12-27 08:23:17,187 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-27T08:23:17.327970046Z [err]  2025-12-27 08:23:17,320 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2025-12-27T08:23:17.327970089Z [err]  2025-12-27 08:23:17,320 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2025-12-27T08:23:17.327973076Z [err]  2025-12-27 08:23:17,187 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2025-12-27T08:23:17.327978014Z [err]  2025-12-27 08:23:17,320 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2025-12-27T08:23:17.327979815Z [err]  2025-12-27 08:23:17,265 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.327984317Z [err]  2025-12-27 08:23:17,275 - server - INFO - üî§ RAW TOKENS: ["H"?, "ello"?]
2025-12-27T08:23:17.327989644Z [err]  2025-12-27 08:23:17,275 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hello' | Generating: False
2025-12-27T08:23:17.327994696Z [err]  2025-12-27 08:23:17,320 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-27T08:23:17.328004326Z [err]  2025-12-27 08:23:17,320 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2025-12-27T08:23:17.328015213Z [err]  2025-12-27 08:23:17,321 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.328317025Z [err]  2025-12-27 08:23:17,321 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-27T08:23:17.328323887Z [err]  2025-12-27 08:23:17,321 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.328330391Z [err]  2025-12-27 08:23:17,321 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-27T08:23:17.328336945Z [err]  2025-12-27 08:23:17,321 - server - INFO - ‚è±Ô∏è [08:23:17.321] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2025-12-27T08:23:17.328344293Z [err]  2025-12-27 08:23:17,321 - server - INFO - ‚è±Ô∏è [08:23:17.321] STT endpoint detection latency: 13ms
2025-12-27T08:23:17.329063280Z [err]  2025-12-27 08:23:17,321 - server - INFO - ‚è±Ô∏è [08:23:17.321] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-27T08:23:17.329071590Z [err]  2025-12-27 08:23:17,326 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (TTL: 3600s)
2025-12-27T08:23:17.329078179Z [err]  2025-12-27 08:23:17,326 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-27T08:23:17.329084386Z [err]  2025-12-27 08:23:17,326 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.329091404Z [err]  2025-12-27 08:23:17,326 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2025-12-27T08:23:17.339908677Z [err]  2025-12-27 08:23:17,337 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2025-12-27T08:23:17.339916469Z [err]  2025-12-27 08:23:17,337 - calling_service - INFO - üë§ User stopped speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.339922462Z [err]  2025-12-27 08:23:17,337 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-27T08:23:17.339927297Z [err]  2025-12-27 08:23:17,337 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2025-12-27T08:23:17.339931325Z [err]  2025-12-27 08:23:17,337 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2025-12-27T08:23:17.339935461Z [err]  2025-12-27 08:23:17,337 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-27T08:23:17.339939902Z [err]  2025-12-27 08:23:17,337 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-27T08:23:17.339943731Z [err]  2025-12-27 08:23:17,337 - calling_service - INFO - ü§ñ Agent started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.458384169Z [err]  2025-12-27 08:23:17,430 - server - INFO - üìù Saved user transcript to database
2025-12-27T08:23:17.458388525Z [err]  2025-12-27 08:23:17,431 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.458394798Z [err]  2025-12-27 08:23:17,431 - calling_service - INFO - ‚è±Ô∏è [08:23:17.431] üì• process_user_input() ENTRY - text: 'Hello?...'
2025-12-27T08:23:17.458399158Z [err]  2025-12-27 08:23:17,436 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.458405118Z [err]  2025-12-27 08:23:17,436 - calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: User spoke while Silence Greeting was triggering
2025-12-27T08:23:17.458409657Z [err]  2025-12-27 08:23:17,456 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:17.458414604Z [err]  2025-12-27 08:23:17,456 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.458418682Z [err]  2025-12-27 08:23:17,457 - telnyx_service - ERROR - ‚ùå Error stopping audio playback: 'ActionsResource' object has no attribute 'playback_stop'
2025-12-27T08:23:17.458422544Z [err]  2025-12-27 08:23:17,457 - calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-27T08:23:17.458426926Z [err]  2025-12-27 08:23:17,457 - calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-27T08:23:17.463127895Z [err]  2025-12-27 08:23:17,462 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.474206828Z [err]  2025-12-27 08:23:17,467 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (TTL: 3600s)
2025-12-27T08:23:17.474213162Z [err]  2025-12-27 08:23:17,467 - calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-27T08:23:17.474218539Z [err]  2025-12-27 08:23:17,467 - calling_service - INFO - ‚è±Ô∏è [08:23:17.467] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:23:17.474222273Z [err]  2025-12-27 08:23:17,467 - calling_service - INFO - ‚è±Ô∏è [08:23:17.467] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:23:17.474225997Z [err]  2025-12-27 08:23:17,467 - calling_service - INFO - ‚è±Ô∏è [08:23:17.467] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:23:17.474230228Z [err]  2025-12-27 08:23:17,467 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-27T08:23:17.474234145Z [err]  2025-12-27 08:23:17,467 - calling_service - INFO - ‚è±Ô∏è [08:23:17.467] ‚úÖ Node selected, about to process content...
2025-12-27T08:23:17.474238358Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:23 AM EST in content
2025-12-27T08:23:17.474242488Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:23:17.474246240Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:23:17.474250181Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:23:17.474254161Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:23:17.474258425Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:23:17.474871651Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:23:17.474878479Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:23:17.474882116Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:23:17.474885605Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:23:17.474889073Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-27T08:23:17.474892673Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-27T08:23:17.474897029Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-27T08:23:17.474901450Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - ‚è±Ô∏è [08:23:17.468] üìÑ About to process content (mode=script, length=9)
2025-12-27T08:23:17.474905751Z [err]  2025-12-27 08:23:17,468 - calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2025-12-27T08:23:17.474909379Z [err]  2025-12-27 08:23:17,468 - server - INFO - üì§ Sentence arrived from LLM: Kendrick?...
2025-12-27T08:23:17.474913575Z [err]  2025-12-27 08:23:17,468 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 130ms
2025-12-27T08:23:17.474917520Z [err]  2025-12-27 08:23:17,468 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-27T08:23:17.474921055Z [err]  2025-12-27 08:23:17,468 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.474924722Z [err]  2025-12-27 08:23:17,468 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-27T08:23:17.557587017Z [err]  2025-12-27 08:23:17,556 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:17.612931489Z [err]  2025-12-27 08:23:17,610 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.612938576Z [err]  2025-12-27 08:23:17,611 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout: User already spoke, skipping greeting
2025-12-27T08:23:17.656290936Z [err]  2025-12-27 08:23:17,643 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:17.734650982Z [err]  2025-12-27 08:23:17,731 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:17.756406678Z [err]  2025-12-27 08:23:17,751 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:17.756411120Z [err]  2025-12-27 08:23:17,751 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-27T08:23:17.756416874Z [err]  2025-12-27 08:23:17,751 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-27T08:23:17.756421576Z [err]  2025-12-27 08:23:17,751 - persistent_tts_service - INFO - üîå [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Establishing persistent TTS WebSocket...
2025-12-27T08:23:17.756426253Z [err]  2025-12-27 08:23:17,751 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-27T08:23:17.756430422Z [err]  2025-12-27 08:23:17,751 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-27T08:23:17.756435144Z [err]  2025-12-27 08:23:17,751 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-27T08:23:17.778203447Z [err]  2025-12-27 08:23:17,775 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.778208274Z [err]  2025-12-27 08:23:17,775 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vvYNT6U9Xv9siuf44... (active sessions: [])
2025-12-27T08:23:17.840439288Z [err]  2025-12-27 08:23:17,823 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:17.840444487Z [err]  2025-12-27 08:23:17,823 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'c436d5a4-3e58-4664-a198-aadaaa0418a5', 'occurred_at': '2025-12-27T08:23:17.699116Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:17.840449477Z [err]  2025-12-27 08:23:17,823 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.840455042Z [err]  2025-12-27 08:23:17,823 - server - INFO - üì® ================================================
2025-12-27T08:23:17.840460920Z [inf]  100.64.0.6:23364 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:17.877087944Z [err]  2025-12-27 08:23:17,876 - calling_service - INFO - üì§ Streamed script sentence 1/1: Kendrick?...
2025-12-27T08:23:17.877097285Z [err]  2025-12-27 08:23:17,876 - calling_service - INFO - üîä Silence tracking reset for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (user responded)
2025-12-27T08:23:17.877098981Z [err]  2025-12-27 08:23:17,875 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-27T08:23:17.877104116Z [err]  2025-12-27 08:23:17,875 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-27T08:23:17.877108902Z [err]  2025-12-27 08:23:17,875 - persistent_tts_service - INFO - ‚úÖ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Persistent TTS WebSocket established
2025-12-27T08:23:17.877113196Z [err]  2025-12-27 08:23:17,875 - persistent_tts_service - INFO - üéß [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Audio receiver loop started
2025-12-27T08:23:17.877117743Z [err]  2025-12-27 08:23:17,875 - persistent_tts_service - INFO - üîä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Comfort noise loop started
2025-12-27T08:23:17.877122185Z [err]  2025-12-27 08:23:17,875 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.877126475Z [err]  2025-12-27 08:23:17,875 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-27T08:23:17.877130976Z [err]  2025-12-27 08:23:17,875 - server - INFO - üîç Persistent TTS lookup: call_id=v3:vvYNT6U9Xv9siuf44..., session=FOUND
2025-12-27T08:23:17.877135140Z [err]  2025-12-27 08:23:17,875 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-27T08:23:17.877139414Z [err]  2025-12-27 08:23:17,875 - server - INFO - üéµ TTS task #1 started at +407ms
2025-12-27T08:23:17.877142981Z [err]  2025-12-27 08:23:17,876 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 538ms
2025-12-27T08:23:17.877743784Z [err]  2025-12-27 08:23:17,876 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:23:17.877753222Z [err]  2025-12-27 08:23:17,876 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-27T08:23:17.877760423Z [err]  2025-12-27 08:23:17,876 - calling_service - INFO - LLM response (0.45s): Kendrick?
2025-12-27T08:23:17.877766175Z [err]  2025-12-27 08:23:17,876 - calling_service - INFO - Total latency: 0.45s
2025-12-27T08:23:17.877770679Z [err]  2025-12-27 08:23:17,876 - server - INFO - ‚úÖ LLM finished in 538ms, TTS tasks already running in background
2025-12-27T08:23:17.877775419Z [err]  2025-12-27 08:23:17,877 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2025-12-27T08:23:17.877780032Z [err]  2025-12-27 08:23:17,877 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-27T08:23:17.877784318Z [err]  2025-12-27 08:23:17,877 - server - INFO -    1 sentences queued and playing seamlessly
2025-12-27T08:23:17.878420479Z [err]  2025-12-27 08:23:17,877 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2025-12-27T08:23:17.878426618Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üéµ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Playback consumer started
2025-12-27T08:23:17.878434550Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üéß [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Audio Receiver Loop STARTED
2025-12-27T08:23:17.878440829Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üíì [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Starting TTS keep-alive loop (every 15s)
2025-12-27T08:23:17.878451771Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üîä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Starting comfort noise loop
2025-12-27T08:23:17.878457641Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üé§ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Streaming sentence #1: Kendrick?...
2025-12-27T08:23:17.878463669Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üöÄ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-27T08:23:17.878468976Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üìä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-27T08:23:17.878474566Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üéß [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Receiver processing sentence #1: 'Kendrick?...'
2025-12-27T08:23:17.878480072Z [err]  2025-12-27 08:23:17,877 - persistent_tts_service - INFO - üìä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] DIAGNOSTIC: queue_latency=0ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:17.879271764Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 409ms (provider: elevenlabs, websocket: False)
2025-12-27T08:23:17.879278382Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 540ms (user stopped ‚Üí play_audio_url called)
2025-12-27T08:23:17.879278473Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-27T08:23:17.879284351Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-27T08:23:17.879287443Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 540ms from user stop üöÄ
2025-12-27T08:23:17.879294026Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-27T08:23:17.879294115Z [err]  2025-12-27 08:23:17,878 - calling_service - INFO - ü§ñ Agent started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:17.879299696Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-27T08:23:17.879304689Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-27T08:23:17.879305433Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:17.879311132Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-27T08:23:17.879315157Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2025-12-27T08:23:17.879319446Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 538ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-27T08:23:17.879891716Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-27T08:23:17.879897070Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-27T08:23:17.879901400Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 840ms estimated
2025-12-27T08:23:17.879905373Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2025-12-27T08:23:17.879909414Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2025-12-27T08:23:17.879914174Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Kendrick?...'
2025-12-27T08:23:17.879917969Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-27T08:23:17.879921636Z [err]  2025-12-27 08:23:17,878 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:18.065668169Z [err]  2025-12-27 08:23:18,064 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 957ms)
2025-12-27T08:23:18.065677498Z [err]  2025-12-27 08:23:18,065 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-27T08:23:18.065684573Z [err]  2025-12-27 08:23:18,065 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-27T08:23:18.117629718Z [err]  2025-12-27 08:23:18,115 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 238ms
2025-12-27T08:23:18.117639960Z [err]  2025-12-27 08:23:18,116 - persistent_tts_service - INFO - üì§ Sending 7043 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2025-12-27T08:23:18.117645282Z [err]  2025-12-27 08:23:18,116 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:18.117649640Z [err]  2025-12-27 08:23:18,116 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2025-12-27T08:23:18.117653725Z [err]  2025-12-27 08:23:18,116 - persistent_tts_service - INFO - ‚úÖ Sent 45 audio chunks via WebSocket
2025-12-27T08:23:19.118308582Z [err]  2025-12-27 08:23:19,117 - persistent_tts_service - INFO - üîá [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] FLOOR RELEASED (is_holding_floor=False)
2025-12-27T08:23:19.334967305Z [err]  2025-12-27 08:23:19,306 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.3s ago), marking agent as done speaking
2025-12-27T08:23:19.334973617Z [err]  2025-12-27 08:23:19,306 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823799.306667 for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:19.334980107Z [err]  2025-12-27 08:23:19,306 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:19.472841373Z [err]  2025-12-27 08:23:19,471 - server - INFO - ‚è±Ô∏è [08:23:19.471] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-27T08:23:19.472848377Z [err]  2025-12-27 08:23:19,466 - calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-27T08:23:19.472852291Z [err]  2025-12-27 08:23:19,471 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-27T08:23:19.472858508Z [err]  2025-12-27 08:23:19,471 - calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-27T08:23:19.472860848Z [err]  2025-12-27 08:23:19,471 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-27T08:23:19.472865340Z [err]  2025-12-27 08:23:19,471 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2025-12-27T08:23:19.472870741Z [err]  2025-12-27 08:23:19,471 - calling_service - INFO - ü§ñ Agent started speaking for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:19.472876106Z [err]  2025-12-27 08:23:19,471 - telnyx_service - INFO - üîä Speaking text on call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: Are you still there?...
2025-12-27T08:23:19.472881096Z [err]  2025-12-27 08:23:19,471 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:23:19.472886582Z [err]  2025-12-27 08:23:19,471 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:23:19.472894497Z [err]  2025-12-27 08:23:19,471 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:23:19.472902196Z [err]  2025-12-27 08:23:19,471 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:23:19.561901439Z [err]  2025-12-27 08:23:19,559 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:19.561905129Z [err]  2025-12-27 08:23:19,559 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-27T08:23:19.561910111Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Text length: 20 chars
2025-12-27T08:23:19.561916248Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Text content: 'Are you still there?'
2025-12-27T08:23:19.561922107Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-27T08:23:19.561928435Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-27T08:23:19.561935120Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-27T08:23:19.561941361Z [err]  2025-12-27 08:23:19,559 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-27T08:23:19.561947694Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-27T08:23:19.561953503Z [err]  2025-12-27 08:23:19,559 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-27T08:23:19.561958696Z [err]  2025-12-27 08:23:19,559 - server - INFO -    Timeout: 10.0s
2025-12-27T08:23:19.572779259Z [err]  2025-12-27 08:23:19,568 - server - INFO -    ‚úì HTTP client created (0.009s)
2025-12-27T08:23:19.572786798Z [err]  2025-12-27 08:23:19,569 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-27T08:23:19.883712572Z [err]  2025-12-27 08:23:19,881 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-27T08:23:19.883718441Z [err]  2025-12-27 08:23:19,881 - server - INFO -    ‚úì Connection established (0.322s) [TARGET: <200ms]
2025-12-27T08:23:19.883722971Z [err]  2025-12-27 08:23:19,881 - server - INFO -    ‚úì Response status: 200
2025-12-27T08:23:19.883726958Z [err]  2025-12-27 08:23:19,881 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-27T08:23:19.893351955Z [err]  2025-12-27 08:23:19,892 - server - INFO -    ‚úì FIRST CHUNK received (0.333s, 1086 bytes) [TARGET: <300ms]
2025-12-27T08:23:19.898564100Z [err]  2025-12-27 08:23:19,895 - server - INFO -    ‚úì ALL CHUNKS received: 40 chunks (0.336s)
2025-12-27T08:23:19.898573140Z [err]  2025-12-27 08:23:19,895 - server - INFO -    ‚úì Total audio size: 18435 bytes
2025-12-27T08:23:19.898580489Z [err]  2025-12-27 08:23:19,895 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-27T08:23:19.898587101Z [err]  2025-12-27 08:23:19,895 - server - INFO -       - Connection: 322ms
2025-12-27T08:23:19.898593366Z [err]  2025-12-27 08:23:19,895 - server - INFO -       - First chunk: 333ms
2025-12-27T08:23:19.898600655Z [err]  2025-12-27 08:23:19,895 - server - INFO -       - All chunks: 336ms
2025-12-27T08:23:19.898607723Z [err]  2025-12-27 08:23:19,895 - server - INFO -       - Audio generation only: 11ms
2025-12-27T08:23:19.898614539Z [err]  2025-12-27 08:23:19,895 - server - INFO - ‚è±Ô∏è [08:23:19.895] üîä TTS COMPLETE: 424ms, audio_size=18435 bytes
2025-12-27T08:23:19.898621310Z [err]  2025-12-27 08:23:19,896 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (18435 bytes)
2025-12-27T08:23:19.898627462Z [err]  2025-12-27 08:23:19,896 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.42s
2025-12-27T08:23:19.898631466Z [err]  2025-12-27 08:23:19,896 - telnyx_service - INFO - ‚úÖ Generated 18435 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:19.898635009Z [err]  2025-12-27 08:23:19,896 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:20.119488060Z [err]  2025-12-27 08:23:20,116 - persistent_tts_service - INFO - ‚úÖ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Receiver finished sentence #1: 1 chunks in 2238ms
2025-12-27T08:23:20.119496294Z [err]  2025-12-27 08:23:20,115 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:20.119503317Z [err]  2025-12-27 08:23:20,115 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2025-12-27T08:23:20.119509882Z [err]  2025-12-27 08:23:20,115 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-27T08:23:20.119516331Z [err]    "errors": [
2025-12-27T08:23:20.119522592Z [err]      {
2025-12-27T08:23:20.119529009Z [err]        "code": "90018",
2025-12-27T08:23:20.119534906Z [err]        "title": "Call has already ended",
2025-12-27T08:23:20.119541659Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-27T08:23:20.119548939Z [err]      }
2025-12-27T08:23:20.119553516Z [err]    ]
2025-12-27T08:23:20.119557276Z [err]  }
2025-12-27T08:23:20.119561344Z [err]  2025-12-27 08:23:20,115 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-27T08:23:20.119565586Z [err]  2025-12-27 08:23:20,116 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-27T08:23:20.350705232Z [err]  2025-12-27 08:23:20,315 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-27T08:23:20.350711539Z [err]  2025-12-27 08:23:20,317 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=0/2
2025-12-27T08:23:20.350794720Z [err]  2025-12-27 08:23:20,314 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:20.350804693Z [err]  2025-12-27 08:23:20,315 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-27T08:23:20.494464161Z [err]  2025-12-27 08:23:20,491 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:20.495117251Z [err]  2025-12-27 08:23:20,494 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-27T08:23:20.593732515Z [err]  2025-12-27 08:23:20,588 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:20.593738027Z [err]  2025-12-27 08:23:20,588 - server - INFO - ‚úÖ QC analysis completed for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:20.593743394Z [err]  2025-12-27 08:23:20,588 - server - INFO - üìä Scores: Commitment=50, Conversion=40, Excellence=50
2025-12-27T08:23:20.782939141Z [err]  2025-12-27 08:23:20,773 - server - INFO - üìä Updated campaign_calls with QC scores for v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:20.856110387Z [err]  2025-12-27 08:23:20,822 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.5s, checkin_count=0/2
2025-12-27T08:23:20.856114066Z [err]  2025-12-27 08:23:20,826 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=1/2
2025-12-27T08:23:20.966592634Z [err]  2025-12-27 08:23:20,950 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-27T08:23:21.050867017Z [err]  2025-12-27 08:23:21,044 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-27T08:23:21.050872812Z [err]  2025-12-27 08:23:21,044 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw: 'str' object has no attribute 'get'
2025-12-27T08:23:21.343871518Z [err]  2025-12-27 08:23:21,267 - server - INFO - üì§ Audio flowing: 320 packets sent to Soniox (5s update)
2025-12-27T08:23:23.150112555Z [err]  2025-12-27 08:23:23,134 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2025-12-27T08:23:23.150122141Z [err]  2025-12-27 08:23:23,134 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.150129045Z [err]  2025-12-27 08:23:23,134 - calling_service - INFO - üîä Silence timer reset for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (user started speaking)
2025-12-27T08:23:23.150134905Z [err]  2025-12-27 08:23:23,134 - calling_service - INFO - üë§ User started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.150140858Z [err]  2025-12-27 08:23:23,134 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-27T08:23:23.150146548Z [err]  2025-12-27 08:23:23,134 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2025-12-27T08:23:23.361986803Z [err]  2025-12-27 08:23:23,275 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2025-12-27T08:23:23.361990551Z [err]  2025-12-27 08:23:23,275 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-27T08:23:23.361994252Z [err]  2025-12-27 08:23:23,275 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2025-12-27T08:23:23.361998186Z [err]  2025-12-27 08:23:23,275 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-27T08:23:23.362003486Z [err]  2025-12-27 08:23:23,275 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2025-12-27T08:23:23.362011001Z [err]  2025-12-27 08:23:23,275 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-27T08:23:23.362016814Z [err]  2025-12-27 08:23:23,275 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-27T08:23:23.362022726Z [err]  2025-12-27 08:23:23,275 - server - INFO - ‚è±Ô∏è [08:23:23.275] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-27T08:23:23.362028659Z [err]  2025-12-27 08:23:23,275 - server - INFO - ‚è±Ô∏è [08:23:23.275] STT endpoint detection latency: 8ms
2025-12-27T08:23:23.362034504Z [err]  2025-12-27 08:23:23,275 - server - INFO - ‚è±Ô∏è [08:23:23.275] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-27T08:23:23.362038016Z [err]  2025-12-27 08:23:23,281 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (TTL: 3600s)
2025-12-27T08:23:23.362043904Z [err]  2025-12-27 08:23:23,281 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-27T08:23:23.362050315Z [err]  2025-12-27 08:23:23,281 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-27T08:23:23.362057155Z [err]  2025-12-27 08:23:23,292 - calling_service - INFO - üë§ User stopped speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.362058312Z [err]  2025-12-27 08:23:23,292 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-27T08:23:23.362062003Z [err]  2025-12-27 08:23:23,295 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2025-12-27T08:23:23.362066283Z [err]  2025-12-27 08:23:23,295 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-27T08:23:23.362070633Z [err]  2025-12-27 08:23:23,295 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+7ms
2025-12-27T08:23:23.362074563Z [err]  2025-12-27 08:23:23,295 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 7ms (Soniox model: stt-rt-v3)
2025-12-27T08:23:23.362078899Z [err]  2025-12-27 08:23:23,295 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-27T08:23:23.362082799Z [err]  2025-12-27 08:23:23,295 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-27T08:23:23.362087602Z [err]  2025-12-27 08:23:23,295 - calling_service - INFO - ü§ñ Agent started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.391114994Z [err]  2025-12-27 08:23:23,388 - server - INFO - üìù Saved user transcript to database
2025-12-27T08:23:23.391122105Z [err]  2025-12-27 08:23:23,388 - calling_service - INFO - ‚è±Ô∏è [08:23:23.388] üì• process_user_input() ENTRY - text: 'Yeah....'
2025-12-27T08:23:23.395958241Z [err]  2025-12-27 08:23:23,393 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.395962221Z [err]  2025-12-27 08:23:23,393 - calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: User spoke while Silence Greeting was triggering
2025-12-27T08:23:23.418099548Z [err]  2025-12-27 08:23:23,417 - calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-27T08:23:23.418129746Z [err]  2025-12-27 08:23:23,417 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:23.418135519Z [err]  2025-12-27 08:23:23,417 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.418143182Z [err]  2025-12-27 08:23:23,417 - telnyx_service - ERROR - ‚ùå Error stopping audio playback: 'ActionsResource' object has no attribute 'playback_stop'
2025-12-27T08:23:23.418152841Z [err]  2025-12-27 08:23:23,417 - calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-27T08:23:23.423328661Z [err]  2025-12-27 08:23:23,422 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:23.434433806Z [err]  2025-12-27 08:23:23,427 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (TTL: 3600s)
2025-12-27T08:23:23.434445238Z [err]  2025-12-27 08:23:23,427 - calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-27T08:23:23.434454791Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - ‚è±Ô∏è [08:23:23.428] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:23:23.434462801Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - ‚è±Ô∏è [08:23:23.428] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:23:23.434468717Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - ‚è±Ô∏è [08:23:23.428] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:23:23.434474001Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-27T08:23:23.434478037Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-27T08:23:23.434482388Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - ‚è±Ô∏è [08:23:23.428] üîÄ About to call _follow_transition() for: Yeah....
2025-12-27T08:23:23.434486706Z [err]  2025-12-27 08:23:23,428 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-27T08:23:23.439252921Z [err]  2025-12-27 08:23:23,436 - calling_service - INFO - ‚è±Ô∏è [08:23:23.436] üîÄ TRANSITION EVALUATION START - Calling LLM for 2 options
2025-12-27T08:23:24.372230685Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 863ms
2025-12-27T08:23:24.372242396Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - ‚è±Ô∏è [08:23:24.292] ‚úÖ Node selected, about to process content...
2025-12-27T08:23:24.372252800Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:23 AM EST in content
2025-12-27T08:23:24.372262283Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:23:24.372271264Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:23:24.372280636Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:23:24.372284221Z [err]  2025-12-27 08:23:24,285 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:24.372289900Z [err]  2025-12-27 08:23:24,291 - calling_service - INFO - ‚è±Ô∏è [08:23:24.291] üîÄ TRANSITION EVALUATION COMPLETE - took 855ms
2025-12-27T08:23:24.372292867Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:23:24.372295287Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - ü§ñ AI transition decision: '0'
2025-12-27T08:23:24.372299580Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she) OR Ask...', 'Wrong number (No John here|Wrong number|etc) - don...']
2025-12-27T08:23:24.372303525Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - Selected transition index: 0
2025-12-27T08:23:24.372307585Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-27T08:23:24.372660849Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:23:24.372679418Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:23:24.372681470Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - ‚è±Ô∏è [08:23:24.292] üìÑ About to process content (mode=script, length=89)
2025-12-27T08:23:24.372685790Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:23:24.372688117Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2025-12-27T08:23:24.372692850Z [err]  2025-12-27 08:23:24,292 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2025-12-27T08:23:24.372696814Z [err]  2025-12-27 08:23:24,292 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 997ms
2025-12-27T08:23:24.372701244Z [err]  2025-12-27 08:23:24,292 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-27T08:23:24.372706689Z [err]  2025-12-27 08:23:24,292 - server - INFO - üîç Persistent TTS lookup: call_id=v3:vvYNT6U9Xv9siuf44..., session=FOUND
2025-12-27T08:23:24.372709442Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:23:24.372711450Z [err]  2025-12-27 08:23:24,292 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-27T08:23:24.372718795Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:23:24.372725268Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-27T08:23:24.372733301Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-27T08:23:24.372984995Z [err]  2025-12-27 08:23:24,292 - server - INFO - üéµ TTS task #1 started at +0ms
2025-12-27T08:23:24.372988762Z [err]  2025-12-27 08:23:24,292 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 997ms
2025-12-27T08:23:24.372992920Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2025-12-27T08:23:24.372996800Z [err]  2025-12-27 08:23:24,292 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-27T08:23:24.373000437Z [err]  2025-12-27 08:23:24,292 - server - INFO - üîç Persistent TTS lookup: call_id=v3:vvYNT6U9Xv9siuf44..., session=FOUND
2025-12-27T08:23:24.373003983Z [err]  2025-12-27 08:23:24,292 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-27T08:23:24.373007553Z [err]  2025-12-27 08:23:24,292 - server - INFO - üéµ TTS task #2 started at +0ms
2025-12-27T08:23:24.373011983Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-27T08:23:24.373015515Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üîä Silence tracking reset for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (user responded)
2025-12-27T08:23:24.373019230Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:23:24.373023339Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2025-12-27T08:23:24.373027118Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - LLM response (0.90s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-27T08:23:24.373031787Z [err]  2025-12-27 08:23:24,292 - calling_service - INFO - Total latency: 0.90s
2025-12-27T08:23:24.373036715Z [err]  2025-12-27 08:23:24,294 - server - INFO - ‚úÖ LLM finished in 998ms, TTS tasks already running in background
2025-12-27T08:23:24.373229686Z [err]  2025-12-27 08:23:24,294 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2025-12-27T08:23:24.373234831Z [err]  2025-12-27 08:23:24,294 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-27T08:23:24.373239887Z [err]  2025-12-27 08:23:24,294 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-27T08:23:24.373244135Z [err]  2025-12-27 08:23:24,294 - persistent_tts_service - INFO - üé§ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Streaming sentence #2: This is Jake......
2025-12-27T08:23:24.373248230Z [err]  2025-12-27 08:23:24,294 - persistent_tts_service - INFO - üöÄ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-27T08:23:24.373252182Z [err]  2025-12-27 08:23:24,294 - persistent_tts_service - INFO - üìä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-27T08:23:24.373257634Z [err]  2025-12-27 08:23:24,294 - persistent_tts_service - INFO - üé§ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2025-12-27T08:23:24.373263242Z [err]  2025-12-27 08:23:24,294 - persistent_tts_service - INFO - üöÄ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Sent sentence #3 (NON-BLOCKING) in 0ms
2025-12-27T08:23:24.373267069Z [err]  2025-12-27 08:23:24,294 - persistent_tts_service - INFO - üìä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:23:24.373270843Z [err]  2025-12-27 08:23:24,295 - persistent_tts_service - INFO - üéß [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Receiver processing sentence #2: 'This is Jake......'
2025-12-27T08:23:24.373274383Z [err]  2025-12-27 08:23:24,295 - persistent_tts_service - INFO - üìä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] DIAGNOSTIC: queue_latency=0ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-27T08:23:24.373934365Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-27T08:23:24.373940851Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-27T08:23:24.373944494Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2025-12-27T08:23:24.373950743Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-27T08:23:24.373954742Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 1000ms from user stop üöÄ
2025-12-27T08:23:24.373958545Z [err]  2025-12-27 08:23:24,295 - calling_service - INFO - ü§ñ Agent started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:24.373962420Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-27T08:23:24.373966446Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:24.373970280Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-27T08:23:24.373974275Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 7ms (provider: soniox, model: stt-rt-v3)
2025-12-27T08:23:24.373977938Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 998ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-27T08:23:24.373981476Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 2ms (provider: elevenlabs, websocket: False)
2025-12-27T08:23:24.373985565Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1000ms (user stopped ‚Üí play_audio_url called)
2025-12-27T08:23:24.374353295Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-27T08:23:24.374358229Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-27T08:23:24.374361893Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-27T08:23:24.374365563Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1300ms estimated
2025-12-27T08:23:24.374369149Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-27T08:23:24.374372588Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2025-12-27T08:23:24.374376090Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-27T08:23:24.374379787Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-27T08:23:24.374383469Z [err]  2025-12-27 08:23:24,295 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:24.484086384Z [err]  2025-12-27 08:23:24,483 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1007ms)
2025-12-27T08:23:24.484092158Z [err]  2025-12-27 08:23:24,483 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-27T08:23:24.484096390Z [err]  2025-12-27 08:23:24,483 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-27T08:23:24.562070913Z [err]  2025-12-27 08:23:24,545 - persistent_tts_service - INFO - üì§ Sending 8545 bytes of audio (54 chunks, 1.1s duration) via WebSocket
2025-12-27T08:23:24.562079826Z [err]  2025-12-27 08:23:24,545 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:24.562087907Z [err]  2025-12-27 08:23:24,545 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-27T08:23:24.562094825Z [err]  2025-12-27 08:23:24,546 - persistent_tts_service - INFO - ‚úÖ Sent 54 audio chunks via WebSocket
2025-12-27T08:23:24.801497354Z [err]  2025-12-27 08:23:24,795 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-27T08:23:24.801504256Z [err]  2025-12-27 08:23:24,795 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:24.801510467Z [err]  2025-12-27 08:23:24,795 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.5s from now)
2025-12-27T08:23:24.801517168Z [err]  2025-12-27 08:23:24,796 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-27T08:23:24.801524079Z [err]  2025-12-27 08:23:24,798 - persistent_tts_service - INFO - üì§ Sending 1069 bytes of audio (7 chunks, 0.1s duration) via WebSocket
2025-12-27T08:23:24.801530478Z [err]  2025-12-27 08:23:24,798 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:24.801536772Z [err]  2025-12-27 08:23:24,799 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.1s (total: 2.7s from now)
2025-12-27T08:23:24.801543939Z [err]  2025-12-27 08:23:24,799 - persistent_tts_service - INFO - ‚úÖ Sent 7 audio chunks via WebSocket
2025-12-27T08:23:24.974053105Z [err]  2025-12-27 08:23:24,972 - persistent_tts_service - INFO - üì§ Sending 17832 bytes of audio (112 chunks, 2.2s duration) via WebSocket
2025-12-27T08:23:24.974057549Z [err]  2025-12-27 08:23:24,973 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:24.974061792Z [err]  2025-12-27 08:23:24,973 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.2s (total: 4.7s from now)
2025-12-27T08:23:24.974720285Z [err]  2025-12-27 08:23:24,974 - persistent_tts_service - INFO - ‚úÖ Sent 112 audio chunks via WebSocket
2025-12-27T08:23:25.451048183Z [err]  2025-12-27 08:23:25,446 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (4.3s left)
2025-12-27T08:23:25.956653835Z [err]  2025-12-27 08:23:25,955 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.7s left)
2025-12-27T08:23:26.405231259Z [err]  2025-12-27 08:23:26,387 - server - INFO - üé§ Soniox receiver alive - 14 messages received in last 10s
2025-12-27T08:23:26.405587184Z [err]  2025-12-27 08:23:26,404 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 568 total packets
2025-12-27T08:23:26.405597466Z [err]  [2025-12-27 08:23:26 +0000] [4] [INFO] connection closed
2025-12-27T08:23:26.568935104Z [err]  2025-12-27 08:23:26,563 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.568943709Z [err]  2025-12-27 08:23:26,563 - server - INFO - üì® ================================================
2025-12-27T08:23:26.569043477Z [err]  2025-12-27 08:23:26,563 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:26.569051411Z [err]  2025-12-27 08:23:26,563 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '12b0810c-cc4a-49a5-9ef6-a58b85c70a47', 'occurred_at': '2025-12-27T08:23:26.279107Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:26.279107Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'd020-i308A', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:26.580044542Z [err]  2025-12-27 08:23:26,573 - redis_service - INFO - ‚ûñ Removed playback d020-i308A, 0 remaining for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.580051048Z [err]  2025-12-27 08:23:26,573 - server - INFO - üîä Redis: Removed playback d020-i308A, 0 remaining
2025-12-27T08:23:26.580064536Z [err]  2025-12-27 08:23:26,573 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-27T08:23:26.580070527Z [err]  2025-12-27 08:23:26,573 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-27T08:23:26.580076431Z [err]  2025-12-27 08:23:26,574 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:26.580082016Z [err]  2025-12-27 08:23:26,574 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '24c0c0c2-6ca1-4f9b-8b92-8f46b8694a2b', 'occurred_at': '2025-12-27T08:23:26.179327Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '16.33', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '619', 'skip_packet_count': '16'}, 'outbound': {'packet_count': '572', 'skip_packet_count': '0'}}, 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:26.179327Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-27T08:23:11.299116Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:26.580088090Z [err]  2025-12-27 08:23:26,574 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.580855125Z [err]  2025-12-27 08:23:26,574 - server - INFO - üì® ================================================
2025-12-27T08:23:26.580860958Z [err]  2025-12-27 08:23:26,574 - server - INFO - üìû Call ended: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.580866759Z [err]  2025-12-27 08:23:26,574 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-27T08:23:26.580872353Z [err]  2025-12-27 08:23:26,576 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:26.580878553Z [err]  2025-12-27 08:23:26,576 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '92b8f99f-c08e-460b-bef2-1b3549dd0b49', 'occurred_at': '2025-12-27T08:23:26.337349Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '0e3ea073-b8b6-456f-b6a0-0db05583f867', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:26.580884106Z [err]  2025-12-27 08:23:26,577 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.580889432Z [err]  2025-12-27 08:23:26,577 - server - INFO - üì® ================================================
2025-12-27T08:23:26.580894781Z [inf]  100.64.0.8:11802 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:26.580899908Z [err]  2025-12-27 08:23:26,578 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-27T08:23:26.580905632Z [err]  2025-12-27 08:23:26,578 - server - INFO - ‚úÖ Found session locally: agent_speaking=True, user_speaking=False
2025-12-27T08:23:26.581524063Z [err]  2025-12-27 08:23:26,578 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823806.57886 for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.581530156Z [err]  2025-12-27 08:23:26,578 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.581535915Z [err]  2025-12-27 08:23:26,578 - server - INFO - ‚è±Ô∏è Agent done speaking, silence timer STARTED (local)
2025-12-27T08:23:26.581541384Z [inf]  100.64.0.4:38924 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:26.758841239Z [err]  2025-12-27 08:23:26,757 - server - INFO - üìù Updated call log: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:26.868695640Z [err]  2025-12-27 08:23:26,850 - server - INFO - ‚úÖ Finalized call log: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA (duration=11s, status=completed)
2025-12-27T08:23:27.007400479Z [err]  2025-12-27 08:23:26,972 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-27T08:23:27.007404190Z [err]  2025-12-27 08:23:26,973 - persistent_tts_service - INFO - ‚úÖ [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Receiver finished sentence #2: 4 chunks in 2678ms
2025-12-27T08:23:27.007408106Z [err]  2025-12-27 08:23:26,973 - persistent_tts_service - INFO - üéß [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Receiver processing sentence #3: 'I was just, um, wondering if y...'
2025-12-27T08:23:27.007412180Z [err]  2025-12-27 08:23:26,973 - persistent_tts_service - INFO - üìä [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] DIAGNOSTIC: queue_latency=2678ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:27.051577603Z [err]  2025-12-27 08:23:27,048 - persistent_tts_service - INFO - üîá [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] FLOOR RELEASED (is_holding_floor=False)
2025-12-27T08:23:27.568633955Z [err]  2025-12-27 08:23:27,563 - server - INFO - üìä Auto-added call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-27T08:23:27.645172810Z [err]  2025-12-27 08:23:27,641 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-27T08:23:27.729809918Z [err]  2025-12-27 08:23:27,729 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:27.750988303Z [err]  2025-12-27 08:23:27,744 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:27.750993509Z [err]  2025-12-27 08:23:27,749 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.750997979Z [err]  2025-12-27 08:23:27,750 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2025-12-27T08:23:27.751001903Z [err]  2025-12-27 08:23:27,750 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-27T08:23:27.772064233Z [err]  2025-12-27 08:23:27,770 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:27.772072639Z [err]  2025-12-27 08:23:27,771 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'e0846e1d-62e8-417b-b251-d5d42fcc6723', 'occurred_at': '2025-12-27T08:23:27.548876Z', 'payload': {'call_control_id': 'v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA', 'call_leg_id': '480e749e-e2fd-11f0-b49e-02420aef95a0', 'call_session_id': '480b2c8a-e2fd-11f0-a816-02420aef95a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:26.288351Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-27T08:23:26.288351Z', 'recording_id': 'cbec96f0-aa67-4184-8ef5-4af7ecb678b2', 'recording_started_at': '2025-12-27T08:23:15.496201Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-27/480e749e-e2fd-11f0-b49e-02420aef95a0-1766823795469783.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251227%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251227T082327Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=6fdcfdc205415e16471f30d3914fd100aefa6ba91d0673aaf1feb04415534566'}, 'start_time': '2025-12-27T08:23:15.496201Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:27.772078510Z [err]  2025-12-27 08:23:27,771 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.772084062Z [err]  2025-12-27 08:23:27,771 - server - INFO - üì® ================================================
2025-12-27T08:23:27.772091656Z [err]  2025-12-27 08:23:27,771 - server - INFO - üéôÔ∏è Recording saved for call: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.776766168Z [err]  2025-12-27 08:23:27,776 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.776773751Z [err]  2025-12-27 08:23:27,776 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=cbec96f0-aa67-4184-8ef5-4af7ecb678b2, call_data=True
2025-12-27T08:23:27.826708865Z [err]  2025-12-27 08:23:27,816 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:27.846927449Z [err]  2025-12-27 08:23:27,836 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:27.846933308Z [err]  2025-12-27 08:23:27,836 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-27T08:23:27.846937294Z [err]  2025-12-27 08:23:27,836 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-27T08:23:27.846941171Z [err]  2025-12-27 08:23:27,836 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-27T08:23:27.846945524Z [err]  2025-12-27 08:23:27,841 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-27T08:23:27.918674837Z [err]  2025-12-27 08:23:27,917 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:27.918682225Z [err]  2025-12-27 08:23:27,918 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-27T08:23:27.929955085Z [err]  2025-12-27 08:23:27,928 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-27T08:23:27.929966320Z [err]  2025-12-27 08:23:27,928 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-27T08:23:27.929974428Z [err]  2025-12-27 08:23:27,928 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-27T08:23:27.929981645Z [err]  2025-12-27 08:23:27,928 - server - INFO - üöÄ Triggered QC analysis for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.929988851Z [err]  2025-12-27 08:23:27,929 - server - INFO - üìä Triggered Campaign QC for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.929996569Z [err]  2025-12-27 08:23:27,929 - server - INFO - üìá Triggered CRM update for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.930003773Z [err]  2025-12-27 08:23:27,929 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.940754342Z [err]  2025-12-27 08:23:27,934 - redis_service - INFO - üßπ Deleted call data from Redis: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.940760914Z [err]  2025-12-27 08:23:27,934 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.940765615Z [inf]  100.64.0.6:15442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:27.940769895Z [err]  2025-12-27 08:23:27,934 - server - INFO - üîç Starting QC analysis for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:27.940780607Z [err]  2025-12-27 08:23:27,934 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-27T08:23:27.940787351Z [err]  2025-12-27 08:23:27,934 - server - INFO - üìá CRM update starting for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:27.940793736Z [err]  2025-12-27 08:23:27,934 - server - INFO - üìá Normalized phone: +17708336397
2025-12-27T08:23:28.027624866Z [err]  2025-12-27 08:23:28,025 - server - INFO - üìù Converted transcript from 4 messages to 146 characters
2025-12-27T08:23:28.027630893Z [err]  2025-12-27 08:23:28,026 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=4, logs_count=6, status=completed
2025-12-27T08:23:28.132810982Z [err]  2025-12-27 08:23:28,123 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:28.132816690Z [err]  2025-12-27 08:23:28,126 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-27T08:23:28.215485496Z [err]  2025-12-27 08:23:28,210 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-27T08:23:28.215495182Z [err]  2025-12-27 08:23:28,213 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-27T08:23:28.215502602Z [err]  2025-12-27 08:23:28,213 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-27T08:23:28.215512279Z [err]  2025-12-27 08:23:28,213 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-27T08:23:28.215522235Z [err]  2025-12-27 08:23:28,213 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-27T08:23:28.215530824Z [err]    File "/app/backend/server.py", line 9758, in trigger_campaign_qc_for_call
2025-12-27T08:23:28.215539279Z [err]      await run_full_qc_analysis(
2025-12-27T08:23:28.215548361Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:28.215555803Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-27T08:23:28.215563536Z [err]  
2025-12-27T08:23:28.391129715Z [err]  2025-12-27 08:23:28,297 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:28.391145299Z [err]  2025-12-27 08:23:28,380 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-27T08:23:28.391145871Z [err]  2025-12-27 08:23:28,297 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-27T08:23:28.391155102Z [err]  2025-12-27 08:23:28,297 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:28.391164153Z [err]  2025-12-27 08:23:28,381 - telnyx_service - INFO - ‚úÖ Call initiated: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:28.391165768Z [err]  2025-12-27 08:23:28,387 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-27T08:23:28.391174952Z [err]  2025-12-27 08:23:28,387 - server - INFO - üíæ Saved recording URL and ID to database: cbec96f0-aa67-4184-8ef5-4af7ecb678b2
2025-12-27T08:23:28.391182640Z [err]  2025-12-27 08:23:28,387 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-27T08:23:28.472595679Z [err]  2025-12-27 08:23:28,470 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:23:28.472604206Z [err]  2025-12-27 08:23:28,470 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-27T08:23:28.472637293Z [err]  2025-12-27 08:23:28,469 - server - INFO - üìù Created call log: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:28.473039554Z [err]  2025-12-27 08:23:28,470 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:23:28.473045903Z [err]  2025-12-27 08:23:28,470 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:28.494538178Z [err]  2025-12-27 08:23:28,493 - server - INFO - üìá CRM: Total variables collected: []
2025-12-27T08:23:28.499414002Z [err]  2025-12-27 08:23:28,496 - redis_service - INFO - üì¶ Stored call data in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (TTL: 3600s)
2025-12-27T08:23:28.499420698Z [err]  2025-12-27 08:23:28,496 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-27T08:23:28.499424951Z [err]  2025-12-27 08:23:28,496 - server - INFO - üìû Outbound call initiated: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:28.499429380Z [inf]  100.64.0.2:45394 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-27T08:23:28.510687895Z [err]  2025-12-27 08:23:28,509 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2025-12-27T08:23:28.510692215Z [err]  2025-12-27 08:23:28,509 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 25080, 'total_audio_proc_ms': 25080, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-27T08:23:28.510696297Z [err]  2025-12-27 08:23:28,509 - server - INFO - ‚úÖ Soniox receive loop ended normally
2025-12-27T08:23:28.510700158Z [err]  2025-12-27 08:23:28,509 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:28.510704373Z [err]  2025-12-27 08:23:28,509 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:C_Mbh_CopshQ6-AJDUd5jn6M136ph_6lmKx7kjX_qpyF_XmXv1ECrw
2025-12-27T08:23:28.510708477Z [err]  2025-12-27 08:23:28,509 - server - INFO - üîá Dead air monitoring task cancelled
2025-12-27T08:23:28.531342620Z [err]  2025-12-27 08:23:28,530 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:28.531351648Z [err]  2025-12-27 08:23:28,530 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': 'c4f166ca-4589-4ced-ada0-2454b95aeaea', 'occurred_at': '2025-12-27T08:23:28.263270Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:28.531356879Z [err]  2025-12-27 08:23:28,530 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:28.531361573Z [err]  2025-12-27 08:23:28,530 - server - INFO - üì® ================================================
2025-12-27T08:23:28.531367536Z [err]  2025-12-27 08:23:28,530 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-27T08:23:28.531372418Z [inf]  100.64.0.4:38926 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:28.713237054Z [err]  2025-12-27 08:23:28,699 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-27T08:23:28.713244951Z [err]  2025-12-27 08:23:28,699 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-27T08:23:28.713249850Z [err]  [2025-12-27 08:23:28 +0000] [4] [INFO] ('100.64.0.10', 17200) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-27T08:23:28.713253988Z [err]  2025-12-27 08:23:28,699 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-27T08:23:28.713258345Z [err]  [2025-12-27 08:23:28 +0000] [4] [INFO] connection open
2025-12-27T08:23:28.713270786Z [err]  2025-12-27 08:23:28,670 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-27T08:23:28.713274491Z [err]  2025-12-27 08:23:28,699 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-27T08:23:28.713279246Z [err]  2025-12-27 08:23:28,699 - server - INFO -    Client: Address(host='100.64.0.10', port=17200)
2025-12-27T08:23:28.713283216Z [err]  2025-12-27 08:23:28,699 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'i2A/xBNKIkWcEnazckZmGw==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': '8RJJYSLgRLy_p9MtLPU1MQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766823808463', 'accept-encoding': 'gzip'}
2025-12-27T08:23:28.724881145Z [err]  2025-12-27 08:23:28,718 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-27/480e749e-e2fd-11f0-b49e-02420aef95a0-1766823795469783.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251227%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251227T082327Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=6fdcfdc205415e16471f30d3914fd100aefa6ba91d0673aaf1feb04415534566 "HTTP/1.1 200 OK"
2025-12-27T08:23:28.807580935Z [err]  2025-12-27 08:23:28,805 - server - INFO - ‚úÖ Downloaded 43510 bytes
2025-12-27T08:23:28.967996833Z [err]  2025-12-27 08:23:28,965 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:28.968005463Z [err]  2025-12-27 08:23:28,965 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-27T08:23:28.968011461Z [err]  2025-12-27 08:23:28,965 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-27T08:23:28.968015784Z [err]  2025-12-27 08:23:28,965 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-27T08:23:28.968041179Z [err]  2025-12-27 08:23:28,958 - server - INFO - ‚úÖ Split into 2 channels
2025-12-27T08:23:28.968047271Z [err]  2025-12-27 08:23:28,958 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-27T08:23:28.968053698Z [err]  2025-12-27 08:23:28,958 - server - INFO - üìä Channel 0: 235884 bytes
2025-12-27T08:23:28.968059235Z [err]  2025-12-27 08:23:28,958 - server - ERROR - ‚ùå No Soniox API key available
2025-12-27T08:23:28.968063136Z [err]  2025-12-27 08:23:28,958 - server - INFO - ‚ùå Channel 0: No speech
2025-12-27T08:23:28.968066861Z [err]  2025-12-27 08:23:28,958 - server - INFO - üìä Channel 1: 235884 bytes
2025-12-27T08:23:28.968070468Z [err]  2025-12-27 08:23:28,958 - server - ERROR - ‚ùå No Soniox API key available
2025-12-27T08:23:28.968074481Z [err]  2025-12-27 08:23:28,958 - server - INFO - ‚ùå Channel 1: No speech
2025-12-27T08:23:28.968078144Z [err]  2025-12-27 08:23:28,959 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-27T08:23:28.968081936Z [inf]  100.64.0.4:38924 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:29.474289494Z [err]  2025-12-27 08:23:29,472 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:23:29.474297834Z [err]  2025-12-27 08:23:29,472 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA] Receiver got 0 chunks for sentence #3! interrupted=False
2025-12-27T08:23:30.486628757Z [err]  2025-12-27 08:23:30,480 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=3.9s, checkin_count=0/2
2025-12-27T08:23:30.526072470Z [err]  2025-12-27 08:23:30,510 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-27T08:23:30.526080480Z [err]  2025-12-27 08:23:30,511 - server - INFO - üîå Telnyx WebSocket disconnected
2025-12-27T08:23:30.989097690Z [err]  2025-12-27 08:23:30,985 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=4.4s, checkin_count=0/2
2025-12-27T08:23:31.724825920Z [err]  2025-12-27 08:23:31,721 - server - INFO - üì¨ Received Telnyx event: start
2025-12-27T08:23:31.724830550Z [err]  2025-12-27 08:23:31,721 - server - INFO - üé¨ Stream started for call: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:31.750461961Z [err]  2025-12-27 08:23:31,747 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:31.750466029Z [err]  2025-12-27 08:23:31,748 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-27T08:23:31.750471913Z [err]  2025-12-27 08:23:31,748 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-27T08:23:31.750477038Z [err]  2025-12-27 08:23:31,749 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:31.750481139Z [err]  2025-12-27 08:23:31,749 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'eeceec31-12e5-4971-b0a2-32ccdc321700', 'occurred_at': '2025-12-27T08:23:31.583270Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-27T08:23:28.263270Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:31.750485527Z [err]  2025-12-27 08:23:31,749 - server - INFO - üéØ Event type: call.answered, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:31.750489209Z [err]  2025-12-27 08:23:31,749 - server - INFO - üì® ================================================
2025-12-27T08:23:31.751033307Z [err]  2025-12-27 08:23:31,749 - server - INFO - ‚úÖ Call answered: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:31.762450950Z [err]  2025-12-27 08:23:31,757 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:31.762457938Z [err]  2025-12-27 08:23:31,760 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-27T08:23:31.762463741Z [err]  2025-12-27 08:23:31,760 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-27T08:23:31.858836415Z [err]  2025-12-27 08:23:31,853 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-27T08:23:31.858848176Z [err]  2025-12-27 08:23:31,853 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:31.858858031Z [err]  2025-12-27 08:23:31,853 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:31.858987631Z [err]  2025-12-27 08:23:31,853 - server - INFO - ‚úÖ Call log updated
2025-12-27T08:23:31.941927549Z [err]  2025-12-27 08:23:31,941 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:32.033230989Z [err]  2025-12-27 08:23:32,022 - server - INFO - üì® ================================================
2025-12-27T08:23:32.033238091Z [inf]  100.64.0.6:15442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:32.033243333Z [err]  2025-12-27 08:23:32,027 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:32.033247636Z [err]  2025-12-27 08:23:32,027 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-27T08:23:32.033263223Z [err]  2025-12-27 08:23:32,021 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:32.033267344Z [err]  2025-12-27 08:23:32,022 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-27T08:23:32.033291499Z [err]  2025-12-27 08:23:32,022 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:32.033304570Z [err]  2025-12-27 08:23:32,022 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'fa1c7936-1478-455c-adff-471325e63d00', 'occurred_at': '2025-12-27T08:23:31.883281Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '560d9344-f61b-4351-acec-a4feaa3b737c', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:32.033313975Z [err]  2025-12-27 08:23:32,022 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:32.054190433Z [err]  2025-12-27 08:23:32,049 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:32.252872883Z [err]  2025-12-27 08:23:32,249 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-27T08:23:32.252881231Z [err]  2025-12-27 08:23:32,249 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-27T08:23:32.264252653Z [err]  2025-12-27 08:23:32,260 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:32.264261135Z [err]  2025-12-27 08:23:32,261 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:32.264268187Z [err]  2025-12-27 08:23:32,261 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-27T08:23:32.404092016Z [err]  2025-12-27 08:23:32,338 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/playback_start "HTTP/1.1 200 OK"
2025-12-27T08:23:32.404095717Z [err]  2025-12-27 08:23:32,338 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: MVmw1L1TAA (loop=True, overlay=True)
2025-12-27T08:23:32.404099729Z [err]  2025-12-27 08:23:32,338 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ'
2025-12-27T08:23:32.404103955Z [err]  2025-12-27 08:23:32,338 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:32.636046523Z [err]  2025-12-27 08:23:32,617 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:32.636052189Z [err]  2025-12-27 08:23:32,621 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-27T08:23:32.636056862Z [err]  2025-12-27 08:23:32,623 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:32.684878347Z [inf]  100.64.0.9:60928 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2025-12-27T08:23:32.813786114Z [err]  2025-12-27 08:23:32,811 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/record_start "HTTP/1.1 200 OK"
2025-12-27T08:23:32.813793180Z [err]  2025-12-27 08:23:32,811 - server - INFO - üéôÔ∏è Call recording started for v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:32.813797843Z [err]  2025-12-27 08:23:32,811 - server - INFO - üîß Creating call session for v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ...
2025-12-27T08:23:32.813801976Z [err]  2025-12-27 08:23:32,812 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:32.813806184Z [err]  2025-12-27 08:23:32,812 - server - INFO - üîß Calling create_call_session() - START
2025-12-27T08:23:32.813810681Z [err]  2025-12-27 08:23:32,812 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-27T08:23:32.818527266Z [err]  2025-12-27 08:23:32,817 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-27T08:23:32.818533909Z [err]  2025-12-27 08:23:32,817 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-27T08:23:32.818541021Z [err]  2025-12-27 08:23:32,818 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-27T08:23:32.818548446Z [err]  2025-12-27 08:23:32,818 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-27T08:23:32.818555444Z [err]  2025-12-27 08:23:32,818 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-27T08:23:32.904863014Z [err]  2025-12-27 08:23:32,899 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-27T08:23:32.904869626Z [err]  2025-12-27 08:23:32,899 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-27T08:23:32.904876049Z [err]  2025-12-27 08:23:32,899 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-27T08:23:32.904882550Z [err]  2025-12-27 08:23:32,899 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-27T08:23:32.904889421Z [err]  2025-12-27 08:23:32,899 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-27T08:23:32.908861151Z [err]  2025-12-27 08:23:32,905 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:32.914021870Z [err]  2025-12-27 08:23:32,912 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 94ms
2025-12-27T08:23:32.914027311Z [err]  2025-12-27 08:23:32,913 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-27T08:23:32.914031283Z [err]  2025-12-27 08:23:32,913 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-27T08:23:32.914034882Z [err]  2025-12-27 08:23:32,913 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-27T08:23:32.914038497Z [err]  2025-12-27 08:23:32,913 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-27T08:23:32.914042419Z [err]  2025-12-27 08:23:32,913 - server - INFO - ‚úÖ Initialized call_states for v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ with session reference
2025-12-27T08:23:32.914049734Z [err]  2025-12-27 08:23:32,913 - server - INFO - ‚úÖ Stored Telnyx WebSocket in call_data for audio streaming
2025-12-27T08:23:32.914059037Z [err]  2025-12-27 08:23:32,913 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found to update for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:32.914778517Z [err]  2025-12-27 08:23:32,913 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-27T08:23:32.988333935Z [err]  2025-12-27 08:23:32,986 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:32.999267739Z [err]  2025-12-27 08:23:32,994 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 94ms
2025-12-27T08:23:32.999272274Z [err]  2025-12-27 08:23:32,994 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-27T08:23:32.999276326Z [err]  2025-12-27 08:23:32,994 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-27T08:23:33.025535446Z [err]  2025-12-27 08:23:33,020 - redis_service - INFO - üì¶ Stored call data in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (TTL: 3600s)
2025-12-27T08:23:33.025543059Z [err]  2025-12-27 08:23:33,020 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-27T08:23:33.025549502Z [err]  2025-12-27 08:23:33,021 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-27T08:23:33.030627564Z [err]  2025-12-27 08:23:33,026 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:33.030637312Z [err]  2025-12-27 08:23:33,026 - server - INFO - ü§ñ AI session created for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:33.030642369Z [err]  2025-12-27 08:23:33,026 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-27T08:23:33.030646418Z [err]  2025-12-27 08:23:33,026 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-27T08:23:33.030650542Z [err]  2025-12-27 08:23:33,026 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-27T08:23:33.030654946Z [err]  2025-12-27 08:23:33,026 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-27T08:23:33.030659378Z [err]  2025-12-27 08:23:33,026 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-27T08:23:33.030663177Z [err]  2025-12-27 08:23:33,026 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-27T08:23:33.030667224Z [err]  2025-12-27 08:23:33,026 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-27T08:23:33.040238283Z [err]  2025-12-27 08:23:33,038 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:33.040242348Z [err]  2025-12-27 08:23:33,039 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-27T08:23:33.040246501Z [err]  2025-12-27 08:23:33,039 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-27T08:23:33.040251659Z [inf]  100.64.0.4:38924 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:33.045084514Z [err]  2025-12-27 08:23:33,041 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-27T08:23:33.527989398Z [err]  2025-12-27 08:23:33,519 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-27T08:23:33.527999093Z [err]  2025-12-27 08:23:33,519 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-27T08:23:33.528005629Z [err]  2025-12-27 08:23:33,519 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:33.528011567Z [err]  2025-12-27 08:23:33,525 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:33.528018168Z [err]  2025-12-27 08:23:33,525 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-27T08:23:33.528090097Z [err]  2025-12-27 08:23:33,519 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-27T08:23:33.839914897Z [err]  2025-12-27 08:23:33,828 - calling_service - INFO - ‚è∞ Check-in triggered after 7.2s silence (threshold: 7s)
2025-12-27T08:23:33.839923448Z [err]  2025-12-27 08:23:33,833 - calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-27T08:23:33.839929436Z [err]  2025-12-27 08:23:33,833 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.2s silence: Are you still there?
2025-12-27T08:23:33.839934768Z [err]  2025-12-27 08:23:33,833 - calling_service - INFO - ü§ñ Agent started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:33.839940304Z [err]  2025-12-27 08:23:33,834 - telnyx_service - INFO - üîä Speaking text on call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: Are you still there?...
2025-12-27T08:23:33.839946672Z [err]  2025-12-27 08:23:33,834 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:23:33.839953709Z [err]  2025-12-27 08:23:33,834 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:23:33.839959250Z [err]  2025-12-27 08:23:33,834 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:23:33.839968878Z [err]  2025-12-27 08:23:33,834 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:23:33.839974300Z [err]  2025-12-27 08:23:33,834 - server - INFO - ‚è±Ô∏è [08:23:33.834] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-27T08:23:33.839979708Z [err]  2025-12-27 08:23:33,834 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-27T08:23:33.839985198Z [err]  2025-12-27 08:23:33,834 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-27T08:23:33.871694279Z [err]  2025-12-27 08:23:33,861 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:33.871700289Z [err]  2025-12-27 08:23:33,861 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '9d580147-abb7-4cde-9645-b2f77513436b', 'occurred_at': '2025-12-27T08:23:33.743272Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'MVmw1L1TAA', 'start_time': '2025-12-27T08:23:33.743272Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:33.871706508Z [inf]  100.64.0.6:15442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:33.871712092Z [err]  2025-12-27 08:23:33,861 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:33.871717609Z [err]  2025-12-27 08:23:33,861 - server - INFO - üì® ================================================
2025-12-27T08:23:33.923298557Z [err]  2025-12-27 08:23:33,922 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-27T08:23:33.923305500Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Timeout: 10.0s
2025-12-27T08:23:33.923324738Z [err]  2025-12-27 08:23:33,921 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:33.923333527Z [err]  2025-12-27 08:23:33,922 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-27T08:23:33.923341060Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Text length: 20 chars
2025-12-27T08:23:33.923347775Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Text content: 'Are you still there?'
2025-12-27T08:23:33.923353406Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-27T08:23:33.923358839Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-27T08:23:33.923364580Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-27T08:23:33.923370167Z [err]  2025-12-27 08:23:33,922 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-27T08:23:33.923375733Z [err]  2025-12-27 08:23:33,922 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-27T08:23:33.934541672Z [err]  2025-12-27 08:23:33,930 - server - INFO -    ‚úì HTTP client created (0.008s)
2025-12-27T08:23:33.934547666Z [err]  2025-12-27 08:23:33,930 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-27T08:23:34.045625698Z [err]  2025-12-27 08:23:34,029 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:34.258862070Z [err]  2025-12-27 08:23:34,248 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-27T08:23:34.258868303Z [err]  2025-12-27 08:23:34,248 - server - INFO -    ‚úì Connection established (0.326s) [TARGET: <200ms]
2025-12-27T08:23:34.258872679Z [err]  2025-12-27 08:23:34,248 - server - INFO -    ‚úì Response status: 200
2025-12-27T08:23:34.258877777Z [err]  2025-12-27 08:23:34,248 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-27T08:23:34.259606539Z [err]  2025-12-27 08:23:34,258 - server - INFO -    ‚úì FIRST CHUNK received (0.337s, 1130 bytes) [TARGET: <300ms]
2025-12-27T08:23:34.404156208Z [err]  2025-12-27 08:23:34,267 - server - INFO -    ‚úì ALL CHUNKS received: 135 chunks (0.345s)
2025-12-27T08:23:34.404161214Z [err]  2025-12-27 08:23:34,267 - server - INFO -    ‚úì Total audio size: 17599 bytes
2025-12-27T08:23:34.404166051Z [err]  2025-12-27 08:23:34,267 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-27T08:23:34.404171388Z [err]  2025-12-27 08:23:34,267 - server - INFO -       - Connection: 326ms
2025-12-27T08:23:34.404176051Z [err]  2025-12-27 08:23:34,267 - server - INFO -       - First chunk: 337ms
2025-12-27T08:23:34.404181508Z [err]  2025-12-27 08:23:34,267 - server - INFO -       - All chunks: 345ms
2025-12-27T08:23:34.404186101Z [err]  2025-12-27 08:23:34,267 - server - INFO -       - Audio generation only: 11ms
2025-12-27T08:23:34.404191248Z [err]  2025-12-27 08:23:34,267 - server - INFO - ‚è±Ô∏è [08:23:34.267] üîä TTS COMPLETE: 433ms, audio_size=17599 bytes
2025-12-27T08:23:34.404196489Z [err]  2025-12-27 08:23:34,267 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2025-12-27T08:23:34.404202261Z [err]  2025-12-27 08:23:34,267 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.43s
2025-12-27T08:23:34.404206311Z [err]  2025-12-27 08:23:34,267 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:34.404210428Z [err]  2025-12-27 08:23:34,267 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:34.487058042Z [err]  2025-12-27 08:23:34,485 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:34.487067173Z [err]  2025-12-27 08:23:34,485 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2025-12-27T08:23:34.487072137Z [err]  2025-12-27 08:23:34,486 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-27T08:23:34.487078790Z [err]    "errors": [
2025-12-27T08:23:34.487083577Z [err]      {
2025-12-27T08:23:34.487088753Z [err]        "code": "90018",
2025-12-27T08:23:34.487093724Z [err]        "title": "Call has already ended",
2025-12-27T08:23:34.487097969Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-27T08:23:34.487103423Z [err]      }
2025-12-27T08:23:34.487108157Z [err]    ]
2025-12-27T08:23:34.487112235Z [err]  }
2025-12-27T08:23:34.487116642Z [err]  2025-12-27 08:23:34,486 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-27T08:23:34.783093406Z [err]  2025-12-27 08:23:34,781 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:34.783100508Z [err]  2025-12-27 08:23:34,782 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-27T08:23:34.783106920Z [err]  2025-12-27 08:23:34,782 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-27T08:23:34.793238319Z [err]  2025-12-27 08:23:34,790 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:34.933127109Z [err]  2025-12-27 08:23:34,925 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:34.933130659Z [err]  2025-12-27 08:23:34,929 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-27T08:23:34.933134268Z [err]  2025-12-27 08:23:34,929 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:34.944591480Z [err]  2025-12-27 08:23:34,940 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:34.950030495Z [err]  2025-12-27 08:23:34,949 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:34.977371892Z [err]  2025-12-27 08:23:34,975 - redis_service - INFO - üì¶ Stored call data in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (TTL: 3600s)
2025-12-27T08:23:34.977388449Z [err]  2025-12-27 08:23:34,976 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-27T08:23:34.977392948Z [err]  2025-12-27 08:23:34,976 - calling_service - INFO - ‚è±Ô∏è [08:23:34.976] üì• process_user_input() ENTRY - text: '...'
2025-12-27T08:23:34.988937033Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:23:34.988944477Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:23:34.988950117Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:23:34.988954881Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚è±Ô∏è [08:23:34.985] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:23:34.988956118Z [err]  2025-12-27 08:23:34,984 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:34.988956429Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:23:34.988965944Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚è±Ô∏è [08:23:34.985] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:23:34.988966008Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚è±Ô∏è [08:23:34.985] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:23:34.988971713Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-27T08:23:34.988976294Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚è±Ô∏è [08:23:34.985] ‚úÖ Node selected, about to process content...
2025-12-27T08:23:34.988980579Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:23 AM EST in content
2025-12-27T08:23:34.988984644Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:23:34.988989950Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:23:34.989646273Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:23:34.989652025Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:23:34.989655722Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:23:34.989659441Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-27T08:23:34.989663366Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-27T08:23:34.989667777Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-27T08:23:34.989671407Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚è±Ô∏è [08:23:34.985] üìÑ About to process content (mode=script, length=9)
2025-12-27T08:23:34.989674896Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üîä Silence tracking reset for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (user responded)
2025-12-27T08:23:34.989678421Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:23:34.989682294Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-27T08:23:34.989686064Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - LLM response (0.01s): Kendrick?
2025-12-27T08:23:34.989689618Z [err]  2025-12-27 08:23:34,985 - calling_service - INFO - Total latency: 0.01s
2025-12-27T08:23:34.989693159Z [err]  2025-12-27 08:23:34,985 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-27T08:23:35.089422323Z [err]  2025-12-27 08:23:35,086 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:35.089430175Z [err]  2025-12-27 08:23:35,087 - telnyx_service - INFO - üîä Speaking text on call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: Kendrick?...
2025-12-27T08:23:35.089435410Z [err]  2025-12-27 08:23:35,087 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:23:35.089439588Z [err]  2025-12-27 08:23:35,087 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:23:35.089444056Z [err]  2025-12-27 08:23:35,087 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:23:35.089448483Z [err]  2025-12-27 08:23:35,087 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:23:35.089452853Z [err]  2025-12-27 08:23:35,087 - server - INFO - ‚è±Ô∏è [08:23:35.087] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-27T08:23:35.089457072Z [err]  2025-12-27 08:23:35,087 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-27T08:23:35.089460999Z [err]  2025-12-27 08:23:35,087 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-27T08:23:35.178732732Z [err]  2025-12-27 08:23:35,174 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:35.178740336Z [err]  2025-12-27 08:23:35,174 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-27T08:23:35.178746960Z [err]  2025-12-27 08:23:35,174 - server - INFO -    Text length: 9 chars
2025-12-27T08:23:35.178760292Z [err]  2025-12-27 08:23:35,174 - server - INFO -    Text content: 'Kendrick?'
2025-12-27T08:23:35.178767208Z [err]  2025-12-27 08:23:35,174 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-27T08:23:35.178775858Z [err]  2025-12-27 08:23:35,174 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-27T08:23:35.178784283Z [err]  2025-12-27 08:23:35,174 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-27T08:23:35.178792232Z [err]  2025-12-27 08:23:35,174 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-27T08:23:35.178799403Z [err]  2025-12-27 08:23:35,174 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-27T08:23:35.178806279Z [err]  2025-12-27 08:23:35,174 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-27T08:23:35.178813033Z [err]  2025-12-27 08:23:35,175 - server - INFO -    Timeout: 10.0s
2025-12-27T08:23:35.185366158Z [err]  2025-12-27 08:23:35,184 - server - INFO -    ‚úì HTTP client created (0.009s)
2025-12-27T08:23:35.185372033Z [err]  2025-12-27 08:23:35,184 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-27T08:23:35.407523532Z [err]  2025-12-27 08:23:35,288 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-27T08:23:35.407529536Z [err]  2025-12-27 08:23:35,288 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823815.288737 for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:35.407535496Z [err]  2025-12-27 08:23:35,288 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:35.407541333Z [err]  2025-12-27 08:23:35,299 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:35.493700802Z [err]  2025-12-27 08:23:35,489 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-27T08:23:35.493708447Z [err]  2025-12-27 08:23:35,489 - server - INFO -    ‚úì Connection established (0.314s) [TARGET: <200ms]
2025-12-27T08:23:35.493712943Z [err]  2025-12-27 08:23:35,489 - server - INFO -    ‚úì Response status: 200
2025-12-27T08:23:35.493717323Z [err]  2025-12-27 08:23:35,489 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-27T08:23:35.504997954Z [err]  2025-12-27 08:23:35,500 - server - INFO -    ‚úì FIRST CHUNK received (0.325s, 923 bytes) [TARGET: <300ms]
2025-12-27T08:23:35.505002799Z [err]  2025-12-27 08:23:35,501 - server - INFO - ‚è±Ô∏è [08:23:35.501] üîä TTS COMPLETE: 414ms, audio_size=12583 bytes
2025-12-27T08:23:35.505004919Z [err]  2025-12-27 08:23:35,501 - server - INFO -    ‚úì ALL CHUNKS received: 44 chunks (0.326s)
2025-12-27T08:23:35.505009168Z [err]  2025-12-27 08:23:35,501 - server - INFO -    ‚úì Total audio size: 12583 bytes
2025-12-27T08:23:35.505013999Z [err]  2025-12-27 08:23:35,501 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-27T08:23:35.505015816Z [err]  2025-12-27 08:23:35,501 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (12583 bytes)
2025-12-27T08:23:35.505019323Z [err]  2025-12-27 08:23:35,501 - server - INFO -       - Connection: 314ms
2025-12-27T08:23:35.505024669Z [err]  2025-12-27 08:23:35,501 - server - INFO -       - First chunk: 325ms
2025-12-27T08:23:35.505025381Z [err]  2025-12-27 08:23:35,501 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.41s
2025-12-27T08:23:35.505031034Z [err]  2025-12-27 08:23:35,501 - server - INFO -       - All chunks: 326ms
2025-12-27T08:23:35.505034317Z [err]  2025-12-27 08:23:35,502 - telnyx_service - INFO - ‚úÖ Generated 12583 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-27T08:23:35.505037493Z [err]  2025-12-27 08:23:35,501 - server - INFO -       - Audio generation only: 11ms
2025-12-27T08:23:35.505042856Z [err]  2025-12-27 08:23:35,502 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-27T08:23:35.818400048Z [err]  2025-12-27 08:23:35,799 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/playback_start "HTTP/1.1 200 OK"
2025-12-27T08:23:35.818413306Z [err]  2025-12-27 08:23:35,800 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.30s
2025-12-27T08:23:35.818421030Z [err]  2025-12-27 08:23:35,800 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.71s
2025-12-27T08:23:35.818428392Z [err]  2025-12-27 08:23:35,800 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-27T08:23:35.818435517Z [err]  2025-12-27 08:23:35,800 - telnyx_service - INFO - üé¨ Playback ID: skZIbQAqpg
2025-12-27T08:23:35.818442730Z [err]  2025-12-27 08:23:35,805 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:35.818449472Z [err]  2025-12-27 08:23:35,805 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-27T08:23:35.818456328Z [err]  2025-12-27 08:23:35,805 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823815.8055735 for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:35.818463298Z [err]  2025-12-27 08:23:35,805 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-27T08:23:36.068278753Z [inf]  100.64.0.5:28296 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-27T08:23:36.253941304Z [err]  2025-12-27 08:23:36,252 - server - INFO - üî§ RAW TOKENS: ["H"?]
2025-12-27T08:23:36.253945226Z [err]  2025-12-27 08:23:36,252 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.253949453Z [err]  2025-12-27 08:23:36,252 - calling_service - INFO - üîä Silence timer reset for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (user started speaking)
2025-12-27T08:23:36.253953625Z [err]  2025-12-27 08:23:36,252 - calling_service - INFO - üë§ User started speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.253957761Z [err]  2025-12-27 08:23:36,252 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-27T08:23:36.253962086Z [err]  2025-12-27 08:23:36,252 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2025-12-27T08:23:36.406759293Z [err]  2025-12-27 08:23:36,310 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:36.406766317Z [err]  2025-12-27 08:23:36,312 - server - INFO - üî§ RAW TOKENS: ["H"?, "ello"?]
2025-12-27T08:23:36.406770970Z [err]  2025-12-27 08:23:36,312 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hello' | Generating: False
2025-12-27T08:23:36.440393590Z [err]  2025-12-27 08:23:36,439 - server - INFO - ‚è±Ô∏è [08:23:36.439] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-27T08:23:36.440407863Z [err]  2025-12-27 08:23:36,438 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2025-12-27T08:23:36.440412973Z [err]  2025-12-27 08:23:36,438 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-27T08:23:36.440420691Z [err]  2025-12-27 08:23:36,439 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2025-12-27T08:23:36.440425992Z [err]  2025-12-27 08:23:36,439 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2025-12-27T08:23:36.440432030Z [err]  2025-12-27 08:23:36,439 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2025-12-27T08:23:36.440437359Z [err]  2025-12-27 08:23:36,439 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:36.440442568Z [err]  2025-12-27 08:23:36,439 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-27T08:23:36.440447817Z [err]  2025-12-27 08:23:36,439 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:36.440452793Z [err]  2025-12-27 08:23:36,439 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-27T08:23:36.440458419Z [err]  2025-12-27 08:23:36,439 - server - INFO - ‚è±Ô∏è [08:23:36.439] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2025-12-27T08:23:36.440466364Z [err]  2025-12-27 08:23:36,439 - server - INFO - ‚è±Ô∏è [08:23:36.439] STT endpoint detection latency: 11ms
2025-12-27T08:23:36.451434264Z [err]  2025-12-27 08:23:36,444 - redis_service - INFO - üì¶ Stored call data in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (TTL: 3600s)
2025-12-27T08:23:36.451440737Z [err]  2025-12-27 08:23:36,444 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-27T08:23:36.451451853Z [err]  2025-12-27 08:23:36,444 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:36.451459234Z [err]  2025-12-27 08:23:36,444 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2025-12-27T08:23:36.456374614Z [err]  2025-12-27 08:23:36,455 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2025-12-27T08:23:36.456379827Z [err]  2025-12-27 08:23:36,455 - calling_service - INFO - üë§ User stopped speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.456383548Z [err]  2025-12-27 08:23:36,455 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-27T08:23:36.456387228Z [err]  2025-12-27 08:23:36,455 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+7ms
2025-12-27T08:23:36.456395072Z [err]  2025-12-27 08:23:36,455 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 7ms (Soniox model: stt-rt-v3)
2025-12-27T08:23:36.456399004Z [err]  2025-12-27 08:23:36,455 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-27T08:23:36.456402482Z [err]  2025-12-27 08:23:36,455 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-27T08:23:36.456405959Z [err]  2025-12-27 08:23:36,455 - calling_service - INFO - ü§ñ Agent started speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.551106957Z [err]  2025-12-27 08:23:36,548 - server - INFO - üìù Saved user transcript to database
2025-12-27T08:23:36.551112761Z [err]  2025-12-27 08:23:36,548 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:36.551116836Z [err]  2025-12-27 08:23:36,549 - calling_service - INFO - ‚è±Ô∏è [08:23:36.549] üì• process_user_input() ENTRY - text: 'Hello?...'
2025-12-27T08:23:36.556612963Z [err]  2025-12-27 08:23:36,554 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.556617909Z [err]  2025-12-27 08:23:36,554 - calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: User spoke while Silence Greeting was triggering
2025-12-27T08:23:36.567796446Z [err]  2025-12-27 08:23:36,562 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:36.567805153Z [err]  2025-12-27 08:23:36,562 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'f5e427af-4ae6-4b42-86dc-a7071f5de992', 'occurred_at': '2025-12-27T08:23:36.443269Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'skZIbQAqpg'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:36.567812221Z [err]  2025-12-27 08:23:36,562 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.567818803Z [err]  2025-12-27 08:23:36,562 - server - INFO - üì® ================================================
2025-12-27T08:23:36.567825812Z [inf]  100.64.0.6:15442 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:36.577791134Z [err]  2025-12-27 08:23:36,575 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:36.577797689Z [err]  2025-12-27 08:23:36,575 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.577802971Z [err]  2025-12-27 08:23:36,575 - telnyx_service - ERROR - ‚ùå Error stopping audio playback: 'ActionsResource' object has no attribute 'playback_stop'
2025-12-27T08:23:36.577809392Z [err]  2025-12-27 08:23:36,575 - calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-27T08:23:36.577820408Z [err]  2025-12-27 08:23:36,575 - calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-27T08:23:36.583470129Z [err]  2025-12-27 08:23:36,580 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:36.589592196Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-27T08:23:36.589599621Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - ‚è±Ô∏è [08:23:36.586] ‚è© About to call _process_call_flow_streaming()
2025-12-27T08:23:36.589604413Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - ‚è±Ô∏è [08:23:36.586] üîÄ Agent type: call_flow, calling flow processor...
2025-12-27T08:23:36.589608546Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - ‚è±Ô∏è [08:23:36.586] üîÄ _process_call_flow_streaming() ENTRY
2025-12-27T08:23:36.589612527Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-27T08:23:36.589616898Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-27T08:23:36.589620893Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - ‚è±Ô∏è [08:23:36.586] üîÄ About to call _follow_transition() for: Hello?...
2025-12-27T08:23:36.589624898Z [err]  2025-12-27 08:23:36,586 - calling_service - INFO - Evaluating transitions from Greeting for message: Hello?
2025-12-27T08:23:36.589694265Z [err]  2025-12-27 08:23:36,586 - redis_service - INFO - üì¶ Stored call data in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (TTL: 3600s)
2025-12-27T08:23:36.600364390Z [err]  2025-12-27 08:23:36,595 - calling_service - INFO - ‚è±Ô∏è [08:23:36.595] üîÄ TRANSITION EVALUATION START - Calling LLM for 2 options
2025-12-27T08:23:36.822501197Z [err]  2025-12-27 08:23:36,821 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:36.822507508Z [err]  2025-12-27 08:23:36,821 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:37.096201477Z [err]  2025-12-27 08:23:37,091 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:37.096210678Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ‚è±Ô∏è [08:23:37.092] üîÄ TRANSITION EVALUATION COMPLETE - took 496ms
2025-12-27T08:23:37.096216865Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ü§ñ AI transition decision: '-1'
2025-12-27T08:23:37.096224347Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she) OR Ask...', 'Wrong number (No John here|Wrong number|etc) - don...']
2025-12-27T08:23:37.096231916Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - Selected transition index: -1
2025-12-27T08:23:37.096239983Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-27T08:23:37.096245809Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ‚ö†Ô∏è No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-27T08:23:37.096251854Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üéØ Goal: Say the customer's name...
2025-12-27T08:23:37.096257621Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 505ms
2025-12-27T08:23:37.096263502Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ‚è±Ô∏è [08:23:37.092] ‚úÖ Node selected, about to process content...
2025-12-27T08:23:37.096268663Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 27, 2025 at 3:23 AM EST in content
2025-12-27T08:23:37.096274149Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-27T08:23:37.096279907Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-27T08:23:37.096766234Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-27T08:23:37.096776452Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-27T08:23:37.096782498Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-27T08:23:37.096788575Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-27T08:23:37.096795069Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-27T08:23:37.096801347Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-27T08:23:37.096808491Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-27T08:23:37.096813770Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-27T08:23:37.096819085Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-27T08:23:37.096824637Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-27T08:23:37.096830163Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ‚è±Ô∏è [08:23:37.092] üìÑ About to process content (mode=script, length=9)
2025-12-27T08:23:37.096836318Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - üõ°Ô∏è Preventing Dead Air: User stayed on script node 'Greeting' without transition
2025-12-27T08:23:37.096841585Z [err]  2025-12-27 08:23:37,092 - calling_service - INFO - ü§ñ Generating sticky-prevention response...
2025-12-27T08:23:37.101477281Z [err]  2025-12-27 08:23:37,099 - calling_service - INFO - ‚ö° PARALLEL MODE: Running KB + analysis simultaneously
2025-12-27T08:23:37.101483569Z [err]  2025-12-27 08:23:37,100 - kb_router - INFO - üö¶ KB Router: SKIP (simple chat pattern matched)
2025-12-27T08:23:37.101488945Z [err]  2025-12-27 08:23:37,100 - calling_service - INFO - ‚ö° Skipping KB (reason: simple_chat)
2025-12-27T08:23:37.101494266Z [err]  2025-12-27 08:23:37,100 - calling_service - INFO - ‚ö° Parallel operations completed in 0ms
2025-12-27T08:23:37.101499519Z [err]  2025-12-27 08:23:37,100 - calling_service - INFO - üîç Node 'Greeting': use_parallel_llm=True
2025-12-27T08:23:37.102583169Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - ‚ö° Parallel mode: Using condensed history (3/3 messages)
2025-12-27T08:23:37.102588356Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-27T08:23:37.102590389Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - ‚è±Ô∏è [08:23:37.101] üí¨ LLM REQUEST START: 3 conversation turns, 7883 system chars (KB cached)
2025-12-27T08:23:37.102597038Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LLM PROMPT BREAKDOWN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:37.102598844Z [err]  
2025-12-27T08:23:37.102602399Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù [SYSTEM MSG 1 - GLOBAL PROMPT] (6467 chars):
2025-12-27T08:23:37.102606835Z [err]  If explaining ends in peri...
2025-12-27T08:23:37.102609024Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-27T08:23:37.102614185Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù [SYSTEM MSG 2 - DYNAMIC CONTEXT] (1416 chars):
2025-12-27T08:23:37.102615347Z [err]  
2025-12-27T08:23:37.102619497Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-27T08:23:37.102622933Z [err]  
2025-12-27T08:23:37.102626616Z [err]  If user says a name, don't assume it's theirs‚Äîwait for explicit correction.
2025-12-27T08:23:37.102630487Z [err]  
2025-12-27T08:23:37.102636895Z [err]  If user asks to repeat info, rephrase naturally‚Äînever exact repeat.
2025-12-27T08:23:37.102640742Z [err]  
2025-12-27T08:23:37.102644280Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-27T08:23:37.102647908Z [err]  
2025-12-27T08:23:37.102651577Z [err]  If asked about call number: "Company number."
2025-12-27T08:23:37.102656323Z [err]  
2025-12-27T08:23:37.103310143Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù   Preview: 
2025-12-27T08:23:37.103317182Z [err]  
2025-12-27T08:23:37.103322352Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-27T08:23:37.103326631Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-27T08:23:37.103328599Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-27T08:23:37.103331226Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-27T08:23:37.103335926Z [err]  
2025-12-27T08:23:37.103341511Z [err]  USER COMMUNICATION STYLE: C type - adjust your response accordingly
2025-12-27T08:23:37.103342002Z [err]  
2025-12-27T08:23:37.103346018Z [err]  CONVERSATION STATUS: Turn 2, objection handling phase
2025-12-27T08:23:37.103351149Z [err]  
2025-12-27T08:23:37.103351602Z [err]  # CURRENT CONTEXT
2025-12-27T08:23:37.103356508Z [err]  This context is provided to help you focus. You still need to:
2025-12-27T08:23:37.103361729Z [err]  Customer: Kendrick
2025-12-27T08:23:37.103363169Z [err]  1. Generate a natural, contextual response
2025-12-27T08:23:37.103368660Z [err]  2. Evaluate transitions per your node instructions
2025-12-27T08:23:37.103373237Z [err]  
2025-12-27T08:23:37.103375013Z [err]  Variables: {"now": "Saturday, December 27, 2025 at 3:23 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment"...
2025-12-27T08:23:37.103677235Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù [CONVERSATION HISTORY] (3 messages)
2025-12-27T08:23:37.103682722Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù   assistant: Kendrick?...
2025-12-27T08:23:37.103686534Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù   user: Hello?...
2025-12-27T08:23:37.103690321Z [err]  2025-12-27 08:23:37,101 - calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:37.148219605Z [err]  2025-12-27 08:23:37,145 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:37.148225477Z [err]  2025-12-27 08:23:37,145 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '35510522-36e1-403e-adfa-a1de96f4554b', 'occurred_at': '2025-12-27T08:23:37.023269Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:37.148229810Z [err]  2025-12-27 08:23:37,145 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:37.148233543Z [err]  2025-12-27 08:23:37,145 - server - INFO - üì® ================================================
2025-12-27T08:23:37.148237499Z [inf]  100.64.0.4:38924 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:37.413435575Z [inf]  100.64.0.4:38924 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:37.413627362Z [err]  2025-12-27 08:23:37,331 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:37.413632632Z [err]  2025-12-27 08:23:37,331 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:37.413638061Z [err]  2025-12-27 08:23:37,363 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:37.413643196Z [err]  2025-12-27 08:23:37,363 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'dd281430-024e-4dc9-a35c-41a58d3d1514', 'occurred_at': '2025-12-27T08:23:37.243271Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'skZIbQAqpg', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:37.413648486Z [err]  2025-12-27 08:23:37,363 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:37.413653644Z [err]  2025-12-27 08:23:37,363 - server - INFO - üì® ================================================
2025-12-27T08:23:37.413659014Z [err]  2025-12-27 08:23:37,373 - redis_service - INFO - ‚ûñ Removed playback skZIbQAqpg, 0 remaining for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:37.413664368Z [err]  2025-12-27 08:23:37,373 - server - INFO - üîä Redis: Removed playback skZIbQAqpg, 0 remaining
2025-12-27T08:23:37.413716239Z [err]  2025-12-27 08:23:37,373 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-27T08:23:37.413721634Z [err]  2025-12-27 08:23:37,373 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-27T08:23:37.413726948Z [err]  2025-12-27 08:23:37,378 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-27T08:23:37.413732106Z [err]  2025-12-27 08:23:37,378 - server - INFO - ‚úÖ Found session locally: agent_speaking=True, user_speaking=False
2025-12-27T08:23:37.413738237Z [err]  2025-12-27 08:23:37,378 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823817.37884 for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:37.413744414Z [err]  2025-12-27 08:23:37,378 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:37.413750301Z [err]  2025-12-27 08:23:37,378 - server - INFO - ‚è±Ô∏è Agent done speaking, silence timer STARTED (local)
2025-12-27T08:23:37.447721199Z [err]  2025-12-27 08:23:37,446 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:37.452695461Z [err]  2025-12-27 08:23:37,449 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-27T08:23:37.533923263Z [err]  2025-12-27 08:23:37,521 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:37.544985649Z [err]  2025-12-27 08:23:37,539 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:37.544991484Z [err]  2025-12-27 08:23:37,539 - server - INFO - ‚úÖ QC analysis completed for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:37.544996319Z [err]  2025-12-27 08:23:37,539 - server - INFO - üìä Scores: Commitment=50, Conversion=20, Excellence=50
2025-12-27T08:23:37.722926039Z [err]  2025-12-27 08:23:37,721 - server - INFO - üìä Updated campaign_calls with QC scores for v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:37.820343722Z [err]  2025-12-27 08:23:37,815 - calling_service - INFO - ‚è±Ô∏è [08:23:37.815] üí¨ LLM FIRST TOKEN: 713ms (grok grok-4-1-fast-non-reasoning)
2025-12-27T08:23:37.841769920Z [err]  2025-12-27 08:23:37,837 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:37.881789345Z [err]  2025-12-27 08:23:37,877 - server - INFO - üì§ Sentence arrived from LLM: [N] Hey Kendrick,...
2025-12-27T08:23:37.881796575Z [err]  2025-12-27 08:23:37,877 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 1422ms
2025-12-27T08:23:37.881803778Z [err]  2025-12-27 08:23:37,877 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-27T08:23:37.881812141Z [err]  2025-12-27 08:23:37,877 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:Dw4NX6yRgKBuko_0A... (active sessions: ['v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA'])
2025-12-27T08:23:37.881818521Z [err]  2025-12-27 08:23:37,877 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-27T08:23:37.903210566Z [err]  2025-12-27 08:23:37,898 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-27T08:23:37.970694647Z [err]  2025-12-27 08:23:37,965 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:37.986501912Z [err]  2025-12-27 08:23:37,985 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-27T08:23:37.986507936Z [err]  2025-12-27 08:23:37,986 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: 'str' object has no attribute 'get'
2025-12-27T08:23:38.061923991Z [err]  2025-12-27 08:23:38,052 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:38.143618184Z [err]  2025-12-27 08:23:38,140 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:38.160072398Z [err]  2025-12-27 08:23:38,158 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-27T08:23:38.160079509Z [err]  2025-12-27 08:23:38,158 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-27T08:23:38.160085093Z [err]  2025-12-27 08:23:38,158 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-27T08:23:38.160090090Z [err]  2025-12-27 08:23:38,158 - persistent_tts_service - INFO - üîå [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Establishing persistent TTS WebSocket...
2025-12-27T08:23:38.160094441Z [err]  2025-12-27 08:23:38,158 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-27T08:23:38.160099738Z [err]  2025-12-27 08:23:38,158 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-27T08:23:38.160104146Z [err]  2025-12-27 08:23:38,158 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-27T08:23:38.417556120Z [err]  2025-12-27 08:23:38,290 - server - INFO - üîç Persistent TTS lookup: call_id=v3:Dw4NX6yRgKBuko_0A..., session=FOUND
2025-12-27T08:23:38.417569470Z [err]  2025-12-27 08:23:38,290 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-27T08:23:38.417580328Z [err]  2025-12-27 08:23:38,290 - server - INFO - üéµ TTS task #1 started at +413ms
2025-12-27T08:23:38.417589851Z [err]  2025-12-27 08:23:38,290 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1835ms
2025-12-27T08:23:38.417592155Z [err]  2025-12-27 08:23:38,290 - calling_service - INFO - üì§ Streamed sentence: [N] Hey Kendrick,...
2025-12-27T08:23:38.417599109Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üéµ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Playback consumer started
2025-12-27T08:23:38.417613063Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üé§ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Streaming sentence #1: [N] Hey Kendrick,...
2025-12-27T08:23:38.417613081Z [err]  2025-12-27 08:23:38,290 - persistent_tts_service - INFO - üîä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Comfort noise loop started
2025-12-27T08:23:38.417617578Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üéß [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Audio Receiver Loop STARTED
2025-12-27T08:23:38.417621802Z [err]  2025-12-27 08:23:38,290 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:38.417626871Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üîä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Starting comfort noise loop
2025-12-27T08:23:38.417627133Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üíì [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Starting TTS keep-alive loop (every 15s)
2025-12-27T08:23:38.417629730Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üöÄ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-27T08:23:38.417630042Z [err]  2025-12-27 08:23:38,290 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-27T08:23:38.417639813Z [err]  2025-12-27 08:23:38,293 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-27T08:23:38.417641086Z [err]  2025-12-27 08:23:38,289 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-27T08:23:38.417641873Z [err]  2025-12-27 08:23:38,291 - persistent_tts_service - INFO - üìä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-27T08:23:38.417649903Z [err]  2025-12-27 08:23:38,293 - server - INFO - üéµ TTS task #2 started at +415ms
2025-12-27T08:23:38.417649945Z [err]  2025-12-27 08:23:38,290 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-27T08:23:38.417651249Z [err]  2025-12-27 08:23:38,293 - server - INFO - üì§ Sentence arrived from LLM: yeah it's me....
2025-12-27T08:23:38.417658610Z [err]  2025-12-27 08:23:38,293 - calling_service - INFO - üì§ Streamed sentence: yeah it's me....
2025-12-27T08:23:38.417658833Z [err]  2025-12-27 08:23:38,290 - persistent_tts_service - INFO - ‚úÖ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Persistent TTS WebSocket established
2025-12-27T08:23:38.417664696Z [err]  2025-12-27 08:23:38,293 - server - INFO - üîç Persistent TTS lookup: call_id=v3:Dw4NX6yRgKBuko_0A..., session=FOUND
2025-12-27T08:23:38.417665751Z [err]  2025-12-27 08:23:38,294 - persistent_tts_service - INFO - üéß [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Receiver processing sentence #1: '[N] Hey Kendrick,...'
2025-12-27T08:23:38.417666566Z [err]  2025-12-27 08:23:38,290 - persistent_tts_service - INFO - üéß [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Audio receiver loop started
2025-12-27T08:23:38.418261377Z [err]  2025-12-27 08:23:38,294 - persistent_tts_service - INFO - üìä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] DIAGNOSTIC: queue_latency=3ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:38.418266288Z [err]  2025-12-27 08:23:38,294 - persistent_tts_service - INFO - üé§ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Streaming sentence #2: yeah it's me....
2025-12-27T08:23:38.418270529Z [err]  2025-12-27 08:23:38,295 - persistent_tts_service - INFO - üöÄ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-27T08:23:38.418275003Z [err]  2025-12-27 08:23:38,295 - persistent_tts_service - INFO - üìä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:23:38.418278613Z [err]  2025-12-27 08:23:38,295 - server - INFO - üì§ Sentence arrived from LLM: You there?...
2025-12-27T08:23:38.418282368Z [err]  2025-12-27 08:23:38,295 - server - INFO - üîç Persistent TTS lookup: call_id=v3:Dw4NX6yRgKBuko_0A..., session=FOUND
2025-12-27T08:23:38.418286028Z [err]  2025-12-27 08:23:38,295 - server - INFO - üöÄ Streaming sentence #3 via persistent WebSocket
2025-12-27T08:23:38.418289464Z [err]  2025-12-27 08:23:38,295 - server - INFO - üéµ TTS task #3 started at +418ms
2025-12-27T08:23:38.418292926Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - üì§ Streamed final fragment: You there?...
2025-12-27T08:23:38.418296712Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - ‚è±Ô∏è [TIMING] LLM_TOTAL: 1193ms for 42 chars (grok grok-4-1-fast-non-reasoning)
2025-12-27T08:23:38.418300133Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user gave meaningful response) for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:38.418303731Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - üîä Silence tracking reset for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (user responded)
2025-12-27T08:23:38.418950917Z [err]  2025-12-27 08:23:38,297 - persistent_tts_service - INFO - üìä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-27T08:23:38.418957243Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚úÖ All 3 persistent TTS streams completed
2025-12-27T08:23:38.418961222Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-27T08:23:38.418962948Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-27T08:23:38.418966336Z [err]  2025-12-27 08:23:38,296 - server - INFO - ‚úÖ LLM finished in 1841ms, TTS tasks already running in background
2025-12-27T08:23:38.418971910Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-27T08:23:38.418974465Z [err]  2025-12-27 08:23:38,297 - server - INFO - üéµ Streaming 3 TTS chunks as they complete...
2025-12-27T08:23:38.418979525Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - LLM response (1.75s): [N] Hey Kendrick, yeah it's me. You there?
2025-12-27T08:23:38.418983661Z [err]  2025-12-27 08:23:38,297 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-27T08:23:38.418988739Z [err]  2025-12-27 08:23:38,295 - calling_service - INFO - Total latency: 1.75s
2025-12-27T08:23:38.418991753Z [err]  2025-12-27 08:23:38,297 - server - INFO -    3 sentences queued and playing seamlessly
2025-12-27T08:23:38.418997766Z [err]  2025-12-27 08:23:38,297 - persistent_tts_service - INFO - üé§ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Streaming sentence #3: You there?...
2025-12-27T08:23:38.419001694Z [err]  2025-12-27 08:23:38,297 - persistent_tts_service - INFO - üöÄ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Sent sentence #3 (NON-BLOCKING) in 0ms
2025-12-27T08:23:38.419725285Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 1842ms from user stop üöÄ
2025-12-27T08:23:38.419734568Z [err]  2025-12-27 08:23:38,297 - calling_service - INFO - ü§ñ Agent started speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:38.419741904Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-27T08:23:38.419748312Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:38.419754901Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-27T08:23:38.419761283Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 7ms (provider: soniox, model: stt-rt-v3)
2025-12-27T08:23:38.419768151Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1841ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-27T08:23:38.419774858Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 420ms (provider: elevenlabs, websocket: False)
2025-12-27T08:23:38.419782005Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1842ms (user stopped ‚Üí play_audio_url called)
2025-12-27T08:23:38.419788736Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-27T08:23:38.419795212Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-27T08:23:38.419801807Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-27T08:23:38.419810004Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-27T08:23:38.420577585Z [err]  2025-12-27 08:23:38,297 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-27T08:23:38.420585541Z [err]  2025-12-27 08:23:38,298 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2142ms estimated
2025-12-27T08:23:38.420591648Z [err]  2025-12-27 08:23:38,298 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 42 chars, 3 sentences
2025-12-27T08:23:38.420597309Z [err]  2025-12-27 08:23:38,298 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2025-12-27T08:23:38.420603396Z [err]  2025-12-27 08:23:38,298 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '[N] Hey Kendrick, yeah it's me. You there?...'
2025-12-27T08:23:38.420609298Z [err]  2025-12-27 08:23:38,298 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-27T08:23:38.420615335Z [err]  2025-12-27 08:23:38,298 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-27T08:23:38.420621168Z [err]  2025-12-27 08:23:38,343 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-27T08:23:38.420627519Z [err]  2025-12-27 08:23:38,343 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823818.3435416 for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:38.420633385Z [err]  2025-12-27 08:23:38,343 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:38.489369241Z [err]  2025-12-27 08:23:38,485 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 2268ms)
2025-12-27T08:23:38.489374659Z [err]  2025-12-27 08:23:38,485 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-27T08:23:38.489414499Z [err]  2025-12-27 08:23:38,485 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-27T08:23:38.534135601Z [err]  2025-12-27 08:23:38,527 - server - INFO - üì§ Audio flowing: 319 packets sent to Soniox (5s update)
2025-12-27T08:23:38.545203621Z [err]  2025-12-27 08:23:38,539 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 248ms
2025-12-27T08:23:38.545208937Z [err]  2025-12-27 08:23:38,539 - persistent_tts_service - INFO - üì§ Sending 8900 bytes of audio (56 chunks, 1.1s duration) via WebSocket
2025-12-27T08:23:38.545214253Z [err]  2025-12-27 08:23:38,539 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:38.545219465Z [err]  2025-12-27 08:23:38,540 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-27T08:23:38.545223108Z [err]  2025-12-27 08:23:38,540 - persistent_tts_service - INFO - ‚úÖ Sent 56 audio chunks via WebSocket
2025-12-27T08:23:38.749735421Z [err]  2025-12-27 08:23:38,722 - persistent_tts_service - INFO - üì§ Sending 7431 bytes of audio (47 chunks, 0.9s duration) via WebSocket
2025-12-27T08:23:38.749740899Z [err]  2025-12-27 08:23:38,722 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:38.749745539Z [err]  2025-12-27 08:23:38,722 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.9s (total: 1.9s from now)
2025-12-27T08:23:38.749749258Z [err]  2025-12-27 08:23:38,723 - persistent_tts_service - INFO - ‚úÖ Sent 47 audio chunks via WebSocket
2025-12-27T08:23:38.963301416Z [err]  2025-12-27 08:23:38,948 - persistent_tts_service - INFO - üì§ Sending 5944 bytes of audio (38 chunks, 0.7s duration) via WebSocket
2025-12-27T08:23:38.963305162Z [err]  2025-12-27 08:23:38,948 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-27T08:23:38.963309283Z [err]  2025-12-27 08:23:38,948 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.7s (total: 2.4s from now)
2025-12-27T08:23:38.963313286Z [err]  2025-12-27 08:23:38,949 - persistent_tts_service - INFO - ‚úÖ Sent 38 audio chunks via WebSocket
2025-12-27T08:23:40.423854281Z [err]  2025-12-27 08:23:40,349 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.1s, checkin_count=1/2
2025-12-27T08:23:40.423858653Z [err]  2025-12-27 08:23:40,370 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.0s left)
2025-12-27T08:23:40.860319304Z [err]  2025-12-27 08:23:40,854 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.6s, checkin_count=1/2
2025-12-27T08:23:40.881628002Z [err]  2025-12-27 08:23:40,875 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=2.5s, checkin_count=0/2
2025-12-27T08:23:40.966450627Z [err]  2025-12-27 08:23:40,949 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-27T08:23:40.966456394Z [err]  2025-12-27 08:23:40,949 - persistent_tts_service - INFO - ‚úÖ [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Receiver finished sentence #1: 3 chunks in 2657ms
2025-12-27T08:23:40.966460038Z [err]  2025-12-27 08:23:40,949 - persistent_tts_service - INFO - üéß [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Receiver processing sentence #2: 'yeah it's me....'
2025-12-27T08:23:40.966464840Z [err]  2025-12-27 08:23:40,949 - persistent_tts_service - INFO - üìä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] DIAGNOSTIC: queue_latency=2654ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-27T08:23:41.542924479Z [err]  2025-12-27 08:23:41,540 - persistent_tts_service - INFO - üîá [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] FLOOR RELEASED (is_holding_floor=False)
2025-12-27T08:23:42.413051422Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:42.413069177Z [err]  2025-12-27 08:23:42,374 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2025-12-27T08:23:42.413075901Z [err]  2025-12-27 08:23:42,374 - calling_service - INFO - ü§ñ Agent started speaking for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:42.413078127Z [err]  2025-12-27 08:23:42,375 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2025-12-27T08:23:42.413083590Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - üîä Speaking text on call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA: Are you still there?...
2025-12-27T08:23:42.413089032Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-27T08:23:42.413090818Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:23:42.413098661Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:23:42.413099100Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:42.413105969Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:23:42.413112101Z [err]  2025-12-27 08:23:42,375 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:23:42.413117530Z [err]  2025-12-27 08:23:42,369 - calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-27T08:23:42.413125370Z [err]  2025-12-27 08:23:42,374 - calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2025-12-27T08:23:42.413133553Z [err]  2025-12-27 08:23:42,374 - calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2025-12-27T08:23:42.693292170Z [err]  }
2025-12-27T08:23:42.693303321Z [err]  2025-12-27 08:23:42,687 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-27T08:23:42.693314614Z [err]  2025-12-27 08:23:42,686 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:42.693318337Z [err]  2025-12-27 08:23:42,686 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.31s
2025-12-27T08:23:42.693321895Z [err]  2025-12-27 08:23:42,686 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-27T08:23:42.693325689Z [err]    "errors": [
2025-12-27T08:23:42.693329563Z [err]      {
2025-12-27T08:23:42.693333892Z [err]        "code": "90018",
2025-12-27T08:23:42.693337495Z [err]        "title": "Call has already ended",
2025-12-27T08:23:42.693341026Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-27T08:23:42.693345288Z [err]      }
2025-12-27T08:23:42.693349041Z [err]    ]
2025-12-27T08:23:42.977983845Z [err]  2025-12-27 08:23:42,975 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:42.977990060Z [err]  2025-12-27 08:23:42,975 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-27T08:23:42.977994226Z [err]  2025-12-27 08:23:42,975 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-27T08:23:43.452129205Z [err]  2025-12-27 08:23:43,450 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:23:43.452134616Z [err]  2025-12-27 08:23:43,450 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Receiver got 0 chunks for sentence #2! interrupted=False
2025-12-27T08:23:43.452139022Z [err]  2025-12-27 08:23:43,450 - persistent_tts_service - INFO - üéß [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Receiver processing sentence #3: 'You there?...'
2025-12-27T08:23:43.452143238Z [err]  2025-12-27 08:23:43,450 - persistent_tts_service - INFO - üìä [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] DIAGNOSTIC: queue_latency=5152ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-27T08:23:43.534025519Z [err]  2025-12-27 08:23:43,528 - server - INFO - üì§ Audio flowing: 569 packets sent to Soniox (5s update)
2025-12-27T08:23:43.967759422Z [err]  2025-12-27 08:23:43,963 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 583 total packets
2025-12-27T08:23:43.967764733Z [err]  [2025-12-27 08:23:43 +0000] [4] [INFO] connection closed
2025-12-27T08:23:44.165819711Z [err]  2025-12-27 08:23:44,130 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:44.165832500Z [err]  2025-12-27 08:23:44,130 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '8a23b621-822a-43a7-8948-54e55c8ad5ff', 'occurred_at': '2025-12-27T08:23:43.893915Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '560d9344-f61b-4351-acec-a4feaa3b737c', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:44.165841331Z [err]  2025-12-27 08:23:44,130 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.165850026Z [err]  2025-12-27 08:23:44,130 - server - INFO - üì® ================================================
2025-12-27T08:23:44.165858790Z [inf]  100.64.0.4:53964 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:44.165866763Z [err]  2025-12-27 08:23:44,139 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:44.165872291Z [err]  2025-12-27 08:23:44,139 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '85ab128e-2867-46bf-9490-f3d33f65dcfb', 'occurred_at': '2025-12-27T08:23:43.843293Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:43.843293Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'MVmw1L1TAA', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:44.166401418Z [err]  2025-12-27 08:23:44,139 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.166408894Z [err]  2025-12-27 08:23:44,139 - server - INFO - üì® ================================================
2025-12-27T08:23:44.166417175Z [err]  2025-12-27 08:23:44,146 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:44.166422903Z [err]  2025-12-27 08:23:44,146 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '8c5dbe49-1b6a-43f2-91db-31c00fae61e0', 'occurred_at': '2025-12-27T08:23:43.763269Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '23.84', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '639', 'skip_packet_count': '19'}, 'outbound': {'packet_count': '585', 'skip_packet_count': '0'}}, 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:43.763269Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-27T08:23:28.263270Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:44.166429679Z [err]  2025-12-27 08:23:44,146 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.166437573Z [err]  2025-12-27 08:23:44,146 - server - INFO - üì® ================================================
2025-12-27T08:23:44.166442203Z [err]  2025-12-27 08:23:44,146 - server - INFO - üìû Call ended: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.166445746Z [err]  2025-12-27 08:23:44,146 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-27T08:23:44.167204616Z [err]  2025-12-27 08:23:44,149 - redis_service - INFO - ‚ûñ Removed playback MVmw1L1TAA, 0 remaining for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.167211882Z [err]  2025-12-27 08:23:44,149 - server - INFO - üîä Redis: Removed playback MVmw1L1TAA, 0 remaining
2025-12-27T08:23:44.167218144Z [err]  2025-12-27 08:23:44,149 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-27T08:23:44.167224010Z [err]  2025-12-27 08:23:44,149 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-27T08:23:44.167229612Z [err]  2025-12-27 08:23:44,154 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-27T08:23:44.167235974Z [err]  2025-12-27 08:23:44,154 - server - INFO - ‚úÖ Found session locally: agent_speaking=False, user_speaking=False
2025-12-27T08:23:44.167242011Z [err]  2025-12-27 08:23:44,154 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823824.1548553 for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.167247363Z [err]  2025-12-27 08:23:44,154 - server - INFO - ‚è±Ô∏è Silence timer STARTED (local, agent wasn't marked as speaking)
2025-12-27T08:23:44.167252772Z [inf]  100.64.0.6:20304 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:44.459323476Z [err]  2025-12-27 08:23:44,330 - server - INFO - üìù Updated call log: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:44.459329071Z [err]  2025-12-27 08:23:44,423 - server - INFO - ‚úÖ Finalized call log: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ (duration=12s, status=completed)
2025-12-27T08:23:45.130985968Z [err]  2025-12-27 08:23:45,126 - server - INFO - üìä Auto-added call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-27T08:23:45.314612750Z [err]  2025-12-27 08:23:45,311 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-27T08:23:45.325908235Z [err]  2025-12-27 08:23:45,322 - redis_service - INFO - üì• Retrieved call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.325912376Z [err]  2025-12-27 08:23:45,322 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2025-12-27T08:23:45.325916027Z [err]  2025-12-27 08:23:45,322 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-27T08:23:45.470614600Z [err]  2025-12-27 08:23:45,414 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-27T08:23:45.505853559Z [err]  2025-12-27 08:23:45,502 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-27T08:23:45.505858162Z [err]  2025-12-27 08:23:45,502 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-27T08:23:45.505861954Z [err]  2025-12-27 08:23:45,502 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-27T08:23:45.505865765Z [err]  2025-12-27 08:23:45,502 - server - INFO - üöÄ Triggered QC analysis for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.505869771Z [err]  2025-12-27 08:23:45,502 - server - INFO - üìä Triggered Campaign QC for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.505873929Z [err]  2025-12-27 08:23:45,502 - server - INFO - üìá Triggered CRM update for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.505877654Z [err]  2025-12-27 08:23:45,502 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.510995892Z [err]  2025-12-27 08:23:45,507 - redis_service - INFO - üßπ Deleted call data from Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.511003162Z [err]  2025-12-27 08:23:45,508 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.511010974Z [inf]  100.64.0.4:53974 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:45.511017225Z [err]  2025-12-27 08:23:45,508 - server - INFO - üîç Starting QC analysis for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.511025465Z [err]  2025-12-27 08:23:45,508 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-27T08:23:45.511033283Z [err]  2025-12-27 08:23:45,508 - server - INFO - üìá CRM update starting for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:45.511047096Z [err]  2025-12-27 08:23:45,508 - server - INFO - üìá Normalized phone: +17708336397
2025-12-27T08:23:45.511051339Z [err]  2025-12-27 08:23:45,509 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-27T08:23:45.511055352Z [err]  2025-12-27 08:23:45,510 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-27T08:23:45.599992933Z [err]  2025-12-27 08:23:45,599 - server - INFO - üìù Converted transcript from 3 messages to 87 characters
2025-12-27T08:23:45.601048188Z [err]  2025-12-27 08:23:45,599 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-27T08:23:45.601053159Z [err]  2025-12-27 08:23:45,599 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '3fdd742a-1bcf-4296-a5ef-293621e3188d', 'occurred_at': '2025-12-27T08:23:45.375849Z', 'payload': {'call_control_id': 'v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ', 'call_leg_id': '522d31b8-e2fd-11f0-b251-02420aef99a0', 'call_session_id': '522a3c88-e2fd-11f0-b4c8-02420aef99a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-27T08:23:43.847598Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-27T08:23:43.847598Z', 'recording_id': '129c2e46-8665-401e-b98e-1bfe8c831eae', 'recording_started_at': '2025-12-27T08:23:32.702624Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-27/522d31b8-e2fd-11f0-b251-02420aef99a0-1766823812677431.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251227%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251227T082345Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=8e620b92dbb4d952a904b34299efb3487d2f7a45586296958405eade6623d771'}, 'start_time': '2025-12-27T08:23:32.702624Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-27T08:23:45.601057368Z [err]  2025-12-27 08:23:45,599 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.601061365Z [err]  2025-12-27 08:23:45,599 - server - INFO - üì® ================================================
2025-12-27T08:23:45.601066062Z [err]  2025-12-27 08:23:45,600 - server - INFO - üéôÔ∏è Recording saved for call: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.601076294Z [err]  2025-12-27 08:23:45,600 - server - INFO - üìá CRM: Total variables collected: []
2025-12-27T08:23:45.601670173Z [err]  2025-12-27 08:23:45,600 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=3, logs_count=4, status=completed
2025-12-27T08:23:45.606512280Z [err]  2025-12-27 08:23:45,605 - redis_service - WARNING - ‚ö†Ô∏è Call data not found in Redis: v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.606519576Z [err]  2025-12-27 08:23:45,605 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=129c2e46-8665-401e-b98e-1bfe8c831eae, call_data=True
2025-12-27T08:23:45.688791555Z [err]  2025-12-27 08:23:45,686 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-27T08:23:45.693961538Z [err]  2025-12-27 08:23:45,689 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-27T08:23:45.699470439Z [err]  2025-12-27 08:23:45,698 - server - INFO - üíæ Saved recording URL and ID to database: 129c2e46-8665-401e-b98e-1bfe8c831eae
2025-12-27T08:23:45.699479004Z [err]  2025-12-27 08:23:45,698 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-27T08:23:45.699487016Z [err]  2025-12-27 08:23:45,698 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-27T08:23:45.778502228Z [err]  2025-12-27 08:23:45,773 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-27T08:23:45.778511271Z [err]  2025-12-27 08:23:45,776 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-27T08:23:45.778517973Z [err]  2025-12-27 08:23:45,777 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-27T08:23:45.778524244Z [err]  2025-12-27 08:23:45,777 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-27T08:23:45.778530963Z [err]  2025-12-27 08:23:45,777 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-27T08:23:45.783328347Z [err]  2025-12-27 08:23:45,780 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-27T08:23:45.783334196Z [err]    File "/app/backend/server.py", line 9758, in trigger_campaign_qc_for_call
2025-12-27T08:23:45.783338304Z [err]      await run_full_qc_analysis(
2025-12-27T08:23:45.783342324Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:45.783346318Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-27T08:23:45.783350875Z [err]  
2025-12-27T08:23:45.869115392Z [err]  2025-12-27 08:23:45,860 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-27T08:23:45.869120100Z [err]  2025-12-27 08:23:45,860 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-27T08:23:45.869123942Z [err]  2025-12-27 08:23:45,860 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:45.965978670Z [err]  2025-12-27 08:23:45,949 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-27T08:23:45.965983117Z [err]  2025-12-27 08:23:45,949 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ] Receiver got 0 chunks for sentence #3! interrupted=False
2025-12-27T08:23:45.997902868Z [err]  2025-12-27 08:23:45,993 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-27/522d31b8-e2fd-11f0-b251-02420aef99a0-1766823812677431.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251227%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251227T082345Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=8e620b92dbb4d952a904b34299efb3487d2f7a45586296958405eade6623d771 "HTTP/1.1 200 OK"
2025-12-27T08:23:46.082671331Z [err]  2025-12-27 08:23:46,078 - server - INFO - ‚úÖ Downloaded 44973 bytes
2025-12-27T08:23:46.242933650Z [err]  2025-12-27 08:23:46,236 - server - INFO - ‚úÖ Split into 2 channels
2025-12-27T08:23:46.242939335Z [err]  2025-12-27 08:23:46,236 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-27T08:23:46.242943423Z [err]  2025-12-27 08:23:46,236 - server - INFO - üìä Channel 0: 243804 bytes
2025-12-27T08:23:46.471932002Z [err]  FileNotFoundError: [Errno 2] No such file or directory: 'curl'
2025-12-27T08:23:46.471940829Z [err]  
2025-12-27T08:23:46.471950677Z [err]  2025-12-27 08:23:46,329 - server - INFO - ‚ùå Channel 0: No speech
2025-12-27T08:23:46.471966615Z [err]  2025-12-27 08:23:46,324 - server - INFO - Soniox: Using user's DB API key (first 10 chars): b999f22d7b...
2025-12-27T08:23:46.471972117Z [err]  2025-12-27 08:23:46,324 - server - INFO - Soniox: Uploading audio file (0.23 MB)...
2025-12-27T08:23:46.471976679Z [err]  2025-12-27 08:23:46,327 - server - INFO - Soniox: Running curl upload command (HTTP/1.1)...
2025-12-27T08:23:46.471981248Z [err]  2025-12-27 08:23:46,328 - server - ERROR - Error transcribing audio file with Soniox: [Errno 2] No such file or directory: 'curl'
2025-12-27T08:23:46.471990068Z [err]  2025-12-27 08:23:46,329 - server - ERROR - Traceback (most recent call last):
2025-12-27T08:23:46.471994956Z [err]    File "/app/backend/server.py", line 6024, in transcribe_audio_soniox_file
2025-12-27T08:23:46.471999190Z [err]      result = subprocess.run(curl_cmd, capture_output=True, text=True, timeout=300)
2025-12-27T08:23:46.472003978Z [err]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:46.472008500Z [err]    File "/usr/local/lib/python3.11/subprocess.py", line 548, in run
2025-12-27T08:23:46.472013402Z [err]      with Popen(*popenargs, **kwargs) as process:
2025-12-27T08:23:46.472018256Z [err]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:46.472022645Z [err]    File "/usr/local/lib/python3.11/subprocess.py", line 1026, in __init__
2025-12-27T08:23:46.472026618Z [err]      self._execute_child(args, executable, preexec_fn, close_fds,
2025-12-27T08:23:46.472030535Z [err]    File "/usr/local/lib/python3.11/subprocess.py", line 1955, in _execute_child
2025-12-27T08:23:46.472034245Z [err]      raise child_exception_type(errno_num, err_msg, err_filename)
2025-12-27T08:23:46.472392625Z [err]  2025-12-27 08:23:46,329 - server - INFO - üìä Channel 1: 243804 bytes
2025-12-27T08:23:46.472403125Z [err]  2025-12-27 08:23:46,417 - server - INFO - Soniox: Using user's DB API key (first 10 chars): b999f22d7b...
2025-12-27T08:23:46.472410012Z [err]  2025-12-27 08:23:46,417 - server - INFO - Soniox: Uploading audio file (0.23 MB)...
2025-12-27T08:23:46.472415760Z [err]  2025-12-27 08:23:46,417 - server - INFO - Soniox: Running curl upload command (HTTP/1.1)...
2025-12-27T08:23:46.472421109Z [err]  2025-12-27 08:23:46,418 - server - ERROR - Error transcribing audio file with Soniox: [Errno 2] No such file or directory: 'curl'
2025-12-27T08:23:46.472426535Z [err]  2025-12-27 08:23:46,419 - server - ERROR - Traceback (most recent call last):
2025-12-27T08:23:46.472433674Z [err]    File "/app/backend/server.py", line 6024, in transcribe_audio_soniox_file
2025-12-27T08:23:46.472434329Z [err]  
2025-12-27T08:23:46.472441252Z [err]      result = subprocess.run(curl_cmd, capture_output=True, text=True, timeout=300)
2025-12-27T08:23:46.472441982Z [err]  2025-12-27 08:23:46,419 - server - INFO - ‚ùå Channel 1: No speech
2025-12-27T08:23:46.472449529Z [err]  2025-12-27 08:23:46,419 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-27T08:23:46.472451656Z [err]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:46.472455567Z [inf]  100.64.0.6:20304 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-27T08:23:46.472459880Z [err]    File "/usr/local/lib/python3.11/subprocess.py", line 548, in run
2025-12-27T08:23:46.472465730Z [err]      with Popen(*popenargs, **kwargs) as process:
2025-12-27T08:23:46.472471166Z [err]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-12-27T08:23:46.472476901Z [err]    File "/usr/local/lib/python3.11/subprocess.py", line 1026, in __init__
2025-12-27T08:23:46.472482865Z [err]      self._execute_child(args, executable, preexec_fn, close_fds,
2025-12-27T08:23:46.472490054Z [err]    File "/usr/local/lib/python3.11/subprocess.py", line 1955, in _execute_child
2025-12-27T08:23:46.472495997Z [err]      raise child_exception_type(errno_num, err_msg, err_filename)
2025-12-27T08:23:46.472502015Z [err]  FileNotFoundError: [Errno 2] No such file or directory: 'curl'
2025-12-27T08:23:46.509235789Z [err]  2025-12-27 08:23:46,503 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:46.509243453Z [err]  2025-12-27 08:23:46,503 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:vvYNT6U9Xv9siuf449TxjD_X5jk0fvYlF4q4U_JPIaGE1vmwY-8PpA
2025-12-27T08:23:46.509249201Z [err]  2025-12-27 08:23:46,503 - server - INFO - üîá Dead air monitoring task cancelled
2025-12-27T08:23:46.509270782Z [err]  2025-12-27 08:23:46,503 - server - INFO - üé§ Soniox receiver alive - 1 messages received in last 10s
2025-12-27T08:23:46.509274931Z [err]  2025-12-27 08:23:46,503 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 8040, 'total_audio_proc_ms': 11160, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-27T08:23:46.509280132Z [err]  2025-12-27 08:23:46,503 - server - INFO - ‚úÖ Soniox receive loop ended normally
2025-12-27T08:23:48.512249741Z [err]  2025-12-27 08:23:48,503 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-27T08:23:48.512258072Z [err]  2025-12-27 08:23:48,503 - server - INFO - üîå Telnyx WebSocket disconnected
2025-12-27T08:23:50.099820211Z [err]  2025-12-27 08:23:50,092 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.9s, checkin_count=0/2
2025-12-27T08:23:50.162884543Z [err]  2025-12-27 08:23:50,156 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:50.162889982Z [err]  2025-12-27 08:23:50,160 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-27T08:23:50.162894024Z [err]  2025-12-27 08:23:50,160 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:50.634812094Z [err]  2025-12-27 08:23:50,598 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=6.4s, checkin_count=0/2
2025-12-27T08:23:51.636943455Z [err]  2025-12-27 08:23:51,614 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2025-12-27T08:23:51.636957943Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-27T08:23:51.636968093Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:51.636974351Z [err]  2025-12-27 08:23:51,608 - calling_service - INFO - ‚è∞ Check-in triggered after 7.5s silence (threshold: 7s)
2025-12-27T08:23:51.636981507Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:51.636982668Z [err]  2025-12-27 08:23:51,613 - calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-27T08:23:51.636988857Z [err]  2025-12-27 08:23:51,614 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.5s silence: Are you still there?
2025-12-27T08:23:51.636995008Z [err]  2025-12-27 08:23:51,614 - calling_service - INFO - ü§ñ Agent started speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:51.637000430Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - üîä Speaking text on call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: Are you still there?...
2025-12-27T08:23:51.637006050Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:23:51.637011712Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:23:51.637017656Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:23:51.637024154Z [err]  2025-12-27 08:23:51,614 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:23:51.906713202Z [err]  2025-12-27 08:23:51,905 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-27T08:23:51.906756084Z [err]  2025-12-27 08:23:51,904 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:51.906762643Z [err]  2025-12-27 08:23:51,904 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.29s
2025-12-27T08:23:51.906769159Z [err]  2025-12-27 08:23:51,905 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-27T08:23:51.906775764Z [err]    "errors": [
2025-12-27T08:23:51.906782000Z [err]      {
2025-12-27T08:23:51.906788016Z [err]        "code": "90018",
2025-12-27T08:23:51.906793683Z [err]        "title": "Call has already ended",
2025-12-27T08:23:51.906797416Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-27T08:23:51.906801526Z [err]      }
2025-12-27T08:23:51.906807117Z [err]    ]
2025-12-27T08:23:51.906811086Z [err]  }
2025-12-27T08:23:51.927628951Z [err]  2025-12-27 08:23:51,925 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:51.932417704Z [err]  2025-12-27 08:23:51,929 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-27T08:23:51.932426908Z [err]  2025-12-27 08:23:51,929 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:52.192622836Z [err]  2025-12-27 08:23:52,177 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:23:52.192628007Z [err]  2025-12-27 08:23:52,177 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-27T08:23:52.192631960Z [err]  2025-12-27 08:23:52,177 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-27T08:23:52.689443228Z [err]  2025-12-27 08:23:52,684 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-27T08:23:52.689447224Z [err]  2025-12-27 08:23:52,684 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766823832.6846855 for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:52.689451208Z [err]  2025-12-27 08:23:52,684 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:54.652832288Z [err]  2025-12-27 08:23:54,647 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-27T08:23:54.652836144Z [err]  2025-12-27 08:23:54,651 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-27T08:23:54.751288548Z [err]  2025-12-27 08:23:54,741 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:54.751294654Z [err]  2025-12-27 08:23:54,742 - server - INFO - ‚úÖ QC analysis completed for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:54.751299148Z [err]  2025-12-27 08:23:54,742 - server - INFO - üìä Scores: Commitment=50, Conversion=0, Excellence=50
2025-12-27T08:23:54.937134858Z [err]  2025-12-27 08:23:54,923 - server - INFO - üìä Updated campaign_calls with QC scores for v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:55.123705688Z [err]  2025-12-27 08:23:55,099 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-27T08:23:55.194253036Z [err]  2025-12-27 08:23:55,186 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-27T08:23:55.194257663Z [err]  2025-12-27 08:23:55,186 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: 'str' object has no attribute 'get'
2025-12-27T08:23:59.789928782Z [err]  2025-12-27 08:23:59,772 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-27T08:23:59.789941411Z [err]  2025-12-27 08:23:59,772 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2025-12-27T08:23:59.789953159Z [err]  2025-12-27 08:23:59,772 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-27T08:23:59.789953349Z [err]  2025-12-27 08:23:59,767 - calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-27T08:23:59.789962689Z [err]  2025-12-27 08:23:59,772 - calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2025-12-27T08:23:59.789963492Z [err]  2025-12-27 08:23:59,773 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:59.789972448Z [err]  2025-12-27 08:23:59,772 - calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2025-12-27T08:23:59.789973019Z [err]  2025-12-27 08:23:59,773 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-27T08:23:59.789977413Z [err]  2025-12-27 08:23:59,772 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2025-12-27T08:23:59.789981661Z [err]  2025-12-27 08:23:59,772 - calling_service - INFO - ü§ñ Agent started speaking for call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ
2025-12-27T08:23:59.789986361Z [err]  2025-12-27 08:23:59,772 - telnyx_service - INFO - üîä Speaking text on call v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ: Are you still there?...
2025-12-27T08:23:59.789990810Z [err]  2025-12-27 08:23:59,772 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-27T08:23:59.789995428Z [err]  2025-12-27 08:23:59,772 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-27T08:23:59.789999682Z [err]  2025-12-27 08:23:59,772 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-27T08:24:00.072987275Z [err]  2025-12-27 08:24:00,070 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:24:00.072998154Z [err]  2025-12-27 08:24:00,070 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.30s
2025-12-27T08:24:00.073005061Z [err]  2025-12-27 08:24:00,070 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-27T08:24:00.073014451Z [err]    "errors": [
2025-12-27T08:24:00.073020893Z [err]      {
2025-12-27T08:24:00.073038845Z [err]        "code": "90018",
2025-12-27T08:24:00.073046159Z [err]        "title": "Call has already ended",
2025-12-27T08:24:00.073052385Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-27T08:24:00.073058925Z [err]      }
2025-12-27T08:24:00.073065557Z [err]    ]
2025-12-27T08:24:00.073075232Z [err]  }
2025-12-27T08:24:00.073081617Z [err]  2025-12-27 08:24:00,071 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-27T08:24:00.350777461Z [err]  2025-12-27 08:24:00,345 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:Dw4NX6yRgKBuko_0AbHUUk6MraZmLNCQ6EyNNltaScQcMaPqdcT8jQ/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-27T08:24:00.350783417Z [err]  2025-12-27 08:24:00,346 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-27T08:24:00.350787327Z [err]  2025-12-27 08:24:00,346 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-27T08:24:00.860440857Z [err]  2025-12-27 08:24:00,856 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2