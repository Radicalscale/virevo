2025-12-30T07:17:44.000000000Z [inf]  Starting Container
2025-12-30T07:17:44.823308649Z [inf]  =========================================
2025-12-30T07:17:44.823318009Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2025-12-30T07:17:44.823323909Z [inf]  =========================================
2025-12-30T07:17:44.823328631Z [inf]  üìç Working directory: /app/backend
2025-12-30T07:17:44.823333577Z [inf]  üîç Python path: /app/backend
2025-12-30T07:17:44.823338902Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2025-12-30T07:17:44.823342859Z [inf]  =========================================
2025-12-30T07:17:45.366833638Z [err]  [2025-12-30 07:17:45 +0000] [1] [INFO] Starting gunicorn 22.0.0
2025-12-30T07:17:45.366837927Z [err]  [2025-12-30 07:17:45 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2025-12-30T07:17:45.366849136Z [err]  [2025-12-30 07:17:45 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-30T07:17:45.366854581Z [err]  [2025-12-30 07:17:45 +0000] [3] [INFO] Booting worker with pid: 3
2025-12-30T07:17:45.632724756Z [err]  [2025-12-30 07:17:45 +0000] [4] [INFO] Booting worker with pid: 4
2025-12-30T07:17:45.632816081Z [err]  [2025-12-30 07:17:45 +0000] [5] [INFO] Booting worker with pid: 5
2025-12-30T07:17:45.695044959Z [err]  [2025-12-30 07:17:45 +0000] [6] [INFO] Booting worker with pid: 6
2025-12-30T07:18:05.884787802Z [err]  ‚ö†Ô∏è Could not import RAG service: error returned from database: (code: 1) table collections already exists
2025-12-30T07:18:05.884802914Z [err]  2025-12-30 07:17:58,582 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-30T07:18:05.884813477Z [err]  2025-12-30 07:17:58,582 - server - INFO - üî• Pre-warming connection libraries...
2025-12-30T07:18:05.884821531Z [err]  2025-12-30 07:17:58,612 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-30T07:18:05.884830351Z [err]  2025-12-30 07:17:58,732 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-30T07:18:05.884843569Z [err]  2025-12-30 07:17:58,832 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-30T07:18:05.884851461Z [err]  2025-12-30 07:17:58,870 - server - INFO - ‚úÖ QC agent router loaded
2025-12-30T07:18:05.884859826Z [err]  2025-12-30 07:17:58,895 - server - INFO - ‚úÖ QC learning router loaded
2025-12-30T07:18:05.884867000Z [err]  2025-12-30 07:17:58,988 - server - INFO - ‚úÖ CRM router loaded
2025-12-30T07:18:05.884875546Z [err]  2025-12-30 07:17:59,000 - server - INFO - ‚úÖ QC test router loaded
2025-12-30T07:18:05.884883344Z [err]  2025-12-30 07:17:59,021 - server - INFO - ‚úÖ Agent test router loaded
2025-12-30T07:18:05.884890384Z [err]  2025-12-30 07:17:59,033 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-30T07:18:05.884898216Z [err]  2025-12-30 07:17:59,033 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-30T07:18:05.884906740Z [err]  [2025-12-30 07:17:59 +0000] [3] [INFO] Started server process [3]
2025-12-30T07:18:05.884913799Z [err]  [2025-12-30 07:17:59 +0000] [3] [INFO] Waiting for application startup.
2025-12-30T07:18:05.884925203Z [err]  2025-12-30 07:17:59,057 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-30T07:18:05.884933199Z [err]  2025-12-30 07:18:03,103 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-30T07:18:05.884941273Z [err]  2025-12-30 07:18:03,103 - server - INFO - üî• Pre-warming connection libraries...
2025-12-30T07:18:05.884949694Z [err]  2025-12-30 07:18:03,103 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-30T07:18:05.884957080Z [err]  2025-12-30 07:18:03,104 - server - INFO - üî• Pre-warming connection libraries...
2025-12-30T07:18:05.884964214Z [err]  2025-12-30 07:18:03,129 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-30T07:18:05.884971214Z [err]  2025-12-30 07:18:03,131 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-30T07:18:05.884979171Z [err]  2025-12-30 07:18:03,135 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-30T07:18:05.884987328Z [err]  2025-12-30 07:18:03,135 - server - INFO - üî• Pre-warming connection libraries...
2025-12-30T07:18:05.884994786Z [err]  2025-12-30 07:18:03,161 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-30T07:18:05.885001982Z [err]  2025-12-30 07:18:03,231 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-30T07:18:05.885009653Z [err]  2025-12-30 07:18:03,242 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-30T07:18:05.885016658Z [err]  2025-12-30 07:18:03,280 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-30T07:18:05.885023972Z [err]  2025-12-30 07:18:03,282 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-30T07:18:05.885031160Z [err]  2025-12-30 07:18:03,293 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-30T07:18:05.885040481Z [err]  2025-12-30 07:18:03,318 - server - INFO - ‚úÖ QC agent router loaded
2025-12-30T07:18:05.885048903Z [err]  2025-12-30 07:18:03,328 - server - INFO - ‚úÖ QC agent router loaded
2025-12-30T07:18:05.885056880Z [err]  2025-12-30 07:18:03,330 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-30T07:18:05.885066609Z [err]  2025-12-30 07:18:03,341 - server - INFO - ‚úÖ QC learning router loaded
2025-12-30T07:18:05.885074939Z [err]  2025-12-30 07:18:03,346 - server - INFO - ‚úÖ QC learning router loaded
2025-12-30T07:18:05.885082640Z [err]  2025-12-30 07:18:03,366 - server - INFO - ‚úÖ QC agent router loaded
2025-12-30T07:18:05.885089930Z [err]  2025-12-30 07:18:03,387 - server - INFO - ‚úÖ QC learning router loaded
2025-12-30T07:18:05.885099070Z [err]  2025-12-30 07:18:03,438 - server - INFO - ‚úÖ CRM router loaded
2025-12-30T07:18:05.885107095Z [err]  2025-12-30 07:18:03,442 - server - INFO - ‚úÖ QC test router loaded
2025-12-30T07:18:05.885115123Z [err]  2025-12-30 07:18:03,445 - server - INFO - ‚úÖ CRM router loaded
2025-12-30T07:18:05.885122727Z [err]  2025-12-30 07:18:03,449 - server - INFO - ‚úÖ QC test router loaded
2025-12-30T07:18:05.885130797Z [err]  2025-12-30 07:18:03,454 - server - INFO - ‚úÖ Agent test router loaded
2025-12-30T07:18:05.885138526Z [err]  2025-12-30 07:18:03,461 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-30T07:18:05.885145775Z [err]  2025-12-30 07:18:03,461 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-30T07:18:05.885153035Z [err]  2025-12-30 07:18:03,461 - server - INFO - ‚úÖ Agent test router loaded
2025-12-30T07:18:05.885160816Z [err]  2025-12-30 07:18:03,467 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-30T07:18:05.885167962Z [err]  2025-12-30 07:18:03,467 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-30T07:18:05.885174946Z [err]  [2025-12-30 07:18:03 +0000] [4] [INFO] Started server process [4]
2025-12-30T07:18:05.885182398Z [err]  [2025-12-30 07:18:03 +0000] [4] [INFO] Waiting for application startup.
2025-12-30T07:18:05.885189588Z [err]  2025-12-30 07:18:03,481 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-30T07:18:05.885197705Z [err]  [2025-12-30 07:18:03 +0000] [5] [INFO] Started server process [5]
2025-12-30T07:18:05.885204929Z [err]  [2025-12-30 07:18:03 +0000] [5] [INFO] Waiting for application startup.
2025-12-30T07:18:05.885212836Z [err]  2025-12-30 07:18:03,484 - server - INFO - ‚úÖ CRM router loaded
2025-12-30T07:18:05.885223172Z [err]  2025-12-30 07:18:03,487 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-30T07:18:05.885230089Z [err]  2025-12-30 07:18:03,487 - server - INFO - ‚úÖ QC test router loaded
2025-12-30T07:18:05.885237120Z [err]  2025-12-30 07:18:03,500 - server - INFO - ‚úÖ Agent test router loaded
2025-12-30T07:18:05.885244311Z [err]  2025-12-30 07:18:03,506 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-30T07:18:05.885251298Z [err]  2025-12-30 07:18:03,506 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-30T07:18:05.885258671Z [err]  [2025-12-30 07:18:03 +0000] [6] [INFO] Started server process [6]
2025-12-30T07:18:05.885265574Z [err]  [2025-12-30 07:18:03 +0000] [6] [INFO] Waiting for application startup.
2025-12-30T07:18:05.885272337Z [err]  2025-12-30 07:18:03,526 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-30T07:18:06.493308359Z [err]  2025-12-30 07:18:06,392 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-30T07:18:06.493315120Z [err]  2025-12-30 07:18:06,392 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-30T07:18:06.493320331Z [err]  2025-12-30 07:18:06,392 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-30T07:18:06.493430593Z [err]  2025-12-30 07:18:06,391 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-30T07:18:07.276381981Z [err]  2025-12-30 07:18:07,118 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-30T07:18:07.532494152Z [err]  2025-12-30 07:18:07,429 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-30T07:18:07.532499501Z [err]  2025-12-30 07:18:07,429 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-30T07:18:07.532505282Z [err]  [2025-12-30 07:18:07 +0000] [3] [INFO] Application startup complete.
2025-12-30T07:18:10.838302116Z [err]  2025-12-30 07:18:10,824 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-30T07:18:10.838314057Z [err]  2025-12-30 07:18:10,824 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-30T07:18:10.838401621Z [err]  2025-12-30 07:18:10,824 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-30T07:18:10.838409569Z [err]  2025-12-30 07:18:10,824 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-30T07:18:10.885608495Z [err]  2025-12-30 07:18:10,883 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-30T07:18:10.885617381Z [err]  2025-12-30 07:18:10,883 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-30T07:18:10.885626225Z [err]  2025-12-30 07:18:10,883 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-30T07:18:10.885633507Z [err]  2025-12-30 07:18:10,883 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-30T07:18:10.995134608Z [err]  2025-12-30 07:18:10,986 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-30T07:18:10.995141550Z [err]  2025-12-30 07:18:10,986 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-30T07:18:10.995147130Z [err]  2025-12-30 07:18:10,986 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-30T07:18:10.995152685Z [err]  2025-12-30 07:18:10,986 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-30T07:18:11.575395814Z [err]  2025-12-30 07:18:11,517 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-30T07:18:11.605274058Z [err]  2025-12-30 07:18:11,601 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-30T07:18:11.605284523Z [err]  2025-12-30 07:18:11,601 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-30T07:18:11.605291914Z [err]  [2025-12-30 07:18:11 +0000] [6] [INFO] Application startup complete.
2025-12-30T07:18:11.609444612Z [err]  2025-12-30 07:18:11,605 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-30T07:18:11.669278141Z [err]  2025-12-30 07:18:11,666 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-30T07:18:11.707488846Z [err]  2025-12-30 07:18:11,689 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-30T07:18:11.707494233Z [err]  2025-12-30 07:18:11,689 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-30T07:18:11.707498543Z [err]  [2025-12-30 07:18:11 +0000] [4] [INFO] Application startup complete.
2025-12-30T07:18:11.765556139Z [err]  2025-12-30 07:18:11,748 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-30T07:18:11.765566353Z [err]  2025-12-30 07:18:11,748 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-30T07:18:11.765576227Z [err]  [2025-12-30 07:18:11 +0000] [5] [INFO] Application startup complete.
2025-12-30T09:12:53.651586353Z [inf]  100.64.0.2:31364 - "GET / HTTP/1.1" 404
2025-12-30T11:44:11.786221414Z [inf]  100.64.0.3:14470 - "GET /robots.txt HTTP/1.1" 404
2025-12-30T11:44:11.786227007Z [inf]  100.64.0.3:14470 - "GET /api/auth/me HTTP/1.1" 401
2025-12-30T15:11:24.508382051Z [inf]  100.64.0.4:34156 - "GET / HTTP/1.1" 404
2025-12-30T15:11:24.508389151Z [inf]  100.64.0.4:34156 - "GET //xmlrpc.php?rsd HTTP/1.1" 404
2025-12-30T15:11:24.508395506Z [inf]  100.64.0.4:34156 - "GET //blog/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:24.508402113Z [inf]  100.64.0.4:34156 - "GET //wordpress/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:25.053656266Z [inf]  100.64.0.5:44234 - "GET //wp/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:25.601504125Z [inf]  100.64.0.6:47786 - "GET //2018/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:26.131454347Z [inf]  100.64.0.7:59604 - "GET //shop/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:26.733071099Z [inf]  100.64.0.8:13668 - "GET //test/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:26.895742150Z [inf]  100.64.0.8:13668 - "GET //wp2/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T15:11:27.371814520Z [inf]  100.64.0.3:12038 - "GET //cms/wp-includes/wlwmanifest.xml HTTP/1.1" 404
2025-12-30T16:18:35.447771870Z [inf]  100.64.0.9:25770 - "GET / HTTP/1.1" 404
2025-12-30T17:51:49.531256752Z [inf]  100.64.0.2:36942 - "GET /.env HTTP/1.1" 404
2025-12-30T17:58:00.694146707Z [inf]  100.64.0.4:34136 - "GET /api/auth/me HTTP/1.1" 401
2025-12-30T17:58:00.694153165Z [inf]  100.64.0.9:10508 - "OPTIONS /api/auth/login HTTP/1.1" 200
2025-12-30T17:58:00.694157438Z [inf]  100.64.0.9:10508 - "POST /api/auth/login HTTP/1.1" 200
2025-12-30T17:58:00.694161998Z [inf]  100.64.0.9:10508 - "GET /api/agents HTTP/1.1" 200
2025-12-30T18:44:37.322254295Z [inf]  100.64.0.10:34500 - "GET / HTTP/1.1" 404
2025-12-30T18:51:27.921724338Z [inf]  100.64.0.9:27710 - "GET /api/auth/me HTTP/1.1" 401
2025-12-30T18:51:27.921734155Z [inf]  100.64.0.7:38284 - "OPTIONS /api/auth/login HTTP/1.1" 200
2025-12-30T18:51:27.921741280Z [inf]  100.64.0.3:45728 - "POST /api/auth/login HTTP/1.1" 200
2025-12-30T18:51:27.921747390Z [inf]  100.64.0.3:45728 - "GET /api/agents HTTP/1.1" 200
2025-12-30T18:51:27.921753194Z [inf]  100.64.0.3:45728 - "GET /api/agents HTTP/1.1" 200
2025-12-30T18:51:47.895491855Z [inf]  100.64.0.9:27710 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-30T18:51:47.895497471Z [err]  2025-12-30 18:51:40,064 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-30T18:51:47.895501384Z [err]  2025-12-30 18:51:40,271 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:47.895504849Z [err]  2025-12-30 18:51:40,358 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:47.895508412Z [err]  2025-12-30 18:51:40,383 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-30T18:51:47.895513480Z [err]  2025-12-30 18:51:40,383 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-30T18:51:47.895517594Z [err]  2025-12-30 18:51:40,383 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-30T18:51:47.895521836Z [err]  2025-12-30 18:51:40,383 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-30T18:51:47.895527999Z [err]  2025-12-30 18:51:41,256 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-30T18:51:47.895531557Z [err]  2025-12-30 18:51:41,258 - telnyx_service - INFO - ‚úÖ Call initiated: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.895534885Z [err]  2025-12-30 18:51:41,361 - server - INFO - üìù Created call log: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.895538294Z [err]  2025-12-30 18:51:41,362 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-30T18:51:47.895541839Z [err]  2025-12-30 18:51:41,362 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-30T18:51:47.895766608Z [err]  2025-12-30 18:51:41,362 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-30T18:51:47.895773735Z [err]  2025-12-30 18:51:41,362 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-30T18:51:47.895777972Z [err]  2025-12-30 18:51:41,391 - redis_service - INFO - üì¶ Stored call data in Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (TTL: 3600s)
2025-12-30T18:51:47.895782638Z [err]  2025-12-30 18:51:41,392 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-30T18:51:47.895787435Z [err]  2025-12-30 18:51:41,392 - server - INFO - üìû Outbound call initiated: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.895791212Z [inf]  100.64.0.5:27450 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-30T18:51:47.895795009Z [err]  2025-12-30 18:51:41,604 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-30T18:51:47.895798720Z [err]  2025-12-30 18:51:41,605 - server - INFO -    Client: Address(host='100.64.0.11', port=52026)
2025-12-30T18:51:47.895802466Z [err]  2025-12-30 18:51:41,605 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'O7ZAUPsxK+vy4G0xh4mITw==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'ctYEdoRSSBCzsYMUnpoFkQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1767120701360', 'accept-encoding': 'gzip'}
2025-12-30T18:51:47.895806465Z [err]  2025-12-30 18:51:41,605 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-30T18:51:47.895810624Z [err]  2025-12-30 18:51:41,605 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-30T18:51:47.896192617Z [err]  [2025-12-30 18:51:41 +0000] [5] [INFO] ('100.64.0.11', 52026) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-30T18:51:47.896196994Z [err]  2025-12-30 18:51:41,605 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-30T18:51:47.896200656Z [err]  [2025-12-30 18:51:41 +0000] [5] [INFO] connection open
2025-12-30T18:51:47.896204155Z [err]  2025-12-30 18:51:41,651 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:47.896209864Z [err]  2025-12-30 18:51:41,652 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': 'e21fa678-77bf-4ecb-aeea-42ef543b3ec1', 'occurred_at': '2025-12-30T18:51:41.043243Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:47.896216399Z [err]  2025-12-30 18:51:41,652 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.896220064Z [err]  2025-12-30 18:51:41,652 - server - INFO - üì® ================================================
2025-12-30T18:51:47.896223521Z [err]  2025-12-30 18:51:41,652 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-30T18:51:47.896226950Z [inf]  100.64.0.11:52036 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:47.896231889Z [err]  2025-12-30 18:51:41,770 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-30T18:51:47.896237090Z [err]  2025-12-30 18:51:41,770 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-30T18:51:47.896744481Z [err]  2025-12-30 18:51:42,109 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-30T18:51:47.896752861Z [err]  2025-12-30 18:51:42,109 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-30T18:51:47.896759536Z [err]  2025-12-30 18:51:44,692 - server - INFO - üì¨ Received Telnyx event: start
2025-12-30T18:51:47.896766094Z [err]  2025-12-30 18:51:44,692 - server - INFO - üé¨ Stream started for call: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.896773711Z [err]  2025-12-30 18:51:44,720 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.896780044Z [err]  2025-12-30 18:51:44,722 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-30T18:51:47.896786139Z [err]  2025-12-30 18:51:44,722 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-30T18:51:47.896792038Z [err]  2025-12-30 18:51:45,144 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:47.896797689Z [err]  2025-12-30 18:51:45,144 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'cb02e004-ebdc-4b61-a82b-7a7d5d106f36', 'occurred_at': '2025-12-30T18:51:44.463236Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-30T18:51:41.043243Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:47.896803467Z [err]  2025-12-30 18:51:45,144 - server - INFO - üéØ Event type: call.answered, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.897051571Z [err]  2025-12-30 18:51:45,144 - server - INFO - üì® ================================================
2025-12-30T18:51:47.897058339Z [err]  2025-12-30 18:51:45,144 - server - INFO - ‚úÖ Call answered: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.897064369Z [err]  2025-12-30 18:51:45,172 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.897070579Z [err]  2025-12-30 18:51:45,173 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-30T18:51:47.897076483Z [err]  2025-12-30 18:51:45,173 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-30T18:51:47.897082651Z [err]  2025-12-30 18:51:45,222 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-30T18:51:47.897088926Z [err]  2025-12-30 18:51:45,222 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-30T18:51:47.897096143Z [err]  2025-12-30 18:51:45,236 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.897102043Z [err]  2025-12-30 18:51:45,237 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-30T18:51:47.897108067Z [err]  2025-12-30 18:51:45,237 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-30T18:51:47.897113917Z [err]  2025-12-30 18:51:45,338 - core_calling_service - INFO - üîç KB count query completed: 4 items
2025-12-30T18:51:47.897120231Z [err]  2025-12-30 18:51:45,338 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-30T18:51:47.897125947Z [err]  2025-12-30 18:51:45,394 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:47.897388453Z [err]  2025-12-30 18:51:45,394 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'ac492f94-e0be-4ba6-93c4-0dfcfe2ad737', 'occurred_at': '2025-12-30T18:51:44.843263Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '13f7e234-96a9-48cd-986b-703e9e403304', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:47.897392631Z [err]  2025-12-30 18:51:45,547 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 96ms
2025-12-30T18:51:47.897398069Z [err]  2025-12-30 18:51:45,394 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.897403656Z [err]  2025-12-30 18:51:45,547 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-30T18:51:47.897406496Z [err]  2025-12-30 18:51:45,394 - server - INFO - üì® ================================================
2025-12-30T18:51:47.897416214Z [inf]  100.64.0.13:48864 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:47.897422307Z [err]  2025-12-30 18:51:45,449 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-30T18:51:47.897427084Z [err]  2025-12-30 18:51:45,449 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-30T18:51:47.897430733Z [err]  2025-12-30 18:51:45,450 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-30T18:51:47.897434096Z [err]  2025-12-30 18:51:45,539 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:47.898064362Z [err]  2025-12-30 18:51:45,547 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-30T18:51:47.898065282Z [err]  2025-12-30 18:51:46,139 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:47.898071324Z [err]  2025-12-30 18:51:45,547 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-30T18:51:47.898073239Z [err]  2025-12-30 18:51:46,227 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:47.898075292Z [err]  2025-12-30 18:51:45,550 - server - INFO - ‚úÖ Initialized call_states for v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA with session reference
2025-12-30T18:51:47.898077343Z [err]  2025-12-30 18:51:45,547 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-30T18:51:47.898084345Z [err]  2025-12-30 18:51:46,227 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-30T18:51:47.898085667Z [err]  2025-12-30 18:51:45,555 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-30T18:51:47.898092715Z [err]  2025-12-30 18:51:46,246 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-30T18:51:47.898094410Z [err]  2025-12-30 18:51:46,049 - server - INFO - ‚úÖ Call log updated
2025-12-30T18:51:47.898099839Z [err]  2025-12-30 18:51:46,049 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-30T18:51:47.898103535Z [err]  2025-12-30 18:51:46,050 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-30T18:51:47.898107389Z [err]  2025-12-30 18:51:46,050 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-30T18:51:47.898453234Z [err]  2025-12-30 18:51:46,391 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-30T18:51:47.898463223Z [err]  2025-12-30 18:51:46,466 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA/actions/playback_start "HTTP/1.1 200 OK"
2025-12-30T18:51:47.898476075Z [err]  2025-12-30 18:51:46,466 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: sA3-2oUX9w (loop=True, overlay=True)
2025-12-30T18:51:47.898486597Z [err]  2025-12-30 18:51:46,467 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA'
2025-12-30T18:51:47.898494228Z [err]  2025-12-30 18:51:46,467 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.898502233Z [err]  2025-12-30 18:51:46,959 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-30T18:51:47.898509082Z [err]  2025-12-30 18:51:46,959 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-30T18:51:47.898515974Z [err]  2025-12-30 18:51:46,959 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-30T18:51:47.898524761Z [err]  2025-12-30 18:51:46,982 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-30T18:51:47.898532231Z [err]  2025-12-30 18:51:46,982 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.898539093Z [err]  2025-12-30 18:51:46,987 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:47.898547855Z [err]  2025-12-30 18:51:46,987 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-30T18:51:47.898671863Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - ‚è±Ô∏è [18:51:47.619] üîÄ Agent type: call_flow, calling flow processor...
2025-12-30T18:51:47.898678829Z [err]  2025-12-30 18:51:47,611 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-30T18:51:47.898680958Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - ‚è±Ô∏è [18:51:47.619] üîÄ _process_call_flow_streaming() ENTRY
2025-12-30T18:51:47.898684973Z [err]  2025-12-30 18:51:47,611 - core_calling_service - INFO - ‚è±Ô∏è [18:51:47.611] üì• process_user_input() ENTRY - text: '...'
2025-12-30T18:51:47.898690009Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-30T18:51:47.898692586Z [err]  2025-12-30 18:51:47,618 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.898700101Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - ‚è±Ô∏è [18:51:47.619] ‚è© About to call _process_call_flow_streaming()
2025-12-30T18:51:47.898701556Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - ‚è±Ô∏è [18:51:47.619] ‚úÖ Node selected, about to process content...
2025-12-30T18:51:47.898718741Z [err]  2025-12-30 18:51:47,492 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:47.898727003Z [err]  2025-12-30 18:51:47,579 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.898734351Z [err]  2025-12-30 18:51:47,586 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.898741380Z [err]  2025-12-30 18:51:47,611 - redis_service - INFO - üì¶ Stored call data in Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (TTL: 3600s)
2025-12-30T18:51:47.899056200Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-30T18:51:47.899060728Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-30T18:51:47.899062939Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-30T18:51:47.899069140Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-30T18:51:47.899069270Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-30T18:51:47.899073908Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{now}} with Tuesday, December 30, 2025 at 1:51 PM EST in content
2025-12-30T18:51:47.899075353Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-30T18:51:47.899078460Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-30T18:51:47.899080959Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-30T18:51:47.899087498Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-30T18:51:47.899088074Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-30T18:51:47.899095101Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-30T18:51:47.899101646Z [err]  2025-12-30 18:51:47,619 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-30T18:51:47.899441466Z [err]  2025-12-30 18:51:47,620 - core_calling_service - INFO - ‚è±Ô∏è [18:51:47.619] üìÑ About to process content (mode=script, length=9)
2025-12-30T18:51:47.899451121Z [err]  2025-12-30 18:51:47,620 - core_calling_service - INFO - üîä Silence tracking reset for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (user responded)
2025-12-30T18:51:47.899453508Z [err]  2025-12-30 18:51:47,722 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-30T18:51:47.899458846Z [err]  2025-12-30 18:51:47,620 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-30T18:51:47.899465096Z [err]  2025-12-30 18:51:47,722 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-30T18:51:47.899466811Z [err]  2025-12-30 18:51:47,722 - server - INFO - ‚è±Ô∏è [18:51:47.722] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-30T18:51:47.899468402Z [err]  2025-12-30 18:51:47,620 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-30T18:51:47.899474269Z [err]  2025-12-30 18:51:47,722 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-30T18:51:47.899476763Z [err]  2025-12-30 18:51:47,620 - core_calling_service - INFO - LLM response (0.01s): Kendrick?
2025-12-30T18:51:47.899482975Z [err]  2025-12-30 18:51:47,722 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-30T18:51:47.899485439Z [err]  2025-12-30 18:51:47,620 - core_calling_service - INFO - Total latency: 0.01s
2025-12-30T18:51:47.899492163Z [err]  2025-12-30 18:51:47,620 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-30T18:51:47.899497675Z [err]  2025-12-30 18:51:47,721 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:47.899503275Z [err]  2025-12-30 18:51:47,722 - telnyx_service - INFO - üîä Speaking text on call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA: Kendrick?...
2025-12-30T18:51:47.899704700Z [err]  2025-12-30 18:51:47,817 - server - INFO -    ‚úì HTTP client created (0.007s)
2025-12-30T18:51:47.899713793Z [err]  2025-12-30 18:51:47,817 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-30T18:51:47.899714787Z [err]  2025-12-30 18:51:47,722 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-30T18:51:47.899723038Z [err]  2025-12-30 18:51:47,722 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-30T18:51:47.899729640Z [err]  2025-12-30 18:51:47,810 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:47.899736155Z [err]  2025-12-30 18:51:47,810 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-30T18:51:47.899742523Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Text length: 9 chars
2025-12-30T18:51:47.899748626Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Text content: 'Kendrick?'
2025-12-30T18:51:47.899755292Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-30T18:51:47.899761892Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-30T18:51:47.899768758Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-30T18:51:47.899775251Z [err]  2025-12-30 18:51:47,810 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-30T18:51:47.899782201Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-30T18:51:47.899789049Z [err]  2025-12-30 18:51:47,810 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-30T18:51:47.899795769Z [err]  2025-12-30 18:51:47,810 - server - INFO -    Timeout: 10.0s
2025-12-30T18:51:48.068740980Z [err]  2025-12-30 18:51:47,971 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA/actions/record_start "HTTP/1.1 200 OK"
2025-12-30T18:51:48.068752430Z [err]  2025-12-30 18:51:47,973 - server - INFO - üéôÔ∏è Call recording started for v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.068760942Z [err]  2025-12-30 18:51:47,973 - server - INFO - üîß Creating call session for v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA...
2025-12-30T18:51:48.068769290Z [err]  2025-12-30 18:51:47,973 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-30T18:51:48.068777955Z [err]  2025-12-30 18:51:47,973 - server - INFO - üîß Calling create_call_session() - START
2025-12-30T18:51:48.068785841Z [err]  2025-12-30 18:51:47,973 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-30T18:51:48.068794175Z [err]  2025-12-30 18:51:47,974 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-30T18:51:48.068921405Z [err]  2025-12-30 18:51:47,975 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-30T18:51:48.068931335Z [err]  2025-12-30 18:51:47,997 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:48.068942387Z [err]  2025-12-30 18:51:48,061 - core_calling_service - INFO - üîç KB count query completed: 4 items
2025-12-30T18:51:48.068949619Z [err]  2025-12-30 18:51:48,061 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-30T18:51:48.082177942Z [err]  2025-12-30 18:51:48,071 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-30T18:51:48.082183152Z [err]  2025-12-30 18:51:48,072 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-30T18:51:48.082190977Z [err]  2025-12-30 18:51:48,072 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-30T18:51:48.129653410Z [inf]  100.64.0.14:48268 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2025-12-30T18:51:48.160997505Z [err]  2025-12-30 18:51:48,160 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:48.168511396Z [err]  2025-12-30 18:51:48,167 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 94ms
2025-12-30T18:51:48.168519441Z [err]  2025-12-30 18:51:48,167 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-30T18:51:48.168527030Z [err]  2025-12-30 18:51:48,167 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-30T18:51:48.207305490Z [err]  2025-12-30 18:51:48,193 - redis_service - INFO - üì¶ Stored call data in Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (TTL: 3600s)
2025-12-30T18:51:48.207309003Z [err]  2025-12-30 18:51:48,198 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-30T18:51:48.207313630Z [err]  2025-12-30 18:51:48,193 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-30T18:51:48.207318622Z [err]  2025-12-30 18:51:48,198 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-30T18:51:48.207319986Z [err]  2025-12-30 18:51:48,193 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-30T18:51:48.207325484Z [err]  2025-12-30 18:51:48,198 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-30T18:51:48.207326108Z [err]  2025-12-30 18:51:48,198 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.207331817Z [err]  2025-12-30 18:51:48,198 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-30T18:51:48.207332631Z [err]  2025-12-30 18:51:48,198 - server - INFO - ü§ñ AI session created for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.207338523Z [err]  2025-12-30 18:51:48,198 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-30T18:51:48.207340154Z [err]  2025-12-30 18:51:48,198 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-30T18:51:48.207345615Z [err]  2025-12-30 18:51:48,198 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-30T18:51:48.225500638Z [err]  2025-12-30 18:51:48,222 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.225505695Z [err]  2025-12-30 18:51:48,223 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-30T18:51:48.225510985Z [err]  2025-12-30 18:51:48,223 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-30T18:51:48.225514853Z [inf]  100.64.0.12:56626 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:48.265462251Z [err]  2025-12-30 18:51:48,264 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-30T18:51:48.265468400Z [err]  2025-12-30 18:51:48,264 - server - INFO -    ‚úì Connection established (0.454s) [TARGET: <200ms]
2025-12-30T18:51:48.265472780Z [err]  2025-12-30 18:51:48,264 - server - INFO -    ‚úì Response status: 200
2025-12-30T18:51:48.265477464Z [err]  2025-12-30 18:51:48,264 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-30T18:51:48.284733334Z [err]  2025-12-30 18:51:48,280 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (13419 bytes)
2025-12-30T18:51:48.284735469Z [err]  2025-12-30 18:51:48,275 - server - INFO -    ‚úì FIRST CHUNK received (0.465s, 963 bytes) [TARGET: <300ms]
2025-12-30T18:51:48.284744406Z [err]  2025-12-30 18:51:48,280 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.56s
2025-12-30T18:51:48.284747811Z [err]  2025-12-30 18:51:48,279 - server - INFO -    ‚úì ALL CHUNKS received: 69 chunks (0.469s)
2025-12-30T18:51:48.284753833Z [err]  2025-12-30 18:51:48,280 - telnyx_service - INFO - ‚úÖ Generated 13419 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-30T18:51:48.284758599Z [err]  2025-12-30 18:51:48,279 - server - INFO -    ‚úì Total audio size: 13419 bytes
2025-12-30T18:51:48.284765169Z [err]  2025-12-30 18:51:48,280 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-30T18:51:48.284768760Z [err]  2025-12-30 18:51:48,279 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-30T18:51:48.284776326Z [err]  2025-12-30 18:51:48,279 - server - INFO -       - Connection: 454ms
2025-12-30T18:51:48.284787291Z [err]  2025-12-30 18:51:48,279 - server - INFO -       - First chunk: 465ms
2025-12-30T18:51:48.284795876Z [err]  2025-12-30 18:51:48,279 - server - INFO -       - All chunks: 469ms
2025-12-30T18:51:48.284803672Z [err]  2025-12-30 18:51:48,279 - server - INFO -       - Audio generation only: 11ms
2025-12-30T18:51:48.284817442Z [err]  2025-12-30 18:51:48,280 - server - INFO - ‚è±Ô∏è [18:51:48.280] üîä TTS COMPLETE: 557ms, audio_size=13419 bytes
2025-12-30T18:51:48.721954457Z [err]  2025-12-30 18:51:48,503 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:48.721959436Z [err]  2025-12-30 18:51:48,503 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA/actions/playback_start "HTTP/1.1 200 OK"
2025-12-30T18:51:48.721964343Z [err]  2025-12-30 18:51:48,504 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2025-12-30T18:51:48.721969190Z [err]  2025-12-30 18:51:48,504 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.78s
2025-12-30T18:51:48.721974840Z [err]  2025-12-30 18:51:48,504 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-30T18:51:48.721980235Z [err]  2025-12-30 18:51:48,504 - telnyx_service - INFO - üé¨ Playback ID: WpRv3hGBeA
2025-12-30T18:51:48.721985955Z [err]  2025-12-30 18:51:48,505 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-30T18:51:48.721991523Z [err]  2025-12-30 18:51:48,505 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Greeting playback started at 1767120708.5050673
2025-12-30T18:51:48.721996212Z [err]  2025-12-30 18:51:48,505 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1767120708.5051186 for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.722001572Z [err]  2025-12-30 18:51:48,505 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-30T18:51:48.832963591Z [inf]  100.64.0.11:52996 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-30T18:51:48.973738264Z [err]  2025-12-30 18:51:48,936 - server - INFO - üî§ RAW TOKENS: ["H"?]
2025-12-30T18:51:48.973750274Z [err]  2025-12-30 18:51:48,939 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.973758171Z [err]  2025-12-30 18:51:48,939 - core_calling_service - INFO - üîä Silence timer reset for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (user started speaking)
2025-12-30T18:51:48.973764986Z [err]  2025-12-30 18:51:48,939 - core_calling_service - INFO - üë§ User started speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:48.973771746Z [err]  2025-12-30 18:51:48,939 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-30T18:51:48.973778286Z [err]  2025-12-30 18:51:48,939 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2025-12-30T18:51:49.010523684Z [err]  2025-12-30 18:51:49,008 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:49.267408474Z [err]  2025-12-30 18:51:49,203 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2025-12-30T18:51:49.267419042Z [err]  2025-12-30 18:51:49,203 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-30T18:51:49.267429720Z [err]  2025-12-30 18:51:49,203 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2025-12-30T18:51:49.267438689Z [err]  2025-12-30 18:51:49,203 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2025-12-30T18:51:49.267447855Z [err]  2025-12-30 18:51:49,203 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2025-12-30T18:51:49.267457225Z [err]  2025-12-30 18:51:49,204 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:49.267465384Z [err]  2025-12-30 18:51:49,204 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-30T18:51:49.267473170Z [err]  2025-12-30 18:51:49,204 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:49.267482662Z [err]  2025-12-30 18:51:49,204 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-30T18:51:49.267490524Z [err]  2025-12-30 18:51:49,204 - server - INFO - ‚è±Ô∏è [18:51:49.204] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2025-12-30T18:51:49.267497709Z [err]  2025-12-30 18:51:49,204 - server - INFO - ‚è±Ô∏è [18:51:49.204] STT endpoint detection latency: 18ms
2025-12-30T18:51:49.267505248Z [err]  2025-12-30 18:51:49,204 - server - INFO - ‚è±Ô∏è [18:51:49.204] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-30T18:51:49.267512180Z [err]  2025-12-30 18:51:49,204 - server - INFO - ‚è±Ô∏è User spoke at 1767120709.204673
2025-12-30T18:51:49.267519058Z [err]  2025-12-30 18:51:49,209 - redis_service - INFO - üì¶ Stored call data in Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (TTL: 3600s)
2025-12-30T18:51:49.267536936Z [err]  2025-12-30 18:51:49,209 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-30T18:51:49.267544738Z [err]  2025-12-30 18:51:49,209 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:49.267553291Z [err]  2025-12-30 18:51:49,209 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2025-12-30T18:51:49.267560422Z [err]  2025-12-30 18:51:49,220 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2025-12-30T18:51:49.267567682Z [err]  2025-12-30 18:51:49,220 - core_calling_service - INFO - üë§ User stopped speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:49.267575342Z [err]  2025-12-30 18:51:49,220 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-30T18:51:49.267582831Z [err]  2025-12-30 18:51:49,220 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2025-12-30T18:51:49.267589921Z [err]  2025-12-30 18:51:49,220 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2025-12-30T18:51:49.267596488Z [err]  2025-12-30 18:51:49,220 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-30T18:51:49.267602847Z [err]  2025-12-30 18:51:49,220 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-30T18:51:49.267609920Z [err]  2025-12-30 18:51:49,220 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:49.323452142Z [err]  2025-12-30 18:51:49,314 - server - INFO - üìù Saved user transcript to database
2025-12-30T18:51:49.323460375Z [err]  2025-12-30 18:51:49,314 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:49.323467041Z [err]  2025-12-30 18:51:49,314 - core_calling_service - INFO - ‚è±Ô∏è [18:51:49.314] üì• process_user_input() ENTRY - text: 'Hello?...'
2025-12-30T18:51:49.323478020Z [err]  2025-12-30 18:51:49,318 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:49.323484581Z [err]  2025-12-30 18:51:49,319 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA: User spoke while Silence Greeting was triggering
2025-12-30T18:51:49.323490694Z [err]  2025-12-30 18:51:49,319 - core_calling_service - INFO - ‚è≥ Smart Barge-In: User spoke early (0.81s) - LETTING GREETING FINISH
2025-12-30T18:51:49.323497048Z [err]  2025-12-30 18:51:49,319 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-30T18:51:49.327111081Z [err]  2025-12-30 18:51:49,323 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:49.331350456Z [err]  2025-12-30 18:51:49,328 - redis_service - INFO - üì¶ Stored call data in Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (TTL: 3600s)
2025-12-30T18:51:49.331361439Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-30T18:51:49.331371679Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - ‚è±Ô∏è [18:51:49.328] ‚è© About to call _process_call_flow_streaming()
2025-12-30T18:51:49.331380025Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - ‚è±Ô∏è [18:51:49.328] üîÄ Agent type: call_flow, calling flow processor...
2025-12-30T18:51:49.331385404Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - ‚è±Ô∏è [18:51:49.328] üîÄ _process_call_flow_streaming() ENTRY
2025-12-30T18:51:49.331392439Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-30T18:51:49.331397897Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-30T18:51:49.331403399Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - ‚è±Ô∏è [18:51:49.328] üîÄ About to call _follow_transition() for: Hello?...
2025-12-30T18:51:49.331408192Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - Evaluating transitions from Greeting for message: Hello?
2025-12-30T18:51:49.331413357Z [err]  2025-12-30 18:51:49,328 - core_calling_service - ERROR - Error in call flow streaming: cannot access local variable 'time' where it is not associated with a value
2025-12-30T18:51:49.331418459Z [err]  2025-12-30 18:51:49,328 - core_calling_service - INFO - ü§ñ Using LLM provider: grok, model: grok-4-1-fast-non-reasoning
2025-12-30T18:51:49.962995868Z [err]  2025-12-30 18:51:49,891 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:49.963002886Z [inf]  100.64.0.15:30184 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:49.963006927Z [err]  2025-12-30 18:51:49,891 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '3f9e1840-2a65-4bf4-b382-1a9670fec816', 'occurred_at': '2025-12-30T18:51:49.343238Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'WpRv3hGBeA'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:49.963012730Z [err]  2025-12-30 18:51:49,891 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:49.963016677Z [err]  2025-12-30 18:51:49,891 - server - INFO - üì® ================================================
2025-12-30T18:51:50.039407260Z [err]  2025-12-30 18:51:50,038 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:50.039413832Z [err]  2025-12-30 18:51:50,038 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '0e7f1028-e2b9-4e11-aed4-4debf25b22ef', 'occurred_at': '2025-12-30T18:51:49.823242Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:50.039417977Z [err]  2025-12-30 18:51:50,038 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:50.039422782Z [err]  2025-12-30 18:51:50,038 - server - INFO - üì® ================================================
2025-12-30T18:51:50.039426579Z [inf]  100.64.0.12:56626 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:50.059001409Z [err]  2025-12-30 18:51:50,051 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:50.059012672Z [err]  2025-12-30 18:51:50,051 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '3821e673-4d15-4ee1-a5fb-23256acf1999', 'occurred_at': '2025-12-30T18:51:49.483235Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'sA3-2oUX9w', 'start_time': '2025-12-30T18:51:49.483235Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:50.059020294Z [err]  2025-12-30 18:51:50,051 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:50.059027247Z [err]  2025-12-30 18:51:50,051 - server - INFO - üì® ================================================
2025-12-30T18:51:50.059034757Z [inf]  100.64.0.15:30184 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:50.483800378Z [err]  2025-12-30 18:51:50,481 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:50.483816743Z [err]  2025-12-30 18:51:50,481 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:50.483823842Z [err]  2025-12-30 18:51:50,481 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-30T18:51:50.574567245Z [err]  2025-12-30 18:51:50,557 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:51:50.574578742Z [err]  2025-12-30 18:51:50,557 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'e2ea99af-6299-414f-a942-094423f0dc59', 'occurred_at': '2025-12-30T18:51:50.183240Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'WpRv3hGBeA', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:51:50.574586954Z [err]  2025-12-30 18:51:50,557 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:50.574594444Z [err]  2025-12-30 18:51:50,557 - server - INFO - üì® ================================================
2025-12-30T18:51:50.574601471Z [err]  2025-12-30 18:51:50,567 - redis_service - INFO - ‚ûñ Removed playback WpRv3hGBeA, 0 remaining for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:50.574608345Z [err]  2025-12-30 18:51:50,567 - server - INFO - üîä Redis: Removed playback WpRv3hGBeA, 0 remaining
2025-12-30T18:51:50.574616105Z [err]  2025-12-30 18:51:50,567 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-30T18:51:50.574621836Z [err]  2025-12-30 18:51:50,567 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-30T18:51:50.574628355Z [err]  2025-12-30 18:51:50,571 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-30T18:51:50.574855995Z [err]  2025-12-30 18:51:50,571 - server - INFO - ‚úÖ Found session locally: agent_speaking=True, user_speaking=False
2025-12-30T18:51:50.574863584Z [err]  2025-12-30 18:51:50,571 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1767120710.5718923 for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:50.574869184Z [err]  2025-12-30 18:51:50,571 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:50.574874794Z [err]  2025-12-30 18:51:50,571 - server - INFO - ‚è±Ô∏è Agent done speaking, silence timer STARTED (local)
2025-12-30T18:51:50.574881097Z [inf]  100.64.0.11:52996 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:51:51.010841753Z [err]  2025-12-30 18:51:50,986 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:51.010848631Z [err]  2025-12-30 18:51:50,986 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.4s, checkin_count=0/2
2025-12-30T18:51:51.010853867Z [err]  2025-12-30 18:51:51,006 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-30T18:51:51.338657617Z [err]  2025-12-30 18:51:51,317 - core_calling_service - INFO - ‚è±Ô∏è [18:51:51.317] üí¨ LLM FIRST TOKEN: 1981ms (grok grok-4-1-fast-non-reasoning)
2025-12-30T18:51:51.338663957Z [err]  2025-12-30 18:51:51,336 - server - INFO - üì§ Sentence arrived from LLM: Hey {customer_name},...
2025-12-30T18:51:51.338668837Z [err]  2025-12-30 18:51:51,336 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 2115ms
2025-12-30T18:51:51.338673671Z [err]  2025-12-30 18:51:51,336 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-30T18:51:51.338678521Z [err]  2025-12-30 18:51:51,336 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:51.338688501Z [err]  2025-12-30 18:51:51,336 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-30T18:51:51.452984944Z [err]  2025-12-30 18:51:51,423 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:51.494107370Z [err]  2025-12-30 18:51:51,491 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:51:51.513530408Z [err]  2025-12-30 18:51:51,510 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:51.650491491Z [err]  2025-12-30 18:51:51,598 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:51:51.650497315Z [err]  2025-12-30 18:51:51,618 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-30T18:51:51.650501595Z [err]  2025-12-30 18:51:51,618 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-30T18:51:51.650505504Z [err]  2025-12-30 18:51:51,618 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-30T18:51:51.650509396Z [err]  2025-12-30 18:51:51,618 - persistent_tts_service - INFO - üîå [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Establishing persistent TTS WebSocket...
2025-12-30T18:51:51.650514902Z [err]  2025-12-30 18:51:51,618 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-30T18:51:51.650519458Z [err]  2025-12-30 18:51:51,618 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-30T18:51:51.650523276Z [err]  2025-12-30 18:51:51,618 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-30T18:51:51.785870854Z [err]  2025-12-30 18:51:51,744 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-30T18:51:51.785876898Z [err]  2025-12-30 18:51:51,745 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-30T18:51:51.785880853Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - ‚úÖ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Persistent TTS WebSocket established
2025-12-30T18:51:51.785884634Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Audio receiver loop started
2025-12-30T18:51:51.785888453Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üîä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Comfort noise loop started
2025-12-30T18:51:51.785892787Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:51.785896608Z [err]  2025-12-30 18:51:51,745 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-30T18:51:51.785900220Z [err]  2025-12-30 18:51:51,745 - server - INFO - üîç Persistent TTS lookup: call_id=v3:JtXB3EMA80vHXwrmo..., session=FOUND
2025-12-30T18:51:51.785903781Z [err]  2025-12-30 18:51:51,745 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-30T18:51:51.785907603Z [err]  2025-12-30 18:51:51,745 - server - INFO - üéµ TTS task #1 started at +409ms
2025-12-30T18:51:51.785911742Z [err]  2025-12-30 18:51:51,745 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 2525ms
2025-12-30T18:51:51.785915293Z [err]  2025-12-30 18:51:51,745 - core_calling_service - INFO - üì§ Streamed sentence: Hey {customer_name},...
2025-12-30T18:51:51.785919072Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üéµ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Playback consumer started
2025-12-30T18:51:51.785961055Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Audio Receiver Loop STARTED
2025-12-30T18:51:51.785965015Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üíì [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Starting TTS keep-alive loop (every 15s)
2025-12-30T18:51:51.785968875Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üîä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Starting comfort noise loop
2025-12-30T18:51:51.785972445Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üé§ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Streaming sentence #1: Hey {customer_name},...
2025-12-30T18:51:51.785976190Z [err]  2025-12-30 18:51:51,745 - persistent_tts_service - INFO - üöÄ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-30T18:51:51.785980486Z [err]  2025-12-30 18:51:51,746 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-30T18:51:51.785984064Z [err]  2025-12-30 18:51:51,747 - server - INFO - üì§ Sentence arrived from LLM: Jake here from JK....
2025-12-30T18:51:51.785987911Z [err]  2025-12-30 18:51:51,747 - server - INFO - üîç Persistent TTS lookup: call_id=v3:JtXB3EMA80vHXwrmo..., session=FOUND
2025-12-30T18:51:51.785991813Z [err]  2025-12-30 18:51:51,747 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-30T18:51:51.785995602Z [err]  2025-12-30 18:51:51,747 - server - INFO - üéµ TTS task #2 started at +411ms
2025-12-30T18:51:51.785999571Z [err]  2025-12-30 18:51:51,747 - core_calling_service - INFO - üì§ Streamed sentence: Jake here from JK....
2025-12-30T18:51:51.786003700Z [err]  2025-12-30 18:51:51,749 - server - INFO - üì§ Sentence arrived from LLM: You filled out our Facebook ad about generating se...
2025-12-30T18:51:51.789943437Z [err]  2025-12-30 18:51:51,749 - server - INFO - üîç Persistent TTS lookup: call_id=v3:JtXB3EMA80vHXwrmo..., session=FOUND
2025-12-30T18:51:51.789952166Z [err]  2025-12-30 18:51:51,749 - server - INFO - üöÄ Streaming sentence #3 via persistent WebSocket
2025-12-30T18:51:51.789958558Z [err]  2025-12-30 18:51:51,749 - server - INFO - üéµ TTS task #3 started at +413ms
2025-12-30T18:51:51.789965668Z [err]  2025-12-30 18:51:51,749 - core_calling_service - INFO - üì§ Streamed sentence: You filled out our Facebook ad about generating se...
2025-12-30T18:51:51.789972366Z [err]  2025-12-30 18:51:51,750 - server - INFO - üì§ Sentence arrived from LLM: right?...
2025-12-30T18:51:51.789978338Z [err]  2025-12-30 18:51:51,750 - server - INFO - üîç Persistent TTS lookup: call_id=v3:JtXB3EMA80vHXwrmo..., session=FOUND
2025-12-30T18:51:51.789984621Z [err]  2025-12-30 18:51:51,750 - server - INFO - üöÄ Streaming sentence #4 via persistent WebSocket
2025-12-30T18:51:51.789990271Z [err]  2025-12-30 18:51:51,750 - server - INFO - üéµ TTS task #4 started at +414ms
2025-12-30T18:51:51.789995640Z [err]  2025-12-30 18:51:51,750 - core_calling_service - INFO - üì§ Streamed sentence: right?...
2025-12-30T18:51:51.790000731Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver processing sentence #1: 'Hey {customer_name},...'
2025-12-30T18:51:51.790005227Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: queue_latency=6ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-30T18:51:51.790009738Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üé§ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Streaming sentence #2: Jake here from JK....
2025-12-30T18:51:51.790014235Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üöÄ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-30T18:51:51.790018700Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=False, is_last=False
2025-12-30T18:51:51.790022713Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üé§ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Streaming sentence #3: You filled out our Facebook ad about generating se...
2025-12-30T18:51:51.790026879Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üöÄ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Sent sentence #3 (NON-BLOCKING) in 0ms
2025-12-30T18:51:51.790030603Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-30T18:51:51.790054762Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üé§ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Streaming sentence #4: right?...
2025-12-30T18:51:51.790061149Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üöÄ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Sent sentence #4 (NON-BLOCKING) in 0ms
2025-12-30T18:51:51.790069355Z [err]  2025-12-30 18:51:51,752 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: pending_sentences=3, audio_queue=0, is_first=False, is_last=False
2025-12-30T18:51:51.790076825Z [err]  2025-12-30 18:51:51,752 - server - INFO - üì§ Sentence arrived from LLM: What's your main goal with extra income?...
2025-12-30T18:51:51.790080613Z [err]  2025-12-30 18:51:51,752 - server - INFO - üîç Persistent TTS lookup: call_id=v3:JtXB3EMA80vHXwrmo..., session=FOUND
2025-12-30T18:51:51.790084623Z [err]  2025-12-30 18:51:51,753 - server - INFO - üöÄ Streaming sentence #5 via persistent WebSocket
2025-12-30T18:51:51.790088695Z [err]  2025-12-30 18:51:51,753 - server - INFO - üéµ TTS task #5 started at +416ms
2025-12-30T18:51:51.790092422Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - üì§ Streamed final fragment: What's your main goal with extra income?...
2025-12-30T18:51:51.790096449Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - ‚è±Ô∏è [TIMING] LLM_TOTAL: 2417ms for 177 chars (grok grok-4-1-fast-non-reasoning)
2025-12-30T18:51:51.790101057Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user gave meaningful response) for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:51.790105265Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - üîä Silence tracking reset for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (user responded)
2025-12-30T18:51:51.790109161Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-30T18:51:51.790114674Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-30T18:51:51.790118546Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - LLM response (2.44s): Hey {customer_name}, Jake here from JK. You filled out our Facebook ad about generating serious passive income with Google leads, right? What's your main goal with extra income?
2025-12-30T18:51:51.790122554Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - Total latency: 2.44s
2025-12-30T18:51:51.790126327Z [err]  2025-12-30 18:51:51,753 - server - INFO - ‚úÖ LLM finished in 2532ms, TTS tasks already running in background
2025-12-30T18:51:51.790130364Z [err]  2025-12-30 18:51:51,753 - server - INFO - üéµ Streaming 5 TTS chunks as they complete...
2025-12-30T18:51:51.790134164Z [err]  2025-12-30 18:51:51,753 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-30T18:51:51.790137888Z [err]  2025-12-30 18:51:51,753 - server - INFO -    5 sentences queued and playing seamlessly
2025-12-30T18:51:51.790142129Z [err]  2025-12-30 18:51:51,753 - persistent_tts_service - INFO - üé§ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Streaming sentence #5: What's your main goal with extra income?...
2025-12-30T18:51:51.790145853Z [err]  2025-12-30 18:51:51,753 - persistent_tts_service - INFO - üöÄ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Sent sentence #5 (NON-BLOCKING) in 0ms
2025-12-30T18:51:51.790149924Z [err]  2025-12-30 18:51:51,753 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: pending_sentences=4, audio_queue=0, is_first=False, is_last=False
2025-12-30T18:51:51.790153984Z [err]  2025-12-30 18:51:51,753 - server - INFO - ‚úÖ All 5 persistent TTS streams completed
2025-12-30T18:51:51.790157668Z [err]  2025-12-30 18:51:51,753 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-30T18:51:51.790161741Z [err]  2025-12-30 18:51:51,753 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 2533ms from user stop üöÄ
2025-12-30T18:51:51.790166811Z [err]  2025-12-30 18:51:51,753 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:51.790170407Z [err]  2025-12-30 18:51:51,753 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-30T18:51:51.790174054Z [err]  2025-12-30 18:51:51,753 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-30T18:51:51.790177507Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-30T18:51:51.790181200Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2025-12-30T18:51:51.790185035Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 2532ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-30T18:51:51.790188597Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 417ms (provider: elevenlabs, websocket: False)
2025-12-30T18:51:51.790192771Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 2533ms (user stopped ‚Üí play_audio_url called)
2025-12-30T18:51:51.790196441Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-30T18:51:51.790200014Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-30T18:51:51.790203784Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-30T18:51:51.790207170Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-30T18:51:51.790210953Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-30T18:51:51.790214932Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2833ms estimated
2025-12-30T18:51:51.790218768Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 177 chars, 5 sentences
2025-12-30T18:51:51.790222497Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2025-12-30T18:51:51.790226409Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Hey {customer_name}, Jake here from JK. You filled out our F...'
2025-12-30T18:51:51.790230338Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-30T18:51:51.790233807Z [err]  2025-12-30 18:51:51,754 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-30T18:51:51.952494537Z [err]  2025-12-30 18:51:51,941 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 2959ms)
2025-12-30T18:51:51.952503001Z [err]  2025-12-30 18:51:51,941 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-30T18:51:51.952508327Z [err]  2025-12-30 18:51:51,941 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-30T18:51:52.023587592Z [err]  2025-12-30 18:51:52,002 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.023588661Z [err]  2025-12-30 18:51:51,996 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-30T18:51:52.023596657Z [err]  2025-12-30 18:51:52,002 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.3s (total: 1.3s from now)
2025-12-30T18:51:52.023599461Z [err]  2025-12-30 18:51:51,996 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1767120711.9968526 for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:52.023602427Z [err]  2025-12-30 18:51:52,002 - persistent_tts_service - INFO - ‚úÖ Sent 68 audio chunks via WebSocket
2025-12-30T18:51:52.023608931Z [err]  2025-12-30 18:51:52,006 - server - INFO - üì§ Audio flowing: 342 packets sent to Soniox (5s update)
2025-12-30T18:51:52.023609391Z [err]  2025-12-30 18:51:51,996 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:51:52.023616236Z [err]  2025-12-30 18:51:52,001 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 256ms
2025-12-30T18:51:52.023623519Z [err]  2025-12-30 18:51:52,002 - persistent_tts_service - INFO - üì§ Sending 10758 bytes of audio (68 chunks, 1.3s duration) via WebSocket
2025-12-30T18:51:52.220029860Z [err]  2025-12-30 18:51:52,201 - persistent_tts_service - INFO - üì§ Sending 11146 bytes of audio (70 chunks, 1.4s duration) via WebSocket
2025-12-30T18:51:52.220037767Z [err]  2025-12-30 18:51:52,201 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.220043245Z [err]  2025-12-30 18:51:52,201 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.4s (total: 2.5s from now)
2025-12-30T18:51:52.220048377Z [err]  2025-12-30 18:51:52,202 - persistent_tts_service - INFO - ‚úÖ Sent 70 audio chunks via WebSocket
2025-12-30T18:51:52.433649677Z [err]  2025-12-30 18:51:52,429 - persistent_tts_service - INFO - üì§ Sending 9659 bytes of audio (61 chunks, 1.2s duration) via WebSocket
2025-12-30T18:51:52.433668236Z [err]  2025-12-30 18:51:52,429 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.433675150Z [err]  2025-12-30 18:51:52,429 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.2s (total: 3.5s from now)
2025-12-30T18:51:52.433681840Z [err]  2025-12-30 18:51:52,430 - persistent_tts_service - INFO - ‚úÖ Sent 61 audio chunks via WebSocket
2025-12-30T18:51:52.640412250Z [err]  2025-12-30 18:51:52,630 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-30T18:51:52.640421235Z [err]  2025-12-30 18:51:52,630 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.640428008Z [err]  2025-12-30 18:51:52,630 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 5.0s from now)
2025-12-30T18:51:52.640434558Z [err]  2025-12-30 18:51:52,632 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-30T18:51:52.640441059Z [err]  2025-12-30 18:51:52,632 - persistent_tts_service - INFO - üì§ Sending 5155 bytes of audio (33 chunks, 0.6s duration) via WebSocket
2025-12-30T18:51:52.640447537Z [err]  2025-12-30 18:51:52,633 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.640453812Z [err]  2025-12-30 18:51:52,633 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.6s (total: 5.7s from now)
2025-12-30T18:51:52.640459590Z [err]  2025-12-30 18:51:52,633 - persistent_tts_service - INFO - ‚úÖ Sent 33 audio chunks via WebSocket
2025-12-30T18:51:52.812860681Z [err]  2025-12-30 18:51:52,801 - persistent_tts_service - INFO - üì§ Sending 12260 bytes of audio (77 chunks, 1.5s duration) via WebSocket
2025-12-30T18:51:52.812866182Z [err]  2025-12-30 18:51:52,802 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.812870336Z [err]  2025-12-30 18:51:52,802 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.5s (total: 7.0s from now)
2025-12-30T18:51:52.812874229Z [err]  2025-12-30 18:51:52,802 - persistent_tts_service - INFO - ‚úÖ Sent 77 audio chunks via WebSocket
2025-12-30T18:51:52.991335350Z [err]  2025-12-30 18:51:52,986 - persistent_tts_service - INFO - üì§ Sending 4829 bytes of audio (31 chunks, 0.6s duration) via WebSocket
2025-12-30T18:51:52.991346176Z [err]  2025-12-30 18:51:52,986 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:52.991356015Z [err]  2025-12-30 18:51:52,986 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.6s (total: 7.5s from now)
2025-12-30T18:51:52.991363122Z [err]  2025-12-30 18:51:52,986 - persistent_tts_service - INFO - ‚úÖ Sent 31 audio chunks via WebSocket
2025-12-30T18:51:53.217072314Z [err]  2025-12-30 18:51:53,211 - persistent_tts_service - INFO - üì§ Sending 18948 bytes of audio (119 chunks, 2.4s duration) via WebSocket
2025-12-30T18:51:53.217078189Z [err]  2025-12-30 18:51:53,211 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-30T18:51:53.217084595Z [err]  2025-12-30 18:51:53,212 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.4s (total: 9.6s from now)
2025-12-30T18:51:53.217091027Z [err]  2025-12-30 18:51:53,213 - persistent_tts_service - INFO - ‚úÖ Sent 119 audio chunks via WebSocket
2025-12-30T18:51:55.037181421Z [err]  2025-12-30 18:51:55,030 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (7.8s left)
2025-12-30T18:51:55.220145111Z [err]  2025-12-30 18:51:55,211 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-30T18:51:55.220150867Z [err]  2025-12-30 18:51:55,211 - persistent_tts_service - INFO - ‚úÖ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver finished sentence #1: 8 chunks in 3465ms
2025-12-30T18:51:55.220155146Z [err]  2025-12-30 18:51:55,211 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver processing sentence #2: 'Jake here from JK....'
2025-12-30T18:51:55.220159120Z [err]  2025-12-30 18:51:55,211 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: queue_latency=3459ms, pending_sentences=3, audio_queue=0, interrupted=False
2025-12-30T18:51:55.547364476Z [err]  2025-12-30 18:51:55,534 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (7.3s left)
2025-12-30T18:51:57.048021278Z [err]  2025-12-30 18:51:57,030 - server - INFO - üì§ Audio flowing: 593 packets sent to Soniox (5s update)
2025-12-30T18:51:57.188880329Z [err]  2025-12-30 18:51:57,167 - server - INFO - üé§ Soniox receiver alive - 11 messages received in last 10s
2025-12-30T18:51:57.714306333Z [err]  2025-12-30 18:51:57,711 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-30T18:51:57.714312920Z [err]  2025-12-30 18:51:57,711 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver got 0 chunks for sentence #2! interrupted=False
2025-12-30T18:51:57.714318102Z [err]  2025-12-30 18:51:57,711 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver processing sentence #3: 'You filled out our Facebook ad...'
2025-12-30T18:51:57.714324404Z [err]  2025-12-30 18:51:57,711 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: queue_latency=5959ms, pending_sentences=2, audio_queue=0, interrupted=False
2025-12-30T18:52:00.084628154Z [err]  2025-12-30 18:52:00,081 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.7s left)
2025-12-30T18:52:00.224431824Z [err]  2025-12-30 18:52:00,211 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-30T18:52:00.224439373Z [err]  2025-12-30 18:52:00,211 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver got 0 chunks for sentence #3! interrupted=False
2025-12-30T18:52:00.224446723Z [err]  2025-12-30 18:52:00,211 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver processing sentence #4: 'right?...'
2025-12-30T18:52:00.224452092Z [err]  2025-12-30 18:52:00,211 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: queue_latency=8458ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-30T18:52:00.922659775Z [err]  2025-12-30 18:52:00,586 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.2s left)
2025-12-30T18:52:02.047523418Z [err]  2025-12-30 18:52:02,046 - server - INFO - üì§ Audio flowing: 844 packets sent to Soniox (5s update)
2025-12-30T18:52:02.637038531Z [err]  2025-12-30 18:52:02,606 - core_calling_service - INFO - ‚è∞ Check-in triggered after 10.6s silence (threshold: 7s)
2025-12-30T18:52:02.637048397Z [err]  2025-12-30 18:52:02,611 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-30T18:52:02.637053668Z [err]  2025-12-30 18:52:02,611 - dead_air_monitor - INFO - üí¨ Sending check-in after 10.6s silence: Are you still there?
2025-12-30T18:52:02.637057412Z [err]  2025-12-30 18:52:02,611 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:02.637061332Z [err]  2025-12-30 18:52:02,612 - telnyx_service - INFO - üîä Speaking text on call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA: Are you still there?...
2025-12-30T18:52:02.637065884Z [err]  2025-12-30 18:52:02,612 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-30T18:52:02.637070235Z [err]  2025-12-30 18:52:02,612 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-30T18:52:02.637075074Z [err]  2025-12-30 18:52:02,612 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-30T18:52:02.637079241Z [err]  2025-12-30 18:52:02,612 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-30T18:52:02.637083342Z [err]  2025-12-30 18:52:02,612 - server - INFO - ‚è±Ô∏è [18:52:02.612] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-30T18:52:02.637087884Z [err]  2025-12-30 18:52:02,612 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-30T18:52:02.637093321Z [err]  2025-12-30 18:52:02,612 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-30T18:52:02.705078728Z [err]  2025-12-30 18:52:02,700 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:52:02.705087468Z [err]  2025-12-30 18:52:02,700 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-30T18:52:02.705093311Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Text length: 20 chars
2025-12-30T18:52:02.705099429Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Text content: 'Are you still there?'
2025-12-30T18:52:02.705106067Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-30T18:52:02.705112040Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-30T18:52:02.705119111Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-30T18:52:02.705125473Z [err]  2025-12-30 18:52:02,700 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-30T18:52:02.705132029Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-30T18:52:02.705138118Z [err]  2025-12-30 18:52:02,700 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-30T18:52:02.705144296Z [err]  2025-12-30 18:52:02,700 - server - INFO -    Timeout: 10.0s
2025-12-30T18:52:02.713370028Z [err]  2025-12-30 18:52:02,712 - server - INFO -    ‚úì HTTP client created (0.011s)
2025-12-30T18:52:02.713380391Z [err]  2025-12-30 18:52:02,712 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-30T18:52:02.717712662Z [err]  2025-12-30 18:52:02,713 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-30T18:52:02.717717351Z [err]  2025-12-30 18:52:02,713 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver got 0 chunks for sentence #4! interrupted=False
2025-12-30T18:52:02.717721976Z [err]  2025-12-30 18:52:02,713 - persistent_tts_service - INFO - üéß [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver processing sentence #5: 'What's your main goal with ext...'
2025-12-30T18:52:02.717726205Z [err]  2025-12-30 18:52:02,713 - persistent_tts_service - INFO - üìä [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] DIAGNOSTIC: queue_latency=10960ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-30T18:52:03.053426274Z [err]  2025-12-30 18:52:03,049 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-30T18:52:03.053432510Z [err]  2025-12-30 18:52:03,049 - server - INFO -    ‚úì Connection established (0.349s) [TARGET: <200ms]
2025-12-30T18:52:03.053436828Z [err]  2025-12-30 18:52:03,049 - server - INFO -    ‚úì Response status: 200
2025-12-30T18:52:03.053440855Z [err]  2025-12-30 18:52:03,049 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-30T18:52:03.077174842Z [err]  2025-12-30 18:52:03,072 - server - INFO -    ‚úì FIRST CHUNK received (0.372s, 1147 bytes) [TARGET: <300ms]
2025-12-30T18:52:03.081938569Z [err]  2025-12-30 18:52:03,079 - server - INFO -    ‚úì ALL CHUNKS received: 80 chunks (0.378s)
2025-12-30T18:52:03.081948412Z [err]  2025-12-30 18:52:03,079 - server - INFO -    ‚úì Total audio size: 17599 bytes
2025-12-30T18:52:03.081957206Z [err]  2025-12-30 18:52:03,079 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-30T18:52:03.081963473Z [err]  2025-12-30 18:52:03,079 - server - INFO -       - Connection: 349ms
2025-12-30T18:52:03.081971707Z [err]  2025-12-30 18:52:03,079 - server - INFO -       - First chunk: 372ms
2025-12-30T18:52:03.081978377Z [err]  2025-12-30 18:52:03,079 - server - INFO -       - All chunks: 378ms
2025-12-30T18:52:03.081984367Z [err]  2025-12-30 18:52:03,079 - server - INFO -       - Audio generation only: 23ms
2025-12-30T18:52:03.081993174Z [err]  2025-12-30 18:52:03,079 - server - INFO - ‚è±Ô∏è [18:52:03.079] üîä TTS COMPLETE: 466ms, audio_size=17599 bytes
2025-12-30T18:52:03.082001839Z [err]  2025-12-30 18:52:03,079 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2025-12-30T18:52:03.082012088Z [err]  2025-12-30 18:52:03,079 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.47s
2025-12-30T18:52:03.082020466Z [err]  2025-12-30 18:52:03,079 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-30T18:52:03.082033272Z [err]  2025-12-30 18:52:03,079 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-30T18:52:03.129534037Z [err]  2025-12-30 18:52:03,112 - persistent_tts_service - INFO - üîá [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] FLOOR RELEASED (is_holding_floor=False)
2025-12-30T18:52:03.378260928Z [err]  2025-12-30 18:52:03,375 - telnyx_service - INFO - üé¨ Playback ID: JbM3a_UIdg
2025-12-30T18:52:03.378265488Z [err]  2025-12-30 18:52:03,374 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA/actions/playback_start "HTTP/1.1 200 OK"
2025-12-30T18:52:03.378274699Z [err]  2025-12-30 18:52:03,375 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.30s
2025-12-30T18:52:03.378282768Z [err]  2025-12-30 18:52:03,375 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.76s
2025-12-30T18:52:03.378289088Z [err]  2025-12-30 18:52:03,375 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-30T18:52:03.387995382Z [err]  2025-12-30 18:52:03,384 - redis_service - INFO - ‚ûï Added playback JbM3a_UIdg to Redis for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:03.388000697Z [err]  2025-12-30 18:52:03,384 - server - INFO - üé¨ Check-in playback ID: JbM3a_UIdg (expected duration: 2.6s)
2025-12-30T18:52:03.388004580Z [err]  2025-12-30 18:52:03,385 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-30T18:52:03.706184393Z [inf]  100.64.0.11:10334 - "GET /api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3 HTTP/1.1" 200
2025-12-30T18:52:04.367046547Z [err]  2025-12-30 18:52:04,353 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:52:04.367054450Z [err]  2025-12-30 18:52:04,354 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'ffc5fe65-ab62-4357-a24e-ae1733b841ee', 'occurred_at': '2025-12-30T18:52:04.143236Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3', 'overlay': False, 'playback_id': 'JbM3a_UIdg'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:52:04.367061264Z [err]  2025-12-30 18:52:04,354 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:04.367068481Z [err]  2025-12-30 18:52:04,354 - server - INFO - üì® ================================================
2025-12-30T18:52:04.367074905Z [inf]  100.64.0.11:10334 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:52:04.929844443Z [err]  2025-12-30 18:52:04,919 - server - INFO - üî§ RAW TOKENS: [" That"?]
2025-12-30T18:52:04.929853532Z [err]  2025-12-30 18:52:04,920 - core_calling_service - INFO - üîä Silence timer reset for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (user started speaking)
2025-12-30T18:52:04.929860095Z [err]  2025-12-30 18:52:04,920 - core_calling_service - INFO - üë§ User started speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:04.929866854Z [err]  2025-12-30 18:52:04,920 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-30T18:52:04.929872011Z [err]  2025-12-30 18:52:04,920 - server - INFO - üîç PARTIAL TRANSCRIPT: 'That' | Generating: False
2025-12-30T18:52:04.929876595Z [err]  2025-12-30 18:52:04,920 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (1.1s left): 1 words - 'That'
2025-12-30T18:52:05.046453112Z [err]  2025-12-30 18:52:05,041 - server - INFO - üî§ RAW TOKENS: [" That"?, " was"?]
2025-12-30T18:52:05.046459067Z [err]  2025-12-30 18:52:05,042 - server - INFO - üîç PARTIAL TRANSCRIPT: 'That was' | Generating: False
2025-12-30T18:52:05.046464026Z [err]  2025-12-30 18:52:05,042 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (0.9s left): 2 words - 'That was'
2025-12-30T18:52:05.200812930Z [err]  2025-12-30 18:52:05,193 - server - INFO - üî§ RAW TOKENS: [" That"?, " was"?, " a"?]
2025-12-30T18:52:05.200823001Z [err]  2025-12-30 18:52:05,193 - server - INFO - üîç PARTIAL TRANSCRIPT: 'That was a' | Generating: False
2025-12-30T18:52:05.200831115Z [err]  2025-12-30 18:52:05,193 - server - INFO - üö¶ BARGE-IN CHECK during audio playback (0.8s left): 3 words - 'That was a'
2025-12-30T18:52:05.200839875Z [err]  2025-12-30 18:52:05,193 - server - INFO - üõë INTERRUPTION TRIGGERED - User said 3 words: 'That was a'
2025-12-30T18:52:05.200846757Z [err]  2025-12-30 18:52:05,193 - server - INFO - üõë Stopping agent IMMEDIATELY...
2025-12-30T18:52:05.200853088Z [err]  2025-12-30 18:52:05,193 - persistent_tts_service - INFO - ‚ö° [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2025-12-30T18:52:05.200860070Z [err]  2025-12-30 18:52:05,193 - persistent_tts_service - INFO - üõë [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] INTERRUPT - Floor Released (is_holding_floor=False)
2025-12-30T18:52:05.214868247Z [err]  2025-12-30 18:52:05,213 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-30T18:52:05.214876585Z [err]  2025-12-30 18:52:05,213 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Receiver got 0 chunks for sentence #5! interrupted=True
2025-12-30T18:52:05.227347954Z [err]  2025-12-30 18:52:05,223 - persistent_tts_service - INFO - üõë [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Sent clear event to Telnyx WebSocket (3x)
2025-12-30T18:52:05.227356468Z [err]  2025-12-30 18:52:05,223 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Reset playback_expected_end_time to NOW
2025-12-30T18:52:05.227363028Z [err]  2025-12-30 18:52:05,223 - server - INFO - ‚úã Cleared WebSocket TTS audio buffer
2025-12-30T18:52:05.227369133Z [err]  2025-12-30 18:52:05,223 - telnyx_service - INFO - üõë Stopping playback JbM3a_UIdg on call: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:05.430587919Z [err]  2025-12-30 18:52:05,427 - server - INFO - üî§ RAW TOKENS: [" That"?, " was"?, " a"?, " hall"?]
2025-12-30T18:52:05.430594103Z [err]  2025-12-30 18:52:05,427 - server - INFO - üîç PARTIAL TRANSCRIPT: 'That was a hall' | Generating: False
2025-12-30T18:52:05.572025371Z [err]  2025-12-30 18:52:05,524 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA/actions/playback_stop "HTTP/1.1 200 OK"
2025-12-30T18:52:05.572031067Z [err]  2025-12-30 18:52:05,525 - telnyx_service - INFO - ‚úÖ Successfully stopped playback JbM3a_UIdg
2025-12-30T18:52:05.572034912Z [err]  2025-12-30 18:52:05,525 - server - INFO - ‚úã Stopped 1 HTTP playbacks (kept comfort noise)
2025-12-30T18:52:05.572038687Z [err]  2025-12-30 18:52:05,532 - redis_service - INFO - üßπ Cleared all playbacks for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:05.572042313Z [err]  2025-12-30 18:52:05,532 - server - INFO - ‚úÖ Agent stopped, user can continue speaking
2025-12-30T18:52:05.581497233Z [err]  2025-12-30 18:52:05,579 - server - INFO - üî§ RAW TOKENS: [" That"?, " was"?, " a"?, " hall"?, "uc"?]
2025-12-30T18:52:05.581504543Z [err]  2025-12-30 18:52:05,579 - server - INFO - üîç PARTIAL TRANSCRIPT: 'That was a hall uc' | Generating: False
2025-12-30T18:52:05.757866797Z [err]  2025-12-30 18:52:05,753 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 1016 total packets
2025-12-30T18:52:05.757876887Z [err]  [2025-12-30 18:52:05 +0000] [5] [INFO] connection closed
2025-12-30T18:52:05.794414745Z [err]  2025-12-30 18:52:05,788 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:52:05.794420036Z [err]  2025-12-30 18:52:05,788 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '16edf625-58f3-4ae7-82da-38acdbf708db', 'occurred_at': '2025-12-30T18:52:05.243237Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3', 'overlay': False, 'playback_id': 'JbM3a_UIdg', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:52:05.794424301Z [err]  2025-12-30 18:52:05,788 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:05.794428513Z [err]  2025-12-30 18:52:05,788 - server - INFO - üì® ================================================
2025-12-30T18:52:05.804413602Z [err]  2025-12-30 18:52:05,803 - redis_service - INFO - ‚ûñ Removed playback JbM3a_UIdg, 0 remaining for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:05.804420705Z [err]  2025-12-30 18:52:05,803 - server - INFO - üîä Redis: Removed playback JbM3a_UIdg, 0 remaining
2025-12-30T18:52:05.804426937Z [err]  2025-12-30 18:52:05,803 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-30T18:52:05.814261050Z [err]  2025-12-30 18:52:05,807 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-30T18:52:05.814267018Z [err]  2025-12-30 18:52:05,807 - server - INFO - üí° Session not on this worker - Redis flag set for WebSocket worker to handle
2025-12-30T18:52:05.814270936Z [inf]  100.64.0.15:53308 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:52:05.942207224Z [err]  2025-12-30 18:52:05,932 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-30T18:52:05.942213836Z [err]  2025-12-30 18:52:05,932 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:05.942217578Z [err]  2025-12-30 18:52:05,938 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:52:05.942221418Z [err]  2025-12-30 18:52:05,938 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': 'aaefe173-a738-4bcf-ae3b-aede0539bed4', 'occurred_at': '2025-12-30T18:52:05.682256Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '13f7e234-96a9-48cd-986b-703e9e403304', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:52:05.942225192Z [err]  2025-12-30 18:52:05,938 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:05.942230127Z [err]  2025-12-30 18:52:05,938 - server - INFO - üì® ================================================
2025-12-30T18:52:05.942234797Z [inf]  100.64.0.11:10334 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:52:06.135408281Z [err]  2025-12-30 18:52:06,092 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:52:06.135419979Z [err]  2025-12-30 18:52:06,092 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': 'a712b701-0142-421b-a9b2-e2f680a315cc', 'occurred_at': '2025-12-30T18:52:05.503238Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '9.52', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '1042', 'skip_packet_count': '25'}, 'outbound': {'packet_count': '1017', 'skip_packet_count': '0'}}, 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-30T18:52:05.503238Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-30T18:51:41.043243Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:52:06.135428801Z [err]  2025-12-30 18:52:06,092 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:06.135438900Z [err]  2025-12-30 18:52:06,092 - server - INFO - üì® ================================================
2025-12-30T18:52:06.135447830Z [err]  2025-12-30 18:52:06,093 - server - INFO - üìû Call ended: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:06.135454190Z [err]  2025-12-30 18:52:06,093 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-30T18:52:06.135460695Z [err]  2025-12-30 18:52:06,111 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:52:06.135468232Z [err]  2025-12-30 18:52:06,111 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '03702aa6-7a6a-43da-bb96-cd4c8f950c72', 'occurred_at': '2025-12-30T18:52:05.543234Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-30T18:52:05.543234Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'sA3-2oUX9w', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:52:06.139314011Z [err]  2025-12-30 18:52:06,111 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:06.139324209Z [err]  2025-12-30 18:52:06,111 - server - INFO - üì® ================================================
2025-12-30T18:52:06.139333619Z [err]  2025-12-30 18:52:06,121 - redis_service - INFO - ‚ûñ Removed playback sA3-2oUX9w, 0 remaining for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:06.139341187Z [err]  2025-12-30 18:52:06,121 - server - INFO - üîä Redis: Removed playback sA3-2oUX9w, 0 remaining
2025-12-30T18:52:06.139348053Z [err]  2025-12-30 18:52:06,121 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-30T18:52:06.139354611Z [err]  2025-12-30 18:52:06,126 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-30T18:52:06.139360673Z [inf]  100.64.0.17:52982 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:52:06.311094308Z [err]  2025-12-30 18:52:06,281 - server - INFO - üìù Updated call log: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:06.395692898Z [err]  2025-12-30 18:52:06,375 - server - INFO - ‚úÖ Finalized call log: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA (duration=21s, status=completed)
2025-12-30T18:52:06.503403404Z [err]  2025-12-30 18:52:06,468 - server - INFO - üì¶ Saved 10 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-30T18:52:07.199804391Z [err]  2025-12-30 18:52:07,175 - server - INFO - üìä Auto-added call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-30T18:52:07.360861326Z [err]  2025-12-30 18:52:07,357 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-30T18:52:07.365072575Z [err]  2025-12-30 18:52:07,362 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.365077999Z [err]  2025-12-30 18:52:07,362 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2025-12-30T18:52:07.365082924Z [err]  2025-12-30 18:52:07,363 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-30T18:52:07.465447231Z [err]  2025-12-30 18:52:07,457 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-30T18:52:07.635564197Z [err]  2025-12-30 18:52:07,544 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-30T18:52:07.635572772Z [err]  2025-12-30 18:52:07,544 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-30T18:52:07.635578482Z [err]  2025-12-30 18:52:07,544 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-30T18:52:07.635583400Z [err]  2025-12-30 18:52:07,545 - server - INFO - üöÄ Triggered QC analysis for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.635587614Z [err]  2025-12-30 18:52:07,545 - server - INFO - üìä Triggered Campaign QC for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.635591977Z [err]  2025-12-30 18:52:07,545 - server - INFO - üìá Triggered CRM update for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.635596077Z [err]  2025-12-30 18:52:07,545 - persistent_tts_service - INFO - üîå [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Closing persistent TTS WebSocket...
2025-12-30T18:52:07.635601292Z [err]  2025-12-30 18:52:07,545 - server - INFO - üîç Starting QC analysis for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.635606025Z [err]  2025-12-30 18:52:07,545 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-30T18:52:07.635610119Z [err]  2025-12-30 18:52:07,546 - server - INFO - üìá CRM update starting for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-30T18:52:07.635834490Z [err]  2025-12-30 18:52:07,546 - server - INFO - üìá Normalized phone: +17708336397
2025-12-30T18:52:07.635842698Z [err]  2025-12-30 18:52:07,546 - server - INFO - üìá CRM: Got 10 variables from active session
2025-12-30T18:52:07.635851285Z [err]  2025-12-30 18:52:07,546 - persistent_tts_service - INFO - üõë [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Audio Receiver Loop CANCELLED
2025-12-30T18:52:07.635857787Z [err]  2025-12-30 18:52:07,546 - persistent_tts_service - INFO - üëã [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Audio Receiver Loop STOPPED
2025-12-30T18:52:07.635864127Z [err]  2025-12-30 18:52:07,546 - persistent_tts_service - INFO - üõë [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Playback consumer shutting down
2025-12-30T18:52:07.635870973Z [err]  2025-12-30 18:52:07,633 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-30T18:52:07.635877404Z [err]  2025-12-30 18:52:07,633 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '8dcaf1e2-8363-45ea-8606-8a401276378c', 'occurred_at': '2025-12-30T18:52:07.053821Z', 'payload': {'call_control_id': 'v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA', 'call_leg_id': '93f6f2fe-e5b0-11f0-a5f5-02420aef97a0', 'call_session_id': '93f431a4-e5b0-11f0-9ac9-02420aef97a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-30T18:52:05.597723Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-30T18:52:05.597723Z', 'recording_id': 'e7369d7b-4d22-4bf0-b7e3-f6cd0ecbe3cd', 'recording_started_at': '2025-12-30T18:51:47.722695Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-30/93f6f2fe-e5b0-11f0-a5f5-02420aef97a0-1767120706806622.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251230%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251230T185207Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=054d7c583911d3ab009b090f3b2c777415ca0f328fe95fb4c068d26c8c900ba9'}, 'start_time': '2025-12-30T18:51:47.722695Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-30T18:52:07.636025219Z [err]  2025-12-30 18:52:07,633 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.636032357Z [err]  2025-12-30 18:52:07,633 - server - INFO - üì® ================================================
2025-12-30T18:52:07.636039021Z [err]  2025-12-30 18:52:07,633 - server - INFO - üéôÔ∏è Recording saved for call: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.639990835Z [err]  2025-12-30 18:52:07,636 - server - INFO - üìù Converted transcript from 3 messages to 222 characters
2025-12-30T18:52:07.639997050Z [err]  2025-12-30 18:52:07,638 - redis_service - INFO - üì• Retrieved call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:07.640002653Z [err]  2025-12-30 18:52:07,638 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=e7369d7b-4d22-4bf0-b7e3-f6cd0ecbe3cd, call_data=True
2025-12-30T18:52:07.735569298Z [err]  2025-12-30 18:52:07,734 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-30T18:52:07.745312551Z [err]  2025-12-30 18:52:07,741 - server - INFO - üíæ Saved recording URL and ID to database: e7369d7b-4d22-4bf0-b7e3-f6cd0ecbe3cd
2025-12-30T18:52:07.745318612Z [err]  2025-12-30 18:52:07,741 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-30T18:52:07.745323251Z [err]  2025-12-30 18:52:07,741 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-30T18:52:07.792098563Z [err]  2025-12-30 18:52:07,791 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-30T18:52:07.792563727Z [err]  2025-12-30 18:52:07,791 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-30T18:52:07.829914752Z [err]  2025-12-30 18:52:07,823 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-30T18:52:07.920331616Z [err]  2025-12-30 18:52:07,909 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-30T18:52:07.920338130Z [err]  2025-12-30 18:52:07,910 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-30T18:52:07.920342869Z [err]  2025-12-30 18:52:07,910 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:08.128816223Z [err]  2025-12-30 18:52:08,107 - server - INFO - üìá CRM: Got 10 extracted variables
2025-12-30T18:52:08.128824991Z [err]  2025-12-30 18:52:08,108 - server - INFO - üìá CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-30T18:52:08.128831962Z [err]  2025-12-30 18:52:08,123 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=3, logs_count=4, status=completed
2025-12-30T18:52:08.133126113Z [err]  2025-12-30 18:52:08,130 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-30/93f6f2fe-e5b0-11f0-a5f5-02420aef97a0-1767120706806622.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251230%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251230T185207Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=054d7c583911d3ab009b090f3b2c777415ca0f328fe95fb4c068d26c8c900ba9 "HTTP/1.1 200 OK"
2025-12-30T18:52:08.245459763Z [err]  2025-12-30 18:52:08,218 - server - INFO - ‚úÖ Downloaded 71723 bytes
2025-12-30T18:52:08.317078670Z [err]  2025-12-30 18:52:08,288 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-30T18:52:08.571133854Z [err]  2025-12-30 18:52:08,560 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-30T18:52:08.651412437Z [err]  2025-12-30 18:52:08,649 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-30T18:52:08.651418693Z [err]  2025-12-30 18:52:08,649 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-30T18:52:08.651422922Z [err]  2025-12-30 18:52:08,649 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-30T18:52:08.651427143Z [err]  2025-12-30 18:52:08,650 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-30T18:52:08.651431582Z [err]    File "/app/backend/server.py", line 9773, in trigger_campaign_qc_for_call
2025-12-30T18:52:08.651436038Z [err]      await run_full_qc_analysis(
2025-12-30T18:52:08.651441727Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-30T18:52:08.651445874Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-30T18:52:08.651451071Z [err]  
2025-12-30T18:52:08.661361756Z [err]  2025-12-30 18:52:08,656 - elevenlabs_ws_service - INFO - üîå Closed ElevenLabs WebSocket connection
2025-12-30T18:52:08.661367769Z [err]  2025-12-30 18:52:08,656 - persistent_tts_service - INFO - ‚úÖ [Call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA] Persistent TTS WebSocket closed
2025-12-30T18:52:08.661374606Z [err]  2025-12-30 18:52:08,656 - persistent_tts_service - INFO - ‚úÖ Closed persistent TTS session for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:08.661378658Z [err]  2025-12-30 18:52:08,656 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:08.661771191Z [err]  2025-12-30 18:52:08,660 - redis_service - INFO - üßπ Deleted call data from Redis: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:08.661775393Z [err]  2025-12-30 18:52:08,660 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:08.661779126Z [inf]  100.64.0.16:62696 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:52:08.967698752Z [err]  2025-12-30 18:52:08,966 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:09.038969811Z [err]  2025-12-30 18:52:09,024 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-12-30T18:52:09.038976213Z [err]  2025-12-30 18:52:09,025 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-30T18:52:09.038980895Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-30T18:52:09.038985873Z [err]  2025-12-30 18:52:09,025 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-30T18:52:09.038990358Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2025-12-30T18:52:09.038994646Z [err]  2025-12-30 18:52:09,026 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:09.518847174Z [err]  2025-12-30 18:52:09,473 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:09.939371224Z [err]  2025-12-30 18:52:09,907 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-12-30T18:52:09.939380538Z [err]  2025-12-30 18:52:09,908 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-30T18:52:09.939387921Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-30T18:52:09.939394047Z [err]  2025-12-30 18:52:09,908 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-30T18:52:09.939400484Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2025-12-30T18:52:09.939405940Z [err]  2025-12-30 18:52:09,908 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:10.008933107Z [err]  2025-12-30 18:52:09,978 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:10.492451330Z [err]  2025-12-30 18:52:10,483 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:10.492457581Z [err]  2025-12-30 18:52:10,483 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2025-12-30T18:52:10.861330638Z [err]  2025-12-30 18:52:10,859 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-12-30T18:52:10.861337370Z [err]  2025-12-30 18:52:10,859 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-30T18:52:10.861342415Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-30T18:52:10.861346521Z [err]  2025-12-30 18:52:10,859 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-30T18:52:10.861350896Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-30T18:52:10.966357768Z [err]  2025-12-30 18:52:10,955 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:10.966364990Z [err]  2025-12-30 18:52:10,955 - server - INFO - ‚úÖ QC analysis completed for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:10.966369609Z [err]  2025-12-30 18:52:10,955 - server - INFO - üìä Scores: Commitment=50, Conversion=20, Excellence=50
2025-12-30T18:52:11.002643102Z [err]  2025-12-30 18:52:10,989 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:11.002651955Z [err]  2025-12-30 18:52:10,990 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2025-12-30T18:52:11.211229166Z [err]  2025-12-30 18:52:11,144 - server - INFO - üìä Updated campaign_calls with QC scores for v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA
2025-12-30T18:52:11.346484187Z [err]  2025-12-30 18:52:11,324 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-30T18:52:11.418696045Z [err]  2025-12-30 18:52:11,416 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-30T18:52:11.418703630Z [err]  2025-12-30 18:52:11,416 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:JtXB3EMA80vHXwrmoRs2BjLR26MWadIVZzfLypNPcSz-VE2PUc1wJA: 'str' object has no attribute 'get'
2025-12-30T18:52:11.554914429Z [err]  2025-12-30 18:52:11,495 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:12.004339686Z [err]  2025-12-30 18:52:12,000 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:12.559741863Z [err]  2025-12-30 18:52:12,505 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:13.031653412Z [err]  2025-12-30 18:52:13,010 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:13.069960197Z [err]  2025-12-30 18:52:13,063 - server - INFO - ‚úÖ Split into 2 channels
2025-12-30T18:52:13.069970483Z [err]  2025-12-30 18:52:13,063 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-30T18:52:13.069978353Z [err]  2025-12-30 18:52:13,063 - server - INFO - üìä Channel 0: 390764 bytes
2025-12-30T18:52:13.069986574Z [err]  2025-12-30 18:52:13,063 - server - ERROR - ‚ùå No Soniox API key available
2025-12-30T18:52:13.069994708Z [err]  2025-12-30 18:52:13,064 - server - INFO - ‚ùå Channel 0: No speech
2025-12-30T18:52:13.070001871Z [err]  2025-12-30 18:52:13,064 - server - INFO - üìä Channel 1: 390764 bytes
2025-12-30T18:52:13.070008990Z [err]  2025-12-30 18:52:13,064 - server - ERROR - ‚ùå No Soniox API key available
2025-12-30T18:52:13.070015690Z [err]  2025-12-30 18:52:13,064 - server - INFO - ‚ùå Channel 1: No speech
2025-12-30T18:52:13.070022850Z [err]  2025-12-30 18:52:13,064 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-30T18:52:13.070028910Z [inf]  100.64.0.12:10732 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-30T18:52:13.557416752Z [err]  2025-12-30 18:52:13,515 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:14.101901323Z [err]  2025-12-30 18:52:14,020 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:14.576559090Z [err]  2025-12-30 18:52:14,525 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:15.037904568Z [err]  2025-12-30 18:52:15,030 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:15.581906557Z [err]  2025-12-30 18:52:15,535 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:16.051359897Z [err]  2025-12-30 18:52:16,040 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:16.738763291Z [err]  2025-12-30 18:52:16,547 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:17.084315255Z [err]  2025-12-30 18:52:17,052 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:17.580194347Z [err]  2025-12-30 18:52:17,557 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:18.067127552Z [err]  2025-12-30 18:52:18,062 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:18.612198935Z [err]  2025-12-30 18:52:18,567 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:19.074440421Z [err]  2025-12-30 18:52:19,072 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:19.607729201Z [err]  2025-12-30 18:52:19,577 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:20.084818002Z [err]  2025-12-30 18:52:20,082 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:20.084825449Z [err]  2025-12-30 18:52:20,082 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2025-12-30T18:52:20.628220527Z [err]  2025-12-30 18:52:20,587 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:20.628228979Z [err]  2025-12-30 18:52:20,588 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=1/2
2025-12-30T18:52:21.094955914Z [err]  2025-12-30 18:52:21,093 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:21.606088562Z [err]  2025-12-30 18:52:21,598 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:22.113225855Z [err]  2025-12-30 18:52:22,103 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:22.646957678Z [err]  2025-12-30 18:52:22,608 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:23.132627347Z [err]  2025-12-30 18:52:23,113 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])
2025-12-30T18:52:23.624827522Z [err]  2025-12-30 18:52:23,618 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:JtXB3EMA80vHXwrmo... (active sessions: [])