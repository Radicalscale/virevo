2025-12-26T12:15:11.000000000Z [inf]  Starting Container
2025-12-26T12:15:13.540469738Z [inf]  =========================================
2025-12-26T12:15:13.540477093Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2025-12-26T12:15:13.540484083Z [inf]  =========================================
2025-12-26T12:15:13.540490681Z [inf]  üìç Working directory: /app/backend
2025-12-26T12:15:13.540496949Z [inf]  üîç Python path: /app/backend
2025-12-26T12:15:13.540504301Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2025-12-26T12:15:13.540509958Z [inf]  =========================================
2025-12-26T12:15:13.540515801Z [err]  [2025-12-26 12:15:12 +0000] [1] [INFO] Starting gunicorn 22.0.0
2025-12-26T12:15:13.540521607Z [err]  [2025-12-26 12:15:12 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2025-12-26T12:15:13.540527055Z [err]  [2025-12-26 12:15:12 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-26T12:15:13.540537205Z [err]  [2025-12-26 12:15:12 +0000] [3] [INFO] Booting worker with pid: 3
2025-12-26T12:15:13.540543163Z [err]  [2025-12-26 12:15:12 +0000] [4] [INFO] Booting worker with pid: 4
2025-12-26T12:15:13.540548548Z [err]  [2025-12-26 12:15:12 +0000] [5] [INFO] Booting worker with pid: 5
2025-12-26T12:15:13.540553558Z [err]  [2025-12-26 12:15:12 +0000] [6] [INFO] Booting worker with pid: 6
2025-12-26T12:15:34.800238776Z [err]  2025-12-26 12:15:32,131 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-26T12:15:34.800247674Z [err]  2025-12-26 12:15:32,131 - server - INFO - üî• Pre-warming connection libraries...
2025-12-26T12:15:34.800253582Z [err]  2025-12-26 12:15:32,136 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-26T12:15:34.800259397Z [err]  2025-12-26 12:15:32,136 - server - INFO - üî• Pre-warming connection libraries...
2025-12-26T12:15:34.800265620Z [err]  2025-12-26 12:15:32,165 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-26T12:15:34.800273016Z [err]  2025-12-26 12:15:32,188 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-26T12:15:34.800278890Z [err]  2025-12-26 12:15:32,294 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-26T12:15:34.800286225Z [err]  2025-12-26 12:15:32,294 - server - INFO - üî• Pre-warming connection libraries...
2025-12-26T12:15:34.800291888Z [err]  2025-12-26 12:15:32,325 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-26T12:15:34.800298266Z [err]  2025-12-26 12:15:32,332 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-26T12:15:34.800308547Z [err]  2025-12-26 12:15:32,350 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-26T12:15:34.800314436Z [err]  2025-12-26 12:15:32,482 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-26T12:15:34.812543548Z [err]  2025-12-26 12:15:32,501 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-26T12:15:34.812556443Z [err]  2025-12-26 12:15:32,540 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-26T12:15:35.965870264Z [err]  2025-12-26 12:15:32,548 - server - INFO - ‚úÖ QC agent router loaded
2025-12-26T12:15:35.965876054Z [err]  2025-12-26 12:15:32,583 - server - INFO - ‚úÖ QC learning router loaded
2025-12-26T12:15:35.965881391Z [err]  2025-12-26 12:15:32,585 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-26T12:15:35.965887244Z [err]  2025-12-26 12:15:32,587 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-26T12:15:35.965892443Z [err]  2025-12-26 12:15:32,587 - server - INFO - üî• Pre-warming connection libraries...
2025-12-26T12:15:35.965897971Z [err]  2025-12-26 12:15:32,617 - server - INFO - ‚úÖ QC agent router loaded
2025-12-26T12:15:35.965903090Z [err]  2025-12-26 12:15:32,646 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-26T12:15:35.965908765Z [err]  2025-12-26 12:15:32,651 - server - INFO - ‚úÖ QC agent router loaded
2025-12-26T12:15:35.965914608Z [err]  2025-12-26 12:15:32,651 - server - INFO - ‚úÖ QC learning router loaded
2025-12-26T12:15:35.965920631Z [err]  2025-12-26 12:15:32,716 - server - INFO - ‚úÖ QC learning router loaded
2025-12-26T12:15:35.965925476Z [err]  2025-12-26 12:15:32,754 - server - INFO - ‚úÖ CRM router loaded
2025-12-26T12:15:35.965931107Z [err]  2025-12-26 12:15:32,775 - server - INFO - ‚úÖ QC test router loaded
2025-12-26T12:15:35.965937639Z [err]  2025-12-26 12:15:32,810 - server - INFO - ‚úÖ Agent test router loaded
2025-12-26T12:15:35.965944063Z [err]  2025-12-26 12:15:32,823 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-26T12:15:35.965949771Z [err]  2025-12-26 12:15:32,823 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-26T12:15:35.965955631Z [err]  [2025-12-26 12:15:32 +0000] [6] [INFO] Started server process [6]
2025-12-26T12:15:35.965961415Z [err]  [2025-12-26 12:15:32 +0000] [6] [INFO] Waiting for application startup.
2025-12-26T12:15:37.211447023Z [err]  2025-12-26 12:15:32,872 - server - INFO - ‚úÖ CRM router loaded
2025-12-26T12:15:37.211460096Z [err]  2025-12-26 12:15:32,879 - server - INFO - ‚úÖ QC test router loaded
2025-12-26T12:15:37.211813385Z [err]  2025-12-26 12:15:32,847 - server - INFO - ‚úÖ CRM router loaded
2025-12-26T12:15:37.211821515Z [err]  2025-12-26 12:15:32,852 - server - INFO - ‚úÖ QC test router loaded
2025-12-26T12:15:37.211829011Z [err]  2025-12-26 12:15:32,861 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-26T12:15:37.211885774Z [err]  2025-12-26 12:15:32,879 - server - INFO - ‚úÖ Agent test router loaded
2025-12-26T12:15:37.211898148Z [err]  2025-12-26 12:15:32,886 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-26T12:15:37.211905261Z [err]  2025-12-26 12:15:32,896 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-26T12:15:37.211911714Z [err]  2025-12-26 12:15:32,896 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-26T12:15:37.211918935Z [err]  2025-12-26 12:15:32,908 - server - INFO - ‚úÖ Agent test router loaded
2025-12-26T12:15:37.211925447Z [err]  [2025-12-26 12:15:32 +0000] [4] [INFO] Started server process [4]
2025-12-26T12:15:37.211931466Z [err]  [2025-12-26 12:15:32 +0000] [4] [INFO] Waiting for application startup.
2025-12-26T12:15:37.211938636Z [err]  2025-12-26 12:15:32,932 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-26T12:15:37.211944690Z [err]  2025-12-26 12:15:32,932 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-26T12:15:37.211951436Z [err]  2025-12-26 12:15:32,935 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-26T12:15:37.211957551Z [err]  [2025-12-26 12:15:32 +0000] [5] [INFO] Started server process [5]
2025-12-26T12:15:37.211963189Z [err]  [2025-12-26 12:15:32 +0000] [5] [INFO] Waiting for application startup.
2025-12-26T12:15:38.557966371Z [err]  2025-12-26 12:15:32,972 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-26T12:15:38.557973437Z [err]  2025-12-26 12:15:33,000 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-26T12:15:38.557980624Z [err]  2025-12-26 12:15:33,109 - server - INFO - ‚úÖ QC agent router loaded
2025-12-26T12:15:38.557987126Z [err]  2025-12-26 12:15:33,160 - server - INFO - ‚úÖ QC learning router loaded
2025-12-26T12:15:38.557993253Z [err]  2025-12-26 12:15:33,392 - server - INFO - ‚úÖ CRM router loaded
2025-12-26T12:15:38.557997897Z [err]  2025-12-26 12:15:33,403 - server - INFO - ‚úÖ QC test router loaded
2025-12-26T12:15:38.558003663Z [err]  2025-12-26 12:15:33,427 - server - INFO - ‚úÖ Agent test router loaded
2025-12-26T12:15:38.558008398Z [err]  2025-12-26 12:15:33,440 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-26T12:15:38.558013539Z [err]  2025-12-26 12:15:33,440 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-26T12:15:38.558026229Z [err]  [2025-12-26 12:15:33 +0000] [3] [INFO] Started server process [3]
2025-12-26T12:15:38.558030873Z [err]  [2025-12-26 12:15:33 +0000] [3] [INFO] Waiting for application startup.
2025-12-26T12:15:38.558035459Z [err]  2025-12-26 12:15:33,486 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-26T12:15:47.043513734Z [err]  2025-12-26 12:15:46,118 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-26T12:15:47.043521984Z [err]  2025-12-26 12:15:46,118 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-26T12:15:47.043530286Z [err]  2025-12-26 12:15:46,118 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-26T12:15:47.043539196Z [err]  2025-12-26 12:15:46,118 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-26T12:15:47.043547865Z [err]  2025-12-26 12:15:46,268 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-26T12:15:47.043555328Z [err]  2025-12-26 12:15:46,268 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-26T12:15:47.043567072Z [err]  2025-12-26 12:15:46,268 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-26T12:15:47.043577050Z [err]  2025-12-26 12:15:46,268 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-26T12:15:47.043585365Z [err]  2025-12-26 12:15:46,387 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-26T12:15:47.043595859Z [err]  2025-12-26 12:15:46,403 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-26T12:15:47.043606436Z [err]  2025-12-26 12:15:46,405 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-26T12:15:47.043615805Z [err]  2025-12-26 12:15:46,405 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-26T12:15:47.043625584Z [err]  2025-12-26 12:15:46,424 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-26T12:15:48.140700441Z [err]  [2025-12-26 12:15:47 +0000] [3] [INFO] Application startup complete.
2025-12-26T12:15:48.140710580Z [err]  2025-12-26 12:15:47,607 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-26T12:15:48.140713068Z [err]  2025-12-26 12:15:46,433 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-26T12:15:48.140718365Z [err]  2025-12-26 12:15:46,434 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-26T12:15:48.140719389Z [err]  2025-12-26 12:15:47,607 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-26T12:15:48.140722376Z [err]  2025-12-26 12:15:46,434 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-26T12:15:48.140730412Z [err]  2025-12-26 12:15:47,242 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-26T12:15:48.140737135Z [err]  2025-12-26 12:15:47,444 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-26T12:15:48.140743582Z [err]  2025-12-26 12:15:47,444 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-26T12:15:48.140751393Z [err]  [2025-12-26 12:15:47 +0000] [5] [INFO] Application startup complete.
2025-12-26T12:15:48.140757275Z [err]  2025-12-26 12:15:47,463 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-26T12:15:48.140763666Z [err]  2025-12-26 12:15:47,472 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-26T12:15:48.140769593Z [err]  2025-12-26 12:15:47,501 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-26T12:15:48.140778176Z [err]  2025-12-26 12:15:47,596 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-26T12:15:48.140787788Z [err]  2025-12-26 12:15:47,596 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-26T12:15:49.239311279Z [err]  [2025-12-26 12:15:47 +0000] [6] [INFO] Application startup complete.
2025-12-26T12:15:49.239327772Z [err]  2025-12-26 12:15:47,633 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-26T12:15:49.239337365Z [err]  2025-12-26 12:15:47,634 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-26T12:15:49.239344208Z [err]  [2025-12-26 12:15:47 +0000] [4] [INFO] Application startup complete.
2025-12-26T12:16:31.474702990Z [inf]  100.64.0.2:37592 - "POST /api/auth/logout HTTP/1.1" 401
2025-12-26T12:16:31.474719595Z [inf]  100.64.0.3:16292 - "OPTIONS /api/auth/login HTTP/1.1" 200
2025-12-26T12:16:31.474725835Z [inf]  100.64.0.2:37592 - "POST /api/auth/login HTTP/1.1" 200
2025-12-26T12:16:31.474732110Z [inf]  100.64.0.2:37592 - "GET /api/agents HTTP/1.1" 200
2025-12-26T12:16:31.474739534Z [inf]  100.64.0.2:37592 - "GET /api/agents HTTP/1.1" 200
2025-12-26T12:16:50.908026344Z [err]  2025-12-26 12:16:43,838 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-26T12:16:50.908036644Z [err]  2025-12-26 12:16:44,821 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-26T12:16:50.908044262Z [err]  2025-12-26 12:16:44,825 - telnyx_service - INFO - ‚úÖ Call initiated: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:50.908155130Z [inf]  100.64.0.2:37592 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-26T12:16:50.908165614Z [err]  2025-12-26 12:16:43,603 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-26T12:16:50.908172873Z [err]  2025-12-26 12:16:43,700 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:16:50.908207518Z [err]  2025-12-26 12:16:44,934 - server - INFO - üìù Created call log: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:50.908213472Z [err]  2025-12-26 12:16:44,934 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-26T12:16:50.908222528Z [err]  2025-12-26 12:16:44,934 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-26T12:16:50.908232058Z [err]  2025-12-26 12:16:43,801 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:16:50.908323553Z [err]  2025-12-26 12:16:43,837 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-26T12:16:50.908331680Z [err]  2025-12-26 12:16:43,838 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-26T12:16:50.908338468Z [err]  2025-12-26 12:16:43,838 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-26T12:16:52.337219851Z [err]  2025-12-26 12:16:44,934 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-26T12:16:52.337227099Z [err]  2025-12-26 12:16:44,934 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-26T12:16:52.337234993Z [err]  2025-12-26 12:16:44,945 - redis_service - INFO - üì¶ Stored call data in Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (TTL: 3600s)
2025-12-26T12:16:52.337242239Z [err]  2025-12-26 12:16:44,945 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-26T12:16:52.337247169Z [err]  2025-12-26 12:16:44,945 - server - INFO - üìû Outbound call initiated: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:52.337253733Z [inf]  100.64.0.4:15870 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-26T12:16:52.337266334Z [err]  2025-12-26 12:16:45,150 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-26T12:16:52.337273246Z [err]  2025-12-26 12:16:45,150 - server - INFO -    Client: Address(host='100.64.0.5', port=37854)
2025-12-26T12:16:52.337279731Z [err]  2025-12-26 12:16:45,150 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'H4BdYcLEraSn6em3E//gwA==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'DQVJvbKiSBWa-VBD9I3ezw', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766751404922', 'accept-encoding': 'gzip'}
2025-12-26T12:16:52.337811876Z [err]  2025-12-26 12:16:45,150 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-26T12:16:52.337822383Z [err]  2025-12-26 12:16:45,150 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-26T12:16:53.655185645Z [err]  [2025-12-26 12:16:45 +0000] [6] [INFO] ('100.64.0.5', 37854) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-26T12:16:53.655221018Z [err]  2025-12-26 12:16:45,150 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-26T12:16:53.655221060Z [err]  [2025-12-26 12:16:45 +0000] [6] [INFO] connection open
2025-12-26T12:16:53.655232918Z [err]  2025-12-26 12:16:45,303 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-26T12:16:53.655241666Z [err]  2025-12-26 12:16:45,303 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-26T12:16:53.655247796Z [err]  2025-12-26 12:16:45,316 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:16:53.655254085Z [err]  2025-12-26 12:16:45,316 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '9f4ebf66-cf0a-46d5-8e9d-c40ff02fef2c', 'occurred_at': '2025-12-26T12:16:44.623241Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:16:53.655261501Z [err]  2025-12-26 12:16:45,316 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:53.655267684Z [err]  2025-12-26 12:16:45,316 - server - INFO - üì® ================================================
2025-12-26T12:16:53.655274382Z [err]  2025-12-26 12:16:45,316 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-26T12:16:53.655282742Z [inf]  100.64.0.6:60892 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:16:55.174673458Z [err]  2025-12-26 12:16:45,525 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-26T12:16:55.174679017Z [err]  2025-12-26 12:16:45,528 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-26T12:16:55.174684834Z [err]  2025-12-26 12:16:49,581 - server - INFO - üì¨ Received Telnyx event: start
2025-12-26T12:16:55.174750156Z [err]  2025-12-26 12:16:49,581 - server - INFO - üé¨ Stream started for call: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:55.174756443Z [err]  2025-12-26 12:16:49,595 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:55.174770794Z [err]  2025-12-26 12:16:49,597 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-26T12:16:55.174783841Z [err]  2025-12-26 12:16:49,597 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-26T12:16:55.174789926Z [err]  2025-12-26 12:16:49,957 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:16:55.174795945Z [err]  2025-12-26 12:16:49,957 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'adfc0f87-e348-42f5-80d2-e3ec43274cd1', 'occurred_at': '2025-12-26T12:16:49.283254Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-26T12:16:44.623241Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:16:55.174805865Z [err]  2025-12-26 12:16:49,957 - server - INFO - üéØ Event type: call.answered, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:56.678385430Z [err]  2025-12-26 12:16:50,570 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': '454d6893-0906-4857-b0da-59c0ce637b14', 'occurred_at': '2025-12-26T12:16:49.803234Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '800091d0-1567-431e-a6c4-1fdabd366e50', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:16:56.678653660Z [err]  2025-12-26 12:16:49,957 - server - INFO - üì® ================================================
2025-12-26T12:16:56.678660061Z [err]  2025-12-26 12:16:49,957 - server - INFO - ‚úÖ Call answered: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:56.678667212Z [err]  2025-12-26 12:16:49,973 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:56.678671799Z [err]  2025-12-26 12:16:50,099 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-26T12:16:56.678678863Z [err]  2025-12-26 12:16:50,117 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-26T12:16:56.678681633Z [err]  2025-12-26 12:16:50,112 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:56.678686413Z [err]  2025-12-26 12:16:50,117 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-26T12:16:56.678693782Z [err]  2025-12-26 12:16:50,570 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:16:56.678698322Z [err]  2025-12-26 12:16:49,974 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-26T12:16:56.678705573Z [err]  2025-12-26 12:16:49,974 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-26T12:16:56.678713355Z [err]  2025-12-26 12:16:50,099 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-26T12:16:58.607337087Z [err]  2025-12-26 12:16:50,570 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:16:58.607343104Z [inf]  100.64.0.8:47252 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:16:58.607348762Z [err]  2025-12-26 12:16:50,571 - server - INFO - üì® ================================================
2025-12-26T12:16:58.607354356Z [err]  2025-12-26 12:16:50,913 - server - INFO - ‚úÖ Call log updated
2025-12-26T12:16:58.607359884Z [err]  2025-12-26 12:16:50,913 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-26T12:16:58.607366015Z [err]  2025-12-26 12:16:50,913 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-26T12:16:58.607371472Z [err]  2025-12-26 12:16:50,913 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-26T12:16:58.607376952Z [err]  2025-12-26 12:16:51,009 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:16:58.607383709Z [err]  2025-12-26 12:16:51,026 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-26T12:16:58.607389343Z [err]  2025-12-26 12:16:51,026 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-26T12:16:58.607395614Z [err]  2025-12-26 12:16:51,044 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-26T12:16:58.607401314Z [err]  2025-12-26 12:16:51,044 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-26T12:16:58.607406919Z [err]  2025-12-26 12:16:51,046 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-26T12:17:00.323415108Z [err]  2025-12-26 12:16:51,099 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:00.323420919Z [err]  2025-12-26 12:16:51,099 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-26T12:17:00.323426891Z [err]  2025-12-26 12:16:51,137 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-26T12:17:00.323433684Z [err]  2025-12-26 12:16:51,140 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:00.323443248Z [err]  2025-12-26 12:16:51,157 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 110ms
2025-12-26T12:17:00.323449605Z [err]  2025-12-26 12:16:51,157 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-26T12:17:00.323455805Z [err]  2025-12-26 12:16:51,157 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-26T12:17:00.323481141Z [err]  2025-12-26 12:16:51,157 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-26T12:17:00.323488365Z [err]  2025-12-26 12:16:51,157 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-26T12:17:00.323494523Z [err]  2025-12-26 12:16:51,159 - server - INFO - ‚úÖ Initialized call_states for v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw with session reference
2025-12-26T12:17:00.323501899Z [err]  2025-12-26 12:16:51,168 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-26T12:17:00.323508132Z [err]  2025-12-26 12:16:51,255 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-26T12:17:00.323514375Z [err]  2025-12-26 12:16:51,329 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-26T12:17:00.323520426Z [err]  2025-12-26 12:16:51,330 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-26T12:17:01.725796743Z [err]  2025-12-26 12:16:51,420 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw/actions/playback_start "HTTP/1.1 200 OK"
2025-12-26T12:17:01.725802382Z [err]  2025-12-26 12:16:51,427 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: mDqsKVOg0A (loop=True, overlay=True)
2025-12-26T12:17:01.725809528Z [err]  2025-12-26 12:16:51,427 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw'
2025-12-26T12:17:01.725815046Z [err]  2025-12-26 12:16:51,427 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:01.725820152Z [err]  2025-12-26 12:16:51,805 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-26T12:17:01.725825738Z [err]  2025-12-26 12:16:51,805 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-26T12:17:01.725831732Z [err]  2025-12-26 12:16:51,805 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-26T12:17:01.725836868Z [err]  2025-12-26 12:16:51,837 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-26T12:17:01.725842432Z [err]  2025-12-26 12:16:51,838 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:01.725847433Z [err]  2025-12-26 12:16:51,839 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:01.725852592Z [err]  2025-12-26 12:16:51,840 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-26T12:17:01.725857181Z [err]  2025-12-26 12:16:52,343 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:03.112041301Z [err]  2025-12-26 12:16:52,845 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:03.112047611Z [inf]  100.64.0.7:26726 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2025-12-26T12:17:03.112053123Z [err]  2025-12-26 12:16:52,915 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw/actions/record_start "HTTP/1.1 200 OK"
2025-12-26T12:17:03.112059164Z [err]  2025-12-26 12:16:52,919 - server - INFO - üéôÔ∏è Call recording started for v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:03.112065236Z [err]  2025-12-26 12:16:52,919 - server - INFO - üîß Creating call session for v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw...
2025-12-26T12:17:03.112071001Z [err]  2025-12-26 12:16:52,919 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-26T12:17:03.112076732Z [err]  2025-12-26 12:16:52,919 - server - INFO - üîß Calling create_call_session() - START
2025-12-26T12:17:03.112296934Z [err]  2025-12-26 12:16:52,919 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-26T12:17:03.112303198Z [err]  2025-12-26 12:16:53,018 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-26T12:17:03.112309401Z [err]  2025-12-26 12:16:53,018 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-26T12:17:03.112315361Z [err]  2025-12-26 12:16:53,031 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-26T12:17:03.112322858Z [err]  2025-12-26 12:16:53,031 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-26T12:17:04.541886529Z [err]  2025-12-26 12:16:53,032 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-26T12:17:04.541895668Z [err]  2025-12-26 12:16:53,124 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:04.541904826Z [err]  2025-12-26 12:16:53,133 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 100ms
2025-12-26T12:17:04.541918613Z [err]  2025-12-26 12:16:53,133 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-26T12:17:04.542096103Z [err]  2025-12-26 12:16:53,133 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-26T12:17:04.542113259Z [err]  2025-12-26 12:16:53,139 - redis_service - INFO - üì¶ Stored call data in Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (TTL: 3600s)
2025-12-26T12:17:04.542113751Z [err]  2025-12-26 12:16:53,141 - server - INFO - ü§ñ AI session created for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:04.542113808Z [err]  2025-12-26 12:16:53,140 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-26T12:17:04.542120928Z [err]  2025-12-26 12:16:53,140 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-26T12:17:04.542123702Z [err]  2025-12-26 12:16:53,140 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:04.542126797Z [err]  2025-12-26 12:16:53,141 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-26T12:17:04.542134670Z [err]  2025-12-26 12:16:53,141 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-26T12:17:04.542141126Z [err]  2025-12-26 12:16:53,141 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-26T12:17:05.849251734Z [err]  2025-12-26 12:16:53,141 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-26T12:17:05.849257843Z [err]  2025-12-26 12:16:53,141 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-26T12:17:05.849263913Z [err]  2025-12-26 12:16:53,141 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-26T12:17:05.849269166Z [err]  2025-12-26 12:16:53,141 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-26T12:17:05.849277428Z [err]  2025-12-26 12:16:53,147 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:05.849284411Z [err]  2025-12-26 12:16:53,149 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-26T12:17:05.849290141Z [err]  2025-12-26 12:16:53,150 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-26T12:17:05.849295706Z [inf]  100.64.0.7:26722 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:17:05.849301736Z [err]  2025-12-26 12:16:53,179 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:05.849307585Z [err]  2025-12-26 12:16:53,196 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:05.849326861Z [err]  2025-12-26 12:16:53,212 - redis_service - INFO - üì¶ Stored call data in Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (TTL: 3600s)
2025-12-26T12:17:05.850552739Z [err]  2025-12-26 12:16:53,212 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-26T12:17:05.850572576Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚è±Ô∏è [12:16:53.213] üì• process_user_input() ENTRY - text: '...'
2025-12-26T12:17:05.850587129Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚è±Ô∏è [12:16:53.213] ‚è© About to call _process_call_flow_streaming()
2025-12-26T12:17:07.152223069Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚è±Ô∏è [12:16:53.213] ‚úÖ Node selected, about to process content...
2025-12-26T12:17:07.152237305Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{now}} with Friday, December 26, 2025 at 7:16 AM EST in content
2025-12-26T12:17:07.152360427Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-26T12:17:07.152377019Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚è±Ô∏è [12:16:53.213] üîÄ Agent type: call_flow, calling flow processor...
2025-12-26T12:17:07.152379288Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-26T12:17:07.152385955Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚è±Ô∏è [12:16:53.213] üîÄ _process_call_flow_streaming() ENTRY
2025-12-26T12:17:07.152391784Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-26T12:17:07.152396264Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-26T12:17:07.152403807Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-26T12:17:07.152413459Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-26T12:17:07.152421899Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-26T12:17:07.152435266Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-26T12:17:07.152463323Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-26T12:17:07.152476253Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-26T12:17:08.349488058Z [err]  2025-12-26 12:16:53,322 - telnyx_service - INFO - üîä Speaking text on call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw: Kendrick?...
2025-12-26T12:17:08.349502386Z [err]  2025-12-26 12:16:53,322 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-26T12:17:08.349506194Z [err]  2025-12-26 12:16:53,319 - redis_service - INFO - üì• Retrieved call data from Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:08.349532836Z [err]  2025-12-26 12:16:53,214 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-26T12:17:08.350124055Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-26T12:17:08.350128054Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-26T12:17:08.350142180Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-26T12:17:08.350146663Z [err]  2025-12-26 12:16:53,213 - calling_service - INFO - ‚è±Ô∏è [12:16:53.213] üìÑ About to process content (mode=script, length=9)
2025-12-26T12:17:08.350150742Z [err]  2025-12-26 12:16:53,214 - calling_service - INFO - üîä Silence tracking reset for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (user responded)
2025-12-26T12:17:08.350154514Z [err]  2025-12-26 12:16:53,214 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-26T12:17:08.350166692Z [err]  2025-12-26 12:16:53,214 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-26T12:17:08.350171563Z [err]  2025-12-26 12:16:53,214 - calling_service - INFO - LLM response (0.00s): Kendrick?
2025-12-26T12:17:08.350175900Z [err]  2025-12-26 12:16:53,214 - calling_service - INFO - Total latency: 0.00s
2025-12-26T12:17:09.701140641Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Text length: 9 chars
2025-12-26T12:17:09.701178620Z [err]  2025-12-26 12:16:53,322 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-26T12:17:09.701191596Z [err]  2025-12-26 12:16:53,322 - server - INFO - ‚è±Ô∏è [12:16:53.322] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-26T12:17:09.701198770Z [err]  2025-12-26 12:16:53,322 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-26T12:17:09.701201797Z [err]  2025-12-26 12:16:53,322 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-26T12:17:09.701210458Z [err]  2025-12-26 12:16:53,322 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-26T12:17:09.701217911Z [err]  2025-12-26 12:16:53,347 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:09.701223323Z [err]  2025-12-26 12:16:53,415 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:09.701228701Z [err]  2025-12-26 12:16:53,416 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-26T12:17:09.701244354Z [err]  2025-12-26 12:16:53,322 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-26T12:17:09.702908347Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Text content: 'Kendrick?'
2025-12-26T12:17:09.702919154Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-26T12:17:09.702931213Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-26T12:17:09.702945042Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-26T12:17:09.702952550Z [err]  2025-12-26 12:16:53,416 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-26T12:17:10.569303334Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-26T12:17:10.569311248Z [err]  2025-12-26 12:16:53,416 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-26T12:17:10.569313127Z [err]  2025-12-26 12:16:53,416 - server - INFO -    Timeout: 10.0s
2025-12-26T12:17:10.569315140Z [err]  2025-12-26 12:16:53,706 - calling_service - INFO - üë§ User started speaking for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.569316967Z [err]  2025-12-26 12:16:53,702 - server - INFO - üî§ RAW TOKENS: ["H"?]
2025-12-26T12:17:10.569325636Z [err]  2025-12-26 12:16:53,432 - server - INFO -    ‚úì HTTP client created (0.016s)
2025-12-26T12:17:10.569325778Z [err]  2025-12-26 12:16:53,706 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-26T12:17:10.569327043Z [err]  2025-12-26 12:16:53,706 - calling_service - INFO - üîä Silence timer reset for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (user started speaking)
2025-12-26T12:17:10.569334604Z [err]  2025-12-26 12:16:53,432 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-26T12:17:10.569335560Z [err]  2025-12-26 12:16:53,706 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2025-12-26T12:17:10.572425499Z [err]  2025-12-26 12:16:53,800 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-26T12:17:10.572443149Z [err]  2025-12-26 12:16:53,800 - server - INFO -    ‚úì Connection established (0.384s) [TARGET: <200ms]
2025-12-26T12:17:10.572528856Z [err]  2025-12-26 12:16:53,800 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-26T12:17:10.572539475Z [err]  2025-12-26 12:16:53,808 - server - INFO -    ‚úì FIRST CHUNK received (0.392s, 1021 bytes) [TARGET: <300ms]
2025-12-26T12:17:10.572549520Z [err]  2025-12-26 12:16:53,800 - server - INFO -    ‚úì Response status: 200
2025-12-26T12:17:10.572557163Z [err]  2025-12-26 12:16:53,810 - telnyx_service - INFO - ‚úÖ Generated 13837 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-26T12:17:10.572562791Z [err]  2025-12-26 12:16:53,810 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-26T12:17:10.572571423Z [err]  2025-12-26 12:16:53,810 - server - INFO - ‚è±Ô∏è [12:16:53.809] üîä TTS COMPLETE: 487ms, audio_size=13837 bytes
2025-12-26T12:17:10.572576854Z [err]  2025-12-26 12:16:53,810 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (13837 bytes)
2025-12-26T12:17:10.572579539Z [err]  2025-12-26 12:16:53,809 - server - INFO -    ‚úì ALL CHUNKS received: 30 chunks (0.393s)
2025-12-26T12:17:10.572583330Z [err]  2025-12-26 12:16:53,810 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.49s
2025-12-26T12:17:10.572589493Z [err]  2025-12-26 12:16:53,809 - server - INFO -    ‚úì Total audio size: 13837 bytes
2025-12-26T12:17:10.572591769Z [err]  2025-12-26 12:16:53,809 - server - INFO -       - All chunks: 393ms
2025-12-26T12:17:10.572597259Z [err]  2025-12-26 12:16:53,809 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-26T12:17:10.572605111Z [err]  2025-12-26 12:16:53,809 - server - INFO -       - Connection: 384ms
2025-12-26T12:17:10.572606261Z [err]  2025-12-26 12:16:53,809 - server - INFO -       - Audio generation only: 8ms
2025-12-26T12:17:10.572613136Z [err]  2025-12-26 12:16:53,809 - server - INFO -       - First chunk: 392ms
2025-12-26T12:17:10.572631021Z [err]  2025-12-26 12:16:53,829 - server - INFO - üî§ RAW TOKENS: ["H"?, "ello"?]
2025-12-26T12:17:10.575719601Z [err]  2025-12-26 12:16:53,829 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hello' | Generating: False
2025-12-26T12:17:10.575725886Z [err]  2025-12-26 12:16:53,848 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.575731373Z [err]  2025-12-26 12:16:53,972 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2025-12-26T12:17:10.575737195Z [err]  2025-12-26 12:16:53,972 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-26T12:17:10.575743415Z [err]  2025-12-26 12:16:53,973 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2025-12-26T12:17:10.575751235Z [err]  2025-12-26 12:16:53,973 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2025-12-26T12:17:10.575757031Z [err]  2025-12-26 12:16:53,973 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2025-12-26T12:17:10.575762011Z [err]  2025-12-26 12:16:53,973 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.575766860Z [err]  2025-12-26 12:16:53,973 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-26T12:17:10.575794421Z [err]  2025-12-26 12:16:53,973 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.575800152Z [err]  2025-12-26 12:16:53,973 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-26T12:17:10.575805797Z [err]  2025-12-26 12:16:53,974 - server - INFO - ‚è±Ô∏è [12:16:53.973] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2025-12-26T12:17:10.575811545Z [err]  2025-12-26 12:16:53,974 - server - INFO - ‚è±Ô∏è [12:16:53.973] STT endpoint detection latency: 5ms
2025-12-26T12:17:10.587190566Z [err]  2025-12-26 12:16:54,092 - server - INFO - üìù Saved user transcript to database
2025-12-26T12:17:10.587322716Z [err]  2025-12-26 12:16:53,974 - server - INFO - ‚è±Ô∏è [12:16:53.973] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-26T12:17:10.587330052Z [err]  2025-12-26 12:16:53,975 - redis_service - INFO - üì¶ Stored call data in Redis: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (TTL: 3600s)
2025-12-26T12:17:10.587337326Z [err]  2025-12-26 12:16:53,975 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-26T12:17:10.587344041Z [err]  2025-12-26 12:16:53,975 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.587351167Z [err]  2025-12-26 12:16:53,975 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2025-12-26T12:17:10.587360095Z [err]  2025-12-26 12:16:53,985 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2025-12-26T12:17:10.587367799Z [err]  2025-12-26 12:16:53,986 - calling_service - INFO - üë§ User stopped speaking for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.587374944Z [err]  2025-12-26 12:16:53,986 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-26T12:17:10.587382831Z [err]  2025-12-26 12:16:53,986 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+17ms
2025-12-26T12:17:10.587390096Z [err]  2025-12-26 12:16:53,986 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 17ms (Soniox model: stt-rt-v3)
2025-12-26T12:17:10.587397155Z [err]  2025-12-26 12:16:53,986 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-26T12:17:10.587404279Z [err]  2025-12-26 12:16:53,986 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-26T12:17:10.587411298Z [err]  2025-12-26 12:16:53,986 - calling_service - INFO - ü§ñ Agent started speaking for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.587535799Z [err]  2025-12-26 12:16:54,093 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.587542933Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - ‚è±Ô∏è [12:16:54.093] üì• process_user_input() ENTRY - text: 'Hello?...'
2025-12-26T12:17:10.587550113Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - ‚è±Ô∏è [12:16:54.093] ‚è© About to call _process_call_flow_streaming()
2025-12-26T12:17:10.587557110Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - ‚è±Ô∏è [12:16:54.093] üîÄ Agent type: call_flow, calling flow processor...
2025-12-26T12:17:10.587563875Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - ‚è±Ô∏è [12:16:54.093] üîÄ _process_call_flow_streaming() ENTRY
2025-12-26T12:17:10.587571523Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-26T12:17:10.587577495Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-26T12:17:10.587585220Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - ‚è±Ô∏è [12:16:54.093] üîÄ About to call _follow_transition() for: Hello?...
2025-12-26T12:17:10.587592893Z [err]  2025-12-26 12:16:54,093 - calling_service - INFO - Evaluating transitions from Greeting for message: Hello?
2025-12-26T12:17:10.587599546Z [err]  2025-12-26 12:16:54,112 - calling_service - INFO - ‚è±Ô∏è [12:16:54.112] üîÄ TRANSITION EVALUATION START - Calling LLM for 2 options
2025-12-26T12:17:10.587606413Z [err]  2025-12-26 12:16:54,336 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw/actions/playback_start "HTTP/1.1 200 OK"
2025-12-26T12:17:10.587613072Z [err]  2025-12-26 12:16:54,337 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.53s
2025-12-26T12:17:10.587858920Z [err]  2025-12-26 12:16:54,337 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 1.02s
2025-12-26T12:17:10.587872355Z [err]  2025-12-26 12:16:54,337 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-26T12:17:10.587879802Z [err]  2025-12-26 12:16:54,337 - telnyx_service - INFO - üé¨ Playback ID: zlzwfR-ujw
2025-12-26T12:17:10.587887817Z [err]  2025-12-26 12:16:54,338 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-26T12:17:10.587895316Z [err]  2025-12-26 12:16:54,338 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-26T12:17:10.587904221Z [err]  2025-12-26 12:16:54,352 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.587913446Z [err]  2025-12-26 12:16:54,352 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.587919846Z [inf]  100.64.0.5:62496 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-26T12:17:10.587926895Z [err]  2025-12-26 12:16:54,520 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:17:10.587933551Z [err]  2025-12-26 12:16:54,520 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'ae169480-7be8-4f75-975e-d64665c18fa2', 'occurred_at': '2025-12-26T12:16:53.983229Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'mDqsKVOg0A', 'start_time': '2025-12-26T12:16:53.983229Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:17:10.598267352Z [err]  2025-12-26 12:16:54,520 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.598273365Z [err]  2025-12-26 12:16:54,520 - server - INFO - üì® ================================================
2025-12-26T12:17:10.598279350Z [inf]  100.64.0.9:12564 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:17:10.598285240Z [err]  2025-12-26 12:16:54,835 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:17:10.598292959Z [err]  2025-12-26 12:16:54,836 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '20c77147-9aee-4fbe-af4e-813015718c98', 'occurred_at': '2025-12-26T12:16:54.323229Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:17:10.598299118Z [err]  2025-12-26 12:16:54,836 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.598304985Z [inf]  100.64.0.6:46672 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:17:10.598311922Z [err]  2025-12-26 12:16:54,836 - server - INFO - üì® ================================================
2025-12-26T12:17:10.598318568Z [err]  2025-12-26 12:16:54,845 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-26T12:17:10.598325042Z [err]  2025-12-26 12:16:54,857 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.599460202Z [err]  2025-12-26 12:16:54,857 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.599598247Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ‚è±Ô∏è [12:16:54.858] üîÄ TRANSITION EVALUATION COMPLETE - took 745ms
2025-12-26T12:17:10.599606527Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ü§ñ AI transition decision: '-1'
2025-12-26T12:17:10.599612429Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she) OR Ask...', 'Wrong number (No John here|Wrong number|etc) - don...']
2025-12-26T12:17:10.599618311Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - Selected transition index: -1
2025-12-26T12:17:10.599624005Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-26T12:17:10.599629983Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ‚ö†Ô∏è No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-26T12:17:10.599635418Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üéØ Goal: Say the customer's name...
2025-12-26T12:17:10.599641458Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 764ms
2025-12-26T12:17:10.599649220Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ‚è±Ô∏è [12:16:54.858] ‚úÖ Node selected, about to process content...
2025-12-26T12:17:10.599655279Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{now}} with Friday, December 26, 2025 at 7:16 AM EST in content
2025-12-26T12:17:10.599662488Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-26T12:17:10.599669387Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-26T12:17:10.606083865Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üõ°Ô∏è Preventing Dead Air: User stayed on script node 'Greeting' without transition
2025-12-26T12:17:10.606097691Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ü§ñ Generating sticky-prevention response...
2025-12-26T12:17:10.606168321Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-26T12:17:10.606176208Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-26T12:17:10.606179478Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-26T12:17:10.606187165Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-26T12:17:10.606211962Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-26T12:17:10.606212107Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-26T12:17:10.606219447Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-26T12:17:10.606225390Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-26T12:17:10.606233386Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-26T12:17:10.606240623Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-26T12:17:10.606246999Z [err]  2025-12-26 12:16:54,858 - calling_service - INFO - ‚è±Ô∏è [12:16:54.858] üìÑ About to process content (mode=script, length=9)
2025-12-26T12:17:10.608292807Z [err]  2025-12-26 12:16:54,871 - calling_service - INFO - ‚ö° PARALLEL MODE: Running KB + analysis simultaneously
2025-12-26T12:17:10.608297143Z [err]  2025-12-26 12:16:54,873 - kb_router - INFO - üö¶ KB Router: SKIP (simple chat pattern matched)
2025-12-26T12:17:10.608301408Z [err]  2025-12-26 12:16:54,873 - calling_service - INFO - ‚ö° Skipping KB (reason: simple_chat)
2025-12-26T12:17:10.608306122Z [err]  2025-12-26 12:16:54,873 - calling_service - INFO - ‚ö° Parallel operations completed in 0ms
2025-12-26T12:17:10.608310585Z [err]  2025-12-26 12:16:54,873 - calling_service - INFO - üîç Node 'Greeting': use_parallel_llm=True
2025-12-26T12:17:10.608315501Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - ‚ö° Parallel mode: Using condensed history (3/3 messages)
2025-12-26T12:17:10.608319768Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - ‚è±Ô∏è [12:16:54.878] üí¨ LLM REQUEST START: 3 conversation turns, 7881 system chars (KB cached)
2025-12-26T12:17:10.608324785Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LLM PROMPT BREAKDOWN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-26T12:17:10.608330414Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù [SYSTEM MSG 1 - GLOBAL PROMPT] (6467 chars):
2025-12-26T12:17:10.608336060Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-26T12:17:10.608342005Z [err]  
2025-12-26T12:17:10.608346599Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-26T12:17:10.608351552Z [err]  
2025-12-26T12:17:10.608355749Z [err]  If user says a name, don't assume it's theirs‚Äîwait for explicit correction.
2025-12-26T12:17:10.608360172Z [err]  
2025-12-26T12:17:10.608364509Z [err]  If user asks to repeat info, rephrase naturally‚Äînever exact repeat.
2025-12-26T12:17:10.611668544Z [err]  
2025-12-26T12:17:10.611810890Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-26T12:17:10.611818442Z [err]  
2025-12-26T12:17:10.611828988Z [err]  If asked about call number: "Company number."
2025-12-26T12:17:10.611835921Z [err]  
2025-12-26T12:17:10.611841501Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-26T12:17:10.611847847Z [err]  
2025-12-26T12:17:10.611852919Z [err]  If explaining ends in peri...
2025-12-26T12:17:10.611859893Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù [SYSTEM MSG 2 - DYNAMIC CONTEXT] (1414 chars):
2025-12-26T12:17:10.611865367Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù   Preview: 
2025-12-26T12:17:10.611872737Z [err]  
2025-12-26T12:17:10.611877928Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-26T12:17:10.611884977Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-26T12:17:10.611892047Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-26T12:17:10.611897238Z [err]  
2025-12-26T12:17:10.611902440Z [err]  USER COMMUNICATION STYLE: C type - adjust your response accordingly
2025-12-26T12:17:10.611908834Z [err]  CONVERSATION STATUS: Turn 2, objection handling phase
2025-12-26T12:17:10.611917237Z [err]  
2025-12-26T12:17:10.611924337Z [err]  This context is provided to help you focus. You still need to:
2025-12-26T12:17:10.611929102Z [err]  1. Generate a natural, contextual response
2025-12-26T12:17:10.611934093Z [err]  2. Evaluate transitions per your node instructions
2025-12-26T12:17:10.612161467Z [err]  
2025-12-26T12:17:10.612167482Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-26T12:17:10.612172751Z [err]  
2025-12-26T12:17:10.612178689Z [err]  # CURRENT CONTEXT
2025-12-26T12:17:10.612184683Z [err]  Customer: Kendrick
2025-12-26T12:17:10.612188795Z [err]  Variables: {"now": "Friday, December 26, 2025 at 7:16 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment": ...
2025-12-26T12:17:10.612193142Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù [CONVERSATION HISTORY] (3 messages)
2025-12-26T12:17:10.612199167Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù   assistant: Kendrick?...
2025-12-26T12:17:10.612203128Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù   user: Hello?...
2025-12-26T12:17:10.612206772Z [err]  2025-12-26 12:16:54,878 - calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-26T12:17:10.612210432Z [err]  2025-12-26 12:16:55,296 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-26T12:17:10.612213949Z [err]  2025-12-26 12:16:55,360 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.612218905Z [err]  2025-12-26 12:16:55,360 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.612222878Z [inf]  100.64.0.8:48124 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:17:10.612226888Z [err]  2025-12-26 12:16:55,436 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:17:10.615194377Z [err]  2025-12-26 12:16:55,836 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.615196053Z [err]  2025-12-26 12:16:55,436 - server - INFO - üì® ================================================
2025-12-26T12:17:10.615205519Z [err]  2025-12-26 12:16:55,665 - calling_service - INFO - ‚è±Ô∏è [12:16:55.665] üí¨ LLM FIRST TOKEN: 786ms (grok grok-4-1-fast-non-reasoning)
2025-12-26T12:17:10.615206459Z [err]  2025-12-26 12:16:55,836 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-26T12:17:10.615212952Z [err]  2025-12-26 12:16:55,836 - server - INFO - üì§ Sentence arrived from LLM: [N] Hey Kendrick,...
2025-12-26T12:17:10.615219936Z [err]  2025-12-26 12:16:55,836 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 1850ms
2025-12-26T12:17:10.615226839Z [err]  2025-12-26 12:16:55,836 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-26T12:17:10.615263183Z [err]  2025-12-26 12:16:55,436 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '7e3cade0-48d3-456b-8e7e-431859748d7c', 'occurred_at': '2025-12-26T12:16:54.903230Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'zlzwfR-ujw'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:17:10.615270820Z [err]  2025-12-26 12:16:55,436 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.621787908Z [err]  2025-12-26 12:16:56,144 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-26T12:17:10.621799279Z [err]  2025-12-26 12:16:56,144 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-26T12:17:10.621814877Z [err]  2025-12-26 12:16:56,023 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:10.621826524Z [err]  2025-12-26 12:16:56,117 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:10.621834137Z [err]  2025-12-26 12:16:56,143 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-26T12:17:10.621841840Z [err]  2025-12-26 12:16:56,143 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-26T12:17:10.621850074Z [err]  2025-12-26 12:16:56,143 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-26T12:17:10.621857036Z [err]  2025-12-26 12:16:56,144 - persistent_tts_service - INFO - üîå [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Establishing persistent TTS WebSocket...
2025-12-26T12:17:10.621930783Z [err]  2025-12-26 12:16:55,863 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.621935227Z [err]  2025-12-26 12:16:55,863 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:ih_SPigjFrxAOqSv2... (active sessions: [])
2025-12-26T12:17:10.621940417Z [err]  2025-12-26 12:16:55,929 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-26T12:17:10.625774243Z [err]  2025-12-26 12:16:56,144 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-26T12:17:10.625780378Z [err]  2025-12-26 12:16:56,158 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-26T12:17:10.625786419Z [err]  2025-12-26 12:16:56,158 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'c13941ff-c3db-4a06-8817-dce3b46d3734', 'occurred_at': '2025-12-26T12:16:55.783231Z', 'payload': {'call_control_id': 'v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw', 'call_leg_id': 'be0e1cfc-e254-11f0-9ad7-02420aef99a0', 'call_session_id': 'be0a5572-e254-11f0-8970-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'zlzwfR-ujw', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-26T12:17:10.625792126Z [err]  2025-12-26 12:16:56,158 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.625798617Z [err]  2025-12-26 12:16:56,158 - server - INFO - üì® ================================================
2025-12-26T12:17:10.625803850Z [err]  2025-12-26 12:16:56,161 - redis_service - INFO - ‚ûñ Removed playback zlzwfR-ujw, 0 remaining for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.625809721Z [err]  2025-12-26 12:16:56,161 - server - INFO - üîä Redis: Removed playback zlzwfR-ujw, 0 remaining
2025-12-26T12:17:10.625815207Z [err]  2025-12-26 12:16:56,161 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-26T12:17:10.625821215Z [err]  2025-12-26 12:16:56,161 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-26T12:17:10.635857476Z [inf]  100.64.0.6:46672 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-26T12:17:10.635861316Z [err]  2025-12-26 12:16:56,163 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-26T12:17:10.635864975Z [err]  2025-12-26 12:16:56,163 - server - INFO - ‚úÖ Found session locally: agent_speaking=True, user_speaking=False
2025-12-26T12:17:10.635868664Z [err]  2025-12-26 12:16:56,163 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766751416.1635246 for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.635872558Z [err]  2025-12-26 12:16:56,163 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.635876890Z [err]  2025-12-26 12:16:56,163 - server - INFO - ‚è±Ô∏è Agent done speaking, silence timer STARTED (local)
2025-12-26T12:17:10.635881643Z [err]  2025-12-26 12:16:56,317 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-26T12:17:10.635885447Z [err]  2025-12-26 12:16:56,318 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-26T12:17:10.635888994Z [err]  2025-12-26 12:16:56,318 - persistent_tts_service - INFO - ‚úÖ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Persistent TTS WebSocket established
2025-12-26T12:17:10.635897610Z [err]  2025-12-26 12:16:56,318 - persistent_tts_service - INFO - üéß [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Audio receiver loop started
2025-12-26T12:17:10.635901778Z [err]  2025-12-26 12:16:56,319 - persistent_tts_service - INFO - üîä [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Comfort noise loop started
2025-12-26T12:17:10.635905791Z [err]  2025-12-26 12:16:56,319 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.641893187Z [err]  2025-12-26 12:16:56,321 - persistent_tts_service - INFO - üé§ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Streaming sentence #1: [N] Hey Kendrick,...
2025-12-26T12:17:10.641906426Z [err]  2025-12-26 12:16:56,322 - persistent_tts_service - INFO - üöÄ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-26T12:17:10.641922520Z [err]  2025-12-26 12:16:56,320 - server - INFO - üéµ TTS task #1 started at +483ms
2025-12-26T12:17:10.641929811Z [err]  2025-12-26 12:16:56,320 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 2334ms
2025-12-26T12:17:10.641936630Z [err]  2025-12-26 12:16:56,320 - calling_service - INFO - üì§ Streamed sentence: [N] Hey Kendrick,...
2025-12-26T12:17:10.641943063Z [err]  2025-12-26 12:16:56,321 - persistent_tts_service - INFO - üéµ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Playback consumer started
2025-12-26T12:17:10.641950742Z [err]  2025-12-26 12:16:56,321 - persistent_tts_service - INFO - üéß [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Audio Receiver Loop STARTED
2025-12-26T12:17:10.641957210Z [err]  2025-12-26 12:16:56,321 - persistent_tts_service - INFO - üíì [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Starting TTS keep-alive loop (every 15s)
2025-12-26T12:17:10.641963741Z [err]  2025-12-26 12:16:56,321 - persistent_tts_service - INFO - üîä [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Starting comfort noise loop
2025-12-26T12:17:10.642040105Z [err]  2025-12-26 12:16:56,319 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-26T12:17:10.642055477Z [err]  2025-12-26 12:16:56,319 - server - INFO - üîç Persistent TTS lookup: call_id=v3:ih_SPigjFrxAOqSv2..., session=FOUND
2025-12-26T12:17:10.642064808Z [err]  2025-12-26 12:16:56,319 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-26T12:17:10.650311532Z [err]  2025-12-26 12:16:56,326 - server - INFO - üîç Persistent TTS lookup: call_id=v3:ih_SPigjFrxAOqSv2..., session=FOUND
2025-12-26T12:17:10.650322137Z [err]  2025-12-26 12:16:56,326 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-26T12:17:10.650333719Z [err]  2025-12-26 12:16:56,328 - persistent_tts_service - INFO - üöÄ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-26T12:17:10.650334338Z [err]  2025-12-26 12:16:56,326 - server - INFO - üéµ TTS task #2 started at +489ms
2025-12-26T12:17:10.650342345Z [err]  2025-12-26 12:16:56,326 - calling_service - INFO - üì§ Streamed sentence: it's Jake here from JK....
2025-12-26T12:17:10.650351051Z [err]  2025-12-26 12:16:56,328 - persistent_tts_service - INFO - üìä [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=False, is_last=False
2025-12-26T12:17:10.650352191Z [err]  2025-12-26 12:16:56,328 - persistent_tts_service - INFO - üéß [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Receiver processing sentence #1: '[N] Hey Kendrick,...'
2025-12-26T12:17:10.650360732Z [err]  2025-12-26 12:16:56,328 - persistent_tts_service - INFO - üìä [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] DIAGNOSTIC: queue_latency=6ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-26T12:17:10.650366939Z [err]  2025-12-26 12:16:56,328 - persistent_tts_service - INFO - üé§ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Streaming sentence #2: it's Jake here from JK....
2025-12-26T12:17:10.650425232Z [err]  2025-12-26 12:16:56,322 - persistent_tts_service - INFO - üìä [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-26T12:17:10.650432285Z [err]  2025-12-26 12:16:56,326 - server - INFO - üì§ Sentence arrived from LLM: it's Jake here from JK....
2025-12-26T12:17:10.655059214Z [err]  2025-12-26 12:16:56,329 - server - INFO - üì§ Sentence arrived from LLM: You there?...
2025-12-26T12:17:10.655065950Z [err]  2025-12-26 12:16:56,329 - server - INFO - üîç Persistent TTS lookup: call_id=v3:ih_SPigjFrxAOqSv2..., session=FOUND
2025-12-26T12:17:10.655072069Z [err]  2025-12-26 12:16:56,329 - server - INFO - üöÄ Streaming sentence #3 via persistent WebSocket
2025-12-26T12:17:10.655080641Z [err]  2025-12-26 12:16:56,329 - server - INFO - üéµ TTS task #3 started at +492ms
2025-12-26T12:17:10.655089303Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - üì§ Streamed final fragment: You there?...
2025-12-26T12:17:10.655095708Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - ‚è±Ô∏è [TIMING] LLM_TOTAL: 1450ms for 52 chars (grok grok-4-1-fast-non-reasoning)
2025-12-26T12:17:10.655102268Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user gave meaningful response) for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.655110826Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - üîä Silence tracking reset for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw (user responded)
2025-12-26T12:17:10.655117181Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-26T12:17:10.655124146Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-26T12:17:10.655131022Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - LLM response (2.24s): [N] Hey Kendrick, it's Jake here from JK. You there?
2025-12-26T12:17:10.655138530Z [err]  2025-12-26 12:16:56,329 - calling_service - INFO - Total latency: 2.24s
2025-12-26T12:17:10.655145598Z [err]  2025-12-26 12:16:56,329 - server - INFO - ‚úÖ LLM finished in 2342ms, TTS tasks already running in background
2025-12-26T12:17:10.655153288Z [err]  2025-12-26 12:16:56,329 - server - INFO - üéµ Streaming 3 TTS chunks as they complete...
2025-12-26T12:17:10.661917479Z [err]  2025-12-26 12:16:56,329 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-26T12:17:10.661925913Z [err]  2025-12-26 12:16:56,329 - server - INFO -    3 sentences queued and playing seamlessly
2025-12-26T12:17:10.661934067Z [err]  2025-12-26 12:16:56,329 - persistent_tts_service - INFO - üé§ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Streaming sentence #3: You there?...
2025-12-26T12:17:10.661940331Z [err]  2025-12-26 12:16:56,330 - persistent_tts_service - INFO - üöÄ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Sent sentence #3 (NON-BLOCKING) in 0ms
2025-12-26T12:17:10.661947430Z [err]  2025-12-26 12:16:56,330 - persistent_tts_service - INFO - üìä [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-26T12:17:10.661953948Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚úÖ All 3 persistent TTS streams completed
2025-12-26T12:17:10.661961372Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-26T12:17:10.661968898Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 2343ms from user stop üöÄ
2025-12-26T12:17:10.661976228Z [err]  2025-12-26 12:16:56,330 - calling_service - INFO - ü§ñ Agent started speaking for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:10.661983810Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-26T12:17:10.661990943Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-26T12:17:10.661998156Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-26T12:17:11.842753286Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 17ms (provider: soniox, model: stt-rt-v3)
2025-12-26T12:17:11.842760099Z [err]  2025-12-26 12:16:56,330 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 2342ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-26T12:17:11.842766601Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 494ms (provider: elevenlabs, websocket: False)
2025-12-26T12:17:11.842772903Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 2344ms (user stopped ‚Üí play_audio_url called)
2025-12-26T12:17:11.842778656Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-26T12:17:11.842784177Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-26T12:17:11.842790369Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-26T12:17:11.842797043Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-26T12:17:11.842802989Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-26T12:17:11.842810721Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2644ms estimated
2025-12-26T12:17:11.842816760Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 52 chars, 3 sentences
2025-12-26T12:17:11.842822439Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2025-12-26T12:17:11.842828515Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '[N] Hey Kendrick, it's Jake here from JK. You there?...'
2025-12-26T12:17:11.842836869Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-26T12:17:13.141616602Z [err]  2025-12-26 12:16:56,331 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-26T12:17:13.141640826Z [err]  2025-12-26 12:16:56,364 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-26T12:17:13.141648200Z [err]  2025-12-26 12:16:56,364 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766751416.3642545 for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:13.141655054Z [err]  2025-12-26 12:16:56,364 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw
2025-12-26T12:17:13.141663611Z [err]  2025-12-26 12:16:56,531 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 2853ms)
2025-12-26T12:17:13.141671007Z [err]  2025-12-26 12:16:56,531 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-26T12:17:13.141677485Z [err]  2025-12-26 12:16:56,531 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-26T12:17:13.141683544Z [err]  2025-12-26 12:16:56,602 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 280ms
2025-12-26T12:17:13.141691563Z [err]  2025-12-26 12:16:56,602 - persistent_tts_service - INFO - üì§ Sending 8900 bytes of audio (56 chunks, 1.1s duration) via WebSocket
2025-12-26T12:17:13.141698376Z [err]  2025-12-26 12:16:56,602 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-26T12:17:13.141706042Z [err]  2025-12-26 12:16:56,602 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-26T12:17:14.921276906Z [err]  2025-12-26 12:16:56,605 - persistent_tts_service - INFO - ‚úÖ Sent 56 audio chunks via WebSocket
2025-12-26T12:17:14.921283549Z [err]  2025-12-26 12:16:56,782 - persistent_tts_service - INFO - üì§ Sending 13747 bytes of audio (86 chunks, 1.7s duration) via WebSocket
2025-12-26T12:17:14.921289906Z [err]  2025-12-26 12:16:56,783 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-26T12:17:14.921296127Z [err]  2025-12-26 12:16:56,783 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.7s from now)
2025-12-26T12:17:14.921302178Z [err]  2025-12-26 12:16:56,784 - persistent_tts_service - INFO - ‚úÖ Sent 86 audio chunks via WebSocket
2025-12-26T12:17:14.921310519Z [err]  2025-12-26 12:16:56,859 - server - INFO - üì§ Audio flowing: 330 packets sent to Soniox (5s update)
2025-12-26T12:17:14.921316622Z [err]  2025-12-26 12:16:56,956 - persistent_tts_service - INFO - üì§ Sending 5944 bytes of audio (38 chunks, 0.7s duration) via WebSocket
2025-12-26T12:17:14.921323397Z [err]  2025-12-26 12:16:56,956 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-26T12:17:14.921330629Z [err]  2025-12-26 12:16:56,956 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.7s (total: 3.2s from now)
2025-12-26T12:17:14.921337339Z [err]  2025-12-26 12:16:56,957 - persistent_tts_service - INFO - ‚úÖ Sent 38 audio chunks via WebSocket
2025-12-26T12:17:14.921343572Z [err]  2025-12-26 12:16:58,957 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-26T12:17:14.921349764Z [err]  2025-12-26 12:16:58,957 - persistent_tts_service - INFO - ‚úÖ [Call v3:ih_SPigjFrxAOqSv2hyz8tlyJNfXC4F-IACvpneAAKsViFHEc80syw] Receiver finished sentence #1: 3 chunks in 2635ms