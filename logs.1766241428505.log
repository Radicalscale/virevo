2025-12-20T14:34:05.000000000Z [inf]  Starting Container
2025-12-20T14:34:06.204308045Z [inf]  =========================================
2025-12-20T14:34:06.204312534Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2025-12-20T14:34:06.204319368Z [inf]  =========================================
2025-12-20T14:34:06.204323774Z [inf]  üìç Working directory: /app/backend
2025-12-20T14:34:06.204327728Z [inf]  üîç Python path: /app/backend
2025-12-20T14:34:06.204332104Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2025-12-20T14:34:06.204336180Z [inf]  =========================================
2025-12-20T14:34:06.995280048Z [err]  [2025-12-20 14:34:06 +0000] [1] [INFO] Starting gunicorn 22.0.0
2025-12-20T14:34:06.995283615Z [err]  [2025-12-20 14:34:06 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2025-12-20T14:34:06.995287417Z [err]  [2025-12-20 14:34:06 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-20T14:34:06.998220299Z [err]  [2025-12-20 14:34:06 +0000] [3] [INFO] Booting worker with pid: 3
2025-12-20T14:34:07.242017989Z [err]  [2025-12-20 14:34:07 +0000] [4] [INFO] Booting worker with pid: 4
2025-12-20T14:34:07.242151144Z [err]  [2025-12-20 14:34:07 +0000] [5] [INFO] Booting worker with pid: 5
2025-12-20T14:34:07.242156677Z [err]  [2025-12-20 14:34:07 +0000] [6] [INFO] Booting worker with pid: 6
2025-12-20T14:34:27.554436364Z [err]  2025-12-20 14:34:23,999 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-20T14:34:27.554448481Z [err]  2025-12-20 14:34:24,000 - server - INFO - üî• Pre-warming connection libraries...
2025-12-20T14:34:27.554456614Z [err]  2025-12-20 14:34:24,026 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-20T14:34:27.554465494Z [err]  2025-12-20 14:34:24,131 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-20T14:34:27.554473263Z [err]  2025-12-20 14:34:24,131 - server - INFO - üî• Pre-warming connection libraries...
2025-12-20T14:34:27.554481358Z [err]  2025-12-20 14:34:24,145 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-20T14:34:27.554489394Z [err]  2025-12-20 14:34:24,145 - server - INFO - üî• Pre-warming connection libraries...
2025-12-20T14:34:27.554496963Z [err]  2025-12-20 14:34:24,152 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-20T14:34:27.554504129Z [err]  2025-12-20 14:34:24,168 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-20T14:34:27.554511884Z [err]  2025-12-20 14:34:24,207 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-20T14:34:27.554519427Z [err]  2025-12-20 14:34:24,241 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-20T14:34:27.554527198Z [err]  2025-12-20 14:34:24,241 - server - INFO - üî• Pre-warming connection libraries...
2025-12-20T14:34:27.554534761Z [err]  2025-12-20 14:34:24,262 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-20T14:34:27.554542764Z [err]  2025-12-20 14:34:24,341 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-20T14:34:27.554550274Z [err]  2025-12-20 14:34:24,344 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-20T14:34:27.554558384Z [err]  2025-12-20 14:34:24,361 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-20T14:34:27.554566251Z [err]  2025-12-20 14:34:24,370 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-20T14:34:27.554574271Z [err]  2025-12-20 14:34:24,386 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-20T14:34:27.554581753Z [err]  2025-12-20 14:34:24,392 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-20T14:34:27.554590867Z [err]  2025-12-20 14:34:24,411 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-20T14:34:27.554599329Z [err]  2025-12-20 14:34:24,411 - server - INFO - ‚úÖ QC agent router loaded
2025-12-20T14:34:27.554607042Z [err]  2025-12-20 14:34:24,418 - server - INFO - ‚úÖ QC agent router loaded
2025-12-20T14:34:27.554615244Z [err]  2025-12-20 14:34:24,425 - server - INFO - ‚úÖ QC agent router loaded
2025-12-20T14:34:27.554621961Z [err]  2025-12-20 14:34:24,432 - server - INFO - ‚úÖ QC learning router loaded
2025-12-20T14:34:27.554628784Z [err]  2025-12-20 14:34:24,434 - server - INFO - ‚úÖ QC learning router loaded
2025-12-20T14:34:27.554636407Z [err]  2025-12-20 14:34:24,447 - server - INFO - ‚úÖ QC learning router loaded
2025-12-20T14:34:27.554644027Z [err]  2025-12-20 14:34:24,447 - server - INFO - ‚úÖ QC agent router loaded
2025-12-20T14:34:27.554650422Z [err]  2025-12-20 14:34:24,464 - server - INFO - ‚úÖ QC learning router loaded
2025-12-20T14:34:27.554657148Z [err]  2025-12-20 14:34:24,531 - server - INFO - ‚úÖ CRM router loaded
2025-12-20T14:34:27.554664063Z [err]  2025-12-20 14:34:24,545 - server - INFO - ‚úÖ CRM router loaded
2025-12-20T14:34:27.554671351Z [err]  2025-12-20 14:34:24,561 - server - INFO - ‚úÖ CRM router loaded
2025-12-20T14:34:27.554678369Z [err]  2025-12-20 14:34:24,564 - server - INFO - ‚úÖ CRM router loaded
2025-12-20T14:34:27.554685782Z [err]  2025-12-20 14:34:24,768 - server - INFO - ‚úÖ QC test router loaded
2025-12-20T14:34:27.554692955Z [err]  2025-12-20 14:34:24,791 - server - INFO - ‚úÖ Agent test router loaded
2025-12-20T14:34:27.554700864Z [err]  2025-12-20 14:34:24,802 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-20T14:34:27.554708055Z [err]  2025-12-20 14:34:24,803 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-20T14:34:27.554715413Z [err]  [2025-12-20 14:34:24 +0000] [6] [INFO] Started server process [6]
2025-12-20T14:34:27.554731586Z [err]  [2025-12-20 14:34:24 +0000] [6] [INFO] Waiting for application startup.
2025-12-20T14:34:27.554739307Z [err]  2025-12-20 14:34:24,828 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-20T14:34:27.554747624Z [err]  2025-12-20 14:34:24,864 - server - INFO - ‚úÖ QC test router loaded
2025-12-20T14:34:27.554754518Z [err]  2025-12-20 14:34:24,865 - server - INFO - ‚úÖ QC test router loaded
2025-12-20T14:34:27.554761314Z [err]  2025-12-20 14:34:24,874 - server - INFO - ‚úÖ QC test router loaded
2025-12-20T14:34:27.554768106Z [err]  2025-12-20 14:34:24,877 - server - INFO - ‚úÖ Agent test router loaded
2025-12-20T14:34:27.554775301Z [err]  2025-12-20 14:34:24,879 - server - INFO - ‚úÖ Agent test router loaded
2025-12-20T14:34:27.554782627Z [err]  2025-12-20 14:34:24,883 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-20T14:34:27.554790024Z [err]  2025-12-20 14:34:24,883 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-20T14:34:27.554797169Z [err]  2025-12-20 14:34:24,887 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-20T14:34:27.554804978Z [err]  2025-12-20 14:34:24,887 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-20T14:34:27.554811998Z [err]  2025-12-20 14:34:24,889 - server - INFO - ‚úÖ Agent test router loaded
2025-12-20T14:34:27.554819881Z [err]  2025-12-20 14:34:24,897 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-20T14:34:27.554827210Z [err]  2025-12-20 14:34:24,897 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-20T14:34:27.554834251Z [err]  [2025-12-20 14:34:24 +0000] [5] [INFO] Started server process [5]
2025-12-20T14:34:27.554840897Z [err]  [2025-12-20 14:34:24 +0000] [5] [INFO] Waiting for application startup.
2025-12-20T14:34:27.554847117Z [err]  [2025-12-20 14:34:24 +0000] [3] [INFO] Started server process [3]
2025-12-20T14:34:27.554854162Z [err]  [2025-12-20 14:34:24 +0000] [3] [INFO] Waiting for application startup.
2025-12-20T14:34:27.554862004Z [err]  2025-12-20 14:34:24,906 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-20T14:34:27.554869048Z [err]  2025-12-20 14:34:24,907 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-20T14:34:27.554876534Z [err]  [2025-12-20 14:34:24 +0000] [4] [INFO] Started server process [4]
2025-12-20T14:34:27.554884419Z [err]  [2025-12-20 14:34:24 +0000] [4] [INFO] Waiting for application startup.
2025-12-20T14:34:27.554893179Z [err]  2025-12-20 14:34:24,920 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-20T14:34:32.402149592Z [err]  2025-12-20 14:34:32,393 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-20T14:34:32.402158373Z [err]  2025-12-20 14:34:32,398 - server - INFO - ‚úÖ Comfort noise file ready for immediate use
2025-12-20T14:34:32.402165629Z [err]  [2025-12-20 14:34:32 +0000] [6] [INFO] Application startup complete.
2025-12-20T14:34:32.586224999Z [err]  2025-12-20 14:34:32,582 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-20T14:34:32.590735979Z [err]  2025-12-20 14:34:32,587 - server - INFO - ‚úÖ Comfort noise file ready for immediate use
2025-12-20T14:34:32.590745857Z [err]  [2025-12-20 14:34:32 +0000] [3] [INFO] Application startup complete.
2025-12-20T14:34:32.615418991Z [err]  2025-12-20 14:34:32,609 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-20T14:34:32.615425673Z [err]  2025-12-20 14:34:32,609 - server - INFO - ‚úÖ Comfort noise file ready for immediate use
2025-12-20T14:34:32.615432336Z [err]  [2025-12-20 14:34:32 +0000] [4] [INFO] Application startup complete.
2025-12-20T14:34:32.669032893Z [err]  2025-12-20 14:34:32,664 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-20T14:34:32.669046698Z [err]  2025-12-20 14:34:32,664 - server - INFO - ‚úÖ Comfort noise file ready for immediate use
2025-12-20T14:34:32.669058786Z [err]  [2025-12-20 14:34:32 +0000] [5] [INFO] Application startup complete.
2025-12-20T14:36:12.767209793Z [inf]  100.64.0.2:13820 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-20T14:36:12.767214520Z [err]  2025-12-20 14:36:05,588 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-20T14:36:12.767220004Z [err]  2025-12-20 14:36:05,682 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:12.767224234Z [err]  2025-12-20 14:36:05,769 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:12.767227995Z [err]  2025-12-20 14:36:05,797 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-20T14:36:12.767232617Z [err]  2025-12-20 14:36:05,797 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-20T14:36:12.767236550Z [err]  2025-12-20 14:36:05,797 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-20T14:36:12.767241112Z [err]  2025-12-20 14:36:05,797 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-20T14:36:12.767245275Z [err]  2025-12-20 14:36:06,440 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-20T14:36:12.767250138Z [err]  2025-12-20 14:36:06,443 - telnyx_service - INFO - ‚úÖ Call initiated: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:12.767254441Z [err]  2025-12-20 14:36:06,547 - server - INFO - üìù Created call log: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:12.767258528Z [err]  2025-12-20 14:36:06,547 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-20T14:36:12.767262425Z [err]  2025-12-20 14:36:06,548 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-20T14:36:12.767574528Z [err]  2025-12-20 14:36:06,548 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-20T14:36:12.767593202Z [err]  2025-12-20 14:36:06,548 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-20T14:36:12.767598349Z [err]  2025-12-20 14:36:06,585 - redis_service - INFO - üì¶ Stored call data in Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (TTL: 3600s)
2025-12-20T14:36:12.767602858Z [err]  2025-12-20 14:36:06,585 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-20T14:36:12.767606705Z [err]  2025-12-20 14:36:06,585 - server - INFO - üìû Outbound call initiated: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:12.767611258Z [inf]  100.64.0.3:28650 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-20T14:36:12.767615578Z [err]  2025-12-20 14:36:06,756 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-20T14:36:12.767620028Z [err]  2025-12-20 14:36:06,756 - server - INFO -    Client: Address(host='100.64.0.4', port=41416)
2025-12-20T14:36:12.767625675Z [err]  2025-12-20 14:36:06,756 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '1WJY6xS0dlUB+7m6lYFZpQ==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': '52y3FyI_TcyHVp9PnpoFkQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766241366523', 'accept-encoding': 'gzip'}
2025-12-20T14:36:12.767630348Z [err]  2025-12-20 14:36:06,756 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-20T14:36:12.767634832Z [err]  2025-12-20 14:36:06,756 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-20T14:36:12.768342387Z [err]  [2025-12-20 14:36:06 +0000] [4] [INFO] ('100.64.0.4', 41416) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-20T14:36:12.768348614Z [err]  2025-12-20 14:36:06,756 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-20T14:36:12.768354789Z [err]  [2025-12-20 14:36:06 +0000] [4] [INFO] connection open
2025-12-20T14:36:12.768358607Z [err]  2025-12-20 14:36:06,788 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:12.768362460Z [err]  2025-12-20 14:36:06,789 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '250dc3ce-333a-4f6b-96c5-a9c34a8f5361', 'occurred_at': '2025-12-20T14:36:06.235962Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:12.768366208Z [err]  2025-12-20 14:36:06,789 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:12.768370419Z [err]  2025-12-20 14:36:06,789 - server - INFO - üì® ================================================
2025-12-20T14:36:12.768375182Z [err]  2025-12-20 14:36:06,789 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-20T14:36:12.768379517Z [inf]  100.64.0.5:12056 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:12.768383339Z [err]  2025-12-20 14:36:06,912 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-20T14:36:12.768388872Z [err]  2025-12-20 14:36:06,912 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-20T14:36:12.768964302Z [err]  2025-12-20 14:36:07,072 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-20T14:36:12.768972445Z [err]  2025-12-20 14:36:07,073 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-20T14:36:17.343432363Z [err]  2025-12-20 14:36:17,288 - server - INFO - üì¨ Received Telnyx event: start
2025-12-20T14:36:17.343440675Z [err]  2025-12-20 14:36:17,288 - server - INFO - üé¨ Stream started for call: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:17.343446598Z [err]  2025-12-20 14:36:17,321 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:17.343453483Z [err]  2025-12-20 14:36:17,324 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-20T14:36:17.343459159Z [err]  2025-12-20 14:36:17,324 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-20T14:36:17.593657615Z [err]  2025-12-20 14:36:17,583 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:17.593665809Z [err]  2025-12-20 14:36:17,583 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'e99f2e76-b0b7-4d98-89ce-1775c6b54f91', 'occurred_at': '2025-12-20T14:36:17.075962Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-20T14:36:06.235962Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:17.593673613Z [err]  2025-12-20 14:36:17,583 - server - INFO - üéØ Event type: call.answered, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:17.593681438Z [err]  2025-12-20 14:36:17,583 - server - INFO - üì® ================================================
2025-12-20T14:36:17.593689309Z [err]  2025-12-20 14:36:17,583 - server - INFO - ‚úÖ Call answered: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:17.598867045Z [err]  2025-12-20 14:36:17,595 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:17.598876734Z [err]  2025-12-20 14:36:17,596 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-20T14:36:17.598885013Z [err]  2025-12-20 14:36:17,596 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-20T14:36:17.847120841Z [err]  2025-12-20 14:36:17,824 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-20T14:36:17.847127895Z [err]  2025-12-20 14:36:17,825 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-20T14:36:17.847136462Z [err]  2025-12-20 14:36:17,837 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:17.847146509Z [err]  2025-12-20 14:36:17,838 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:17.847155000Z [err]  2025-12-20 14:36:17,838 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-20T14:36:18.048169326Z [err]  2025-12-20 14:36:18,042 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:18.048178062Z [err]  2025-12-20 14:36:18,042 - server - INFO - üì® ================================================
2025-12-20T14:36:18.048186573Z [inf]  100.64.0.5:21132 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:18.048203341Z [err]  2025-12-20 14:36:18,042 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:18.048209415Z [err]  2025-12-20 14:36:18,042 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'a16ef2ed-2a8a-44d1-bfb7-e0524cab2839', 'occurred_at': '2025-12-20T14:36:17.535962Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': 'b251b659-99f7-4fb0-8812-57fd39988528', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:18.546288366Z [err]  2025-12-20 14:36:18,472 - server - INFO - ‚úÖ Call log updated
2025-12-20T14:36:18.546298816Z [err]  2025-12-20 14:36:18,472 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-20T14:36:18.546307728Z [err]  2025-12-20 14:36:18,472 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-20T14:36:18.546315780Z [err]  2025-12-20 14:36:18,472 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:18.546325366Z [err]  2025-12-20 14:36:18,491 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-20T14:36:18.546333963Z [err]  2025-12-20 14:36:18,491 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-20T14:36:18.546340357Z [err]  2025-12-20 14:36:18,504 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-20T14:36:18.546346146Z [err]  2025-12-20 14:36:18,504 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-20T14:36:18.546352001Z [err]  2025-12-20 14:36:18,505 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-20T14:36:18.567575145Z [err]  2025-12-20 14:36:18,565 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:18.607355857Z [err]  2025-12-20 14:36:18,601 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-20T14:36:18.607363191Z [err]  2025-12-20 14:36:18,603 - server - INFO - ‚úÖ Initialized call_states for v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA with session reference
2025-12-20T14:36:18.607368647Z [err]  2025-12-20 14:36:18,604 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-20T14:36:18.607386098Z [err]  2025-12-20 14:36:18,592 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:18.607390204Z [err]  2025-12-20 14:36:18,601 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 95ms
2025-12-20T14:36:18.607394169Z [err]  2025-12-20 14:36:18,601 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-20T14:36:18.607398667Z [err]  2025-12-20 14:36:18,601 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-20T14:36:18.607402801Z [err]  2025-12-20 14:36:18,601 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-20T14:36:18.788661324Z [err]  2025-12-20 14:36:18,652 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:18.788664559Z [err]  2025-12-20 14:36:18,652 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-20T14:36:18.788668974Z [err]  2025-12-20 14:36:18,673 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-20T14:36:18.788673064Z [err]  2025-12-20 14:36:18,692 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-20T14:36:18.958419991Z [err]  2025-12-20 14:36:18,953 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/playback_start "HTTP/1.1 200 OK"
2025-12-20T14:36:18.958441483Z [err]  2025-12-20 14:36:18,954 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: 0BBSuClS4w (loop=True, overlay=True)
2025-12-20T14:36:18.958448701Z [err]  2025-12-20 14:36:18,955 - server - INFO - üéµ Comfort noise started as continuous background overlay (playback_id: 0BBSuClS4w)
2025-12-20T14:36:18.958456065Z [err]  2025-12-20 14:36:18,955 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:19.270193732Z [err]  2025-12-20 14:36:19,268 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:19.270201046Z [err]  2025-12-20 14:36:19,269 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '8c8d1d80-6743-4470-a4d6-5fc0a6d23920', 'occurred_at': '2025-12-20T14:36:19.055966Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': '0BBSuClS4w', 'start_time': '2025-12-20T14:36:19.055966Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:19.270206542Z [err]  2025-12-20 14:36:19,269 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:19.270211192Z [err]  2025-12-20 14:36:19,269 - server - INFO - üì® ================================================
2025-12-20T14:36:19.270215793Z [inf]  100.64.0.5:21132 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:20.502366442Z [err]  2025-12-20 14:36:20,442 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-20T14:36:20.502379024Z [err]  2025-12-20 14:36:20,442 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-20T14:36:20.502387589Z [err]  2025-12-20 14:36:20,443 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-20T14:36:20.502395429Z [err]  2025-12-20 14:36:20,443 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-20T14:36:20.502402242Z [err]  2025-12-20 14:36:20,462 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-20T14:36:20.502410020Z [err]  2025-12-20 14:36:20,463 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-20T14:36:20.502417877Z [err]  2025-12-20 14:36:20,463 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:20.502506517Z [err]  2025-12-20 14:36:20,438 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/record_start "HTTP/1.1 200 OK"
2025-12-20T14:36:20.502512732Z [err]  2025-12-20 14:36:20,440 - server - INFO - üéôÔ∏è Call recording started for v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:20.502521116Z [err]  2025-12-20 14:36:20,440 - server - INFO - üîß Creating call session for v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA...
2025-12-20T14:36:20.502528195Z [err]  2025-12-20 14:36:20,440 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:20.502531125Z [err]  2025-12-20 14:36:20,469 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:20.502535717Z [err]  2025-12-20 14:36:20,440 - server - INFO - üîß Calling create_call_session() - START
2025-12-20T14:36:20.502540546Z [err]  2025-12-20 14:36:20,469 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-20T14:36:20.502543580Z [err]  2025-12-20 14:36:20,440 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-20T14:36:20.502548396Z [err]  2025-12-20 14:36:20,470 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-20T14:36:20.535221834Z [err]  2025-12-20 14:36:20,528 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-20T14:36:20.535227375Z [err]  2025-12-20 14:36:20,528 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-20T14:36:20.535231807Z [err]  2025-12-20 14:36:20,529 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-20T14:36:20.535237561Z [err]  2025-12-20 14:36:20,529 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-20T14:36:20.535241354Z [err]  2025-12-20 14:36:20,529 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-20T14:36:20.639931298Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-20T14:36:20.639931934Z [err]  2025-12-20 14:36:20,630 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:20.639938247Z [err]  2025-12-20 14:36:20,637 - redis_service - INFO - üì¶ Stored call data in Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (TTL: 3600s)
2025-12-20T14:36:20.639943847Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-20T14:36:20.639944909Z [err]  2025-12-20 14:36:20,637 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-20T14:36:20.639951513Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚è±Ô∏è [14:36:20.637] üì• process_user_input() ENTRY - text: '...'
2025-12-20T14:36:20.639953656Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-20T14:36:20.639958259Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚è±Ô∏è [14:36:20.638] ‚è© About to call _process_call_flow_streaming()
2025-12-20T14:36:20.639964022Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚è±Ô∏è [14:36:20.638] üîÄ Agent type: call_flow, calling flow processor...
2025-12-20T14:36:20.639969735Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚è±Ô∏è [14:36:20.638] üîÄ _process_call_flow_streaming() ENTRY
2025-12-20T14:36:20.639975882Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-20T14:36:20.639981827Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚è±Ô∏è [14:36:20.638] ‚úÖ Node selected, about to process content...
2025-12-20T14:36:20.639987238Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 20, 2025 at 9:36 AM EST in content
2025-12-20T14:36:20.640836362Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-20T14:36:20.640848945Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-20T14:36:20.640860327Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-20T14:36:20.640868077Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-20T14:36:20.640875433Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-20T14:36:20.640883082Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-20T14:36:20.640890364Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-20T14:36:20.640897783Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-20T14:36:20.640904405Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-20T14:36:20.640912507Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚è±Ô∏è [14:36:20.638] üìÑ About to process content (mode=script, length=9)
2025-12-20T14:36:20.640920024Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üîä Silence tracking reset for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (user responded)
2025-12-20T14:36:20.640928180Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-20T14:36:20.640934848Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-20T14:36:20.641408631Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - LLM response (0.00s): Kendrick?
2025-12-20T14:36:20.641416368Z [err]  2025-12-20 14:36:20,638 - calling_service - INFO - Total latency: 0.00s
2025-12-20T14:36:20.641422117Z [err]  2025-12-20 14:36:20,638 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-20T14:36:20.641429732Z [err]  2025-12-20 14:36:20,639 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:20.652697686Z [err]  2025-12-20 14:36:20,647 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 117ms
2025-12-20T14:36:20.652704141Z [err]  2025-12-20 14:36:20,647 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-20T14:36:20.652710565Z [err]  2025-12-20 14:36:20,647 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-20T14:36:20.678811283Z [err]  2025-12-20 14:36:20,677 - redis_service - INFO - üì¶ Stored call data in Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (TTL: 3600s)
2025-12-20T14:36:20.678820255Z [err]  2025-12-20 14:36:20,677 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-20T14:36:20.678825356Z [err]  2025-12-20 14:36:20,677 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-20T14:36:20.683911335Z [err]  2025-12-20 14:36:20,683 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-20T14:36:20.683911963Z [err]  2025-12-20 14:36:20,682 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:20.683923097Z [err]  2025-12-20 14:36:20,682 - server - INFO - ü§ñ AI session created for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:20.683924560Z [err]  2025-12-20 14:36:20,683 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-20T14:36:20.683929215Z [err]  2025-12-20 14:36:20,682 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-20T14:36:20.683933217Z [err]  2025-12-20 14:36:20,683 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-20T14:36:20.683937228Z [err]  2025-12-20 14:36:20,683 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-20T14:36:20.683941531Z [err]  2025-12-20 14:36:20,683 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-20T14:36:20.683945394Z [err]  2025-12-20 14:36:20,683 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-20T14:36:20.683949743Z [err]  2025-12-20 14:36:20,683 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-20T14:36:20.683953418Z [err]  2025-12-20 14:36:20,683 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-20T14:36:20.688528692Z [inf]  100.64.0.6:53518 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:20.845380587Z [err]  2025-12-20 14:36:20,742 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-20T14:36:20.845393555Z [err]  2025-12-20 14:36:20,743 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-20T14:36:20.845403191Z [err]  2025-12-20 14:36:20,830 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:20.845410660Z [err]  2025-12-20 14:36:20,830 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-20T14:36:20.845418110Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Text length: 9 chars
2025-12-20T14:36:20.845425956Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Text content: 'Kendrick?'
2025-12-20T14:36:20.845434533Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-20T14:36:20.845437010Z [err]  2025-12-20 14:36:20,741 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:20.845441734Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-20T14:36:20.845443496Z [err]  2025-12-20 14:36:20,742 - telnyx_service - INFO - üîä Speaking text on call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA: Kendrick?...
2025-12-20T14:36:20.845448348Z [err]  2025-12-20 14:36:20,742 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-20T14:36:20.845453663Z [err]  2025-12-20 14:36:20,742 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-20T14:36:20.845459536Z [err]  2025-12-20 14:36:20,742 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-20T14:36:20.845466056Z [err]  2025-12-20 14:36:20,742 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-20T14:36:20.845472712Z [err]  2025-12-20 14:36:20,742 - server - INFO - ‚è±Ô∏è [14:36:20.742] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-20T14:36:20.845762173Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-20T14:36:20.845768033Z [err]  2025-12-20 14:36:20,830 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-20T14:36:20.845773555Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-20T14:36:20.845778763Z [err]  2025-12-20 14:36:20,830 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-20T14:36:20.845784626Z [err]  2025-12-20 14:36:20,830 - server - INFO -    Timeout: 10.0s
2025-12-20T14:36:20.845790144Z [err]  2025-12-20 14:36:20,838 - server - INFO -    ‚úì HTTP client created (0.008s)
2025-12-20T14:36:20.845911879Z [err]  2025-12-20 14:36:20,838 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-20T14:36:20.985641787Z [err]  2025-12-20 14:36:20,976 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:20.985648781Z [err]  2025-12-20 14:36:20,976 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-20T14:36:21.211285441Z [err]  2025-12-20 14:36:21,184 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-20T14:36:21.211296681Z [err]  2025-12-20 14:36:21,184 - server - INFO -    ‚úì Connection established (0.353s) [TARGET: <200ms]
2025-12-20T14:36:21.211307402Z [err]  2025-12-20 14:36:21,184 - server - INFO -    ‚úì Response status: 200
2025-12-20T14:36:21.211314526Z [err]  2025-12-20 14:36:21,184 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-20T14:36:21.211322185Z [err]  2025-12-20 14:36:21,200 - server - INFO -    ‚úì FIRST CHUNK received (0.369s, 1156 bytes) [TARGET: <300ms]
2025-12-20T14:36:21.211329464Z [err]  2025-12-20 14:36:21,202 - server - INFO -    ‚úì ALL CHUNKS received: 82 chunks (0.372s)
2025-12-20T14:36:21.211336896Z [err]  2025-12-20 14:36:21,202 - server - INFO -    ‚úì Total audio size: 13419 bytes
2025-12-20T14:36:21.211343729Z [err]  2025-12-20 14:36:21,202 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-20T14:36:21.211352482Z [err]  2025-12-20 14:36:21,202 - server - INFO -       - Connection: 353ms
2025-12-20T14:36:21.211359629Z [err]  2025-12-20 14:36:21,202 - server - INFO -       - First chunk: 369ms
2025-12-20T14:36:21.211366241Z [err]  2025-12-20 14:36:21,202 - server - INFO -       - All chunks: 372ms
2025-12-20T14:36:21.211372679Z [err]  2025-12-20 14:36:21,202 - server - INFO -       - Audio generation only: 16ms
2025-12-20T14:36:21.211380033Z [err]  2025-12-20 14:36:21,202 - server - INFO - ‚è±Ô∏è [14:36:21.202] üîä TTS COMPLETE: 459ms, audio_size=13419 bytes
2025-12-20T14:36:21.211386451Z [err]  2025-12-20 14:36:21,202 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (13419 bytes)
2025-12-20T14:36:21.211393341Z [err]  2025-12-20 14:36:21,202 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.46s
2025-12-20T14:36:21.211400209Z [err]  2025-12-20 14:36:21,203 - telnyx_service - INFO - ‚úÖ Generated 13419 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-20T14:36:21.211603329Z [err]  2025-12-20 14:36:21,203 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-20T14:36:21.439679800Z [err]  2025-12-20 14:36:21,420 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/playback_start "HTTP/1.1 200 OK"
2025-12-20T14:36:21.439687335Z [err]  2025-12-20 14:36:21,421 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2025-12-20T14:36:21.439694166Z [err]  2025-12-20 14:36:21,421 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.68s
2025-12-20T14:36:21.439703346Z [err]  2025-12-20 14:36:21,421 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-20T14:36:21.439712377Z [err]  2025-12-20 14:36:21,421 - telnyx_service - INFO - üé¨ Playback ID: 2Gyg-2h03g
2025-12-20T14:36:21.439719281Z [err]  2025-12-20 14:36:21,421 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-20T14:36:21.439726505Z [err]  2025-12-20 14:36:21,421 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241381.4218903 for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:21.439732899Z [err]  2025-12-20 14:36:21,421 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-20T14:36:21.511469948Z [err]  2025-12-20 14:36:21,482 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:22.005316639Z [err]  2025-12-20 14:36:21,988 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:22.458137188Z [inf]  100.64.0.5:21132 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-20T14:36:22.508412856Z [err]  2025-12-20 14:36:22,495 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:22.853236521Z [inf]  100.64.0.5:21132 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:22.853339627Z [err]  2025-12-20 14:36:22,771 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:22.853349076Z [err]  2025-12-20 14:36:22,771 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '1502a7af-c0ad-42ad-954f-e3131a41bd02', 'occurred_at': '2025-12-20T14:36:22.415968Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'silence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:22.853356490Z [err]  2025-12-20 14:36:22,771 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:22.853363412Z [err]  2025-12-20 14:36:22,771 - server - INFO - üì® ================================================
2025-12-20T14:36:23.006377945Z [err]  2025-12-20 14:36:23,001 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:23.411947709Z [err]  2025-12-20 14:36:23,372 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:23.411956459Z [err]  2025-12-20 14:36:23,372 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'e39db5c6-a583-4b2d-ac35-bda1304a40b4', 'occurred_at': '2025-12-20T14:36:22.935962Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': '2Gyg-2h03g'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:23.411963410Z [err]  2025-12-20 14:36:23,372 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:23.411970961Z [err]  2025-12-20 14:36:23,372 - server - INFO - üì® ================================================
2025-12-20T14:36:23.411978198Z [inf]  100.64.0.7:30624 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:23.525009482Z [err]  2025-12-20 14:36:23,506 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:24.003776066Z [err]  2025-12-20 14:36:23,986 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:24.003782992Z [err]  2025-12-20 14:36:23,986 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'c19cc7fd-6bb8-4035-98de-221d9bbd8ffb', 'occurred_at': '2025-12-20T14:36:23.775964Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': '2Gyg-2h03g', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:24.003789573Z [err]  2025-12-20 14:36:23,986 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:24.003796890Z [err]  2025-12-20 14:36:23,986 - server - INFO - üì® ================================================
2025-12-20T14:36:24.003804738Z [err]  2025-12-20 14:36:23,997 - redis_service - INFO - ‚ûñ Removed playback 2Gyg-2h03g, 0 remaining for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:24.003813152Z [err]  2025-12-20 14:36:23,997 - server - INFO - üîä Redis: Removed playback 2Gyg-2h03g, 0 remaining
2025-12-20T14:36:24.003820716Z [err]  2025-12-20 14:36:23,997 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-20T14:36:24.003827053Z [err]  2025-12-20 14:36:24,002 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-20T14:36:24.003831825Z [inf]  100.64.0.5:21132 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:24.023258953Z [err]  2025-12-20 14:36:24,013 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:24.532905431Z [err]  2025-12-20 14:36:24,519 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:25.029745845Z [err]  2025-12-20 14:36:25,025 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:25.478005674Z [err]  2025-12-20 14:36:25,476 - server - INFO - üì§ Audio flowing: 383 packets sent to Soniox (5s update)
2025-12-20T14:36:25.553501519Z [err]  2025-12-20 14:36:25,531 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:26.083618038Z [err]  2025-12-20 14:36:26,038 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:26.319076271Z [err]  2025-12-20 14:36:26,315 - server - INFO - üî§ RAW TOKENS: ["Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2025-12-20T14:36:26.319084242Z [err]  2025-12-20 14:36:26,316 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-20T14:36:26.319997453Z [err]  2025-12-20 14:36:26,319 - server - INFO - üßπ Cleaned transcript: 'Ye ah.' -> 'Yeah.'
2025-12-20T14:36:26.320003705Z [err]  2025-12-20 14:36:26,319 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-20T14:36:26.320008813Z [err]  2025-12-20 14:36:26,319 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2025-12-20T14:36:26.320736589Z [err]  2025-12-20 14:36:26,319 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:26.320741760Z [err]  2025-12-20 14:36:26,319 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-20T14:36:26.320746397Z [err]  2025-12-20 14:36:26,319 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:26.320750845Z [err]  2025-12-20 14:36:26,319 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-20T14:36:26.320754421Z [err]  2025-12-20 14:36:26,320 - server - INFO - ‚è±Ô∏è [14:36:26.320] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-20T14:36:26.320759823Z [err]  2025-12-20 14:36:26,320 - server - INFO - ‚è±Ô∏è [14:36:26.320] STT endpoint detection latency: 23ms
2025-12-20T14:36:26.320764017Z [err]  2025-12-20 14:36:26,320 - server - INFO - ‚è±Ô∏è [14:36:26.320] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-20T14:36:26.331727125Z [err]  2025-12-20 14:36:26,325 - redis_service - INFO - üì¶ Stored call data in Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (TTL: 3600s)
2025-12-20T14:36:26.331732905Z [err]  2025-12-20 14:36:26,326 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-20T14:36:26.331736946Z [err]  2025-12-20 14:36:26,326 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:26.331742640Z [err]  2025-12-20 14:36:26,326 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-20T14:36:26.343040578Z [err]  2025-12-20 14:36:26,336 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-20T14:36:26.343048435Z [err]  2025-12-20 14:36:26,336 - calling_service - INFO - üë§ User stopped speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:26.343057121Z [err]  2025-12-20 14:36:26,336 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-20T14:36:26.343061943Z [err]  2025-12-20 14:36:26,336 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2025-12-20T14:36:26.343067054Z [err]  2025-12-20 14:36:26,336 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2025-12-20T14:36:26.343071538Z [err]  2025-12-20 14:36:26,336 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-20T14:36:26.343076719Z [err]  2025-12-20 14:36:26,336 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-20T14:36:26.343083141Z [err]  2025-12-20 14:36:26,336 - calling_service - INFO - ü§ñ Agent started speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:26.428396413Z [err]  2025-12-20 14:36:26,426 - server - INFO - üìù Saved user transcript to database
2025-12-20T14:36:26.428402222Z [err]  2025-12-20 14:36:26,427 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:26.428407449Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - ‚è±Ô∏è [14:36:26.427] üì• process_user_input() ENTRY - text: 'Yeah....'
2025-12-20T14:36:26.428411994Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - ‚è±Ô∏è [14:36:26.427] ‚è© About to call _process_call_flow_streaming()
2025-12-20T14:36:26.428415595Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - ‚è±Ô∏è [14:36:26.427] üîÄ Agent type: call_flow, calling flow processor...
2025-12-20T14:36:26.428419293Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - ‚è±Ô∏è [14:36:26.427] üîÄ _process_call_flow_streaming() ENTRY
2025-12-20T14:36:26.428424751Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-20T14:36:26.428428578Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-20T14:36:26.428432320Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - ‚è±Ô∏è [14:36:26.427] üîÄ About to call _follow_transition() for: Yeah....
2025-12-20T14:36:26.428436409Z [err]  2025-12-20 14:36:26,427 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-20T14:36:26.437028824Z [err]  2025-12-20 14:36:26,436 - calling_service - INFO - ‚è±Ô∏è [14:36:26.436] üîÄ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-20T14:36:26.600766919Z [err]  2025-12-20 14:36:26,596 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-20T14:36:26.600775629Z [err]  2025-12-20 14:36:26,596 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241386.5963159 for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:26.600782500Z [err]  2025-12-20 14:36:26,596 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:26.605321755Z [err]  2025-12-20 14:36:26,601 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:27.066921339Z [err]  2025-12-20 14:36:27,063 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20T14:36:27.071906343Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - ‚è±Ô∏è [14:36:27.070] üîÄ TRANSITION EVALUATION COMPLETE - took 634ms
2025-12-20T14:36:27.071916835Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - ü§ñ AI transition decision: '0'
2025-12-20T14:36:27.071925017Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc) - don...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-20T14:36:27.071932442Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - Selected transition index: 0
2025-12-20T14:36:27.071939262Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-20T14:36:27.071944938Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 643ms
2025-12-20T14:36:27.071951420Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - ‚è±Ô∏è [14:36:27.070] ‚úÖ Node selected, about to process content...
2025-12-20T14:36:27.071957799Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 20, 2025 at 9:36 AM EST in content
2025-12-20T14:36:27.071965100Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-20T14:36:27.071971850Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-20T14:36:27.071978393Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-20T14:36:27.071985553Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-20T14:36:27.071992702Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-20T14:36:27.072651776Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-20T14:36:27.072654788Z [err]  2025-12-20 14:36:27,071 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:27.072658280Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-20T14:36:27.072663232Z [err]  2025-12-20 14:36:27,070 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-20T14:36:27.072663903Z [err]  2025-12-20 14:36:27,071 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-20T14:36:27.072667865Z [err]  2025-12-20 14:36:27,071 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-20T14:36:27.072671604Z [err]  2025-12-20 14:36:27,071 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-20T14:36:27.072675340Z [err]  2025-12-20 14:36:27,071 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-20T14:36:27.072678980Z [err]  2025-12-20 14:36:27,071 - calling_service - INFO - ‚è±Ô∏è [14:36:27.071] üìÑ About to process content (mode=script, length=89)
2025-12-20T14:36:27.072682418Z [err]  2025-12-20 14:36:27,071 - calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2025-12-20T14:36:27.072687526Z [err]  2025-12-20 14:36:27,071 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2025-12-20T14:36:27.072693405Z [err]  2025-12-20 14:36:27,071 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 734ms
2025-12-20T14:36:27.072699305Z [err]  2025-12-20 14:36:27,071 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-20T14:36:27.120445206Z [err]  2025-12-20 14:36:27,107 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:X_GlDaL5KMstJ_n_R... (active sessions: [])
2025-12-20T14:36:27.160336548Z [err]  2025-12-20 14:36:27,159 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:27.254563511Z [err]  2025-12-20 14:36:27,246 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:27.366671906Z [err]  2025-12-20 14:36:27,334 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:27.366678306Z [err]  2025-12-20 14:36:27,354 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-20T14:36:27.366682444Z [err]  2025-12-20 14:36:27,354 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-20T14:36:27.366688338Z [err]  2025-12-20 14:36:27,354 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-20T14:36:27.366691968Z [err]  2025-12-20 14:36:27,355 - persistent_tts_service - INFO - üîå [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Establishing persistent TTS WebSocket...
2025-12-20T14:36:27.366695768Z [err]  2025-12-20 14:36:27,355 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-20T14:36:27.366699725Z [err]  2025-12-20 14:36:27,355 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-20T14:36:27.366704172Z [err]  2025-12-20 14:36:27,355 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-20T14:36:27.480250091Z [err]  2025-12-20 14:36:27,478 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1141ms
2025-12-20T14:36:27.480250545Z [err]  2025-12-20 14:36:27,477 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-20T14:36:27.480257546Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2025-12-20T14:36:27.480262379Z [err]  2025-12-20 14:36:27,477 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-20T14:36:27.480264152Z [err]  2025-12-20 14:36:27,478 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-20T14:36:27.480270362Z [err]  2025-12-20 14:36:27,477 - persistent_tts_service - INFO - ‚úÖ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Persistent TTS WebSocket established
2025-12-20T14:36:27.480276859Z [err]  2025-12-20 14:36:27,477 - persistent_tts_service - INFO - üéß [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Audio receiver loop started
2025-12-20T14:36:27.480283349Z [err]  2025-12-20 14:36:27,477 - persistent_tts_service - INFO - üîä [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Comfort noise loop started
2025-12-20T14:36:27.480292106Z [err]  2025-12-20 14:36:27,478 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:27.480298613Z [err]  2025-12-20 14:36:27,478 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-20T14:36:27.480304984Z [err]  2025-12-20 14:36:27,478 - server - INFO - üîç Persistent TTS lookup: call_id=v3:X_GlDaL5KMstJ_n_R..., session=FOUND
2025-12-20T14:36:27.480311139Z [err]  2025-12-20 14:36:27,478 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-20T14:36:27.480317658Z [err]  2025-12-20 14:36:27,478 - server - INFO - üéµ TTS task #1 started at +406ms
2025-12-20T14:36:27.480955199Z [err]  2025-12-20 14:36:27,478 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-20T14:36:27.480963946Z [err]  2025-12-20 14:36:27,478 - server - INFO - üîç Persistent TTS lookup: call_id=v3:X_GlDaL5KMstJ_n_R..., session=FOUND
2025-12-20T14:36:27.480971212Z [err]  2025-12-20 14:36:27,478 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-20T14:36:27.480977201Z [err]  2025-12-20 14:36:27,478 - server - INFO - üéµ TTS task #2 started at +406ms
2025-12-20T14:36:27.480983824Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-20T14:36:27.480990089Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user gave meaningful response) for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:27.480997322Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - üîä Silence tracking reset for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (user responded)
2025-12-20T14:36:27.481003717Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-20T14:36:27.481009824Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2025-12-20T14:36:27.481016188Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - LLM response (1.05s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-20T14:36:27.481022502Z [err]  2025-12-20 14:36:27,478 - calling_service - INFO - Total latency: 1.05s
2025-12-20T14:36:27.481028821Z [err]  2025-12-20 14:36:27,478 - server - INFO - ‚úÖ LLM finished in 1141ms, TTS tasks already running in background
2025-12-20T14:36:27.481034686Z [err]  2025-12-20 14:36:27,478 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2025-12-20T14:36:27.481481192Z [err]  2025-12-20 14:36:27,478 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-20T14:36:27.481488047Z [err]  2025-12-20 14:36:27,478 - persistent_tts_service - INFO - üéµ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Playback consumer started
2025-12-20T14:36:27.481493469Z [err]  2025-12-20 14:36:27,478 - persistent_tts_service - INFO - üéß [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Audio Receiver Loop STARTED
2025-12-20T14:36:27.481499546Z [err]  2025-12-20 14:36:27,478 - persistent_tts_service - INFO - üíì [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Starting TTS keep-alive loop (every 15s)
2025-12-20T14:36:27.481505282Z [err]  2025-12-20 14:36:27,478 - persistent_tts_service - INFO - üîä [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Starting comfort noise loop
2025-12-20T14:36:27.481512568Z [err]  2025-12-20 14:36:27,478 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-20T14:36:28.321349023Z [err]  2025-12-20 14:36:28,198 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-20T14:36:28.321353369Z [err]  2025-12-20 14:36:28,284 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-20T14:36:28.321357498Z [err]  2025-12-20 14:36:28,284 - persistent_tts_service - INFO - üé§ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Streaming sentence #1: This is Jake......
2025-12-20T14:36:28.321361657Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üöÄ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-20T14:36:28.321366256Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üìä [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-20T14:36:28.321370075Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üé§ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Streaming sentence #2: I was just, um, wondering if you could possibly he...
2025-12-20T14:36:28.321375478Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üöÄ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-20T14:36:28.321379734Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üìä [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-20T14:36:28.321383960Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üéß [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Receiver processing sentence #1: 'This is Jake......'
2025-12-20T14:36:28.321388098Z [err]  2025-12-20 14:36:28,285 - persistent_tts_service - INFO - üìä [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] DIAGNOSTIC: queue_latency=0ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-20T14:36:28.322014388Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2025-12-20T14:36:28.322016485Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-20T14:36:28.322025945Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-20T14:36:28.322032759Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 1954ms from user stop üöÄ
2025-12-20T14:36:28.322041152Z [err]  2025-12-20 14:36:28,291 - calling_service - INFO - ü§ñ Agent started speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:28.322047792Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-20T14:36:28.322054823Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-20T14:36:28.322062023Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-20T14:36:28.322067286Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-20T14:36:28.322069917Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2025-12-20T14:36:28.322076228Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1141ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-20T14:36:28.322082805Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 1220ms (provider: elevenlabs, websocket: False)
2025-12-20T14:36:28.322088899Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1954ms (user stopped ‚Üí play_audio_url called)
2025-12-20T14:36:28.322518290Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-20T14:36:28.322527226Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-20T14:36:28.322534341Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-20T14:36:28.322540501Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2254ms estimated
2025-12-20T14:36:28.322547542Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-20T14:36:28.322553793Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2025-12-20T14:36:28.322560001Z [err]  2025-12-20 14:36:28,291 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-20T14:36:28.322565702Z [err]  2025-12-20 14:36:28,292 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-20T14:36:28.322572292Z [err]  2025-12-20 14:36:28,292 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-20T14:36:28.501479452Z [err]  2025-12-20 14:36:28,472 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1651ms)
2025-12-20T14:36:28.501483232Z [err]  2025-12-20 14:36:28,472 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-20T14:36:28.501487377Z [err]  2025-12-20 14:36:28,472 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-20T14:36:28.545311642Z [err]  2025-12-20 14:36:28,540 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 256ms
2025-12-20T14:36:28.545320322Z [err]  2025-12-20 14:36:28,541 - persistent_tts_service - INFO - üì§ Sending 8900 bytes of audio (56 chunks, 1.1s duration) via WebSocket
2025-12-20T14:36:28.545327404Z [err]  2025-12-20 14:36:28,541 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-20T14:36:28.545334147Z [err]  2025-12-20 14:36:28,541 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-20T14:36:28.545339884Z [err]  2025-12-20 14:36:28,541 - persistent_tts_service - INFO - ‚úÖ Sent 56 audio chunks via WebSocket
2025-12-20T14:36:28.773441409Z [err]  2025-12-20 14:36:28,767 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-20T14:36:28.773452389Z [err]  2025-12-20 14:36:28,768 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-20T14:36:28.773459705Z [err]  2025-12-20 14:36:28,768 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.6s from now)
2025-12-20T14:36:28.773463640Z [err]  2025-12-20 14:36:28,769 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket
2025-12-20T14:36:28.773467353Z [err]  2025-12-20 14:36:28,769 - persistent_tts_service - INFO - üì§ Sending 697 bytes of audio (5 chunks, 0.1s duration) via WebSocket
2025-12-20T14:36:28.773471407Z [err]  2025-12-20 14:36:28,769 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-20T14:36:28.773475787Z [err]  2025-12-20 14:36:28,769 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.1s (total: 2.7s from now)
2025-12-20T14:36:28.773481169Z [err]  2025-12-20 14:36:28,769 - persistent_tts_service - INFO - ‚úÖ Sent 5 audio chunks via WebSocket
2025-12-20T14:36:28.980936986Z [err]  2025-12-20 14:36:28,977 - persistent_tts_service - INFO - üì§ Sending 22291 bytes of audio (140 chunks, 2.8s duration) via WebSocket
2025-12-20T14:36:28.980942300Z [err]  2025-12-20 14:36:28,977 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-20T14:36:28.980949183Z [err]  2025-12-20 14:36:28,977 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.8s (total: 5.3s from now)
2025-12-20T14:36:28.980954528Z [err]  2025-12-20 14:36:28,979 - persistent_tts_service - INFO - ‚úÖ Sent 140 audio chunks via WebSocket
2025-12-20T14:36:30.355152486Z [err]  2025-12-20 14:36:30,336 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.9s left)
2025-12-20T14:36:30.520812709Z [err]  2025-12-20 14:36:30,519 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 627 total packets
2025-12-20T14:36:30.520819819Z [err]  [2025-12-20 14:36:30 +0000] [4] [INFO] connection closed
2025-12-20T14:36:30.732700594Z [err]  2025-12-20 14:36:30,727 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:30.732706193Z [err]  2025-12-20 14:36:30,727 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': 'c5532b83-ad4d-4e15-8833-a0698b8fa5ef', 'occurred_at': '2025-12-20T14:36:30.451854Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': 'b251b659-99f7-4fb0-8812-57fd39988528', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:30.732710361Z [err]  2025-12-20 14:36:30,727 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.732713884Z [err]  2025-12-20 14:36:30,727 - server - INFO - üì® ================================================
2025-12-20T14:36:30.732717517Z [inf]  100.64.0.8:18880 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:30.772118975Z [err]  2025-12-20 14:36:30,761 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:30.772124301Z [err]  2025-12-20 14:36:30,761 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '4e50d8c6-3541-46ba-8fb8-4722e520f58a', 'occurred_at': '2025-12-20T14:36:30.375966Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-20T14:36:30.375966Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': '0BBSuClS4w', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:30.772129342Z [err]  2025-12-20 14:36:30,761 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.772133494Z [err]  2025-12-20 14:36:30,761 - server - INFO - üì® ================================================
2025-12-20T14:36:30.783128936Z [err]  2025-12-20 14:36:30,776 - redis_service - INFO - ‚ûñ Removed playback 0BBSuClS4w, 0 remaining for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.783136446Z [err]  2025-12-20 14:36:30,776 - server - INFO - üîä Redis: Removed playback 0BBSuClS4w, 0 remaining
2025-12-20T14:36:30.783142235Z [err]  2025-12-20 14:36:30,776 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-20T14:36:30.783147370Z [err]  2025-12-20 14:36:30,782 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-20T14:36:30.783154007Z [inf]  100.64.0.4:25914 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:30.911294008Z [err]  2025-12-20 14:36:30,843 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241390.8431702 for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.911303120Z [err]  2025-12-20 14:36:30,843 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.911309119Z [err]  2025-12-20 14:36:30,849 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.4s left)
2025-12-20T14:36:30.911369015Z [err]  2025-12-20 14:36:30,843 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-20T14:36:30.950388758Z [err]  2025-12-20 14:36:30,944 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:30.950397945Z [err]  2025-12-20 14:36:30,944 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '69a7f0ab-91eb-4ea2-982c-9875f2c5fb8b', 'occurred_at': '2025-12-20T14:36:30.315962Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '42.16', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '654', 'skip_packet_count': '20'}, 'outbound': {'packet_count': '633', 'skip_packet_count': '0'}}, 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-20T14:36:30.315962Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-20T14:36:06.235962Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:30.950402680Z [err]  2025-12-20 14:36:30,944 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.950407590Z [err]  2025-12-20 14:36:30,944 - server - INFO - üì® ================================================
2025-12-20T14:36:30.950412020Z [err]  2025-12-20 14:36:30,944 - server - INFO - üìû Call ended: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:30.950416290Z [err]  2025-12-20 14:36:30,944 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-20T14:36:30.989938451Z [err]  2025-12-20 14:36:30,977 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-20T14:36:30.989945526Z [err]  2025-12-20 14:36:30,977 - persistent_tts_service - INFO - ‚úÖ [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Receiver finished sentence #1: 4 chunks in 2692ms
2025-12-20T14:36:30.989952277Z [err]  2025-12-20 14:36:30,977 - persistent_tts_service - INFO - üéß [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Receiver processing sentence #2: 'I was just, um, wondering if y...'
2025-12-20T14:36:30.989959287Z [err]  2025-12-20 14:36:30,977 - persistent_tts_service - INFO - üìä [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] DIAGNOSTIC: queue_latency=2692ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-20T14:36:31.923898981Z [err]  2025-12-20 14:36:31,863 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-20T14:36:31.923905514Z [err]  2025-12-20 14:36:31,919 - server - INFO - üìù Updated call log: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:31.963039679Z [err]  2025-12-20 14:36:31,951 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:32.012280942Z [err]  2025-12-20 14:36:32,009 - server - INFO - ‚úÖ Finalized call log: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA (duration=14s, status=completed)
2025-12-20T14:36:32.051122447Z [err]  2025-12-20 14:36:32,038 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:32.062111948Z [err]  2025-12-20 14:36:32,058 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-20T14:36:32.062117833Z [err]  2025-12-20 14:36:32,058 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-20T14:36:32.062121782Z [err]  2025-12-20 14:36:32,058 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-20T14:36:32.062127915Z [err]  2025-12-20 14:36:32,058 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-20T14:36:32.240544842Z [err]  2025-12-20 14:36:32,207 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:32.240552447Z [err]  2025-12-20 14:36:32,207 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '0b57d16e-4ecc-4f4d-bb97-fdf1b1219dc8', 'occurred_at': '2025-12-20T14:36:31.711185Z', 'payload': {'call_control_id': 'v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA', 'call_leg_id': '37aae2e6-ddb1-11f0-a7e1-02420aef96a0', 'call_session_id': '37a862dc-ddb1-11f0-9e46-02420aef96a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-20T14:36:30.441251Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-20T14:36:30.441251Z', 'recording_id': 'a90492eb-5270-44e8-b472-c26a7e7b7f9d', 'recording_started_at': '2025-12-20T14:36:20.197105Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-20/37aae2e6-ddb1-11f0-a7e1-02420aef96a0-1766241379295696.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251220%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251220T143631Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=e60f9eac0c7dc2ecdc4ff1d8dcfb6fe29c1b9fba32d121e6c775342096f82585'}, 'start_time': '2025-12-20T14:36:20.197105Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:32.240557326Z [err]  2025-12-20 14:36:32,207 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:32.240561306Z [err]  2025-12-20 14:36:32,207 - server - INFO - üì® ================================================
2025-12-20T14:36:32.240565847Z [err]  2025-12-20 14:36:32,207 - server - INFO - üéôÔ∏è Recording saved for call: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:32.240569953Z [err]  2025-12-20 14:36:32,213 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:32.241300653Z [err]  2025-12-20 14:36:32,213 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=a90492eb-5270-44e8-b472-c26a7e7b7f9d, call_data=True
2025-12-20T14:36:32.327674303Z [err]  2025-12-20 14:36:32,303 - server - INFO - üíæ Saved recording URL and ID to database: a90492eb-5270-44e8-b472-c26a7e7b7f9d
2025-12-20T14:36:32.327680813Z [err]  2025-12-20 14:36:32,303 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-20T14:36:32.327685719Z [err]  2025-12-20 14:36:32,303 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-20T14:36:32.573051396Z [err]  2025-12-20 14:36:32,563 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-20T14:36:32.573055864Z [err]  2025-12-20 14:36:32,566 - telnyx_service - INFO - ‚úÖ Call initiated: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:32.611743054Z [err]  2025-12-20 14:36:32,596 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-20/37aae2e6-ddb1-11f0-a7e1-02420aef96a0-1766241379295696.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251220%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251220T143631Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=e60f9eac0c7dc2ecdc4ff1d8dcfb6fe29c1b9fba32d121e6c775342096f82585 "HTTP/1.1 200 OK"
2025-12-20T14:36:32.658586557Z [err]  2025-12-20 14:36:32,655 - server - INFO - üìù Created call log: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:32.658593348Z [err]  2025-12-20 14:36:32,655 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-20T14:36:32.658599240Z [err]  2025-12-20 14:36:32,655 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-20T14:36:32.659174839Z [err]  2025-12-20 14:36:32,655 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-20T14:36:32.659180987Z [err]  2025-12-20 14:36:32,655 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-20T14:36:32.698415251Z [err]  2025-12-20 14:36:32,683 - server - INFO - ‚úÖ Downloaded 41003 bytes
2025-12-20T14:36:32.698419182Z [err]  2025-12-20 14:36:32,683 - redis_service - INFO - üì¶ Stored call data in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (TTL: 3600s)
2025-12-20T14:36:32.698422929Z [err]  2025-12-20 14:36:32,683 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-20T14:36:32.698427130Z [err]  2025-12-20 14:36:32,683 - server - INFO - üìû Outbound call initiated: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:32.698432086Z [inf]  100.64.0.10:58964 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-20T14:36:32.719677394Z [err]  2025-12-20 14:36:32,717 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-20T14:36:32.719684776Z [inf]  100.64.0.5:36534 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:32.719731692Z [err]  2025-12-20 14:36:32,709 - server - INFO - üìä Auto-added call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-20T14:36:32.719737491Z [err]  2025-12-20 14:36:32,717 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:32.719742465Z [err]  2025-12-20 14:36:32,717 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': 'dd2183e3-c73e-4332-844e-7bbb29ef17da', 'occurred_at': '2025-12-20T14:36:32.444127Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:32.719746415Z [err]  2025-12-20 14:36:32,717 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:32.719750450Z [err]  2025-12-20 14:36:32,717 - server - INFO - üì® ================================================
2025-12-20T14:36:32.804053778Z [err]  2025-12-20 14:36:32,802 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-20T14:36:32.804059765Z [err]  2025-12-20 14:36:32,802 - server - INFO -    Client: Address(host='100.64.0.11', port=34506)
2025-12-20T14:36:32.804063772Z [err]  2025-12-20 14:36:32,802 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'DMFUUB31uL72mExRL/spCQ==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'casst8kYSRW8ToSfxtoGcA', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766241392572', 'accept-encoding': 'gzip'}
2025-12-20T14:36:32.804073609Z [err]  2025-12-20 14:36:32,802 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-20T14:36:32.804077914Z [err]  2025-12-20 14:36:32,802 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-20T14:36:32.804081961Z [err]  [2025-12-20 14:36:32 +0000] [4] [INFO] ('100.64.0.11', 34506) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-20T14:36:32.804086025Z [err]  2025-12-20 14:36:32,802 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-20T14:36:32.804089836Z [err]  [2025-12-20 14:36:32 +0000] [4] [INFO] connection open
2025-12-20T14:36:32.938986521Z [err]  2025-12-20 14:36:32,886 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-20T14:36:32.938999630Z [err]  2025-12-20 14:36:32,898 - redis_service - INFO - üì• Retrieved call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:32.939009719Z [err]  2025-12-20 14:36:32,898 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2025-12-20T14:36:32.939022051Z [err]  2025-12-20 14:36:32,898 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-20T14:36:32.939028165Z [err]  2025-12-20 14:36:32,845 - server - INFO - ‚úÖ Split into 2 channels
2025-12-20T14:36:32.939031924Z [err]  2025-12-20 14:36:32,846 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-20T14:36:32.939035781Z [err]  2025-12-20 14:36:32,846 - server - INFO - üìä Channel 0: 221804 bytes
2025-12-20T14:36:32.939039728Z [err]  2025-12-20 14:36:32,846 - server - ERROR - ‚ùå No Soniox API key available
2025-12-20T14:36:32.939043759Z [err]  2025-12-20 14:36:32,846 - server - INFO - ‚ùå Channel 0: No speech
2025-12-20T14:36:32.939048269Z [err]  2025-12-20 14:36:32,846 - server - INFO - üìä Channel 1: 221804 bytes
2025-12-20T14:36:32.939051825Z [err]  2025-12-20 14:36:32,846 - server - ERROR - ‚ùå No Soniox API key available
2025-12-20T14:36:32.939056031Z [err]  2025-12-20 14:36:32,846 - server - INFO - ‚ùå Channel 1: No speech
2025-12-20T14:36:32.939061082Z [err]  2025-12-20 14:36:32,846 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-20T14:36:32.939065002Z [inf]  100.64.0.9:28558 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:32.979543589Z [err]  2025-12-20 14:36:32,966 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-20T14:36:32.979552067Z [err]  2025-12-20 14:36:32,967 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-20T14:36:32.990600273Z [err]  2025-12-20 14:36:32,987 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-20T14:36:33.075282058Z [err]  2025-12-20 14:36:33,074 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-20T14:36:33.075287614Z [err]  2025-12-20 14:36:33,074 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-20T14:36:33.075292575Z [err]  2025-12-20 14:36:33,074 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-20T14:36:33.075296077Z [err]  2025-12-20 14:36:33,074 - server - INFO - üöÄ Triggered QC analysis for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.075299734Z [err]  2025-12-20 14:36:33,074 - server - INFO - üìä Triggered Campaign QC for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.075305053Z [err]  2025-12-20 14:36:33,074 - server - INFO - üìá Triggered CRM update for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.075308862Z [err]  2025-12-20 14:36:33,074 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.076171913Z [err]  2025-12-20 14:36:33,075 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-20T14:36:33.077247207Z [err]  2025-12-20 14:36:33,076 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-20T14:36:33.082755310Z [err]  2025-12-20 14:36:33,080 - redis_service - INFO - üßπ Deleted call data from Redis: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.082761308Z [err]  2025-12-20 14:36:33,080 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.082766252Z [inf]  100.64.0.9:28548 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:33.082771163Z [err]  2025-12-20 14:36:33,080 - server - INFO - üîç Starting QC analysis for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.082775714Z [err]  2025-12-20 14:36:33,080 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-20T14:36:33.082780369Z [err]  2025-12-20 14:36:33,081 - server - INFO - üìá CRM update starting for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:33.082784310Z [err]  2025-12-20 14:36:33,081 - server - INFO - üìá Normalized phone: +17708336397
2025-12-20T14:36:33.169947859Z [err]  2025-12-20 14:36:33,168 - server - INFO - üìù Converted transcript from 3 messages to 133 characters
2025-12-20T14:36:33.309291100Z [err]  2025-12-20 14:36:33,270 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:33.309295041Z [err]  2025-12-20 14:36:33,298 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-20T14:36:33.309298927Z [err]  2025-12-20 14:36:33,299 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-20T14:36:33.382982574Z [err]  2025-12-20 14:36:33,357 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-20T14:36:33.448007916Z [err]  2025-12-20 14:36:33,444 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-20T14:36:33.448014661Z [err]  2025-12-20 14:36:33,444 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:33.448019355Z [err]  2025-12-20 14:36:33,444 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:33.486842523Z [err]  2025-12-20 14:36:33,477 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-20T14:36:33.486848692Z [err]  2025-12-20 14:36:33,477 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] Receiver got 0 chunks for sentence #2! interrupted=False
2025-12-20T14:36:33.644092617Z [err]  2025-12-20 14:36:33,638 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=3, logs_count=4, status=completed
2025-12-20T14:36:33.655617184Z [err]  2025-12-20 14:36:33,651 - server - INFO - üìá CRM: Total variables collected: []
2025-12-20T14:36:33.929268185Z [err]  2025-12-20 14:36:33,830 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-20T14:36:34.087151865Z [err]  2025-12-20 14:36:34,072 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-20T14:36:34.165423776Z [err]  2025-12-20 14:36:34,160 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-20T14:36:34.165429456Z [err]  2025-12-20 14:36:34,160 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-20T14:36:34.165434063Z [err]  2025-12-20 14:36:34,160 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-20T14:36:34.165438163Z [err]  2025-12-20 14:36:34,160 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-20T14:36:34.165442297Z [err]    File "/app/backend/server.py", line 9698, in trigger_campaign_qc_for_call
2025-12-20T14:36:34.165446819Z [err]      await run_full_qc_analysis(
2025-12-20T14:36:34.165450927Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-20T14:36:34.165454760Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-20T14:36:34.165459557Z [err]  
2025-12-20T14:36:34.552876719Z [err]  2025-12-20 14:36:34,550 - persistent_tts_service - INFO - üîá [Call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA] FLOOR RELEASED (is_holding_floor=False)
2025-12-20T14:36:36.292339022Z [err]  2025-12-20 14:36:36,278 - server - INFO - üì¨ Received Telnyx event: start
2025-12-20T14:36:36.292349326Z [err]  2025-12-20 14:36:36,278 - server - INFO - üé¨ Stream started for call: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.292355784Z [err]  2025-12-20 14:36:36,287 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:36.292365068Z [err]  2025-12-20 14:36:36,287 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': '20cc1f10-4e05-4311-be1d-d5cd137eeb83', 'occurred_at': '2025-12-20T14:36:36.123963Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-20T14:36:32.444127Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:36.292371544Z [err]  2025-12-20 14:36:36,287 - server - INFO - üéØ Event type: call.answered, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.292377637Z [err]  2025-12-20 14:36:36,287 - server - INFO - üì® ================================================
2025-12-20T14:36:36.292383651Z [err]  2025-12-20 14:36:36,287 - server - INFO - ‚úÖ Call answered: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.308664449Z [err]  2025-12-20 14:36:36,304 - redis_service - INFO - üì• Retrieved call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.308673210Z [err]  2025-12-20 14:36:36,305 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-20T14:36:36.308680477Z [err]  2025-12-20 14:36:36,306 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-20T14:36:36.320788643Z [err]  2025-12-20 14:36:36,315 - redis_service - INFO - üì• Retrieved call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.320796342Z [err]  2025-12-20 14:36:36,316 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-20T14:36:36.320801983Z [err]  2025-12-20 14:36:36,316 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-20T14:36:36.408533998Z [err]  2025-12-20 14:36:36,407 - server - INFO - ‚úÖ Call log updated
2025-12-20T14:36:36.408543087Z [err]  2025-12-20 14:36:36,407 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-20T14:36:36.408545935Z [err]  2025-12-20 14:36:36,407 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-20T14:36:36.408625429Z [err]  2025-12-20 14:36:36,407 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:36.513702530Z [err]  2025-12-20 14:36:36,495 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:36.587748983Z [err]  2025-12-20 14:36:36,569 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:36.587758306Z [err]  2025-12-20 14:36:36,569 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': '3936f983-384c-408a-b6c4-ec10610b3e37', 'occurred_at': '2025-12-20T14:36:36.423970Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '9938306c-b297-4665-9846-7731efea421c', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:36.587766186Z [err]  2025-12-20 14:36:36,569 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.587770859Z [err]  2025-12-20 14:36:36,569 - server - INFO - üì® ================================================
2025-12-20T14:36:36.587774847Z [inf]  100.64.0.5:36534 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:36.587804208Z [err]  2025-12-20 14:36:36,583 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:36.587809164Z [err]  2025-12-20 14:36:36,583 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-20T14:36:36.609492334Z [err]  2025-12-20 14:36:36,608 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-20T14:36:36.785853232Z [err]  2025-12-20 14:36:36,782 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-20T14:36:36.785864390Z [err]  2025-12-20 14:36:36,783 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-20T14:36:36.814558750Z [err]  2025-12-20 14:36:36,806 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-20T14:36:36.814566510Z [err]  2025-12-20 14:36:36,806 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-20T14:36:36.819577737Z [err]  2025-12-20 14:36:36,818 - redis_service - INFO - üì• Retrieved call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.820484439Z [err]  2025-12-20 14:36:36,819 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:36.820489482Z [err]  2025-12-20 14:36:36,820 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-20T14:36:36.953841229Z [err]  2025-12-20 14:36:36,908 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-20T14:36:36.953873485Z [err]  2025-12-20 14:36:36,880 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw/actions/playback_start "HTTP/1.1 200 OK"
2025-12-20T14:36:36.953877251Z [err]  2025-12-20 14:36:36,881 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: h-SMO6U9FA (loop=True, overlay=True)
2025-12-20T14:36:36.953882052Z [err]  2025-12-20 14:36:36,881 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw'
2025-12-20T14:36:36.953886352Z [err]  2025-12-20 14:36:36,881 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:36.953890886Z [err]  2025-12-20 14:36:36,907 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-20T14:36:36.953897111Z [err]  2025-12-20 14:36:36,907 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-20T14:36:36.953901028Z [err]  2025-12-20 14:36:36,908 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-20T14:36:36.953904745Z [err]  2025-12-20 14:36:36,908 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-20T14:36:37.009394090Z [err]  2025-12-20 14:36:36,995 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:37.009403138Z [err]  2025-12-20 14:36:37,003 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 95ms
2025-12-20T14:36:37.009409537Z [err]  2025-12-20 14:36:37,003 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-20T14:36:37.009417644Z [err]  2025-12-20 14:36:37,003 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-20T14:36:37.009424307Z [err]  2025-12-20 14:36:37,003 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-20T14:36:37.009431291Z [err]  2025-12-20 14:36:37,003 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-20T14:36:37.009438104Z [err]  2025-12-20 14:36:37,003 - server - INFO - ‚úÖ Initialized call_states for v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw with session reference
2025-12-20T14:36:37.009445014Z [err]  2025-12-20 14:36:37,003 - server - INFO - ‚úÖ Stored Telnyx WebSocket in call_data for audio streaming
2025-12-20T14:36:37.009451239Z [err]  2025-12-20 14:36:37,003 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found to update for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:37.009455391Z [err]  2025-12-20 14:36:37,004 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-20T14:36:37.117377032Z [err]  2025-12-20 14:36:37,091 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-20T14:36:37.192414663Z [err]  2025-12-20 14:36:37,159 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw/actions/record_start "HTTP/1.1 200 OK"
2025-12-20T14:36:37.192420974Z [err]  2025-12-20 14:36:37,160 - server - INFO - üéôÔ∏è Call recording started for v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:37.192425499Z [err]  2025-12-20 14:36:37,161 - server - INFO - üîß Creating call session for v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw...
2025-12-20T14:36:37.192429453Z [err]  2025-12-20 14:36:37,161 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:37.192433511Z [err]  2025-12-20 14:36:37,161 - server - INFO - üîß Calling create_call_session() - START
2025-12-20T14:36:37.192438035Z [err]  2025-12-20 14:36:37,161 - calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-20T14:36:37.243329246Z [inf]  100.64.0.6:61772 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2025-12-20T14:36:37.253687908Z [err]  2025-12-20 14:36:37,249 - calling_service - INFO - üîç KB count query completed: 4 items
2025-12-20T14:36:37.253692915Z [err]  2025-12-20 14:36:37,249 - calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-20T14:36:37.265554335Z [err]  2025-12-20 14:36:37,262 - calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-20T14:36:37.265564127Z [err]  2025-12-20 14:36:37,262 - calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-20T14:36:37.265570228Z [err]  2025-12-20 14:36:37,263 - calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-20T14:36:37.355274063Z [err]  2025-12-20 14:36:37,351 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:37.359512758Z [err]  2025-12-20 14:36:37,358 - calling_service - INFO - ‚úÖ LLM client pre-warmed in 94ms
2025-12-20T14:36:37.359520231Z [err]  2025-12-20 14:36:37,358 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-20T14:36:37.359526844Z [err]  2025-12-20 14:36:37,358 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-20T14:36:37.400188179Z [err]  2025-12-20 14:36:37,386 - redis_service - INFO - üì¶ Stored call data in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (TTL: 3600s)
2025-12-20T14:36:37.400194676Z [err]  2025-12-20 14:36:37,386 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-20T14:36:37.400201082Z [err]  2025-12-20 14:36:37,386 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-20T14:36:37.400207315Z [err]  2025-12-20 14:36:37,392 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:37.400214114Z [err]  2025-12-20 14:36:37,392 - server - INFO - ü§ñ AI session created for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:37.400220339Z [err]  2025-12-20 14:36:37,392 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-20T14:36:37.400224793Z [err]  2025-12-20 14:36:37,392 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-20T14:36:37.400230257Z [err]  2025-12-20 14:36:37,392 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-20T14:36:37.400238687Z [err]  2025-12-20 14:36:37,392 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-20T14:36:37.400242683Z [err]  2025-12-20 14:36:37,392 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-20T14:36:37.400246469Z [err]  2025-12-20 14:36:37,392 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-20T14:36:37.400250259Z [err]  2025-12-20 14:36:37,392 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-20T14:36:37.400857220Z [err]  2025-12-20 14:36:37,392 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-20T14:36:37.400866555Z [err]  2025-12-20 14:36:37,392 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-20T14:36:37.400873204Z [inf]  100.64.0.9:28548 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:37.595343090Z [err]  2025-12-20 14:36:37,588 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-20T14:36:37.595350676Z [err]  2025-12-20 14:36:37,588 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-20T14:36:37.595355424Z [err]  2025-12-20 14:36:37,588 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-20T14:36:37.595360011Z [err]  2025-12-20 14:36:37,589 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:37.595365527Z [err]  2025-12-20 14:36:37,594 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:37.596143354Z [err]  2025-12-20 14:36:37,594 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-20T14:36:38.130574313Z [err]  2025-12-20 14:36:38,099 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:38.142030005Z [err]  2025-12-20 14:36:38,139 - calling_service - INFO - ‚è∞ Check-in triggered after 7.3s silence (threshold: 7s)
2025-12-20T14:36:38.147058087Z [err]  2025-12-20 14:36:38,145 - calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-20T14:36:38.147067121Z [err]  2025-12-20 14:36:38,145 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.3s silence: Are you still there?
2025-12-20T14:36:38.147074936Z [err]  2025-12-20 14:36:38,145 - calling_service - INFO - ü§ñ Agent started speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:38.147081981Z [err]  2025-12-20 14:36:38,145 - telnyx_service - INFO - üîä Speaking text on call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA: Are you still there?...
2025-12-20T14:36:38.147089129Z [err]  2025-12-20 14:36:38,145 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-20T14:36:38.147096521Z [err]  2025-12-20 14:36:38,145 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-20T14:36:38.147103491Z [err]  2025-12-20 14:36:38,145 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-20T14:36:38.147109915Z [err]  2025-12-20 14:36:38,145 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-20T14:36:38.147117030Z [err]  2025-12-20 14:36:38,145 - server - INFO - ‚è±Ô∏è [14:36:38.145] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-20T14:36:38.147121857Z [err]  2025-12-20 14:36:38,145 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-20T14:36:38.147125862Z [err]  2025-12-20 14:36:38,145 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-20T14:36:38.242193176Z [err]  2025-12-20 14:36:38,233 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-20T14:36:38.242193179Z [err]  2025-12-20 14:36:38,233 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:38.242203519Z [err]  2025-12-20 14:36:38,233 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-20T14:36:38.242203939Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Timeout: 10.0s
2025-12-20T14:36:38.242211847Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Text length: 20 chars
2025-12-20T14:36:38.242214737Z [err]  2025-12-20 14:36:38,240 - server - INFO -    ‚úì HTTP client created (0.007s)
2025-12-20T14:36:38.242219996Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Text content: 'Are you still there?'
2025-12-20T14:36:38.242222029Z [err]  2025-12-20 14:36:38,240 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-20T14:36:38.242233512Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-20T14:36:38.242240586Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-20T14:36:38.242249393Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-20T14:36:38.242256134Z [err]  2025-12-20 14:36:38,233 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-20T14:36:38.242264012Z [err]  2025-12-20 14:36:38,233 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-20T14:36:38.601386110Z [err]  2025-12-20 14:36:38,593 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-20T14:36:38.601392638Z [err]  2025-12-20 14:36:38,593 - server - INFO -    ‚úì Connection established (0.360s) [TARGET: <200ms]
2025-12-20T14:36:38.601397237Z [err]  2025-12-20 14:36:38,593 - server - INFO -    ‚úì Response status: 200
2025-12-20T14:36:38.601401803Z [err]  2025-12-20 14:36:38,593 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-20T14:36:38.612782887Z [err]  2025-12-20 14:36:38,606 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:38.612788790Z [err]  2025-12-20 14:36:38,608 - server - INFO -    ‚úì FIRST CHUNK received (0.375s, 1100 bytes) [TARGET: <300ms]
2025-12-20T14:36:38.614035973Z [err]  2025-12-20 14:36:38,612 - server - INFO -    ‚úì ALL CHUNKS received: 69 chunks (0.379s)
2025-12-20T14:36:38.614043538Z [err]  2025-12-20 14:36:38,613 - server - INFO -    ‚úì Total audio size: 18435 bytes
2025-12-20T14:36:38.614050247Z [err]  2025-12-20 14:36:38,613 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-20T14:36:38.614057067Z [err]  2025-12-20 14:36:38,613 - server - INFO -       - Connection: 360ms
2025-12-20T14:36:38.614064140Z [err]  2025-12-20 14:36:38,613 - server - INFO -       - First chunk: 375ms
2025-12-20T14:36:38.614071116Z [err]  2025-12-20 14:36:38,613 - server - INFO -       - All chunks: 379ms
2025-12-20T14:36:38.614078478Z [err]  2025-12-20 14:36:38,613 - server - INFO -       - Audio generation only: 15ms
2025-12-20T14:36:38.614903920Z [err]  2025-12-20 14:36:38,613 - server - INFO - ‚è±Ô∏è [14:36:38.613] üîä TTS COMPLETE: 467ms, audio_size=18435 bytes
2025-12-20T14:36:38.614909200Z [err]  2025-12-20 14:36:38,613 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (18435 bytes)
2025-12-20T14:36:38.614913167Z [err]  2025-12-20 14:36:38,613 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.47s
2025-12-20T14:36:38.614917401Z [err]  2025-12-20 14:36:38,613 - telnyx_service - INFO - ‚úÖ Generated 18435 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-20T14:36:38.614921064Z [err]  2025-12-20 14:36:38,613 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-20T14:36:38.767533678Z [err]  2025-12-20 14:36:38,767 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20T14:36:38.772960295Z [err]  2025-12-20 14:36:38,769 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-20T14:36:38.772968075Z [err]  2025-12-20 14:36:38,771 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:38.846733082Z [err]  2025-12-20 14:36:38,820 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:38.846739827Z [err]  2025-12-20 14:36:38,820 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'c340fcbe-4e98-40be-b22b-ba82a8637f8d', 'occurred_at': '2025-12-20T14:36:38.283961Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'h-SMO6U9FA', 'start_time': '2025-12-20T14:36:38.283961Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:38.846748813Z [err]  2025-12-20 14:36:38,820 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:38.846755655Z [err]  2025-12-20 14:36:38,820 - server - INFO - üì® ================================================
2025-12-20T14:36:38.846762064Z [inf]  100.64.0.12:48308 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:38.846769122Z [err]  2025-12-20 14:36:38,836 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-20T14:36:38.846776408Z [err]  2025-12-20 14:36:38,837 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2025-12-20T14:36:38.846781187Z [err]  2025-12-20 14:36:38,837 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-20T14:36:38.846785758Z [err]    "errors": [
2025-12-20T14:36:38.846790761Z [err]      {
2025-12-20T14:36:38.846794318Z [err]        "code": "90018",
2025-12-20T14:36:38.850747139Z [err]        "title": "Call has already ended",
2025-12-20T14:36:38.850762670Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-20T14:36:38.850770754Z [err]      }
2025-12-20T14:36:38.850775425Z [err]    ]
2025-12-20T14:36:38.850780377Z [err]  }
2025-12-20T14:36:38.850786143Z [err]  2025-12-20 14:36:38,837 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-20T14:36:39.139812183Z [err]  2025-12-20 14:36:39,100 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-20T14:36:39.139821224Z [err]  2025-12-20 14:36:39,101 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-20T14:36:39.139828883Z [err]  2025-12-20 14:36:39,101 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-20T14:36:39.139838484Z [err]  2025-12-20 14:36:39,128 - redis_service - INFO - üì• Retrieved call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:39.139845564Z [err]  2025-12-20 14:36:39,134 - redis_service - INFO - üì¶ Stored call data in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (TTL: 3600s)
2025-12-20T14:36:39.139852767Z [err]  2025-12-20 14:36:39,134 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-20T14:36:39.139859391Z [err]  2025-12-20 14:36:39,134 - calling_service - INFO - ‚è±Ô∏è [14:36:39.134] üì• process_user_input() ENTRY - text: '...'
2025-12-20T14:36:39.139865659Z [err]  2025-12-20 14:36:39,134 - calling_service - INFO - ‚è±Ô∏è [14:36:39.134] ‚è© About to call _process_call_flow_streaming()
2025-12-20T14:36:39.139872848Z [err]  2025-12-20 14:36:39,134 - calling_service - INFO - ‚è±Ô∏è [14:36:39.134] üîÄ Agent type: call_flow, calling flow processor...
2025-12-20T14:36:39.139880354Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - ‚è±Ô∏è [14:36:39.135] üîÄ _process_call_flow_streaming() ENTRY
2025-12-20T14:36:39.139887252Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-20T14:36:39.139893714Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - ‚è±Ô∏è [14:36:39.135] ‚úÖ Node selected, about to process content...
2025-12-20T14:36:39.140414378Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 20, 2025 at 9:36 AM EST in content
2025-12-20T14:36:39.140421909Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-20T14:36:39.140427480Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-20T14:36:39.140433914Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-20T14:36:39.140439619Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-20T14:36:39.140445708Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-20T14:36:39.140450091Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-20T14:36:39.140454107Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-20T14:36:39.140458206Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-20T14:36:39.140462018Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-20T14:36:39.140466662Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-20T14:36:39.140470623Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-20T14:36:39.140474595Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-20T14:36:39.140479637Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - ‚è±Ô∏è [14:36:39.135] üìÑ About to process content (mode=script, length=9)
2025-12-20T14:36:39.141209847Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üîä Silence tracking reset for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (user responded)
2025-12-20T14:36:39.141218833Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-20T14:36:39.141226406Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-20T14:36:39.141233710Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - LLM response (0.00s): Kendrick?
2025-12-20T14:36:39.141240705Z [err]  2025-12-20 14:36:39,135 - calling_service - INFO - Total latency: 0.00s
2025-12-20T14:36:39.141249068Z [err]  2025-12-20 14:36:39,135 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-20T14:36:39.146220086Z [err]  2025-12-20 14:36:39,141 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:39.286704537Z [err]  2025-12-20 14:36:39,239 - redis_service - INFO - üì• Retrieved call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:39.286710486Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - üîä Speaking text on call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw: Kendrick?...
2025-12-20T14:36:39.286715829Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-20T14:36:39.286722239Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-20T14:36:39.286728408Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-20T14:36:39.286734236Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-20T14:36:39.286740590Z [err]  2025-12-20 14:36:39,239 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (13419 bytes)
2025-12-20T14:36:39.286747127Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-20T14:36:39.286752814Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - ‚úÖ Generated 13419 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-20T14:36:39.286756566Z [err]  2025-12-20 14:36:39,239 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-20T14:36:39.518794594Z [err]  2025-12-20 14:36:39,517 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw/actions/playback_start "HTTP/1.1 200 OK"
2025-12-20T14:36:39.518799788Z [err]  2025-12-20 14:36:39,518 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.28s
2025-12-20T14:36:39.518803705Z [err]  2025-12-20 14:36:39,518 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.28s
2025-12-20T14:36:39.518807426Z [err]  2025-12-20 14:36:39,518 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-20T14:36:39.518811692Z [err]  2025-12-20 14:36:39,518 - telnyx_service - INFO - üé¨ Playback ID: bKbDqX3Wnw
2025-12-20T14:36:39.519622684Z [err]  2025-12-20 14:36:39,518 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-20T14:36:39.519628497Z [err]  2025-12-20 14:36:39,518 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241399.518502 for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:39.519632893Z [err]  2025-12-20 14:36:39,518 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-20T14:36:39.615822091Z [err]  2025-12-20 14:36:39,612 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (5.4s ago), marking agent as done speaking
2025-12-20T14:36:39.615827201Z [err]  2025-12-20 14:36:39,613 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241399.6131108 for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:39.615831134Z [err]  2025-12-20 14:36:39,613 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:39.653657134Z [err]  2025-12-20 14:36:39,649 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:39.761597134Z [inf]  100.64.0.8:57196 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-20T14:36:40.125857498Z [err]  2025-12-20 14:36:40,118 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=1/2
2025-12-20T14:36:40.170240311Z [err]  2025-12-20 14:36:40,156 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:40.170245774Z [err]  2025-12-20 14:36:40,156 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.6s, checkin_count=0/2
2025-12-20T14:36:40.255618902Z [err]  2025-12-20 14:36:40,254 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:40.255623622Z [err]  2025-12-20 14:36:40,254 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'b2686d01-9216-49ee-a0a5-a0c76d2c8e50', 'occurred_at': '2025-12-20T14:36:40.143986Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'bKbDqX3Wnw'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:40.255627708Z [err]  2025-12-20 14:36:40,254 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:40.255632085Z [err]  2025-12-20 14:36:40,254 - server - INFO - üì® ================================================
2025-12-20T14:36:40.255636695Z [inf]  100.64.0.8:57196 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:40.363554037Z [err]  2025-12-20 14:36:40,361 - server - INFO - üî§ RAW TOKENS: ["H"?]
2025-12-20T14:36:40.363560378Z [err]  2025-12-20 14:36:40,361 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:40.363565092Z [err]  2025-12-20 14:36:40,361 - calling_service - INFO - üîä Silence timer reset for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (user started speaking)
2025-12-20T14:36:40.363570093Z [err]  2025-12-20 14:36:40,361 - calling_service - INFO - üë§ User started speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:40.363573978Z [err]  2025-12-20 14:36:40,361 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2025-12-20T14:36:40.535411080Z [err]  2025-12-20 14:36:40,530 - server - INFO - üî§ RAW TOKENS: ["H"?, "ello"?]
2025-12-20T14:36:40.535421904Z [err]  2025-12-20 14:36:40,530 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hello' | Generating: False
2025-12-20T14:36:40.629973118Z [err]  2025-12-20 14:36:40,625 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=1/2
2025-12-20T14:36:40.670575891Z [err]  2025-12-20 14:36:40,662 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:40.670587194Z [err]  2025-12-20 14:36:40,662 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=0/2
2025-12-20T14:36:40.671753244Z [err]  2025-12-20 14:36:40,670 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2025-12-20T14:36:40.671759217Z [err]  2025-12-20 14:36:40,670 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-20T14:36:40.671763885Z [err]  2025-12-20 14:36:40,670 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2025-12-20T14:36:40.671768055Z [err]  2025-12-20 14:36:40,670 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2025-12-20T14:36:40.671772195Z [err]  2025-12-20 14:36:40,670 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2025-12-20T14:36:40.671776118Z [err]  2025-12-20 14:36:40,670 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:40.671780450Z [err]  2025-12-20 14:36:40,671 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-20T14:36:40.671784319Z [err]  2025-12-20 14:36:40,671 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:40.671788595Z [err]  2025-12-20 14:36:40,671 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-20T14:36:40.672743525Z [err]  2025-12-20 14:36:40,671 - server - INFO - ‚è±Ô∏è [14:36:40.671] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2025-12-20T14:36:40.672749549Z [err]  2025-12-20 14:36:40,671 - server - INFO - ‚è±Ô∏è [14:36:40.671] STT endpoint detection latency: 8ms
2025-12-20T14:36:40.672755039Z [err]  2025-12-20 14:36:40,671 - server - INFO - ‚è±Ô∏è [14:36:40.671] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-20T14:36:40.678104438Z [err]  2025-12-20 14:36:40,676 - redis_service - INFO - üì¶ Stored call data in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (TTL: 3600s)
2025-12-20T14:36:40.678110235Z [err]  2025-12-20 14:36:40,676 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-20T14:36:40.678114524Z [err]  2025-12-20 14:36:40,676 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:40.678118467Z [err]  2025-12-20 14:36:40,676 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2025-12-20T14:36:40.689631004Z [err]  2025-12-20 14:36:40,687 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2025-12-20T14:36:40.689646952Z [err]  2025-12-20 14:36:40,687 - calling_service - INFO - üë§ User stopped speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:40.689655558Z [err]  2025-12-20 14:36:40,687 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-20T14:36:40.689660659Z [err]  2025-12-20 14:36:40,687 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+7ms
2025-12-20T14:36:40.689665878Z [err]  2025-12-20 14:36:40,687 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 7ms (Soniox model: stt-rt-v3)
2025-12-20T14:36:40.689670988Z [err]  2025-12-20 14:36:40,687 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-20T14:36:40.689675714Z [err]  2025-12-20 14:36:40,687 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-20T14:36:40.689679978Z [err]  2025-12-20 14:36:40,687 - calling_service - INFO - ü§ñ Agent started speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:40.791046315Z [err]  2025-12-20 14:36:40,778 - server - INFO - üìù Saved user transcript to database
2025-12-20T14:36:40.791053412Z [err]  2025-12-20 14:36:40,778 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:40.791060367Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - ‚è±Ô∏è [14:36:40.778] üì• process_user_input() ENTRY - text: 'Hello?...'
2025-12-20T14:36:40.791069177Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - ‚è±Ô∏è [14:36:40.778] ‚è© About to call _process_call_flow_streaming()
2025-12-20T14:36:40.791076067Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - ‚è±Ô∏è [14:36:40.778] üîÄ Agent type: call_flow, calling flow processor...
2025-12-20T14:36:40.791082422Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - ‚è±Ô∏è [14:36:40.778] üîÄ _process_call_flow_streaming() ENTRY
2025-12-20T14:36:40.791088372Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-20T14:36:40.791092348Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-20T14:36:40.791096399Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - ‚è±Ô∏è [14:36:40.778] üîÄ About to call _follow_transition() for: Hello?...
2025-12-20T14:36:40.791100683Z [err]  2025-12-20 14:36:40,778 - calling_service - INFO - Evaluating transitions from Greeting for message: Hello?
2025-12-20T14:36:40.791110936Z [err]  2025-12-20 14:36:40,787 - calling_service - INFO - ‚è±Ô∏è [14:36:40.787] üîÄ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-20T14:36:41.190584963Z [err]  2025-12-20 14:36:41,172 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:41.190596461Z [err]  2025-12-20 14:36:41,172 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:41.224243265Z [err]  2025-12-20 14:36:41,222 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20T14:36:41.225273740Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚è±Ô∏è [14:36:41.224] üîÄ TRANSITION EVALUATION COMPLETE - took 436ms
2025-12-20T14:36:41.225279960Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ü§ñ AI transition decision: '-1'
2025-12-20T14:36:41.225286158Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc) - don...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-20T14:36:41.225292515Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - Selected transition index: -1
2025-12-20T14:36:41.225298397Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-20T14:36:41.225303113Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚ö†Ô∏è No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-20T14:36:41.225307401Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üéØ Goal: Say the customer's name...
2025-12-20T14:36:41.225311118Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 445ms
2025-12-20T14:36:41.225314818Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚è±Ô∏è [14:36:41.224] ‚úÖ Node selected, about to process content...
2025-12-20T14:36:41.225318560Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 20, 2025 at 9:36 AM EST in content
2025-12-20T14:36:41.225322687Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-20T14:36:41.225326548Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-20T14:36:41.225330216Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-20T14:36:41.226298056Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-20T14:36:41.226306574Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-20T14:36:41.226312913Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-20T14:36:41.226320114Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-20T14:36:41.226325763Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-20T14:36:41.226331602Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-20T14:36:41.226336661Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-20T14:36:41.226342016Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-20T14:36:41.226347887Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚è±Ô∏è [14:36:41.224] üìÑ About to process content (mode=script, length=9)
2025-12-20T14:36:41.226355166Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚è≠Ô∏è Staying on same script node without dynamic_rephrase - NOT re-speaking content
2025-12-20T14:36:41.226361790Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîä Silence tracking reset for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (user responded)
2025-12-20T14:36:41.226369611Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-20T14:36:41.226382133Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-20T14:36:41.227132138Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-20T14:36:41.227135796Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - LLM response (0.45s): 
2025-12-20T14:36:41.227139391Z [err]  2025-12-20 14:36:41,224 - calling_service - INFO - Total latency: 0.45s
2025-12-20T14:36:41.227143415Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚úÖ LLM finished in 536ms, TTS tasks already running in background
2025-12-20T14:36:41.227146993Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-20T14:36:41.227151066Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-20T14:36:41.227154718Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-20T14:36:41.227158130Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 7ms (provider: soniox, model: stt-rt-v3)
2025-12-20T14:36:41.227163602Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 536ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-20T14:36:41.227167275Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 0ms (provider: elevenlabs, websocket: False)
2025-12-20T14:36:41.227170777Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 537ms (user stopped ‚Üí play_audio_url called)
2025-12-20T14:36:41.227174353Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-20T14:36:41.227179013Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-20T14:36:41.227183394Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-20T14:36:41.227845873Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-20T14:36:41.227856783Z [err]  2025-12-20 14:36:41,225 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 837ms estimated
2025-12-20T14:36:41.227865900Z [err]  2025-12-20 14:36:41,225 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 0 chars, 0 sentences
2025-12-20T14:36:41.227873525Z [err]  2025-12-20 14:36:41,225 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2025-12-20T14:36:41.227880601Z [err]  2025-12-20 14:36:41,225 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '...'
2025-12-20T14:36:41.227887463Z [err]  2025-12-20 14:36:41,225 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-20T14:36:41.227895391Z [err]  2025-12-20 14:36:41,225 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-20T14:36:41.227916879Z [err]  2025-12-20 14:36:41,224 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-20T14:36:41.267814338Z [err]  2025-12-20 14:36:41,267 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:41.267821807Z [err]  2025-12-20 14:36:41,267 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'd02e011a-2944-41df-9d9a-063627aceb10', 'occurred_at': '2025-12-20T14:36:40.983962Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'bKbDqX3Wnw', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:41.267826707Z [err]  2025-12-20 14:36:41,267 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:41.267831015Z [err]  2025-12-20 14:36:41,267 - server - INFO - üì® ================================================
2025-12-20T14:36:41.285045314Z [err]  2025-12-20 14:36:41,283 - redis_service - INFO - ‚ûñ Removed playback bKbDqX3Wnw, 0 remaining for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:41.285051650Z [err]  2025-12-20 14:36:41,283 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-20T14:36:41.285062048Z [err]  2025-12-20 14:36:41,283 - server - INFO - üîä Redis: Removed playback bKbDqX3Wnw, 0 remaining
2025-12-20T14:36:41.290102963Z [err]  2025-12-20 14:36:41,288 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-20T14:36:41.290109379Z [err]  2025-12-20 14:36:41,289 - server - INFO - üí° Session not on this worker - Redis flag set for WebSocket worker to handle
2025-12-20T14:36:41.290116790Z [inf]  100.64.0.4:47032 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:41.408596121Z [err]  2025-12-20 14:36:41,404 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 543ms)
2025-12-20T14:36:41.408604874Z [err]  2025-12-20 14:36:41,404 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-20T14:36:41.408611382Z [err]  2025-12-20 14:36:41,405 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-20T14:36:41.489132513Z [err]  2025-12-20 14:36:41,487 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:41.489139602Z [err]  2025-12-20 14:36:41,487 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '60bc5ed7-df5c-4c11-aa85-dd915287f913', 'occurred_at': '2025-12-20T14:36:41.203965Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:41.489144344Z [err]  2025-12-20 14:36:41,487 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:41.489148926Z [err]  2025-12-20 14:36:41,487 - server - INFO - üì® ================================================
2025-12-20T14:36:41.489154359Z [inf]  100.64.0.5:47726 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:41.682400264Z [err]  2025-12-20 14:36:41,679 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-20T14:36:41.682410325Z [err]  2025-12-20 14:36:41,679 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241401.6793587 for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:41.682417515Z [err]  2025-12-20 14:36:41,679 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:41.687304351Z [err]  2025-12-20 14:36:41,685 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:42.091448754Z [err]  2025-12-20 14:36:42,083 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20T14:36:42.091456294Z [err]  2025-12-20 14:36:42,088 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-20T14:36:42.091461413Z [err]  2025-12-20 14:36:42,088 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:42.205791353Z [err]  2025-12-20 14:36:42,191 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:42.649571981Z [err]  2025-12-20 14:36:42,608 - server - INFO - üì§ Audio flowing: 295 packets sent to Soniox (5s update)
2025-12-20T14:36:42.698607552Z [err]  2025-12-20 14:36:42,697 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:43.204787320Z [err]  2025-12-20 14:36:43,203 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:43.757199936Z [err]  2025-12-20 14:36:43,709 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.227703702Z [err]  2025-12-20 14:36:44,215 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.357777211Z [err]  2025-12-20 14:36:44,352 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2025-12-20T14:36:44.357785827Z [err]  2025-12-20 14:36:44,353 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:44.357827693Z [err]  2025-12-20 14:36:44,353 - calling_service - INFO - üîä Silence timer reset for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (user started speaking)
2025-12-20T14:36:44.357835510Z [err]  2025-12-20 14:36:44,353 - calling_service - INFO - üë§ User started speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:44.357843104Z [err]  2025-12-20 14:36:44,353 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2025-12-20T14:36:44.505733697Z [err]  2025-12-20 14:36:44,496 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2025-12-20T14:36:44.505737316Z [err]  2025-12-20 14:36:44,504 - redis_service - INFO - üì¶ Stored call data in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (TTL: 3600s)
2025-12-20T14:36:44.505742160Z [err]  2025-12-20 14:36:44,496 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-20T14:36:44.505748876Z [err]  2025-12-20 14:36:44,497 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2025-12-20T14:36:44.505757177Z [err]  2025-12-20 14:36:44,497 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-20T14:36:44.505763215Z [err]  2025-12-20 14:36:44,497 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2025-12-20T14:36:44.505769423Z [err]  2025-12-20 14:36:44,497 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.505776046Z [err]  2025-12-20 14:36:44,497 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-20T14:36:44.505782035Z [err]  2025-12-20 14:36:44,497 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.505787882Z [err]  2025-12-20 14:36:44,497 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-20T14:36:44.505818560Z [err]  2025-12-20 14:36:44,497 - server - INFO - ‚è±Ô∏è [14:36:44.497] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-20T14:36:44.505826915Z [err]  2025-12-20 14:36:44,497 - server - INFO - ‚è±Ô∏è [14:36:44.497] STT endpoint detection latency: 17ms
2025-12-20T14:36:44.505833844Z [err]  2025-12-20 14:36:44,497 - server - INFO - ‚è±Ô∏è [14:36:44.497] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-20T14:36:44.506229153Z [err]  2025-12-20 14:36:44,504 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-20T14:36:44.506234666Z [err]  2025-12-20 14:36:44,504 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.506239163Z [err]  2025-12-20 14:36:44,504 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-20T14:36:44.518050312Z [err]  2025-12-20 14:36:44,514 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-20T14:36:44.518054853Z [err]  2025-12-20 14:36:44,514 - calling_service - INFO - üë§ User stopped speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:44.518936920Z [err]  2025-12-20 14:36:44,517 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2025-12-20T14:36:44.518942524Z [err]  2025-12-20 14:36:44,517 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-20T14:36:44.518948470Z [err]  2025-12-20 14:36:44,517 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+13ms
2025-12-20T14:36:44.518952561Z [err]  2025-12-20 14:36:44,517 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 13ms (Soniox model: stt-rt-v3)
2025-12-20T14:36:44.518956357Z [err]  2025-12-20 14:36:44,517 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-20T14:36:44.518960539Z [err]  2025-12-20 14:36:44,517 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-20T14:36:44.518964660Z [err]  2025-12-20 14:36:44,517 - calling_service - INFO - ü§ñ Agent started speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:44.618335869Z [err]  2025-12-20 14:36:44,608 - server - INFO - üìù Saved user transcript to database
2025-12-20T14:36:44.618347475Z [err]  2025-12-20 14:36:44,608 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.618356336Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - ‚è±Ô∏è [14:36:44.608] üì• process_user_input() ENTRY - text: 'Yeah....'
2025-12-20T14:36:44.618364913Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - ‚è±Ô∏è [14:36:44.608] ‚è© About to call _process_call_flow_streaming()
2025-12-20T14:36:44.618372581Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - ‚è±Ô∏è [14:36:44.608] üîÄ Agent type: call_flow, calling flow processor...
2025-12-20T14:36:44.618382279Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - ‚è±Ô∏è [14:36:44.608] üîÄ _process_call_flow_streaming() ENTRY
2025-12-20T14:36:44.618390967Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - Flow processing - History length: 5, Is first: False
2025-12-20T14:36:44.618398192Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-20T14:36:44.618404705Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - ‚è±Ô∏è [14:36:44.608] üîÄ About to call _follow_transition() for: Yeah....
2025-12-20T14:36:44.618411715Z [err]  2025-12-20 14:36:44,608 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-20T14:36:44.618415700Z [err]  2025-12-20 14:36:44,617 - calling_service - INFO - ‚è±Ô∏è [14:36:44.617] üîÄ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-20T14:36:44.731859520Z [err]  2025-12-20 14:36:44,728 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:44.731863139Z [err]  2025-12-20 14:36:44,728 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:45.245539611Z [err]  2025-12-20 14:36:45,239 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:45.245547462Z [err]  2025-12-20 14:36:45,239 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:45.487864190Z [err]  2025-12-20 14:36:45,486 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20T14:36:45.492585973Z [err]  2025-12-20 14:36:45,490 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-20T14:36:45.631691828Z [err]  2025-12-20 14:36:45,581 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:45.631698007Z [err]  2025-12-20 14:36:45,582 - server - INFO - ‚úÖ QC analysis completed for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:45.631703670Z [err]  2025-12-20 14:36:45,582 - server - INFO - üìä Scores: Commitment=50, Conversion=20, Excellence=50
2025-12-20T14:36:45.753116741Z [err]  2025-12-20 14:36:45,749 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:45.753123634Z [err]  2025-12-20 14:36:45,750 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:45.764162033Z [err]  2025-12-20 14:36:45,759 - server - INFO - üìä Updated campaign_calls with QC scores for v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:45.942964941Z [err]  2025-12-20 14:36:45,936 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-20T14:36:46.025028264Z [err]  2025-12-20 14:36:46,024 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-20T14:36:46.025033297Z [err]  2025-12-20 14:36:46,024 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA: 'str' object has no attribute 'get'
2025-12-20T14:36:46.176924162Z [err]  2025-12-20 14:36:46,118 - calling_service - WARNING - ‚ö†Ô∏è This prevents 13-second freezes. User should re-respond to trigger evaluation.
2025-12-20T14:36:46.176935028Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 1509ms
2025-12-20T14:36:46.176942781Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - ‚è±Ô∏è [14:36:46.118] ‚úÖ Node selected, about to process content...
2025-12-20T14:36:46.176949232Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{now}} with Saturday, December 20, 2025 at 9:36 AM EST in content
2025-12-20T14:36:46.176956108Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-20T14:36:46.176963758Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-20T14:36:46.176970738Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-20T14:36:46.176977734Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-20T14:36:46.176983967Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-20T14:36:46.176990796Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-20T14:36:46.176998099Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-20T14:36:46.177004908Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-20T14:36:46.177011731Z [err]  2025-12-20 14:36:46,118 - calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-20T14:36:46.177077209Z [err]  2025-12-20 14:36:46,118 - calling_service - WARNING - ‚ö†Ô∏è TRANSITION EVALUATION TIMEOUT (>1.5s) - staying on current node
2025-12-20T14:36:46.177486377Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-20T14:36:46.177493162Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-20T14:36:46.177499738Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-20T14:36:46.177506416Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - ‚è±Ô∏è [14:36:46.119] üìÑ About to process content (mode=script, length=9)
2025-12-20T14:36:46.177512933Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - ‚è≠Ô∏è Staying on same script node without dynamic_rephrase - NOT re-speaking content
2025-12-20T14:36:46.177518501Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - üîä Silence tracking reset for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (user responded)
2025-12-20T14:36:46.177524223Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-20T14:36:46.177530844Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-20T14:36:46.177591052Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - LLM response (1.51s): 
2025-12-20T14:36:46.177598304Z [err]  2025-12-20 14:36:46,119 - calling_service - INFO - Total latency: 1.51s
2025-12-20T14:36:46.177605591Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚úÖ LLM finished in 1601ms, TTS tasks already running in background
2025-12-20T14:36:46.177612506Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-20T14:36:46.177619996Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-20T14:36:46.178464026Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-20T14:36:46.178470209Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 13ms (provider: soniox, model: stt-rt-v3)
2025-12-20T14:36:46.178476721Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1601ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-20T14:36:46.178483446Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 0ms (provider: elevenlabs, websocket: False)
2025-12-20T14:36:46.178489836Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1601ms (user stopped ‚Üí play_audio_url called)
2025-12-20T14:36:46.178495886Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-20T14:36:46.178502508Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-20T14:36:46.178508813Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-20T14:36:46.178514536Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-20T14:36:46.178520187Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-20T14:36:46.178526801Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1901ms estimated
2025-12-20T14:36:46.178533575Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 0 chars, 0 sentences
2025-12-20T14:36:46.178539519Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2025-12-20T14:36:46.178546120Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '...'
2025-12-20T14:36:46.178552371Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-20T14:36:46.178889089Z [err]  2025-12-20 14:36:46,119 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-20T14:36:46.330236442Z [err]  2025-12-20 14:36:46,263 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:46.330242449Z [err]  2025-12-20 14:36:46,263 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:46.330246939Z [err]  2025-12-20 14:36:46,300 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1614ms)
2025-12-20T14:36:46.330252915Z [err]  2025-12-20 14:36:46,300 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-20T14:36:46.330257192Z [err]  2025-12-20 14:36:46,300 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-20T14:36:46.700450219Z [err]  2025-12-20 14:36:46,699 - calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-20T14:36:46.711736424Z [err]  2025-12-20 14:36:46,705 - calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2025-12-20T14:36:46.711745497Z [err]  2025-12-20 14:36:46,705 - calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2025-12-20T14:36:46.711752597Z [err]  2025-12-20 14:36:46,705 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2025-12-20T14:36:46.711759246Z [err]  2025-12-20 14:36:46,705 - calling_service - INFO - ü§ñ Agent started speaking for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:46.711764811Z [err]  2025-12-20 14:36:46,705 - telnyx_service - INFO - üîä Speaking text on call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA: Are you still there?...
2025-12-20T14:36:46.711769215Z [err]  2025-12-20 14:36:46,705 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-20T14:36:46.711772847Z [err]  2025-12-20 14:36:46,705 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-20T14:36:46.711776761Z [err]  2025-12-20 14:36:46,705 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-20T14:36:46.711787205Z [err]  2025-12-20 14:36:46,705 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-20T14:36:46.711791158Z [err]  2025-12-20 14:36:46,705 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (18435 bytes)
2025-12-20T14:36:46.711794759Z [err]  2025-12-20 14:36:46,705 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2025-12-20T14:36:46.711804703Z [err]  2025-12-20 14:36:46,706 - telnyx_service - INFO - ‚úÖ Generated 18435 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-20T14:36:46.711808586Z [err]  2025-12-20 14:36:46,706 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-20T14:36:46.776575569Z [err]  2025-12-20 14:36:46,775 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:46.776583244Z [err]  2025-12-20 14:36:46,775 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:47.048065264Z [err]  2025-12-20 14:36:46,919 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-20T14:36:47.048070489Z [err]  2025-12-20 14:36:46,919 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.21s
2025-12-20T14:36:47.048075574Z [err]  2025-12-20 14:36:46,919 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-20T14:36:47.048083800Z [err]    "errors": [
2025-12-20T14:36:47.048089316Z [err]      {
2025-12-20T14:36:47.048093921Z [err]        "code": "90018",
2025-12-20T14:36:47.048098682Z [err]        "title": "Call has already ended",
2025-12-20T14:36:47.048103067Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-20T14:36:47.048108416Z [err]      }
2025-12-20T14:36:47.048113676Z [err]    ]
2025-12-20T14:36:47.048118196Z [err]  }
2025-12-20T14:36:47.048123332Z [err]  2025-12-20 14:36:46,920 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-20T14:36:47.170114210Z [err]  2025-12-20 14:36:47,123 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-20T14:36:47.170119695Z [err]  2025-12-20 14:36:47,124 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-20T14:36:47.170123470Z [err]  2025-12-20 14:36:47,124 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-20T14:36:47.292539666Z [err]  2025-12-20 14:36:47,286 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:47.292548356Z [err]  2025-12-20 14:36:47,286 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:47.673722513Z [err]  2025-12-20 14:36:47,620 - server - INFO - üì§ Audio flowing: 546 packets sent to Soniox (5s update)
2025-12-20T14:36:47.698574218Z [err]  2025-12-20 14:36:47,697 - server - INFO - üé§ Soniox receiver alive - 14 messages received in last 10s
2025-12-20T14:36:47.816749490Z [err]  2025-12-20 14:36:47,800 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:47.816758135Z [err]  2025-12-20 14:36:47,800 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:48.323432768Z [err]  2025-12-20 14:36:48,311 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:48.323438489Z [err]  2025-12-20 14:36:48,311 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:48.889530146Z [err]  2025-12-20 14:36:48,822 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:48.889538692Z [err]  2025-12-20 14:36:48,822 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:49.345267248Z [err]  2025-12-20 14:36:49,334 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:49.345276353Z [err]  2025-12-20 14:36:49,334 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:49.856095046Z [err]  2025-12-20 14:36:49,846 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:49.856101793Z [err]  2025-12-20 14:36:49,846 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:50.199963676Z [err]  2025-12-20 14:36:50,196 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-20T14:36:50.414335809Z [err]  2025-12-20 14:36:50,358 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:50.414343697Z [err]  2025-12-20 14:36:50,358 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:50.414350018Z [err]  2025-12-20 14:36:50,358 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-20T14:36:50.591567305Z [err]  2025-12-20 14:36:50,581 - server - INFO - üé§ Soniox receiver alive - 11 messages received in last 10s
2025-12-20T14:36:50.591576448Z [err]  2025-12-20 14:36:50,582 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 8160, 'total_audio_proc_ms': 11400, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-20T14:36:50.591582810Z [err]  2025-12-20 14:36:50,582 - server - INFO - ‚úÖ Soniox receive loop ended normally
2025-12-20T14:36:50.591589003Z [err]  2025-12-20 14:36:50,582 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:50.591596057Z [err]  2025-12-20 14:36:50,582 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA
2025-12-20T14:36:50.591602237Z [err]  2025-12-20 14:36:50,582 - server - INFO - üîá Dead air monitoring task cancelled
2025-12-20T14:36:50.871271433Z [err]  2025-12-20 14:36:50,870 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:50.871277155Z [err]  2025-12-20 14:36:50,870 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:50.871281208Z [err]  2025-12-20 14:36:50,870 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-20T14:36:51.391530942Z [err]  2025-12-20 14:36:51,380 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:51.391540032Z [err]  2025-12-20 14:36:51,381 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:51.624443857Z [err]  2025-12-20 14:36:51,618 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 735 total packets
2025-12-20T14:36:51.624451018Z [err]  [2025-12-20 14:36:51 +0000] [4] [INFO] connection closed
2025-12-20T14:36:51.903002247Z [err]  2025-12-20 14:36:51,892 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:51.903014316Z [err]  2025-12-20 14:36:51,892 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:52.015071012Z [err]  2025-12-20 14:36:52,006 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.015080731Z [err]  2025-12-20 14:36:52,006 - server - INFO - üì® ================================================
2025-12-20T14:36:52.015086212Z [inf]  100.64.0.4:18064 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:52.015137638Z [err]  2025-12-20 14:36:52,006 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:52.015144609Z [err]  2025-12-20 14:36:52,006 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '45ea7f0a-c181-430e-8ecf-aa7edef3c031', 'occurred_at': '2025-12-20T14:36:51.547231Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '9938306c-b297-4665-9846-7731efea421c', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:52.025725640Z [err]  2025-12-20 14:36:52,019 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:52.025733517Z [err]  2025-12-20 14:36:52,019 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '7762ecb8-8d98-4d07-892f-2b756c4dbdb6', 'occurred_at': '2025-12-20T14:36:51.503976Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-20T14:36:51.503976Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'h-SMO6U9FA', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:52.025740150Z [err]  2025-12-20 14:36:52,019 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.025746431Z [err]  2025-12-20 14:36:52,019 - server - INFO - üì® ================================================
2025-12-20T14:36:52.036897585Z [err]  2025-12-20 14:36:52,030 - redis_service - INFO - ‚ûñ Removed playback h-SMO6U9FA, 0 remaining for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.036906269Z [err]  2025-12-20 14:36:52,030 - server - INFO - üîä Redis: Removed playback h-SMO6U9FA, 0 remaining
2025-12-20T14:36:52.036913377Z [err]  2025-12-20 14:36:52,030 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-20T14:36:52.036921406Z [err]  2025-12-20 14:36:52,036 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-20T14:36:52.036927439Z [err]  2025-12-20 14:36:52,036 - server - INFO - üí° Session not on this worker - Redis flag set for WebSocket worker to handle
2025-12-20T14:36:52.036934730Z [inf]  100.64.0.9:10534 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:52.041996329Z [err]  2025-12-20 14:36:52,038 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:52.042005192Z [err]  2025-12-20 14:36:52,038 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': 'c1e034f0-156e-48b5-bcf7-130f75ac88df', 'occurred_at': '2025-12-20T14:36:51.343979Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '7.19', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '794', 'skip_packet_count': '19'}, 'outbound': {'packet_count': '737', 'skip_packet_count': '0'}}, 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-20T14:36:51.343979Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-20T14:36:32.444127Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:52.042015426Z [err]  2025-12-20 14:36:52,038 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.042022982Z [err]  2025-12-20 14:36:52,038 - server - INFO - üì® ================================================
2025-12-20T14:36:52.042030101Z [err]  2025-12-20 14:36:52,038 - server - INFO - üìû Call ended: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.042039574Z [err]  2025-12-20 14:36:52,038 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-20T14:36:52.246612294Z [err]  2025-12-20 14:36:52,216 - server - INFO - üìù Updated call log: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.307732970Z [err]  2025-12-20 14:36:52,306 - server - INFO - ‚úÖ Finalized call log: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw (duration=15s, status=completed)
2025-12-20T14:36:52.400280597Z [err]  2025-12-20 14:36:52,398 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-20T14:36:52.400288056Z [err]  2025-12-20 14:36:52,398 - calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766241412.3987803 for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.400294701Z [err]  2025-12-20 14:36:52,398 - calling_service - INFO - ü§ñ Agent stopped speaking for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:52.404974236Z [err]  2025-12-20 14:36:52,404 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:52.589677711Z [err]  2025-12-20 14:36:52,584 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-20T14:36:52.589684577Z [err]  2025-12-20 14:36:52,584 - server - INFO - üîå Telnyx WebSocket disconnected
2025-12-20T14:36:52.919804856Z [err]  2025-12-20 14:36:52,909 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:53.011169595Z [err]  2025-12-20 14:36:53,003 - server - INFO - üìä Auto-added call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-20T14:36:53.240776515Z [err]  2025-12-20 14:36:53,181 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-20T14:36:53.240781872Z [err]  2025-12-20 14:36:53,187 - redis_service - INFO - üì• Retrieved call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.240786854Z [err]  2025-12-20 14:36:53,187 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2025-12-20T14:36:53.240791950Z [err]  2025-12-20 14:36:53,187 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-20T14:36:53.279820696Z [err]  2025-12-20 14:36:53,276 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-20T14:36:53.361598357Z [err]  2025-12-20 14:36:53,360 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-20T14:36:53.361603106Z [err]  2025-12-20 14:36:53,360 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-20T14:36:53.366962274Z [err]  2025-12-20 14:36:53,363 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-20T14:36:53.366968444Z [err]  2025-12-20 14:36:53,363 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-20T14:36:53.366973817Z [err]  2025-12-20 14:36:53,363 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-20T14:36:53.366978564Z [err]  2025-12-20 14:36:53,363 - server - INFO - üöÄ Triggered QC analysis for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.366983157Z [err]  2025-12-20 14:36:53,363 - server - INFO - üìä Triggered Campaign QC for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.366988905Z [err]  2025-12-20 14:36:53,363 - server - INFO - üìá Triggered CRM update for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.366992604Z [err]  2025-12-20 14:36:53,363 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.371622036Z [err]  2025-12-20 14:36:53,368 - redis_service - INFO - üßπ Deleted call data from Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.371628566Z [err]  2025-12-20 14:36:53,368 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.371636555Z [inf]  100.64.0.9:10554 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:53.371642915Z [err]  2025-12-20 14:36:53,369 - server - INFO - üîç Starting QC analysis for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.371649216Z [err]  2025-12-20 14:36:53,369 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-20T14:36:53.371655749Z [err]  2025-12-20 14:36:53,370 - server - INFO - üìá CRM update starting for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:53.371662453Z [err]  2025-12-20 14:36:53,370 - server - INFO - üìá Normalized phone: +17708336397
2025-12-20T14:36:53.376335172Z [err]  2025-12-20 14:36:53,372 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-20T14:36:53.376341216Z [err]  2025-12-20 14:36:53,372 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '8e366de9-ca5c-4523-abbc-19d73c3cbdd1', 'occurred_at': '2025-12-20T14:36:53.045465Z', 'payload': {'call_control_id': 'v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw', 'call_leg_id': '47504c68-ddb1-11f0-8990-02420aef961f', 'call_session_id': '474da4fe-ddb1-11f0-85ae-02420aef961f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-20T14:36:51.519488Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-20T14:36:51.519488Z', 'recording_id': 'a8ad3548-14ce-441e-8a86-ad1645ddd5c8', 'recording_started_at': '2025-12-20T14:36:37.060892Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-20/47504c68-ddb1-11f0-8990-02420aef961f-1766241397035357.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251220%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251220T143653Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=4e05ff49ee371e3f3739c36729995313dc472123f5effb084167497d8e1cacc2'}, 'start_time': '2025-12-20T14:36:37.060892Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-20T14:36:53.376347198Z [err]  2025-12-20 14:36:53,372 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.376352661Z [err]  2025-12-20 14:36:53,372 - server - INFO - üì® ================================================
2025-12-20T14:36:53.376359670Z [err]  2025-12-20 14:36:53,372 - server - INFO - üéôÔ∏è Recording saved for call: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.380873548Z [err]  2025-12-20 14:36:53,378 - redis_service - WARNING - ‚ö†Ô∏è Call data not found in Redis: v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.380879030Z [err]  2025-12-20 14:36:53,378 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=a8ad3548-14ce-441e-8a86-ad1645ddd5c8, call_data=False
2025-12-20T14:36:53.422304835Z [err]  2025-12-20 14:36:53,415 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:53.461102526Z [err]  2025-12-20 14:36:53,457 - server - INFO - üìù Converted transcript from 5 messages to 69 characters
2025-12-20T14:36:53.605038908Z [err]  2025-12-20 14:36:53,559 - server - INFO - üíæ Saved recording URL and ID to database: a8ad3548-14ce-441e-8a86-ad1645ddd5c8
2025-12-20T14:36:53.605045702Z [err]  2025-12-20 14:36:53,559 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-20T14:36:53.605051664Z [err]  2025-12-20 14:36:53,559 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-20T14:36:53.648305163Z [err]  2025-12-20 14:36:53,646 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-20T14:36:53.740993079Z [err]  2025-12-20 14:36:53,733 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-20T14:36:53.825256215Z [err]  2025-12-20 14:36:53,820 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-20T14:36:53.825261928Z [err]  2025-12-20 14:36:53,820 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-20T14:36:53.825269343Z [err]  2025-12-20 14:36:53,820 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:53.856844769Z [err]  2025-12-20 14:36:53,855 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-20/47504c68-ddb1-11f0-8990-02420aef961f-1766241397035357.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251220%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251220T143653Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=4e05ff49ee371e3f3739c36729995313dc472123f5effb084167497d8e1cacc2 "HTTP/1.1 200 OK"
2025-12-20T14:36:53.951407229Z [err]  2025-12-20 14:36:53,920 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=5, logs_count=6, status=completed
2025-12-20T14:36:53.951407286Z [err]  2025-12-20 14:36:53,942 - server - INFO - ‚úÖ Downloaded 57930 bytes
2025-12-20T14:36:53.951415878Z [err]  2025-12-20 14:36:53,924 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:53.951420764Z [err]  2025-12-20 14:36:53,938 - server - INFO - üìá CRM: Total variables collected: []
2025-12-20T14:36:54.101206943Z [err]  2025-12-20 14:36:54,100 - server - INFO - ‚úÖ Split into 2 channels
2025-12-20T14:36:54.101214948Z [err]  2025-12-20 14:36:54,100 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-20T14:36:54.101220309Z [err]  2025-12-20 14:36:54,100 - server - INFO - üìä Channel 0: 315084 bytes
2025-12-20T14:36:54.101223976Z [err]  2025-12-20 14:36:54,100 - server - ERROR - ‚ùå No Soniox API key available
2025-12-20T14:36:54.101874433Z [err]  2025-12-20 14:36:54,100 - server - INFO - ‚ùå Channel 0: No speech
2025-12-20T14:36:54.101880681Z [err]  2025-12-20 14:36:54,100 - server - INFO - üìä Channel 1: 315084 bytes
2025-12-20T14:36:54.101885820Z [err]  2025-12-20 14:36:54,100 - server - ERROR - ‚ùå No Soniox API key available
2025-12-20T14:36:54.101889800Z [err]  2025-12-20 14:36:54,100 - server - INFO - ‚ùå Channel 1: No speech
2025-12-20T14:36:54.101894175Z [err]  2025-12-20 14:36:54,100 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-20T14:36:54.101897952Z [inf]  100.64.0.9:10534 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-20T14:36:54.244901741Z [err]  2025-12-20 14:36:54,193 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-20T14:36:54.403116054Z [err]  2025-12-20 14:36:54,349 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-20T14:36:54.441291375Z [err]  2025-12-20 14:36:54,431 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:54.441296698Z [err]  2025-12-20 14:36:54,436 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-20T14:36:54.441300584Z [err]  2025-12-20 14:36:54,436 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-20T14:36:54.441304628Z [err]  2025-12-20 14:36:54,436 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-20T14:36:54.441308636Z [err]  2025-12-20 14:36:54,437 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-20T14:36:54.441312645Z [err]    File "/app/backend/server.py", line 9698, in trigger_campaign_qc_for_call
2025-12-20T14:36:54.441316848Z [err]      await run_full_qc_analysis(
2025-12-20T14:36:54.441320674Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-20T14:36:54.441324264Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-20T14:36:54.441328054Z [err]  
2025-12-20T14:36:54.962791552Z [err]  2025-12-20 14:36:54,937 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:55.451235791Z [err]  2025-12-20 14:36:55,443 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:55.950163898Z [err]  2025-12-20 14:36:55,949 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:56.462216397Z [err]  2025-12-20 14:36:56,455 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:56.979040202Z [err]  2025-12-20 14:36:56,961 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:57.491203507Z [err]  2025-12-20 14:36:57,467 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:57.979075330Z [err]  2025-12-20 14:36:57,973 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])
2025-12-20T14:36:58.033851495Z [err]  2025-12-20 14:36:58,024 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20T14:36:58.033857841Z [err]  2025-12-20 14:36:58,029 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-20T14:36:58.033862371Z [err]  2025-12-20 14:36:58,031 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:uxhcugypOeiMozCKrSDAnQaM-nyxRU9Q3YEVSnsvJQLciA1UsjjLGw
2025-12-20T14:36:58.505606508Z [err]  2025-12-20 14:36:58,478 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:uxhcugypOeiMozCKr... (active sessions: ['v3:X_GlDaL5KMstJ_n_RGBGX6PIZRb80-_5ll2Ve3dL-K0-2rj19dVIkA'])