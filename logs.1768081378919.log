2026-01-10T21:35:42.000000000Z [inf]  Starting Container
2026-01-10T21:35:43.614629441Z [err]  [2026-01-10 21:35:43 +0000] [3] [INFO] Booting worker with pid: 3
2026-01-10T21:35:43.614641540Z [err]  [2026-01-10 21:35:43 +0000] [4] [INFO] Booting worker with pid: 4
2026-01-10T21:35:43.614650051Z [err]  [2026-01-10 21:35:43 +0000] [5] [INFO] Booting worker with pid: 5
2026-01-10T21:35:43.614658474Z [inf]  =========================================
2026-01-10T21:35:43.614659750Z [err]  [2026-01-10 21:35:43 +0000] [6] [INFO] Booting worker with pid: 6
2026-01-10T21:35:43.614666844Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2026-01-10T21:35:43.614673811Z [inf]  =========================================
2026-01-10T21:35:43.614681456Z [inf]  üìç Working directory: /app/backend
2026-01-10T21:35:43.614688226Z [inf]  üîç Python path: /app/backend
2026-01-10T21:35:43.614695844Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2026-01-10T21:35:43.614702893Z [inf]  =========================================
2026-01-10T21:35:43.614710407Z [err]  [2026-01-10 21:35:43 +0000] [1] [INFO] Starting gunicorn 22.0.0
2026-01-10T21:35:43.614717701Z [err]  [2026-01-10 21:35:43 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2026-01-10T21:35:43.614725600Z [err]  [2026-01-10 21:35:43 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2026-01-10T21:36:03.496207937Z [err]  2026-01-10 21:35:58,612 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T21:36:03.496212530Z [err]  2026-01-10 21:35:58,590 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T21:36:03.496219825Z [err]  2026-01-10 21:35:58,590 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T21:36:03.496222147Z [err]  2026-01-10 21:35:58,619 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T21:36:03.496228333Z [err]  2026-01-10 21:35:58,596 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T21:36:03.496233178Z [err]  2026-01-10 21:35:58,723 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T21:36:03.496234948Z [err]  2026-01-10 21:35:58,596 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T21:36:03.496242942Z [err]  2026-01-10 21:35:58,598 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T21:36:03.496243677Z [err]  2026-01-10 21:35:58,728 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T21:36:03.496249763Z [err]  2026-01-10 21:35:58,598 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T21:36:03.496255447Z [err]  2026-01-10 21:35:58,602 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T21:36:03.496261475Z [err]  2026-01-10 21:35:58,604 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T21:36:03.496267357Z [err]  2026-01-10 21:35:58,607 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T21:36:03.496273807Z [err]  2026-01-10 21:35:58,607 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T21:36:03.497022112Z [err]  2026-01-10 21:35:58,732 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T21:36:03.497029713Z [err]  2026-01-10 21:35:58,736 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T21:36:03.497036716Z [err]  2026-01-10 21:35:58,823 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T21:36:03.497044143Z [err]  2026-01-10 21:35:58,825 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T21:36:03.497050335Z [err]  2026-01-10 21:35:58,831 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T21:36:03.497056174Z [err]  2026-01-10 21:35:58,835 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T21:36:03.497062760Z [err]  2026-01-10 21:35:58,864 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T21:36:03.497068877Z [err]  2026-01-10 21:35:58,864 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T21:36:03.497076635Z [err]  2026-01-10 21:35:58,866 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T21:36:03.497082983Z [err]  2026-01-10 21:35:58,868 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T21:36:03.497089516Z [err]  2026-01-10 21:35:58,888 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T21:36:03.497095347Z [err]  2026-01-10 21:35:58,890 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T21:36:03.497101240Z [err]  2026-01-10 21:35:58,891 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T21:36:03.497107070Z [err]  2026-01-10 21:35:58,891 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T21:36:03.497113225Z [err]  2026-01-10 21:35:58,893 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T21:36:03.497119281Z [err]  2026-01-10 21:35:58,894 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T21:36:03.497126060Z [err]  2026-01-10 21:35:58,894 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T21:36:03.498500779Z [err]  2026-01-10 21:35:58,898 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T21:36:03.498510612Z [err]  2026-01-10 21:35:59,002 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T21:36:03.498519115Z [err]  2026-01-10 21:35:59,005 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T21:36:03.498578512Z [err]  2026-01-10 21:35:59,007 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T21:36:03.498586696Z [err]  2026-01-10 21:35:59,014 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T21:36:03.498594882Z [err]  2026-01-10 21:35:59,014 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T21:36:03.498603151Z [err]  2026-01-10 21:35:59,015 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T21:36:03.498610790Z [err]  2026-01-10 21:35:59,016 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T21:36:03.498618217Z [err]  2026-01-10 21:35:59,018 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T21:36:03.498625618Z [err]  2026-01-10 21:35:59,036 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T21:36:03.498634673Z [err]  2026-01-10 21:35:59,036 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T21:36:03.498641929Z [err]  2026-01-10 21:35:59,039 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T21:36:03.498653482Z [err]  2026-01-10 21:35:59,040 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T21:36:03.498660812Z [err]  2026-01-10 21:35:59,048 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T21:36:03.498668824Z [err]  2026-01-10 21:35:59,048 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T21:36:03.498676765Z [err]  2026-01-10 21:35:59,049 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T21:36:03.498684476Z [err]  2026-01-10 21:35:59,049 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T21:36:03.498691729Z [err]  2026-01-10 21:35:59,050 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T21:36:03.499968148Z [err]  2026-01-10 21:35:59,050 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T21:36:03.499976773Z [err]  2026-01-10 21:35:59,058 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T21:36:03.499983417Z [err]  2026-01-10 21:35:59,059 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T21:36:03.499990216Z [err]  [2026-01-10 21:35:59 +0000] [5] [INFO] Started server process [5]
2026-01-10T21:36:03.499995520Z [err]  [2026-01-10 21:35:59 +0000] [4] [INFO] Started server process [4]
2026-01-10T21:36:03.500000625Z [err]  [2026-01-10 21:35:59 +0000] [4] [INFO] Waiting for application startup.
2026-01-10T21:36:03.500006055Z [err]  [2026-01-10 21:35:59 +0000] [5] [INFO] Waiting for application startup.
2026-01-10T21:36:03.500010871Z [err]  [2026-01-10 21:35:59 +0000] [3] [INFO] Started server process [3]
2026-01-10T21:36:03.500015955Z [err]  [2026-01-10 21:35:59 +0000] [3] [INFO] Waiting for application startup.
2026-01-10T21:36:03.500020970Z [err]  [2026-01-10 21:35:59 +0000] [6] [INFO] Started server process [6]
2026-01-10T21:36:03.500025369Z [err]  [2026-01-10 21:35:59 +0000] [6] [INFO] Waiting for application startup.
2026-01-10T21:36:03.500030266Z [err]  2026-01-10 21:35:59,155 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T21:36:03.500041232Z [err]  2026-01-10 21:35:59,155 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T21:36:03.500045651Z [err]  2026-01-10 21:35:59,156 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T21:36:03.500050379Z [err]  2026-01-10 21:35:59,156 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T21:36:08.099667284Z [err]  2026-01-10 21:36:08,089 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T21:36:08.099667320Z [err]  2026-01-10 21:36:08,093 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T21:36:08.099676923Z [err]  2026-01-10 21:36:08,089 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T21:36:08.099684827Z [err]  2026-01-10 21:36:08,092 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T21:36:08.099692415Z [err]  2026-01-10 21:36:08,092 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T21:36:08.099699482Z [err]  2026-01-10 21:36:08,092 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T21:36:08.099707023Z [err]  2026-01-10 21:36:08,093 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T21:36:08.099716041Z [err]  2026-01-10 21:36:08,093 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T21:36:08.105077874Z [err]  2026-01-10 21:36:08,101 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T21:36:08.105089542Z [err]  2026-01-10 21:36:08,102 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T21:36:08.107041715Z [err]  2026-01-10 21:36:08,105 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T21:36:08.107057097Z [err]  2026-01-10 21:36:08,105 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T21:36:08.107067467Z [err]  2026-01-10 21:36:08,105 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T21:36:08.112540526Z [err]  2026-01-10 21:36:08,107 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T21:36:08.112544836Z [err]  2026-01-10 21:36:08,107 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T21:36:08.112548844Z [err]  2026-01-10 21:36:08,107 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T21:36:08.892864997Z [err]  2026-01-10 21:36:08,856 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T21:36:08.892871573Z [err]  2026-01-10 21:36:08,863 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T21:36:08.892877870Z [err]  2026-01-10 21:36:08,872 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T21:36:08.892882149Z [err]  2026-01-10 21:36:08,875 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T21:36:08.971217549Z [err]  2026-01-10 21:36:08,955 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T21:36:08.971221442Z [err]  2026-01-10 21:36:08,966 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T21:36:08.971237261Z [err]  [2026-01-10 21:36:08 +0000] [4] [INFO] Application startup complete.
2026-01-10T21:36:08.984192608Z [err]  2026-01-10 21:36:08,982 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T21:36:08.985535720Z [err]  2026-01-10 21:36:08,983 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T21:36:08.985545282Z [err]  2026-01-10 21:36:08,983 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T21:36:08.985552237Z [err]  [2026-01-10 21:36:08 +0000] [6] [INFO] Application startup complete.
2026-01-10T21:36:08.985559832Z [err]  2026-01-10 21:36:08,984 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T21:36:08.985566980Z [err]  [2026-01-10 21:36:08 +0000] [5] [INFO] Application startup complete.
2026-01-10T21:36:08.991346789Z [err]  2026-01-10 21:36:08,988 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T21:36:08.997714726Z [err]  2026-01-10 21:36:08,996 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T21:36:08.997722475Z [err]  [2026-01-10 21:36:08 +0000] [3] [INFO] Application startup complete.
2026-01-10T21:41:51.617299642Z [inf]  100.64.0.2:27288 - "GET /api/auth/me HTTP/1.1" 200
2026-01-10T21:41:51.617306212Z [err]  2026-01-10 21:41:45,069 - server - INFO - üìû Call history request - user_id: dcafa642-6136-4096-b77d-a4cb99a62651, limit: 10, offset: 0
2026-01-10T21:41:51.617312510Z [err]  2026-01-10 21:41:45,069 - server - INFO - üìû Query: {'user_id': 'dcafa642-6136-4096-b77d-a4cb99a62651'}
2026-01-10T21:41:51.617318195Z [inf]  100.64.0.2:27288 - "GET /api/agents HTTP/1.1" 200
2026-01-10T21:41:51.617327364Z [err]  2026-01-10 21:41:46,214 - server - INFO - üìû Found 10 calls for user (Total: 6451)
2026-01-10T21:41:51.617332735Z [inf]  100.64.0.2:27296 - "GET /api/call-history?limit=10 HTTP/1.1" 200
2026-01-10T21:41:51.617338803Z [inf]  100.64.0.2:27298 - "GET /api/dashboard/analytics HTTP/1.1" 200
2026-01-10T21:41:51.617344360Z [inf]  100.64.0.2:27298 - "GET /api/agents HTTP/1.1" 200
2026-01-10T21:42:11.616168034Z [err]  2026-01-10 21:42:07,379 - telnyx_service - INFO - ‚úÖ Call initiated: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.616178452Z [err]  2026-01-10 21:42:07,477 - server - INFO - üìù Created call log: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.616185369Z [err]  2026-01-10 21:42:07,477 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T21:42:11.616195696Z [err]  2026-01-10 21:42:07,477 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'barge_in_settings': {'enable_verbose_barge_in': True, 'word_count_threshold': 10, 'interruption_prompt': 'The user is speaking for a long time. Interrupt them politely but firmly to acknowledge what they said and guide the conversation back to the goal. start by saying an elongated why whhhhyyyy...'}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2026-01-10T21:42:11.616219683Z [inf]  100.64.0.3:60710 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-10T21:42:11.616224215Z [err]  2026-01-10 21:42:06,664 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T21:42:11.616232776Z [err]  2026-01-10 21:42:06,754 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:11.616237162Z [err]  2026-01-10 21:42:06,840 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:11.616242930Z [err]  2026-01-10 21:42:06,864 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:11.616247756Z [err]  2026-01-10 21:42:06,864 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2026-01-10T21:42:11.616251707Z [err]  2026-01-10 21:42:06,864 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-10T21:42:11.616256333Z [err]  2026-01-10 21:42:06,864 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T21:42:11.616260280Z [err]  2026-01-10 21:42:07,376 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2026-01-10T21:42:11.616964173Z [err]  2026-01-10 21:42:07,477 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T21:42:11.616966375Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T21:42:11.616971440Z [err]  2026-01-10 21:42:07,477 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T21:42:11.616974776Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T21:42:11.616979973Z [err]  2026-01-10 21:42:07,509 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:11.616983314Z [err]  2026-01-10 21:42:07,689 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2026-01-10T21:42:11.616987234Z [err]  2026-01-10 21:42:07,509 - server - INFO - üì¶ Call data stored in Redis and memory
2026-01-10T21:42:11.616990576Z [err]  2026-01-10 21:42:07,689 - server - INFO -    Client: Address(host='100.64.0.4', port=18866)
2026-01-10T21:42:11.616995065Z [err]  2026-01-10 21:42:07,509 - server - INFO - üìû Outbound call initiated: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.616999046Z [err]  2026-01-10 21:42:07,689 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '0BK6ZRUPtEnTpq4Z8n2Agg==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'yH92-4dlTjiKZGkoLPU1MQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1768081327455', 'accept-encoding': 'gzip'}
2026-01-10T21:42:11.617003281Z [inf]  100.64.0.2:27298 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-10T21:42:11.617010074Z [err]  2026-01-10 21:42:07,585 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T21:42:11.617017187Z [err]  2026-01-10 21:42:07,586 - server - WARNING - ‚ö†Ô∏è Call-initiated webhook returned status 530: <!doctype html>
2026-01-10T21:42:11.617023448Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T21:42:11.618073526Z [err]  2026-01-10 21:42:07,689 - server - INFO -    Path: /api/telnyx/audio-stream
2026-01-10T21:42:11.618080356Z [err]  2026-01-10 21:42:07,689 - server - INFO - üîå Incoming Telnyx WebSocket connection
2026-01-10T21:42:11.618086118Z [err]  [2026-01-10 21:42:07 +0000] [3] [INFO] ('100.64.0.4', 18866) - "WebSocket /api/telnyx/audio-stream" [accepted]
2026-01-10T21:42:11.618091819Z [err]  2026-01-10 21:42:07,690 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2026-01-10T21:42:11.618098428Z [err]  [2026-01-10 21:42:07 +0000] [3] [INFO] connection open
2026-01-10T21:42:11.618104904Z [err]  2026-01-10 21:42:07,823 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:11.618110850Z [err]  2026-01-10 21:42:07,823 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '50051c0c-c77b-4209-b219-fab2d738b0a0', 'occurred_at': '2026-01-10T21:42:07.249318Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:11.618117022Z [err]  2026-01-10 21:42:07,823 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.618122726Z [err]  2026-01-10 21:42:07,823 - server - INFO - üì® ================================================
2026-01-10T21:42:11.618128389Z [err]  2026-01-10 21:42:07,823 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2026-01-10T21:42:11.618134171Z [inf]  100.64.0.5:38988 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:11.618965528Z [err]  2026-01-10 21:42:07,849 - server - INFO - üì¨ Received Telnyx event: connected
2026-01-10T21:42:11.618975985Z [err]  2026-01-10 21:42:07,849 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2026-01-10T21:42:11.618984062Z [err]  2026-01-10 21:42:10,072 - server - INFO - üì¨ Received Telnyx event: start
2026-01-10T21:42:11.618992702Z [err]  2026-01-10 21:42:10,073 - server - INFO - üé¨ Stream started for call: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.618999924Z [err]  2026-01-10 21:42:10,112 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.619010073Z [err]  2026-01-10 21:42:10,114 - server - INFO - ‚úÖ Call data found after 0s wait
2026-01-10T21:42:11.619016834Z [err]  2026-01-10 21:42:10,114 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2026-01-10T21:42:11.619021352Z [err]  2026-01-10 21:42:10,247 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:11.619025666Z [err]  2026-01-10 21:42:10,248 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'b97a4c74-25e5-4516-918d-f2361f5a8e8a', 'occurred_at': '2026-01-10T21:42:09.949318Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2026-01-10T21:42:07.249318Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:11.619030277Z [err]  2026-01-10 21:42:10,248 - server - INFO - üéØ Event type: call.answered, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.620058248Z [err]  2026-01-10 21:42:10,248 - server - INFO - üì® ================================================
2026-01-10T21:42:11.620068457Z [err]  2026-01-10 21:42:10,248 - server - INFO - ‚úÖ Call answered: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.620075757Z [err]  2026-01-10 21:42:10,273 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.620082141Z [err]  2026-01-10 21:42:10,274 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2026-01-10T21:42:11.620086461Z [err]  2026-01-10 21:42:10,274 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2026-01-10T21:42:11.620090453Z [err]  2026-01-10 21:42:10,369 - server - INFO - ‚úÖ Call log updated
2026-01-10T21:42:11.620094259Z [err]  2026-01-10 21:42:10,369 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T21:42:11.620097748Z [err]  2026-01-10 21:42:10,369 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T21:42:11.620102171Z [err]  2026-01-10 21:42:10,369 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T21:42:11.620106298Z [err]  2026-01-10 21:42:10,418 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T21:42:11.620109757Z [err]  2026-01-10 21:42:10,419 - server - WARNING - ‚ö†Ô∏è Call-started webhook returned status 530: <!doctype html>
2026-01-10T21:42:11.620113471Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T21:42:11.620117451Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T21:42:11.622911468Z [err]  2026-01-10 21:42:10,565 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:11.622921373Z [err]  2026-01-10 21:42:10,613 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2026-01-10T21:42:11.622924511Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T21:42:11.622929479Z [err]  2026-01-10 21:42:10,456 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:11.622933848Z [err]  2026-01-10 21:42:10,522 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:11.622938521Z [err]  2026-01-10 21:42:10,522 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'bb5eb756-24a4-4980-adf7-3a29d3d572cb', 'occurred_at': '2026-01-10T21:42:10.229323Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '4be13cd4-d8f9-4b25-9efc-0b2c9fa24cb7', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:11.622943428Z [err]  2026-01-10 21:42:10,523 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.622948133Z [err]  2026-01-10 21:42:10,523 - server - INFO - üì® ================================================
2026-01-10T21:42:11.622952431Z [inf]  100.64.0.6:52418 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:11.622956653Z [err]  2026-01-10 21:42:10,543 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:11.622961112Z [err]  2026-01-10 21:42:10,543 - server - INFO - üîß Creating Telnyx service with user's keys...
2026-01-10T21:42:11.623744323Z [err]  2026-01-10 21:42:10,614 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2026-01-10T21:42:11.623752639Z [err]  2026-01-10 21:42:10,629 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.623762293Z [err]  2026-01-10 21:42:10,630 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T21:42:11.623769701Z [err]  2026-01-10 21:42:10,630 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-10T21:42:11.623776653Z [err]  2026-01-10 21:42:10,718 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-10T21:42:11.623783832Z [err]  2026-01-10 21:42:10,718 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-10T21:42:11.623790208Z [err]  2026-01-10 21:42:10,733 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-10T21:42:11.623797146Z [err]  2026-01-10 21:42:10,733 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-10T21:42:11.623804086Z [err]  2026-01-10 21:42:10,735 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-10T21:42:11.623810869Z [err]  2026-01-10 21:42:10,823 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:11.623817118Z [err]  2026-01-10 21:42:10,832 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_start "HTTP/1.1 200 OK"
2026-01-10T21:42:11.623824191Z [err]  2026-01-10 21:42:10,832 - core_calling_service - INFO - üöÄ Created global HTTP/2 client for LLM calls
2026-01-10T21:42:11.624890930Z [err]  2026-01-10 21:42:10,834 - server - INFO - ‚úÖ Initialized call_states for v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w with session reference
2026-01-10T21:42:11.624898645Z [err]  2026-01-10 21:42:10,835 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 3000ms...
2026-01-10T21:42:11.624899796Z [err]  2026-01-10 21:42:10,833 - core_calling_service - INFO - üöÄ Created cached Grok client with HTTP/2
2026-01-10T21:42:11.624904075Z [err]  2026-01-10 21:42:10,924 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2026-01-10T21:42:11.624909131Z [err]  2026-01-10 21:42:11,218 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/record_start "HTTP/1.1 200 OK"
2026-01-10T21:42:11.624910702Z [err]  2026-01-10 21:42:10,833 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 97ms
2026-01-10T21:42:11.624918387Z [err]  2026-01-10 21:42:10,833 - server - INFO - ‚úÖ Session created in WebSocket worker
2026-01-10T21:42:11.624925131Z [err]  2026-01-10 21:42:10,833 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 3000ms
2026-01-10T21:42:11.624931535Z [err]  2026-01-10 21:42:10,833 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2026-01-10T21:42:11.624936643Z [err]  2026-01-10 21:42:10,833 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: I93pcToo-A (loop=True, overlay=True)
2026-01-10T21:42:11.624941850Z [err]  2026-01-10 21:42:10,833 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2026-01-10T21:42:11.624945625Z [err]  2026-01-10 21:42:10,833 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w'
2026-01-10T21:42:11.624949923Z [err]  2026-01-10 21:42:10,833 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.626229605Z [inf]  100.64.0.7:55736 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2026-01-10T21:42:11.626236365Z [err]  2026-01-10 21:42:11,405 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:11.626243077Z [err]  2026-01-10 21:42:11,417 - core_calling_service - INFO - üöÄ Created global HTTP/2 client for LLM calls
2026-01-10T21:42:11.626246244Z [err]  2026-01-10 21:42:11,219 - server - INFO - üéôÔ∏è Call recording started for v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.626268223Z [err]  2026-01-10 21:42:11,219 - server - INFO - üîß Creating call session for v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w...
2026-01-10T21:42:11.626275095Z [err]  2026-01-10 21:42:11,219 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T21:42:11.626281963Z [err]  2026-01-10 21:42:11,219 - server - INFO - üîß Calling create_call_session() - START
2026-01-10T21:42:11.626288461Z [err]  2026-01-10 21:42:11,219 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-10T21:42:11.626295918Z [err]  2026-01-10 21:42:11,306 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-10T21:42:11.626302736Z [err]  2026-01-10 21:42:11,307 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-10T21:42:11.626306868Z [err]  2026-01-10 21:42:11,318 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-10T21:42:11.626310441Z [err]  2026-01-10 21:42:11,318 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-10T21:42:11.626314056Z [err]  2026-01-10 21:42:11,318 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-10T21:42:11.627601930Z [err]  2026-01-10 21:42:11,447 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2026-01-10T21:42:11.627608565Z [err]  2026-01-10 21:42:11,452 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.627615314Z [err]  2026-01-10 21:42:11,418 - core_calling_service - INFO - üöÄ Created cached Grok client with HTTP/2
2026-01-10T21:42:11.627615461Z [err]  2026-01-10 21:42:11,452 - server - INFO - ü§ñ AI session created for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.627622366Z [err]  2026-01-10 21:42:11,452 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2026-01-10T21:42:11.627625965Z [err]  2026-01-10 21:42:11,418 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 99ms
2026-01-10T21:42:11.627632356Z [err]  2026-01-10 21:42:11,418 - server - INFO - üîß Calling create_call_session() - COMPLETE
2026-01-10T21:42:11.627638745Z [err]  2026-01-10 21:42:11,418 - server - INFO - ‚úÖ Session object created: CallSession
2026-01-10T21:42:11.627645128Z [err]  2026-01-10 21:42:11,446 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:11.627651898Z [err]  2026-01-10 21:42:11,447 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2026-01-10T21:42:11.627656041Z [err]  2026-01-10 21:42:11,447 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2026-01-10T21:42:11.627660294Z [err]  2026-01-10 21:42:11,447 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2026-01-10T21:42:11.627664223Z [err]  2026-01-10 21:42:11,447 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2026-01-10T21:42:11.628526486Z [err]  2026-01-10 21:42:11,452 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2026-01-10T21:42:11.628535020Z [err]  2026-01-10 21:42:11,452 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2026-01-10T21:42:11.628536145Z [err]  2026-01-10 21:42:11,479 - server - INFO - ü§ê No greeting - waiting for user to speak first
2026-01-10T21:42:11.628542567Z [err]  2026-01-10 21:42:11,471 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:11.628543107Z [err]  2026-01-10 21:42:11,452 - server - INFO - üëÇ User speaks first - waiting for user input...
2026-01-10T21:42:11.628544715Z [err]  2026-01-10 21:42:11,479 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2026-01-10T21:42:11.628550855Z [err]  2026-01-10 21:42:11,453 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2026-01-10T21:42:11.628551279Z [err]  2026-01-10 21:42:11,472 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.628557818Z [err]  2026-01-10 21:42:11,453 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2026-01-10T21:42:11.628558786Z [err]  2026-01-10 21:42:11,477 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:11.628564677Z [err]  2026-01-10 21:42:11,453 - server - INFO - üé§ Voice flow - streaming started via dial command
2026-01-10T21:42:11.628565877Z [err]  2026-01-10 21:42:11,478 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2026-01-10T21:42:11.628571835Z [err]  2026-01-10 21:42:11,478 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:11.629436715Z [inf]  100.64.0.4:18868 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:12.001496773Z [err]  2026-01-10 21:42:11,983 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.351300293Z [err]  2026-01-10 21:42:12,332 - server - INFO - üî§ RAW TOKENS: ["Hell"‚úì, "o."‚úì, "<end>"‚úì]
2026-01-10T21:42:12.351311828Z [err]  2026-01-10 21:42:12,332 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T21:42:12.351319142Z [err]  2026-01-10 21:42:12,332 - server - INFO - üì• FINAL TOKENS: 'Hell o.' (2 tokens)
2026-01-10T21:42:12.351326000Z [err]  2026-01-10 21:42:12,332 - server - INFO - üé§ Soniox final transcript: 'Hell o.'
2026-01-10T21:42:12.351333032Z [err]  2026-01-10 21:42:12,333 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.351466364Z [err]  2026-01-10 21:42:12,230 - server - INFO - üî§ RAW TOKENS: ["Hell"?]
2026-01-10T21:42:12.351470107Z [err]  2026-01-10 21:42:12,233 - core_calling_service - INFO - üîä Silence timer reset for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (user started speaking)
2026-01-10T21:42:12.351474046Z [err]  2026-01-10 21:42:12,233 - core_calling_service - INFO - üë§ User started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.351477870Z [err]  2026-01-10 21:42:12,233 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.351481965Z [err]  2026-01-10 21:42:12,233 - server - WARNING - ‚ö†Ô∏è [REAL TIMING] No TTS session found to clear for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.351486098Z [err]  2026-01-10 21:42:12,259 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.351490333Z [err]  2026-01-10 21:42:12,287 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:12.351494163Z [err]  2026-01-10 21:42:12,287 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hell' | Generating: False
2026-01-10T21:42:12.351713740Z [err]  2026-01-10 21:42:12,333 - server - INFO - üîç FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2026-01-10T21:42:12.351721370Z [err]  2026-01-10 21:42:12,333 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.351727352Z [err]  2026-01-10 21:42:12,333 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T21:42:12.351733055Z [err]  2026-01-10 21:42:12,333 - server - INFO - ‚è±Ô∏è [21:42:12.333] üìù FINAL TRANSCRIPT RECEIVED: 'Hell o.'
2026-01-10T21:42:12.351739110Z [err]  2026-01-10 21:42:12,333 - server - INFO - ‚è±Ô∏è [21:42:12.333] STT endpoint detection latency: 15ms
2026-01-10T21:42:12.351745287Z [err]  2026-01-10 21:42:12,333 - server - INFO - ‚è±Ô∏è [21:42:12.333] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T21:42:12.351749682Z [err]  2026-01-10 21:42:12,333 - server - INFO - ‚è±Ô∏è User spoke at 1768081332.3337753
2026-01-10T21:42:12.351753222Z [err]  2026-01-10 21:42:12,339 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:12.351756790Z [err]  2026-01-10 21:42:12,339 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T21:42:12.351760624Z [err]  2026-01-10 21:42:12,339 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.351764138Z [err]  2026-01-10 21:42:12,339 - server - INFO - ‚úÖ Agent SILENT - User said 2 word(s): 'Hell o.' - Processing...
2026-01-10T21:42:12.351768389Z [err]  2026-01-10 21:42:12,349 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 0ms
2026-01-10T21:42:12.351774211Z [err]  2026-01-10 21:42:12,349 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hell o.
2026-01-10T21:42:12.352827788Z [err]  2026-01-10 21:42:12,349 - core_calling_service - INFO - üë§ User stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.352834536Z [err]  2026-01-10 21:42:12,349 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T21:42:12.352839873Z [err]  2026-01-10 21:42:12,349 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+9ms
2026-01-10T21:42:12.352844766Z [err]  2026-01-10 21:42:12,349 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 9ms (Soniox model: stt-rt-v3)
2026-01-10T21:42:12.352849284Z [err]  2026-01-10 21:42:12,349 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T21:42:12.352853712Z [err]  2026-01-10 21:42:12,349 - server - INFO - üìä [REAL TIMING] Processing start: 31ms after user audio end
2026-01-10T21:42:12.352857612Z [err]  2026-01-10 21:42:12,349 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T21:42:12.352861577Z [err]  2026-01-10 21:42:12,349 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.497229620Z [err]  2026-01-10 21:42:12,444 - server - INFO - üìù Saved user transcript to database
2026-01-10T21:42:12.497236629Z [err]  2026-01-10 21:42:12,444 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.497243970Z [err]  2026-01-10 21:42:12,445 - core_calling_service - INFO - ‚è±Ô∏è [21:42:12.445] üì• process_user_input() ENTRY - text: 'Hell o....'
2026-01-10T21:42:12.497251331Z [err]  2026-01-10 21:42:12,450 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.497258853Z [err]  2026-01-10 21:42:12,450 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: User spoke while Silence Greeting was triggering
2026-01-10T21:42:12.497267481Z [err]  2026-01-10 21:42:12,474 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:12.497273554Z [err]  2026-01-10 21:42:12,475 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.836671880Z [err]  2026-01-10 21:42:12,821 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T21:42:12.836678250Z [err]  2026-01-10 21:42:12,821 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T21:42:12.836682951Z [err]  2026-01-10 21:42:12,822 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T21:42:12.836686739Z [err]  2026-01-10 21:42:12,822 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T21:42:12.836691591Z [err]  2026-01-10 21:42:12,827 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.836695190Z [err]  2026-01-10 21:42:12,830 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:12.836699016Z [err]  2026-01-10 21:42:12,830 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '1208310b-168b-4b2a-a615-7ad35a4119d6', 'occurred_at': '2026-01-10T21:42:12.569324Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'I93pcToo-A', 'start_time': '2026-01-10T21:42:12.569324Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:12.836703007Z [err]  2026-01-10 21:42:12,830 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:12.836706764Z [err]  2026-01-10 21:42:12,830 - server - INFO - üì® ================================================
2026-01-10T21:42:12.837931036Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T21:42:12.837933767Z [inf]  100.64.0.5:38988 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:12.837942388Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T21:42:12.837943984Z [err]  2026-01-10 21:42:12,833 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:12.837951271Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T21:42:12.837957348Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚è±Ô∏è [21:42:12.833] ‚è© About to call _process_call_flow_streaming()
2026-01-10T21:42:12.837963098Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚è±Ô∏è [21:42:12.833] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T21:42:12.837969282Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚è±Ô∏è [21:42:12.833] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T21:42:12.837976785Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2026-01-10T21:42:12.837982362Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚è±Ô∏è [21:42:12.833] ‚úÖ Node selected, about to process content...
2026-01-10T21:42:12.837989029Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 4:42 PM EST in content
2026-01-10T21:42:12.837994953Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T21:42:12.837999278Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T21:42:12.838405932Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T21:42:12.838411947Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T21:42:12.838416666Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T21:42:12.838421558Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T21:42:12.838425417Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T21:42:12.838429366Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2026-01-10T21:42:12.838432964Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2026-01-10T21:42:12.838438086Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2026-01-10T21:42:12.838441889Z [err]  2026-01-10 21:42:12,833 - core_calling_service - INFO - ‚è±Ô∏è [21:42:12.833] üìÑ About to process content (mode=script, length=9)
2026-01-10T21:42:12.838446276Z [err]  2026-01-10 21:42:12,834 - core_calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2026-01-10T21:42:12.838449629Z [err]  2026-01-10 21:42:12,834 - server - INFO - üì§ Sentence arrived from LLM: Kendrick?...
2026-01-10T21:42:12.838453096Z [err]  2026-01-10 21:42:12,834 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 484ms
2026-01-10T21:42:12.838457062Z [err]  2026-01-10 21:42:12,834 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T21:42:12.838460654Z [err]  2026-01-10 21:42:12,834 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:hdzgV-VgJHW4_6v3-... (active sessions: [])
2026-01-10T21:42:12.839310515Z [err]  2026-01-10 21:42:12,834 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2026-01-10T21:42:12.924600805Z [err]  2026-01-10 21:42:12,922 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:13.035572928Z [err]  2026-01-10 21:42:13,009 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:13.098979507Z [err]  2026-01-10 21:42:13,096 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:13.124143142Z [err]  2026-01-10 21:42:13,119 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:13.124146914Z [err]  2026-01-10 21:42:13,119 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2026-01-10T21:42:13.124152770Z [err]  2026-01-10 21:42:13,119 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-10T21:42:13.124158545Z [err]  2026-01-10 21:42:13,119 - persistent_tts_service - INFO - üîå [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Establishing persistent TTS WebSocket...
2026-01-10T21:42:13.124162565Z [err]  2026-01-10 21:42:13,119 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-10T21:42:13.124166472Z [err]  2026-01-10 21:42:13,120 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2026-01-10T21:42:13.124170444Z [err]  2026-01-10 21:42:13,120 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2026-01-10T21:42:13.332631480Z [err]  2026-01-10 21:42:13,246 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2026-01-10T21:42:13.332636836Z [err]  2026-01-10 21:42:13,246 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2026-01-10T21:42:13.332641343Z [err]  2026-01-10 21:42:13,246 - persistent_tts_service - INFO - ‚úÖ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Persistent TTS WebSocket established
2026-01-10T21:42:13.332645765Z [err]  2026-01-10 21:42:13,246 - persistent_tts_service - INFO - üéß [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Continuous audio receiver started
2026-01-10T21:42:13.332651642Z [err]  2026-01-10 21:42:13,246 - persistent_tts_service - INFO - üîä [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Comfort noise loop started
2026-01-10T21:42:13.332656162Z [err]  2026-01-10 21:42:13,246 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:13.332661066Z [err]  2026-01-10 21:42:13,246 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2026-01-10T21:42:13.332665414Z [err]  2026-01-10 21:42:13,246 - server - INFO - üîç Persistent TTS lookup: call_id=v3:hdzgV-VgJHW4_6v3-..., session=FOUND
2026-01-10T21:42:13.332669147Z [err]  2026-01-10 21:42:13,246 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T21:42:13.332673116Z [err]  2026-01-10 21:42:13,246 - server - INFO - üéµ TTS task #1 started at +412ms
2026-01-10T21:42:13.332677396Z [err]  2026-01-10 21:42:13,246 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 897ms
2026-01-10T21:42:13.332682375Z [err]  2026-01-10 21:42:13,246 - core_calling_service - INFO - üì§ Streamed script sentence 1/1: Kendrick?...
2026-01-10T21:42:13.332686146Z [err]  2026-01-10 21:42:13,246 - core_calling_service - INFO - üîä Silence tracking reset for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (user responded)
2026-01-10T21:42:13.339105406Z [err]  2026-01-10 21:42:13,246 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T21:42:13.339114381Z [err]  2026-01-10 21:42:13,246 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2026-01-10T21:42:13.339120515Z [err]  2026-01-10 21:42:13,246 - core_calling_service - INFO - LLM response (0.80s): Kendrick?
2026-01-10T21:42:13.339125896Z [err]  2026-01-10 21:42:13,246 - core_calling_service - INFO - Total latency: 0.80s
2026-01-10T21:42:13.339130362Z [err]  2026-01-10 21:42:13,247 - server - INFO - ‚úÖ LLM finished in 898ms, TTS tasks already running in background
2026-01-10T21:42:13.339135602Z [err]  2026-01-10 21:42:13,248 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2026-01-10T21:42:13.339140290Z [err]  2026-01-10 21:42:13,248 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T21:42:13.339144624Z [err]  2026-01-10 21:42:13,248 - server - INFO -    1 sentences queued and playing seamlessly
2026-01-10T21:42:13.339149763Z [err]  2026-01-10 21:42:13,248 - persistent_tts_service - INFO - üéµ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Playback consumer started
2026-01-10T21:42:13.339154141Z [err]  2026-01-10 21:42:13,248 - persistent_tts_service - INFO - üéß [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Continuous Audio Receiver STARTED
2026-01-10T21:42:13.339158766Z [err]  2026-01-10 21:42:13,248 - persistent_tts_service - INFO - üíì [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Starting TTS keep-alive loop (every 15s)
2026-01-10T21:42:13.339164722Z [err]  2026-01-10 21:42:13,249 - persistent_tts_service - INFO - üîä [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Starting comfort noise loop
2026-01-10T21:42:13.339169587Z [err]  2026-01-10 21:42:13,249 - persistent_tts_service - INFO - üé§ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Streaming sentence #1: Kendrick?...
2026-01-10T21:42:13.339173679Z [err]  2026-01-10 21:42:13,249 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T21:42:13.339177734Z [err]  2026-01-10 21:42:13,249 - persistent_tts_service - INFO - üöÄ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent sentence #1 to ElevenLabs in 0ms (non-blocking)
2026-01-10T21:42:13.339181745Z [err]  2026-01-10 21:42:13,249 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'Kendrick?...'
2026-01-10T21:42:13.339185793Z [err]  2026-01-10 21:42:13,249 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2026-01-10T21:42:13.339193204Z [err]  2026-01-10 21:42:13,249 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T21:42:13.339199274Z [err]  2026-01-10 21:42:13,249 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 900ms from user stop üöÄ
2026-01-10T21:42:13.339207185Z [err]  2026-01-10 21:42:13,249 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:13.339213190Z [err]  2026-01-10 21:42:13,249 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T21:42:13.339219066Z [err]  2026-01-10 21:42:13,249 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T21:42:13.339226132Z [err]  2026-01-10 21:42:13,249 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T21:42:13.339233959Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 9ms (provider: soniox, model: stt-rt-v3)
2026-01-10T21:42:13.339240166Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 898ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T21:42:13.339246017Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 415ms (provider: elevenlabs, websocket: False)
2026-01-10T21:42:13.339252266Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 900ms (user stopped ‚Üí play_audio_url called)
2026-01-10T21:42:13.339262193Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T21:42:13.339267735Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T21:42:13.339271649Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T21:42:13.339276369Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T21:42:13.339283814Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T21:42:13.339289548Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1200ms estimated
2026-01-10T21:42:13.339296089Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2026-01-10T21:42:13.339301674Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hell o....'
2026-01-10T21:42:13.339307538Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Kendrick?...'
2026-01-10T21:42:13.339314681Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T21:42:13.339321469Z [err]  2026-01-10 21:42:13,250 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T21:42:13.451643453Z [err]  2026-01-10 21:42:13,438 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1322ms)
2026-01-10T21:42:13.451651069Z [err]  2026-01-10 21:42:13,439 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T21:42:13.451657541Z [err]  2026-01-10 21:42:13,439 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T21:42:13.475599824Z [err]  2026-01-10 21:42:13,470 - persistent_tts_service - INFO - üìä [REAL TIMING] ElevenLabs FIRST AUDIO CHUNK received (chunk #1, 7043 bytes)
2026-01-10T21:42:13.475605479Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - üìä [REAL TIMING] PLAYBACK CONSUMER: First chunk arrived, queue latency: 0ms
2026-01-10T21:42:13.475611261Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 221ms
2026-01-10T21:42:13.475619538Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - üì§ Sending 7043 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2026-01-10T21:42:13.475632410Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:13.475638827Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T21:42:13.475645134Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2026-01-10T21:42:13.475652096Z [err]  2026-01-10 21:42:13,471 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081333.471 (chunk 1/45, 160 bytes)
2026-01-10T21:42:13.843595865Z [err]  2026-01-10 21:42:13,792 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:13.843601669Z [err]  2026-01-10 21:42:13,792 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'ab54ebc4-4d32-4ed2-b64e-ac1bae2cb1e5', 'occurred_at': '2026-01-10T21:42:13.329318Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:13.843607282Z [err]  2026-01-10 21:42:13,792 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:13.843612750Z [err]  2026-01-10 21:42:13,792 - server - INFO - üì® ================================================
2026-01-10T21:42:13.843618703Z [inf]  100.64.0.8:32018 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:13.850916521Z [err]  2026-01-10 21:42:13,843 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:13.850934633Z [err]  2026-01-10 21:42:13,843 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout: User already spoke, skipping greeting
2026-01-10T21:42:14.128903884Z [err]  2026-01-10 21:42:14,127 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 45 CHUNKS SENT TO TELNYX in 655ms (audio duration: 0.9s, paced after 10 chunks)
2026-01-10T21:42:14.128916850Z [err]  2026-01-10 21:42:14,127 - persistent_tts_service - INFO - ‚úÖ Sent 45 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:14.556631668Z [err]  2026-01-10 21:42:14,541 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.2s ago), marking agent as done speaking
2026-01-10T21:42:14.556640527Z [err]  2026-01-10 21:42:14,541 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081334.5414634 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:14.556647273Z [err]  2026-01-10 21:42:14,541 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:14.631175168Z [err]  2026-01-10 21:42:14,627 - persistent_tts_service - INFO - üîá [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T21:42:16.498343079Z [err]  2026-01-10 21:42:16,495 - server - INFO - üì§ Audio flowing: 304 packets sent to Soniox (5s update)
2026-01-10T21:42:16.522220273Z [err]  2026-01-10 21:42:16,510 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2026-01-10T21:42:16.522231220Z [err]  2026-01-10 21:42:16,511 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.522240103Z [err]  2026-01-10 21:42:16,511 - core_calling_service - INFO - üîä Silence timer reset for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (user started speaking)
2026-01-10T21:42:16.522247891Z [err]  2026-01-10 21:42:16,511 - core_calling_service - INFO - üë§ User started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.522255291Z [err]  2026-01-10 21:42:16,511 - persistent_tts_service - INFO - ‚ö° [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T21:42:16.522267628Z [err]  2026-01-10 21:42:16,511 - persistent_tts_service - INFO - üõë [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T21:42:16.543940634Z [err]  2026-01-10 21:42:16,543 - persistent_tts_service - INFO - üõë [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T21:42:16.543952673Z [err]  2026-01-10 21:42:16,543 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Reset playback_expected_end_time to NOW
2026-01-10T21:42:16.543961754Z [err]  2026-01-10 21:42:16,543 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.549587199Z [err]  2026-01-10 21:42:16,548 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.555056797Z [err]  2026-01-10 21:42:16,553 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:16.555066881Z [err]  2026-01-10 21:42:16,554 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2026-01-10T21:42:16.741523419Z [err]  2026-01-10 21:42:16,690 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2026-01-10T21:42:16.741531677Z [err]  2026-01-10 21:42:16,690 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T21:42:16.741536160Z [err]  2026-01-10 21:42:16,690 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2026-01-10T21:42:16.741540873Z [err]  2026-01-10 21:42:16,690 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2026-01-10T21:42:16.741564463Z [err]  2026-01-10 21:42:16,690 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2026-01-10T21:42:16.741570786Z [err]  2026-01-10 21:42:16,690 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.1s, generating=False, playbacks=0, is_active=False
2026-01-10T21:42:16.741574655Z [err]  2026-01-10 21:42:16,691 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T21:42:16.741578374Z [err]  2026-01-10 21:42:16,691 - server - INFO - ‚è±Ô∏è [21:42:16.691] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2026-01-10T21:42:16.741582457Z [err]  2026-01-10 21:42:16,691 - server - INFO - ‚è±Ô∏è [21:42:16.691] STT endpoint detection latency: 12ms
2026-01-10T21:42:16.741586209Z [err]  2026-01-10 21:42:16,691 - server - INFO - ‚è±Ô∏è [21:42:16.691] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T21:42:16.741589779Z [err]  2026-01-10 21:42:16,691 - server - INFO - ‚è±Ô∏è User spoke at 1768081336.6912618
2026-01-10T21:42:16.741593350Z [err]  2026-01-10 21:42:16,696 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:16.741597185Z [err]  2026-01-10 21:42:16,696 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T21:42:16.741601009Z [err]  2026-01-10 21:42:16,696 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2026-01-10T21:42:16.742467085Z [err]  2026-01-10 21:42:16,707 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 0ms
2026-01-10T21:42:16.742472785Z [err]  2026-01-10 21:42:16,707 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2026-01-10T21:42:16.742477068Z [err]  2026-01-10 21:42:16,707 - core_calling_service - INFO - üë§ User stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.742482535Z [err]  2026-01-10 21:42:16,710 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T21:42:16.742486660Z [err]  2026-01-10 21:42:16,710 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T21:42:16.742490760Z [err]  2026-01-10 21:42:16,710 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+13ms
2026-01-10T21:42:16.742494743Z [err]  2026-01-10 21:42:16,710 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 13ms (Soniox model: stt-rt-v3)
2026-01-10T21:42:16.742499217Z [err]  2026-01-10 21:42:16,710 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T21:42:16.742503227Z [err]  2026-01-10 21:42:16,710 - server - INFO - üìä [REAL TIMING] Processing start: 32ms after user audio end
2026-01-10T21:42:16.742507425Z [err]  2026-01-10 21:42:16,710 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T21:42:16.742511689Z [err]  2026-01-10 21:42:16,710 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.806948455Z [err]  2026-01-10 21:42:16,805 - server - INFO - üìù Saved user transcript to database
2026-01-10T21:42:16.806967048Z [err]  2026-01-10 21:42:16,805 - persistent_tts_service - INFO - üîÑ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Interrupt flag reset - ready for new audio
2026-01-10T21:42:16.806981565Z [err]  2026-01-10 21:42:16,805 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T21:42:16.806996744Z [err]  2026-01-10 21:42:16,805 - core_calling_service - INFO - ‚è±Ô∏è [21:42:16.805] üì• process_user_input() ENTRY - text: 'Yeah....'
2026-01-10T21:42:16.815386137Z [err]  2026-01-10 21:42:16,811 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:16.815393293Z [err]  2026-01-10 21:42:16,811 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: User spoke while Silence Greeting was triggering
2026-01-10T21:42:16.840885655Z [err]  2026-01-10 21:42:16,840 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:16.840894653Z [err]  2026-01-10 21:42:16,840 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:17.096942106Z [err]  2026-01-10 21:42:17,095 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T21:42:17.098643143Z [err]  2026-01-10 21:42:17,096 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T21:42:17.098650903Z [err]  2026-01-10 21:42:17,096 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T21:42:17.098656194Z [err]  2026-01-10 21:42:17,097 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T21:42:17.104159906Z [err]  2026-01-10 21:42:17,102 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:17.110303095Z [err]  2026-01-10 21:42:17,108 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:17.110312701Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T21:42:17.110321023Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚è±Ô∏è [21:42:17.108] ‚è© About to call _process_call_flow_streaming()
2026-01-10T21:42:17.110328990Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚è±Ô∏è [21:42:17.108] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T21:42:17.110337603Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚è±Ô∏è [21:42:17.108] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T21:42:17.110346255Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - Flow processing - History length: 3, Is first: False
2026-01-10T21:42:17.110353429Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 2
2026-01-10T21:42:17.110359290Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚è±Ô∏è [21:42:17.108] üöÄ Checking special cases before merged transition+response...
2026-01-10T21:42:17.110364130Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîç Checking 'Hello=Yes' override for msg='yeah' on node='Greeting'
2026-01-10T21:42:17.110369464Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚ö° OVERRIDE TRIGGERED: 'Yeah.' on Greeting node -> Forcing Transition 0
2026-01-10T21:42:17.110374279Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - ‚è±Ô∏è [21:42:17.108] ‚úÖ Node selected, about to process content...
2026-01-10T21:42:17.110379633Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 4:42 PM EST in content
2026-01-10T21:42:17.110384197Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T21:42:17.112139880Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T21:42:17.112148080Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T21:42:17.112148363Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2026-01-10T21:42:17.112152437Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T21:42:17.112156265Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T21:42:17.112160517Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T21:42:17.112165498Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T21:42:17.112170016Z [err]  2026-01-10 21:42:17,109 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2026-01-10T21:42:17.112170482Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T21:42:17.112175602Z [err]  2026-01-10 21:42:17,108 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T21:42:17.112179457Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2026-01-10T21:42:17.112185176Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2026-01-10T21:42:17.112189045Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - ‚è±Ô∏è [21:42:17.109] üìÑ About to process content (mode=script, length=89)
2026-01-10T21:42:17.113120655Z [err]  2026-01-10 21:42:17,109 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 399ms
2026-01-10T21:42:17.113128900Z [err]  2026-01-10 21:42:17,109 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T21:42:17.113134313Z [err]  2026-01-10 21:42:17,109 - server - INFO - üîç Persistent TTS lookup: call_id=v3:hdzgV-VgJHW4_6v3-..., session=FOUND
2026-01-10T21:42:17.113139115Z [err]  2026-01-10 21:42:17,109 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T21:42:17.113143864Z [err]  2026-01-10 21:42:17,109 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T21:42:17.113152169Z [err]  2026-01-10 21:42:17,109 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 399ms
2026-01-10T21:42:17.113161463Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2026-01-10T21:42:17.113169129Z [err]  2026-01-10 21:42:17,109 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2026-01-10T21:42:17.113176663Z [err]  2026-01-10 21:42:17,109 - server - INFO - üîç Persistent TTS lookup: call_id=v3:hdzgV-VgJHW4_6v3-..., session=FOUND
2026-01-10T21:42:17.113183697Z [err]  2026-01-10 21:42:17,109 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T21:42:17.113191084Z [err]  2026-01-10 21:42:17,109 - server - INFO - üéµ TTS task #2 started at +0ms
2026-01-10T21:42:17.113197369Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2026-01-10T21:42:17.113204178Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - üîä Silence tracking reset for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (user responded)
2026-01-10T21:42:17.113211552Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T21:42:17.114400173Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2026-01-10T21:42:17.114407233Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - LLM response (0.30s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2026-01-10T21:42:17.114414687Z [err]  2026-01-10 21:42:17,109 - core_calling_service - INFO - Total latency: 0.30s
2026-01-10T21:42:17.114420190Z [err]  2026-01-10 21:42:17,110 - server - INFO - ‚úÖ LLM finished in 400ms, TTS tasks already running in background
2026-01-10T21:42:17.114424985Z [err]  2026-01-10 21:42:17,111 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T21:42:17.114429786Z [err]  2026-01-10 21:42:17,111 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T21:42:17.114434368Z [err]  2026-01-10 21:42:17,111 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T21:42:17.114439284Z [err]  2026-01-10 21:42:17,111 - persistent_tts_service - INFO - üé§ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Streaming sentence #2: This is Jake......
2026-01-10T21:42:17.114444285Z [err]  2026-01-10 21:42:17,111 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T21:42:17.114449153Z [err]  2026-01-10 21:42:17,111 - persistent_tts_service - INFO - üöÄ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent sentence #2 to ElevenLabs in 0ms (non-blocking)
2026-01-10T21:42:17.114453948Z [err]  2026-01-10 21:42:17,111 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'This is Jake......'
2026-01-10T21:42:17.114458679Z [err]  2026-01-10 21:42:17,111 - persistent_tts_service - INFO - üé§ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2026-01-10T21:42:17.115635571Z [err]  2026-01-10 21:42:17,111 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T21:42:17.115645292Z [err]  2026-01-10 21:42:17,112 - persistent_tts_service - INFO - üöÄ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent sentence #3 to ElevenLabs in 0ms (non-blocking)
2026-01-10T21:42:17.115651717Z [err]  2026-01-10 21:42:17,112 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'I was just, um, wondering if you could possibly he...'
2026-01-10T21:42:17.115658075Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T21:42:17.115664297Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T21:42:17.115670576Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 402ms from user stop üöÄ
2026-01-10T21:42:17.115676923Z [err]  2026-01-10 21:42:17,112 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:17.115682879Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T21:42:17.115689172Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T21:42:17.115695773Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T21:42:17.115702121Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 13ms (provider: soniox, model: stt-rt-v3)
2026-01-10T21:42:17.115707870Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 400ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T21:42:17.117035122Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 3ms (provider: elevenlabs, websocket: False)
2026-01-10T21:42:17.117045659Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 402ms (user stopped ‚Üí play_audio_url called)
2026-01-10T21:42:17.117053723Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T21:42:17.117060080Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T21:42:17.117079221Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T21:42:17.117085295Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T21:42:17.117092503Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T21:42:17.117097600Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 702ms estimated
2026-01-10T21:42:17.117104482Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2026-01-10T21:42:17.117112789Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2026-01-10T21:42:17.117117855Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2026-01-10T21:42:17.117129700Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T21:42:17.117135189Z [err]  2026-01-10 21:42:17,112 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T21:42:17.421417976Z [err]  2026-01-10 21:42:17,301 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 416ms)
2026-01-10T21:42:17.421424969Z [err]  2026-01-10 21:42:17,301 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T21:42:17.421430775Z [err]  2026-01-10 21:42:17,301 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T21:42:17.582431802Z [err]  2026-01-10 21:42:17,580 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (1.0s ago), marking agent as done speaking
2026-01-10T21:42:17.582439172Z [err]  2026-01-10 21:42:17,580 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081337.5807972 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:17.582447263Z [err]  2026-01-10 21:42:17,580 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:17.639375690Z [err]  2026-01-10 21:42:17,638 - persistent_tts_service - INFO - üì§ Sending 8173 bytes of audio (52 chunks, 1.0s duration) via WebSocket
2026-01-10T21:42:17.639381843Z [err]  2026-01-10 21:42:17,638 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:17.641696560Z [err]  2026-01-10 21:42:17,638 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T21:42:17.641707556Z [err]  2026-01-10 21:42:17,638 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.0s (total: 1.0s from now)
2026-01-10T21:42:17.641713563Z [err]  2026-01-10 21:42:17,638 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081337.639 (chunk 1/52, 160 bytes)
2026-01-10T21:42:18.413041077Z [err]  2026-01-10 21:42:18,408 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 52 CHUNKS SENT TO TELNYX in 770ms (audio duration: 1.0s, paced after 10 chunks)
2026-01-10T21:42:18.413049806Z [err]  2026-01-10 21:42:18,409 - persistent_tts_service - INFO - ‚úÖ Sent 52 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:18.413056021Z [err]  2026-01-10 21:42:18,409 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T21:42:18.413062550Z [err]  2026-01-10 21:42:18,409 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:18.413068514Z [err]  2026-01-10 21:42:18,409 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.0s from now)
2026-01-10T21:42:18.413075108Z [err]  2026-01-10 21:42:18,409 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081338.409 (chunk 1/87, 160 bytes)
2026-01-10T21:42:19.904525995Z [err]  2026-01-10 21:42:19,814 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1405ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T21:42:19.904530505Z [err]  2026-01-10 21:42:19,814 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:19.904535888Z [err]  2026-01-10 21:42:19,815 - persistent_tts_service - INFO - üì§ Sending 1811 bytes of audio (12 chunks, 0.2s duration) via WebSocket
2026-01-10T21:42:19.904541193Z [err]  2026-01-10 21:42:19,815 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:19.904545646Z [err]  2026-01-10 21:42:19,815 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.2s (total: 0.8s from now)
2026-01-10T21:42:19.904550670Z [err]  2026-01-10 21:42:19,815 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081339.815 (chunk 1/12, 160 bytes)
2026-01-10T21:42:19.904555560Z [err]  2026-01-10 21:42:19,851 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 12 CHUNKS SENT TO TELNYX in 36ms (audio duration: 0.2s, paced after 10 chunks)
2026-01-10T21:42:19.904560102Z [err]  2026-01-10 21:42:19,851 - persistent_tts_service - INFO - ‚úÖ Sent 12 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:19.904564960Z [err]  2026-01-10 21:42:19,851 - persistent_tts_service - INFO - üì§ Sending 18948 bytes of audio (119 chunks, 2.4s duration) via WebSocket
2026-01-10T21:42:19.904569426Z [err]  2026-01-10 21:42:19,851 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:19.904573896Z [err]  2026-01-10 21:42:19,851 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.4s (total: 3.1s from now)
2026-01-10T21:42:19.910264512Z [err]  2026-01-10 21:42:19,851 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081339.852 (chunk 1/119, 160 bytes)
2026-01-10T21:42:20.126318117Z [err]  2026-01-10 21:42:20,110 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.9s left)
2026-01-10T21:42:20.618657619Z [err]  2026-01-10 21:42:20,616 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.4s left)
2026-01-10T21:42:21.519201256Z [err]  2026-01-10 21:42:21,515 - server - INFO - üì§ Audio flowing: 553 packets sent to Soniox (5s update)
2026-01-10T21:42:21.858873813Z [err]  2026-01-10 21:42:21,857 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 119 CHUNKS SENT TO TELNYX in 2005ms (audio duration: 2.4s, paced after 10 chunks)
2026-01-10T21:42:21.858880705Z [err]  2026-01-10 21:42:21,857 - persistent_tts_service - INFO - ‚úÖ Sent 119 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:22.392305577Z [err]  2026-01-10 21:42:22,211 - server - INFO - üé§ Soniox receiver alive - 13 messages received in last 10s
2026-01-10T21:42:23.395909095Z [err]  2026-01-10 21:42:23,279 - persistent_tts_service - INFO - üîá [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T21:42:24.681180724Z [err]  2026-01-10 21:42:24,667 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2026-01-10T21:42:24.681186576Z [err]  2026-01-10 21:42:24,672 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-10T21:42:24.681190675Z [err]  2026-01-10 21:42:24,672 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2026-01-10T21:42:24.681194877Z [err]  2026-01-10 21:42:24,672 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:24.681198427Z [err]  2026-01-10 21:42:24,672 - telnyx_service - INFO - üîä Speaking text on call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: Are you still there?...
2026-01-10T21:42:24.681201970Z [err]  2026-01-10 21:42:24,672 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T21:42:24.681205410Z [err]  2026-01-10 21:42:24,672 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T21:42:24.681209234Z [err]  2026-01-10 21:42:24,672 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T21:42:24.681213189Z [err]  2026-01-10 21:42:24,672 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T21:42:24.681217295Z [err]  2026-01-10 21:42:24,672 - server - INFO - ‚è±Ô∏è [21:42:24.672] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2026-01-10T21:42:24.681221389Z [err]  2026-01-10 21:42:24,672 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2026-01-10T21:42:24.681225009Z [err]  2026-01-10 21:42:24,672 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2026-01-10T21:42:24.762224747Z [err]  2026-01-10 21:42:24,759 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:24.762225786Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Timeout: 10.0s
2026-01-10T21:42:24.762233322Z [err]  2026-01-10 21:42:24,760 - server - INFO - üì¶ ElevenLabs Request Payload:
2026-01-10T21:42:24.762239070Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Text length: 20 chars
2026-01-10T21:42:24.762242960Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Text content: 'Are you still there?'
2026-01-10T21:42:24.762248337Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Text bytes: b'Are you still there?'
2026-01-10T21:42:24.762253022Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Model: eleven_turbo_v2_5
2026-01-10T21:42:24.762257682Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2026-01-10T21:42:24.762262173Z [err]  2026-01-10 21:42:24,760 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2026-01-10T21:42:24.762268450Z [err]  2026-01-10 21:42:24,760 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2026-01-10T21:42:24.762274662Z [err]  2026-01-10 21:42:24,760 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2026-01-10T21:42:24.774109095Z [err]  2026-01-10 21:42:24,768 - server - INFO -    ‚úì HTTP client created (0.008s)
2026-01-10T21:42:24.774112942Z [err]  2026-01-10 21:42:24,768 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2026-01-10T21:42:25.085247396Z [err]  2026-01-10 21:42:25,075 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.40s
2026-01-10T21:42:25.085258711Z [err]  2026-01-10 21:42:25,067 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2026-01-10T21:42:25.085262311Z [err]  2026-01-10 21:42:25,067 - server - INFO -    ‚úì Connection established (0.307s) [TARGET: <200ms]
2026-01-10T21:42:25.085266041Z [err]  2026-01-10 21:42:25,067 - server - INFO -    ‚úì Response status: 200
2026-01-10T21:42:25.085269643Z [err]  2026-01-10 21:42:25,067 - server - INFO -    ‚Üí Streaming audio chunks...
2026-01-10T21:42:25.085274916Z [err]  2026-01-10 21:42:25,072 - server - INFO -    ‚úì FIRST CHUNK received (0.312s, 938 bytes) [TARGET: <300ms]
2026-01-10T21:42:25.085280376Z [err]  2026-01-10 21:42:25,075 - server - INFO -    ‚úì ALL CHUNKS received: 74 chunks (0.315s)
2026-01-10T21:42:25.085284129Z [err]  2026-01-10 21:42:25,075 - server - INFO -    ‚úì Total audio size: 17599 bytes
2026-01-10T21:42:25.085287969Z [err]  2026-01-10 21:42:25,075 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2026-01-10T21:42:25.085291655Z [err]  2026-01-10 21:42:25,075 - server - INFO -       - Connection: 307ms
2026-01-10T21:42:25.085295094Z [err]  2026-01-10 21:42:25,075 - server - INFO -       - First chunk: 312ms
2026-01-10T21:42:25.085298868Z [err]  2026-01-10 21:42:25,075 - server - INFO -       - All chunks: 315ms
2026-01-10T21:42:25.085302341Z [err]  2026-01-10 21:42:25,075 - server - INFO -       - Audio generation only: 5ms
2026-01-10T21:42:25.085305991Z [err]  2026-01-10 21:42:25,075 - server - INFO - ‚è±Ô∏è [21:42:25.075] üîä TTS COMPLETE: 402ms, audio_size=17599 bytes
2026-01-10T21:42:25.085309764Z [err]  2026-01-10 21:42:25,075 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2026-01-10T21:42:25.087651731Z [err]  2026-01-10 21:42:25,086 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T21:42:25.087658007Z [err]  2026-01-10 21:42:25,086 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T21:42:25.445831824Z [err]  2026-01-10 21:42:25,386 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_start "HTTP/1.1 200 OK"
2026-01-10T21:42:25.445837734Z [err]  2026-01-10 21:42:25,387 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.30s
2026-01-10T21:42:25.445845016Z [err]  2026-01-10 21:42:25,387 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.72s
2026-01-10T21:42:25.445853757Z [err]  2026-01-10 21:42:25,387 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2026-01-10T21:42:25.445861510Z [err]  2026-01-10 21:42:25,387 - telnyx_service - INFO - üé¨ Playback ID: lZFbWC6Dtw
2026-01-10T21:42:25.445867580Z [err]  2026-01-10 21:42:25,398 - redis_service - INFO - ‚ûï Added playback lZFbWC6Dtw to Redis for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:25.445878079Z [err]  2026-01-10 21:42:25,398 - server - INFO - üé¨ Check-in playback ID: lZFbWC6Dtw (expected duration: 2.6s)
2026-01-10T21:42:25.445884931Z [err]  2026-01-10 21:42:25,398 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T21:42:25.910970229Z [err]  2026-01-10 21:42:25,909 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.1s left)
2026-01-10T21:42:25.916664261Z [err]  2026-01-10 21:42:25,913 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:25.916672646Z [err]  2026-01-10 21:42:25,913 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '9eb52819-09ef-4cbc-acc7-1bf7d142b642', 'occurred_at': '2026-01-10T21:42:25.469330Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3', 'overlay': False, 'playback_id': 'lZFbWC6Dtw'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:25.916677461Z [err]  2026-01-10 21:42:25,913 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:25.916681125Z [err]  2026-01-10 21:42:25,913 - server - INFO - üì® ================================================
2026-01-10T21:42:25.916685004Z [inf]  100.64.0.9:13036 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:26.100254906Z [err]  2026-01-10 21:42:26,099 - server - INFO - üî§ RAW TOKENS: [" S"?]
2026-01-10T21:42:26.100260895Z [err]  2026-01-10 21:42:26,099 - core_calling_service - INFO - üîä Silence timer reset for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (user started speaking)
2026-01-10T21:42:26.100265528Z [err]  2026-01-10 21:42:26,099 - core_calling_service - INFO - üë§ User started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.100270088Z [err]  2026-01-10 21:42:26,099 - persistent_tts_service - INFO - ‚ö° [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T21:42:26.100274446Z [err]  2026-01-10 21:42:26,099 - persistent_tts_service - INFO - üõë [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T21:42:26.131842348Z [err]  2026-01-10 21:42:26,130 - persistent_tts_service - INFO - üõë [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T21:42:26.131848709Z [err]  2026-01-10 21:42:26,130 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Reset playback_expected_end_time to NOW
2026-01-10T21:42:26.131852736Z [err]  2026-01-10 21:42:26,130 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.138278136Z [err]  2026-01-10 21:42:26,136 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.151192094Z [err]  2026-01-10 21:42:26,145 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:26.151200384Z [err]  2026-01-10 21:42:26,145 - server - INFO - üîç PARTIAL TRANSCRIPT: 'S' | Generating: False
2026-01-10T21:42:26.245871630Z [err]  2026-01-10 21:42:26,231 - server - INFO - üî§ RAW TOKENS: [" S"?, "ure"?]
2026-01-10T21:42:26.245877194Z [err]  2026-01-10 21:42:26,231 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Sure' | Generating: False
2026-01-10T21:42:26.461502294Z [err]  2026-01-10 21:42:26,301 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T21:42:26.461514875Z [err]  2026-01-10 21:42:26,302 - server - INFO - üßπ Cleaned transcript: ' S ure .' -> 'Sure.'
2026-01-10T21:42:26.461522518Z [err]  2026-01-10 21:42:26,302 - server - INFO - üì• FINAL TOKENS: 'Sure.' (3 tokens)
2026-01-10T21:42:26.461529510Z [err]  2026-01-10 21:42:26,302 - server - INFO - üé§ Soniox final transcript: 'Sure.'
2026-01-10T21:42:26.461536497Z [err]  2026-01-10 21:42:26,302 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.2s, generating=False, playbacks=1, is_active=False
2026-01-10T21:42:26.461545598Z [err]  2026-01-10 21:42:26,302 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T21:42:26.461552512Z [err]  2026-01-10 21:42:26,302 - server - INFO - ‚è±Ô∏è [21:42:26.302] üìù FINAL TRANSCRIPT RECEIVED: 'Sure.'
2026-01-10T21:42:26.461559339Z [err]  2026-01-10 21:42:26,302 - server - INFO - ‚è±Ô∏è [21:42:26.302] STT endpoint detection latency: 7ms
2026-01-10T21:42:26.461565738Z [err]  2026-01-10 21:42:26,302 - server - INFO - ‚è±Ô∏è [21:42:26.302] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T21:42:26.461576396Z [err]  2026-01-10 21:42:26,302 - server - INFO - ‚è±Ô∏è User spoke at 1768081346.302832
2026-01-10T21:42:26.461583596Z [err]  2026-01-10 21:42:26,308 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:26.461589878Z [err]  2026-01-10 21:42:26,308 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T21:42:26.461596306Z [err]  2026-01-10 21:42:26,308 - server - INFO - ‚ö†Ô∏è Agent marked as speaking but audio done and not generating - treating as SILENT
2026-01-10T21:42:26.461762103Z [err]  2026-01-10 21:42:26,301 - server - INFO - üî§ RAW TOKENS: [" S"‚úì, "ure"‚úì, "."‚úì, "<end>"‚úì]
2026-01-10T21:42:26.469701636Z [err]  2026-01-10 21:42:26,308 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Sure.' - Processing...
2026-01-10T21:42:26.469708295Z [err]  2026-01-10 21:42:26,319 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: -8ms
2026-01-10T21:42:26.469714696Z [err]  2026-01-10 21:42:26,319 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Sure.
2026-01-10T21:42:26.469720868Z [err]  2026-01-10 21:42:26,319 - core_calling_service - INFO - üë§ User stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.469726381Z [err]  2026-01-10 21:42:26,319 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T21:42:26.469733976Z [err]  2026-01-10 21:42:26,319 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T21:42:26.469739604Z [err]  2026-01-10 21:42:26,320 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+2ms
2026-01-10T21:42:26.469745803Z [err]  2026-01-10 21:42:26,320 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 2ms (Soniox model: stt-rt-v3)
2026-01-10T21:42:26.469751666Z [err]  2026-01-10 21:42:26,320 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T21:42:26.469757971Z [err]  2026-01-10 21:42:26,320 - server - INFO - üìä [REAL TIMING] Processing start: 24ms after user audio end
2026-01-10T21:42:26.469763437Z [err]  2026-01-10 21:42:26,320 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T21:42:26.469769431Z [err]  2026-01-10 21:42:26,320 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.469775801Z [err]  2026-01-10 21:42:26,422 - server - INFO - üìù Saved user transcript to database
2026-01-10T21:42:26.469782591Z [err]  2026-01-10 21:42:26,422 - persistent_tts_service - INFO - üîÑ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Interrupt flag reset - ready for new audio
2026-01-10T21:42:26.469790118Z [err]  2026-01-10 21:42:26,422 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T21:42:26.469798210Z [err]  2026-01-10 21:42:26,422 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.422] üì• process_user_input() ENTRY - text: 'Sure....'
2026-01-10T21:42:26.469807699Z [err]  2026-01-10 21:42:26,427 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.469814077Z [err]  2026-01-10 21:42:26,428 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: User spoke while Silence Greeting was triggering
2026-01-10T21:42:26.469820828Z [err]  2026-01-10 21:42:26,460 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T21:42:26.469827890Z [err]  2026-01-10 21:42:26,460 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.539831488Z [err]  2026-01-10 21:42:26,535 - server - INFO - üì§ Audio flowing: 803 packets sent to Soniox (5s update)
2026-01-10T21:42:26.907809178Z [err]  2026-01-10 21:42:26,833 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T21:42:26.907815969Z [err]  2026-01-10 21:42:26,834 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T21:42:26.907821461Z [err]  2026-01-10 21:42:26,835 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T21:42:26.907826948Z [err]  2026-01-10 21:42:26,835 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T21:42:26.907831626Z [err]  2026-01-10 21:42:26,840 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.907836172Z [err]  2026-01-10 21:42:26,845 - redis_service - INFO - üì¶ Stored call data in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (TTL: 3600s)
2026-01-10T21:42:26.907842817Z [err]  2026-01-10 21:42:26,845 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T21:42:26.907847651Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.846] ‚è© About to call _process_call_flow_streaming()
2026-01-10T21:42:26.907852588Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.846] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T21:42:26.907856985Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.846] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T21:42:26.907861023Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - Flow processing - History length: 5, Is first: False
2026-01-10T21:42:26.907865121Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 1763159750250
2026-01-10T21:42:26.907869159Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.846] üöÄ Checking special cases before merged transition+response...
2026-01-10T21:42:26.908667675Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üé§ AUTO-TRANSITION AFTER RESPONSE - user spoke, transitioning to: 1763161849799
2026-01-10T21:42:26.908675709Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚úÖ Auto-transitioned (after response) to: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic
2026-01-10T21:42:26.908680773Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.846] ‚úÖ Node selected, about to process content...
2026-01-10T21:42:26.908686601Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 4:42 PM EST in content
2026-01-10T21:42:26.908691775Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T21:42:26.908696773Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T21:42:26.908704335Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T21:42:26.908709621Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T21:42:26.908714730Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T21:42:26.908719071Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T21:42:26.908723159Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T21:42:26.908727275Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T21:42:26.908731858Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T21:42:26.909761806Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 260 chars) - will return text instantly
2026-01-10T21:42:26.909769171Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - Using flow node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic (type: conversation, mode: script)
2026-01-10T21:42:26.909774499Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - ‚è±Ô∏è [21:42:26.846] üìÑ About to process content (mode=script, length=260)
2026-01-10T21:42:26.909779142Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2026-01-10T21:42:26.909783424Z [err]  2026-01-10 21:42:26,846 - server - INFO - üì§ Sentence arrived from LLM: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T21:42:26.909789098Z [err]  2026-01-10 21:42:26,846 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 526ms
2026-01-10T21:42:26.909796891Z [err]  2026-01-10 21:42:26,846 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T21:42:26.909803899Z [err]  2026-01-10 21:42:26,846 - server - INFO - üîç Persistent TTS lookup: call_id=v3:hdzgV-VgJHW4_6v3-..., session=FOUND
2026-01-10T21:42:26.909810901Z [err]  2026-01-10 21:42:26,846 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T21:42:26.909818027Z [err]  2026-01-10 21:42:26,846 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T21:42:26.909825101Z [err]  2026-01-10 21:42:26,846 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 526ms
2026-01-10T21:42:26.909832988Z [err]  2026-01-10 21:42:26,846 - core_calling_service - INFO - üì§ Streamed script sentence 1/2: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T21:42:26.909839571Z [err]  2026-01-10 21:42:26,847 - server - INFO - üì§ Sentence arrived from LLM: I know this call is out of the blue, but do you ha...
2026-01-10T21:42:26.910871041Z [err]  2026-01-10 21:42:26,847 - server - INFO - üîç Persistent TTS lookup: call_id=v3:hdzgV-VgJHW4_6v3-..., session=FOUND
2026-01-10T21:42:26.910877647Z [err]  2026-01-10 21:42:26,847 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T21:42:26.910881822Z [err]  2026-01-10 21:42:26,847 - server - INFO - üéµ TTS task #2 started at +0ms
2026-01-10T21:42:26.910886184Z [err]  2026-01-10 21:42:26,847 - core_calling_service - INFO - üì§ Streamed script sentence 2/2: I know this call is out of the blue, but do you ha...
2026-01-10T21:42:26.910890370Z [err]  2026-01-10 21:42:26,847 - core_calling_service - INFO - üîä Silence tracking reset for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (user responded)
2026-01-10T21:42:26.910894679Z [err]  2026-01-10 21:42:26,847 - core_calling_service - INFO - ‚úÖ User gave meaningful response to check-in, resetting counter
2026-01-10T21:42:26.910898752Z [err]  2026-01-10 21:42:26,847 - core_calling_service - INFO - üíæ Storing node ID 1763161849799 in conversation history
2026-01-10T21:42:26.910902595Z [err]  2026-01-10 21:42:26,847 - core_calling_service - INFO - LLM response (0.42s): Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stacking income without stacking hours. I know this call is out of the blue, but do you have just 25 seconds for me to explain why I'm reaching out today specifically?
2026-01-10T21:42:26.910906227Z [err]  2026-01-10 21:42:26,847 - core_calling_service - INFO - Total latency: 0.42s
2026-01-10T21:42:26.910909961Z [err]  2026-01-10 21:42:26,847 - server - INFO - ‚úÖ LLM finished in 527ms, TTS tasks already running in background
2026-01-10T21:42:26.910913784Z [err]  2026-01-10 21:42:26,848 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T21:42:26.910917818Z [err]  2026-01-10 21:42:26,848 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T21:42:26.912106045Z [err]  2026-01-10 21:42:26,848 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T21:42:26.912113025Z [err]  2026-01-10 21:42:26,848 - persistent_tts_service - INFO - üé§ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Streaming sentence #4: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T21:42:26.912119090Z [err]  2026-01-10 21:42:26,848 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T21:42:26.912124675Z [err]  2026-01-10 21:42:26,848 - persistent_tts_service - INFO - üöÄ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent sentence #4 to ElevenLabs in 0ms (non-blocking)
2026-01-10T21:42:26.912130462Z [err]  2026-01-10 21:42:26,848 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'Well, uh, I don't know if you could yet, but, I'm ...'
2026-01-10T21:42:26.912135674Z [err]  2026-01-10 21:42:26,848 - persistent_tts_service - INFO - üé§ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Streaming sentence #5: I know this call is out of the blue, but do you ha...
2026-01-10T21:42:26.912141517Z [err]  2026-01-10 21:42:26,848 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T21:42:26.912146748Z [err]  2026-01-10 21:42:26,849 - persistent_tts_service - INFO - üöÄ [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] Sent sentence #5 to ElevenLabs in 0ms (non-blocking)
2026-01-10T21:42:26.912152157Z [err]  2026-01-10 21:42:26,849 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'I know this call is out of the blue, but do you ha...'
2026-01-10T21:42:26.912158056Z [err]  2026-01-10 21:42:26,849 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:26.913315215Z [err]  2026-01-10 21:42:26,849 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '262aded7-08e3-45b6-a7da-edfc4a2c86ac', 'occurred_at': '2026-01-10T21:42:26.569320Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3', 'overlay': False, 'playback_id': 'lZFbWC6Dtw', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:26.913320638Z [err]  2026-01-10 21:42:26,849 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.913324806Z [err]  2026-01-10 21:42:26,849 - server - INFO - üì® ================================================
2026-01-10T21:42:26.913328688Z [err]  2026-01-10 21:42:26,859 - redis_service - INFO - ‚ûñ Removed playback lZFbWC6Dtw, 0 remaining for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.913333105Z [err]  2026-01-10 21:42:26,859 - server - INFO - üîä Redis: Removed playback lZFbWC6Dtw, 0 remaining
2026-01-10T21:42:26.913339175Z [err]  2026-01-10 21:42:26,859 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-10T21:42:26.913343278Z [err]  2026-01-10 21:42:26,859 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2026-01-10T21:42:26.913357211Z [err]  2026-01-10 21:42:26,864 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-10T21:42:26.913361038Z [err]  2026-01-10 21:42:26,864 - server - INFO - ‚úÖ Found session locally: agent_speaking=True, user_speaking=False
2026-01-10T21:42:26.914207192Z [err]  2026-01-10 21:42:26,864 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081346.8648942 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.914216719Z [err]  2026-01-10 21:42:26,864 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.914224391Z [err]  2026-01-10 21:42:26,864 - server - INFO - ‚è±Ô∏è Agent done speaking, silence timer STARTED (local)
2026-01-10T21:42:26.914230541Z [inf]  100.64.0.9:13036 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:26.914236839Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T21:42:26.914246516Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T21:42:26.914253572Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 545ms from user stop üöÄ
2026-01-10T21:42:26.914260106Z [err]  2026-01-10 21:42:26,865 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.914266162Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T21:42:26.914273666Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T21:42:26.914279377Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T21:42:26.914284758Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 2ms (provider: soniox, model: stt-rt-v3)
2026-01-10T21:42:26.914291961Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 527ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T21:42:26.915460243Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 18ms (provider: elevenlabs, websocket: False)
2026-01-10T21:42:26.915467724Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T21:42:26.915468354Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 545ms (user stopped ‚Üí play_audio_url called)
2026-01-10T21:42:26.915488378Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T21:42:26.915494077Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T21:42:26.915500325Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T21:42:26.915509811Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T21:42:26.915515829Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T21:42:26.915521801Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 845ms estimated
2026-01-10T21:42:26.915527875Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 260 chars, 2 sentences
2026-01-10T21:42:26.915533198Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Sure....'
2026-01-10T21:42:26.915538718Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Well, uh, I don't know if you could yet, but, I'm calling be...'
2026-01-10T21:42:26.915547045Z [err]  2026-01-10 21:42:26,865 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T21:42:26.937887716Z [err]  2026-01-10 21:42:26,928 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-10T21:42:26.937893142Z [err]  2026-01-10 21:42:26,928 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081346.9284456 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:26.937897156Z [err]  2026-01-10 21:42:26,928 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:27.080767251Z [err]  2026-01-10 21:42:27,054 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 547ms)
2026-01-10T21:42:27.080775604Z [err]  2026-01-10 21:42:27,054 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T21:42:27.080781717Z [err]  2026-01-10 21:42:27,054 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T21:42:27.240449663Z [err]  2026-01-10 21:42:27,209 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T21:42:27.240458652Z [err]  2026-01-10 21:42:27,209 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:27.240466181Z [err]  2026-01-10 21:42:27,209 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T21:42:27.240473265Z [err]  2026-01-10 21:42:27,209 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2026-01-10T21:42:27.240478996Z [err]  2026-01-10 21:42:27,209 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081347.209 (chunk 1/87, 160 bytes)
2026-01-10T21:42:28.628651176Z [err]  2026-01-10 21:42:28,623 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1414ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T21:42:28.628660494Z [err]  2026-01-10 21:42:28,623 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:28.628667312Z [err]  2026-01-10 21:42:28,623 - persistent_tts_service - INFO - üì§ Sending 3297 bytes of audio (21 chunks, 0.4s duration) via WebSocket
2026-01-10T21:42:28.628673318Z [err]  2026-01-10 21:42:28,623 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:28.628677871Z [err]  2026-01-10 21:42:28,623 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.4s (total: 0.7s from now)
2026-01-10T21:42:28.628682231Z [err]  2026-01-10 21:42:28,623 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081348.624 (chunk 1/21, 160 bytes)
2026-01-10T21:42:28.831744944Z [err]  2026-01-10 21:42:28,830 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 21 CHUNKS SENT TO TELNYX in 206ms (audio duration: 0.4s, paced after 10 chunks)
2026-01-10T21:42:28.831754454Z [err]  2026-01-10 21:42:28,830 - persistent_tts_service - INFO - ‚úÖ Sent 21 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:28.831762653Z [err]  2026-01-10 21:42:28,830 - persistent_tts_service - INFO - üì§ Sending 13375 bytes of audio (84 chunks, 1.7s duration) via WebSocket
2026-01-10T21:42:28.831771883Z [err]  2026-01-10 21:42:28,830 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:28.831778634Z [err]  2026-01-10 21:42:28,830 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.2s from now)
2026-01-10T21:42:28.831785743Z [err]  2026-01-10 21:42:28,830 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081348.830 (chunk 1/84, 160 bytes)
2026-01-10T21:42:30.234155201Z [err]  2026-01-10 21:42:30,192 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 84 CHUNKS SENT TO TELNYX in 1361ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T21:42:30.234159611Z [err]  2026-01-10 21:42:30,192 - persistent_tts_service - INFO - ‚úÖ Sent 84 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:30.234164048Z [err]  2026-01-10 21:42:30,192 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T21:42:30.234169239Z [err]  2026-01-10 21:42:30,192 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:30.234185283Z [err]  2026-01-10 21:42:30,192 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.5s from now)
2026-01-10T21:42:30.234190075Z [err]  2026-01-10 21:42:30,192 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081350.193 (chunk 1/87, 160 bytes)
2026-01-10T21:42:30.475763325Z [err]  2026-01-10 21:42:30,471 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.3s left)
2026-01-10T21:42:30.978573442Z [err]  2026-01-10 21:42:30,977 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.8s left)
2026-01-10T21:42:31.537378955Z [err]  2026-01-10 21:42:31,535 - server - INFO - üì§ Audio flowing: 1050 packets sent to Soniox (5s update)
2026-01-10T21:42:31.679526175Z [err]  2026-01-10 21:42:31,610 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:31.679534821Z [err]  2026-01-10 21:42:31,610 - persistent_tts_service - INFO - üì§ Sending 2182 bytes of audio (14 chunks, 0.3s duration) via WebSocket
2026-01-10T21:42:31.679540678Z [err]  2026-01-10 21:42:31,610 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:31.679545676Z [err]  2026-01-10 21:42:31,610 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.3s (total: 1.4s from now)
2026-01-10T21:42:31.679550229Z [err]  2026-01-10 21:42:31,610 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081351.611 (chunk 1/14, 160 bytes)
2026-01-10T21:42:31.679664318Z [err]  2026-01-10 21:42:31,610 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1417ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T21:42:31.690158106Z [err]  2026-01-10 21:42:31,683 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 14 CHUNKS SENT TO TELNYX in 72ms (audio duration: 0.3s, paced after 10 chunks)
2026-01-10T21:42:31.690164171Z [err]  2026-01-10 21:42:31,683 - persistent_tts_service - INFO - ‚úÖ Sent 14 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:31.690168936Z [err]  2026-01-10 21:42:31,683 - persistent_tts_service - INFO - üì§ Sending 16719 bytes of audio (105 chunks, 2.1s duration) via WebSocket
2026-01-10T21:42:31.690172775Z [err]  2026-01-10 21:42:31,683 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:31.690176999Z [err]  2026-01-10 21:42:31,683 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.1s (total: 3.4s from now)
2026-01-10T21:42:31.690180994Z [err]  2026-01-10 21:42:31,684 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081351.684 (chunk 1/105, 160 bytes)
2026-01-10T21:42:32.764640323Z [err]  2026-01-10 21:42:32,762 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2026-01-10T21:42:33.477239060Z [err]  2026-01-10 21:42:33,427 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 105 CHUNKS SENT TO TELNYX in 1743ms (audio duration: 2.1s, paced after 10 chunks)
2026-01-10T21:42:33.477241459Z [err]  2026-01-10 21:42:33,427 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.2s (total: 2.8s from now)
2026-01-10T21:42:33.477247602Z [err]  2026-01-10 21:42:33,427 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081353.428 (chunk 1/59, 160 bytes)
2026-01-10T21:42:33.477249853Z [err]  2026-01-10 21:42:33,427 - persistent_tts_service - INFO - ‚úÖ Sent 105 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:33.477259028Z [err]  2026-01-10 21:42:33,427 - persistent_tts_service - INFO - üì§ Sending 9288 bytes of audio (59 chunks, 1.2s duration) via WebSocket
2026-01-10T21:42:33.477267561Z [err]  2026-01-10 21:42:33,427 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:34.478612431Z [err]  2026-01-10 21:42:34,328 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 59 CHUNKS SENT TO TELNYX in 900ms (audio duration: 1.2s, paced after 10 chunks)
2026-01-10T21:42:34.478619370Z [err]  2026-01-10 21:42:34,328 - persistent_tts_service - INFO - ‚úÖ Sent 59 audio chunks via WebSocket (paced sending enabled)
2026-01-10T21:42:34.478627283Z [err]  2026-01-10 21:42:34,328 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T21:42:34.478634058Z [err]  2026-01-10 21:42:34,328 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:34.478641488Z [err]  2026-01-10 21:42:34,328 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 3.7s from now)
2026-01-10T21:42:34.478649122Z [err]  2026-01-10 21:42:34,328 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768081354.329 (chunk 1/87, 160 bytes)
2026-01-10T21:42:34.999173082Z [err]  2026-01-10 21:42:34,998 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:34.999183024Z [err]  2026-01-10 21:42:34,998 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '9da89f08-05e2-4f89-a998-1af4abb6ba98', 'occurred_at': '2026-01-10T21:42:34.869317Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T21:42:34.869317Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'I93pcToo-A', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:34.999190914Z [err]  2026-01-10 21:42:34,998 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:34.999198091Z [err]  2026-01-10 21:42:34,998 - server - INFO - üì® ================================================
2026-01-10T21:42:35.011183481Z [err]  2026-01-10 21:42:35,009 - redis_service - INFO - ‚ûñ Removed playback I93pcToo-A, 0 remaining for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:35.011189720Z [err]  2026-01-10 21:42:35,009 - server - INFO - üîä Redis: Removed playback I93pcToo-A, 0 remaining
2026-01-10T21:42:35.011193397Z [err]  2026-01-10 21:42:35,009 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-10T21:42:35.011198887Z [err]  2026-01-10 21:42:35,009 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2026-01-10T21:42:35.016775563Z [err]  2026-01-10 21:42:35,015 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-10T21:42:35.016784886Z [err]  2026-01-10 21:42:35,015 - server - INFO - ‚úÖ Found session locally: agent_speaking=False, user_speaking=False
2026-01-10T21:42:35.016792114Z [err]  2026-01-10 21:42:35,015 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081355.0153313 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:35.016799459Z [err]  2026-01-10 21:42:35,015 - server - INFO - ‚è±Ô∏è Silence timer STARTED (local, agent wasn't marked as speaking)
2026-01-10T21:42:35.016806424Z [inf]  100.64.0.9:13036 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:35.017717592Z [err]  2026-01-10 21:42:35,016 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 1214 total packets
2026-01-10T21:42:35.017726951Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2026-01-10T21:42:35.018628686Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - INFO - üì§ Sending 1440 bytes of audio (9 chunks, 0.2s duration) via WebSocket
2026-01-10T21:42:35.018637056Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:35.018644358Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.2s (total: 0.2s from now)
2026-01-10T21:42:35.018650940Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T21:42:35.018657234Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - INFO - üì§ Sending 27493 bytes of audio (172 chunks, 3.4s duration) via WebSocket
2026-01-10T21:42:35.018663688Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T21:42:35.018671674Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +3.4s (total: 3.6s from now)
2026-01-10T21:42:35.018679032Z [err]  2026-01-10 21:42:35,017 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T21:42:35.018685406Z [err]  [2026-01-10 21:42:35 +0000] [3] [INFO] connection closed
2026-01-10T21:42:35.027854216Z [err]  2026-01-10 21:42:35,026 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.6s left)
2026-01-10T21:42:35.109820948Z [err]  2026-01-10 21:42:35,107 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:35.109829388Z [err]  2026-01-10 21:42:35,107 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '25b5f413-cd93-49d5-9f5e-45586125ac94', 'occurred_at': '2026-01-10T21:42:35.006266Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '4be13cd4-d8f9-4b25-9efc-0b2c9fa24cb7', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:35.109836932Z [err]  2026-01-10 21:42:35,107 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:35.109843505Z [err]  2026-01-10 21:42:35,107 - server - INFO - üì® ================================================
2026-01-10T21:42:35.109851179Z [inf]  100.64.0.4:18868 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:35.179164908Z [err]  2026-01-10 21:42:35,173 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:35.179170294Z [err]  2026-01-10 21:42:35,173 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '3d7abd63-3050-46e1-a017-fb942241771d', 'occurred_at': '2026-01-10T21:42:34.789317Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '29.09', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '1247', 'skip_packet_count': '21'}, 'outbound': {'packet_count': '1219', 'skip_packet_count': '0'}}, 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T21:42:34.789317Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2026-01-10T21:42:07.249318Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:35.179174451Z [err]  2026-01-10 21:42:35,173 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:35.179178286Z [err]  2026-01-10 21:42:35,173 - server - INFO - üì® ================================================
2026-01-10T21:42:35.179182531Z [err]  2026-01-10 21:42:35,173 - server - INFO - üìû Call ended: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:35.179186354Z [err]  2026-01-10 21:42:35,173 - server - INFO - üìû Hangup cause: normal_clearing
2026-01-10T21:42:35.484268653Z [err]  2026-01-10 21:42:35,359 - server - INFO - üìù Updated call log: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:35.484275031Z [err]  2026-01-10 21:42:35,452 - server - INFO - ‚úÖ Finalized call log: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w (duration=24s, status=completed)
2026-01-10T21:42:35.535695774Z [err]  2026-01-10 21:42:35,531 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.1s left)
2026-01-10T21:42:35.557170742Z [err]  2026-01-10 21:42:35,546 - server - INFO - üì¶ Saved 11 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2026-01-10T21:42:36.164151710Z [err]  2026-01-10 21:42:36,160 - server - INFO - üìä Auto-added call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2026-01-10T21:42:36.503285039Z [err]  2026-01-10 21:42:36,342 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T21:42:36.503291887Z [err]  2026-01-10 21:42:36,348 - redis_service - INFO - üì• Retrieved call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.503297792Z [err]  2026-01-10 21:42:36,348 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=Yes
2026-01-10T21:42:36.503304019Z [err]  2026-01-10 21:42:36,348 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2026-01-10T21:42:36.503310468Z [err]  2026-01-10 21:42:36,391 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T21:42:36.503315793Z [err]  2026-01-10 21:42:36,392 - server - WARNING - ‚ö†Ô∏è Post-call webhook returned status 530: <!doctype html>
2026-01-10T21:42:36.503321464Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T21:42:36.503327199Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T21:42:36.503333066Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T21:42:36.503338953Z [err]  2026-01-10 21:42:36,441 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2026-01-10T21:42:36.529636950Z [err]  2026-01-10 21:42:36,527 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2026-01-10T21:42:36.529645446Z [err]  2026-01-10 21:42:36,527 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2026-01-10T21:42:36.529651039Z [err]  2026-01-10 21:42:36,527 - server - INFO - üìá [HANGUP] Agent info keys: None
2026-01-10T21:42:36.529655347Z [err]  2026-01-10 21:42:36,527 - server - INFO - üöÄ Triggered QC analysis for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.529660078Z [err]  2026-01-10 21:42:36,527 - server - INFO - üìä Triggered Campaign QC for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.529664470Z [err]  2026-01-10 21:42:36,527 - server - INFO - üìá Triggered CRM update for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.529669352Z [err]  2026-01-10 21:42:36,528 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.529673413Z [err]  2026-01-10 21:42:36,528 - core_calling_service - INFO - Call session v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w closed
2026-01-10T21:42:36.529677574Z [err]  2026-01-10 21:42:36,528 - server - INFO - ‚úÖ Closed CallSession for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.535875730Z [err]  2026-01-10 21:42:36,533 - redis_service - INFO - üßπ Deleted call data from Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.535885617Z [err]  2026-01-10 21:42:36,533 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.535890871Z [inf]  100.64.0.8:32018 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:36.535898698Z [err]  2026-01-10 21:42:36,533 - server - INFO - üîç Starting QC analysis for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.535903014Z [err]  2026-01-10 21:42:36,534 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2026-01-10T21:42:36.537100502Z [err]  2026-01-10 21:42:36,535 - server - INFO - üìá CRM update starting for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T21:42:36.537106731Z [err]  2026-01-10 21:42:36,535 - server - INFO - üìá Normalized phone: +17708336397
2026-01-10T21:42:36.557701543Z [err]  2026-01-10 21:42:36,555 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T21:42:36.557708692Z [err]  2026-01-10 21:42:36,555 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '28bbbe8d-74bc-43a0-9448-ad8527e42d0a', 'occurred_at': '2026-01-10T21:42:36.358505Z', 'payload': {'call_control_id': 'v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w', 'call_leg_id': '35e966cc-ee6d-11f0-b3af-02420aef941f', 'call_session_id': '35e72b28-ee6d-11f0-91f0-02420aef941f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T21:42:34.876039Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2026-01-10T21:42:34.876039Z', 'recording_id': '6746aff3-1987-4746-a9f2-08db23f10f67', 'recording_started_at': '2026-01-10T21:42:11.118322Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-10/35e966cc-ee6d-11f0-b3af-02420aef941f-1768081331052920.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T214236Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=498514cc189f58785ae049674121b8afb606866df448768bcf3d7b6bb0cc6905'}, 'start_time': '2026-01-10T21:42:11.118322Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T21:42:36.557715303Z [err]  2026-01-10 21:42:36,555 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.557720280Z [err]  2026-01-10 21:42:36,555 - server - INFO - üì® ================================================
2026-01-10T21:42:36.557725255Z [err]  2026-01-10 21:42:36,555 - server - INFO - üéôÔ∏è Recording saved for call: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.562146743Z [err]  2026-01-10 21:42:36,561 - redis_service - WARNING - ‚ö†Ô∏è Call data not found in Redis: v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:36.562154179Z [err]  2026-01-10 21:42:36,561 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=6746aff3-1987-4746-a9f2-08db23f10f67, call_data=False
2026-01-10T21:42:36.638177545Z [err]  2026-01-10 21:42:36,625 - server - INFO - üìù Converted transcript from 6 messages to 431 characters
2026-01-10T21:42:36.662028714Z [err]  2026-01-10 21:42:36,656 - server - INFO - üíæ Saved recording URL and ID to database: 6746aff3-1987-4746-a9f2-08db23f10f67
2026-01-10T21:42:36.662038056Z [err]  2026-01-10 21:42:36,656 - server - INFO - ‚úÖ Entering dual-channel processing
2026-01-10T21:42:36.662045968Z [err]  2026-01-10 21:42:36,656 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2026-01-10T21:42:36.721849569Z [err]  2026-01-10 21:42:36,720 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T21:42:36.808530477Z [err]  2026-01-10 21:42:36,807 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2026-01-10T21:42:36.895180640Z [err]  2026-01-10 21:42:36,893 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2026-01-10T21:42:36.895188969Z [err]  2026-01-10 21:42:36,893 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T21:42:36.895196926Z [err]  2026-01-10 21:42:36,893 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:37.054761204Z [err]  2026-01-10 21:42:37,052 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-10/35e966cc-ee6d-11f0-b3af-02420aef941f-1768081331052920.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T214236Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=498514cc189f58785ae049674121b8afb606866df448768bcf3d7b6bb0cc6905 "HTTP/1.1 200 OK"
2026-01-10T21:42:37.090391941Z [err]  2026-01-10 21:42:37,088 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=6, logs_count=8, status=completed
2026-01-10T21:42:37.114345963Z [err]  2026-01-10 21:42:37,102 - server - INFO - üìá CRM: Got 11 extracted variables
2026-01-10T21:42:37.114352996Z [err]  2026-01-10 21:42:37,102 - server - INFO - üìá CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2026-01-10T21:42:37.275182735Z [err]  2026-01-10 21:42:37,226 - server - INFO - ‚úÖ Downloaded 95337 bytes
2026-01-10T21:42:37.280892514Z [err]  2026-01-10 21:42:37,279 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2026-01-10T21:42:37.521791681Z [err]  2026-01-10 21:42:37,413 - server - INFO - ‚úÖ Split into 2 channels
2026-01-10T21:42:37.521800885Z [err]  2026-01-10 21:42:37,414 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2026-01-10T21:42:37.521810516Z [err]  2026-01-10 21:42:37,414 - server - INFO - üìä Channel 0: 521884 bytes
2026-01-10T21:42:37.521824612Z [err]  2026-01-10 21:42:37,414 - server - ERROR - ‚ùå No Soniox API key available
2026-01-10T21:42:37.521832270Z [err]  2026-01-10 21:42:37,414 - server - INFO - ‚ùå Channel 0: No speech
2026-01-10T21:42:37.521839899Z [err]  2026-01-10 21:42:37,414 - server - INFO - üìä Channel 1: 521884 bytes
2026-01-10T21:42:37.521848088Z [err]  2026-01-10 21:42:37,414 - server - ERROR - ‚ùå No Soniox API key available
2026-01-10T21:42:37.521856658Z [err]  2026-01-10 21:42:37,415 - server - INFO - ‚ùå Channel 1: No speech
2026-01-10T21:42:37.521863832Z [err]  2026-01-10 21:42:37,415 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2026-01-10T21:42:37.521873957Z [inf]  100.64.0.9:13036 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T21:42:37.521882678Z [err]  2026-01-10 21:42:37,430 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2026-01-10T21:42:37.521891462Z [err]  2026-01-10 21:42:37,516 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2026-01-10T21:42:37.521901608Z [err]  2026-01-10 21:42:37,516 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2026-01-10T21:42:37.521909543Z [err]  2026-01-10 21:42:37,517 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T21:42:37.521916891Z [err]  2026-01-10 21:42:37,517 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2026-01-10T21:42:37.522404254Z [err]    File "/app/backend/server.py", line 10084, in trigger_campaign_qc_for_call
2026-01-10T21:42:37.522410527Z [err]      await run_full_qc_analysis(
2026-01-10T21:42:37.522414994Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2026-01-10T21:42:37.522419109Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T21:42:37.522424004Z [err]  
2026-01-10T21:42:37.648903409Z [err]  2026-01-10 21:42:37,646 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T21:42:37.648911985Z [err]  2026-01-10 21:42:37,646 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T21:42:37.648919062Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T21:42:37.648925735Z [err]  2026-01-10 21:42:37,646 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T21:42:37.648931706Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-10T21:42:37.648938087Z [err]  2026-01-10 21:42:37,648 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:37.833334334Z [err]  2026-01-10 21:42:37,818 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T21:42:37.833347738Z [err]  2026-01-10 21:42:37,818 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T21:42:37.833357182Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T21:42:37.833367048Z [err]  2026-01-10 21:42:37,818 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T21:42:37.833375948Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-10T21:42:37.833383985Z [err]  2026-01-10 21:42:37,819 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:37.993138435Z [err]  2026-01-10 21:42:37,992 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T21:42:37.994757253Z [err]  2026-01-10 21:42:37,992 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T21:42:37.994765534Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T21:42:37.994771480Z [err]  2026-01-10 21:42:37,992 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T21:42:37.994777742Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T21:42:38.083081432Z [err]  2026-01-10 21:42:38,082 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:38.083092106Z [err]  2026-01-10 21:42:38,082 - server - INFO - ‚úÖ QC analysis completed for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:38.083101132Z [err]  2026-01-10 21:42:38,082 - server - INFO - üìä Scores: Commitment=50, Conversion=40, Excellence=50
2026-01-10T21:42:38.265069766Z [err]  2026-01-10 21:42:38,264 - server - INFO - üìä Updated campaign_calls with QC scores for v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:38.538164670Z [err]  2026-01-10 21:42:38,438 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2026-01-10T21:42:38.538170272Z [err]  2026-01-10 21:42:38,524 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2026-01-10T21:42:38.538177363Z [err]  2026-01-10 21:42:38,525 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: 'str' object has no attribute 'get'
2026-01-10T21:42:38.940668810Z [err]  2026-01-10 21:42:38,934 - persistent_tts_service - INFO - üîá [Call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T21:42:40.085767327Z [err]  2026-01-10 21:42:40,084 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.1s, checkin_count=0/2
2026-01-10T21:42:40.592338270Z [err]  2026-01-10 21:42:40,590 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.6s, checkin_count=0/2
2026-01-10T21:42:42.126441309Z [err]  2026-01-10 21:42:42,114 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T21:42:42.126474929Z [err]  2026-01-10 21:42:42,108 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2026-01-10T21:42:42.126479816Z [err]  2026-01-10 21:42:42,113 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-10T21:42:42.126480432Z [err]  2026-01-10 21:42:42,114 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2026-01-10T21:42:42.126489451Z [err]  2026-01-10 21:42:42,114 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:42.126495844Z [err]  2026-01-10 21:42:42,114 - telnyx_service - INFO - üîä Speaking text on call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: Are you still there?...
2026-01-10T21:42:42.126500433Z [err]  2026-01-10 21:42:42,114 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T21:42:42.126918551Z [err]  2026-01-10 21:42:42,114 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T21:42:42.126925161Z [err]  2026-01-10 21:42:42,114 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T21:42:42.126929864Z [err]  2026-01-10 21:42:42,114 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2026-01-10T21:42:42.126934510Z [err]  2026-01-10 21:42:42,114 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2026-01-10T21:42:42.126938899Z [err]  2026-01-10 21:42:42,117 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T21:42:42.126943379Z [err]  2026-01-10 21:42:42,117 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T21:42:42.520351529Z [err]    "errors": [
2026-01-10T21:42:42.520360818Z [err]  2026-01-10 21:42:42,336 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2026-01-10T21:42:42.520361889Z [err]      {
2026-01-10T21:42:42.520368394Z [err]        "code": "90018",
2026-01-10T21:42:42.520374671Z [err]        "title": "Call has already ended",
2026-01-10T21:42:42.520381354Z [err]        "detail": "This call is no longer active and can't receive commands."
2026-01-10T21:42:42.520394801Z [err]      }
2026-01-10T21:42:42.520405572Z [err]    ]
2026-01-10T21:42:42.520415502Z [err]  }
2026-01-10T21:42:42.520443915Z [err]  2026-01-10 21:42:42,336 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T21:42:42.520450466Z [err]  2026-01-10 21:42:42,336 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.22s
2026-01-10T21:42:42.520458073Z [err]  2026-01-10 21:42:42,336 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2026-01-10T21:42:42.579274585Z [err]  2026-01-10 21:42:42,578 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T21:42:42.580449177Z [err]  2026-01-10 21:42:42,579 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2026-01-10T21:42:42.580458707Z [err]  2026-01-10 21:42:42,579 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T21:42:43.085767481Z [err]  2026-01-10 21:42:43,084 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-10T21:42:43.085775521Z [err]  2026-01-10 21:42:43,084 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081363.084527 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:43.085780219Z [err]  2026-01-10 21:42:43,084 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:50.175934502Z [err]  2026-01-10 21:42:50,170 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=7.1s, checkin_count=1/2
2026-01-10T21:42:50.175946029Z [err]  2026-01-10 21:42:50,171 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2026-01-10T21:42:50.178113689Z [err]  2026-01-10 21:42:50,176 - core_calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2026-01-10T21:42:50.178122527Z [err]  2026-01-10 21:42:50,176 - core_calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2026-01-10T21:42:50.178129322Z [err]  2026-01-10 21:42:50,176 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2026-01-10T21:42:50.178137459Z [err]  2026-01-10 21:42:50,176 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:50.178143808Z [err]  2026-01-10 21:42:50,176 - telnyx_service - INFO - üîä Speaking text on call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w: Are you still there?...
2026-01-10T21:42:50.178150176Z [err]  2026-01-10 21:42:50,176 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T21:42:50.178156245Z [err]  2026-01-10 21:42:50,176 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T21:42:50.178161883Z [err]  2026-01-10 21:42:50,176 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T21:42:50.178167590Z [err]  2026-01-10 21:42:50,176 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T21:42:50.178174437Z [err]  2026-01-10 21:42:50,176 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2026-01-10T21:42:50.178180311Z [err]  2026-01-10 21:42:50,176 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2026-01-10T21:42:50.178186259Z [err]  2026-01-10 21:42:50,177 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T21:42:50.178191802Z [err]  2026-01-10 21:42:50,177 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T21:42:50.415961653Z [err]  2026-01-10 21:42:50,407 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T21:42:50.415968449Z [err]  2026-01-10 21:42:50,407 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.23s
2026-01-10T21:42:50.415972539Z [err]  2026-01-10 21:42:50,408 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2026-01-10T21:42:50.415977827Z [err]    "errors": [
2026-01-10T21:42:50.415982768Z [err]      {
2026-01-10T21:42:50.415987061Z [err]        "code": "90018",
2026-01-10T21:42:50.415990780Z [err]        "title": "Call has already ended",
2026-01-10T21:42:50.415994451Z [err]        "detail": "This call is no longer active and can't receive commands."
2026-01-10T21:42:50.415998013Z [err]      }
2026-01-10T21:42:50.416002376Z [err]    ]
2026-01-10T21:42:50.416006539Z [err]  }
2026-01-10T21:42:50.416010585Z [err]  2026-01-10 21:42:50,408 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2026-01-10T21:42:50.679310487Z [err]  2026-01-10 21:42:50,617 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T21:42:50.679316417Z [err]  2026-01-10 21:42:50,618 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2026-01-10T21:42:50.679320845Z [err]  2026-01-10 21:42:50,618 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T21:42:51.141787279Z [err]  2026-01-10 21:42:51,128 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (12.5s ago), marking agent as done speaking
2026-01-10T21:42:51.141793642Z [err]  2026-01-10 21:42:51,129 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768081371.1290126 for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w
2026-01-10T21:42:51.141799304Z [err]  2026-01-10 21:42:51,129 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:hdzgV-VgJHW4_6v3-eKw6avOCr0U_PqN6XZFPm_EJ3PlRbiRgTrC9w