2025-12-17T08:28:40.315430434Z [err]  2025-12-17 08:28:40,314 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-17T08:28:40.326869554Z [err]  2025-12-17 08:28:40,325 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=True, user_speaking=True, silence=0.0s, checkin_count=0/2
2025-12-17T08:28:40.326873893Z [err]  2025-12-17 08:28:40,325 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-17T08:28:40.326879371Z [err]  2025-12-17 08:28:40,325 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:40.332775978Z [err]  2025-12-17 08:28:40,327 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T08:28:40.332790789Z [err]  2025-12-17 08:28:40,327 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T08:28:40.332799457Z [err]  2025-12-17 08:28:40,328 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+8ms
2025-12-17T08:28:40.332807205Z [err]  2025-12-17 08:28:40,328 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 8ms (Soniox model: stt-rt-v3)
2025-12-17T08:28:40.332815648Z [err]  2025-12-17 08:28:40,328 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T08:28:40.332827716Z [err]  2025-12-17 08:28:40,328 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T08:28:40.332835269Z [err]  2025-12-17 08:28:40,328 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:40.426151778Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-17T08:28:40.426158277Z [err]  2025-12-17 08:28:40,424 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T08:28:40.426166235Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 2
2025-12-17T08:28:40.426172226Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - â±ï¸ [08:28:40.424] ğŸ“¥ process_user_input() ENTRY - text: 'Yeah....'
2025-12-17T08:28:40.426177379Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - â±ï¸ [08:28:40.424] ğŸ”€ About to call _follow_transition() for: Yeah....
2025-12-17T08:28:40.426184181Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - â±ï¸ [08:28:40.424] â© About to call _process_call_flow_streaming()
2025-12-17T08:28:40.426188385Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-17T08:28:40.426193686Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - â±ï¸ [08:28:40.424] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T08:28:40.426201795Z [err]  2025-12-17 08:28:40,424 - calling_service - INFO - â±ï¸ [08:28:40.424] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T08:28:40.433073551Z [err]  2025-12-17 08:28:40,432 - calling_service - INFO - â±ï¸ [08:28:40.432] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-17T08:28:40.858292783Z [err]  2025-12-17 08:28:40,830 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T08:28:41.115745665Z [err]  2025-12-17 08:28:41,114 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T08:28:41.127794783Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - â±ï¸ [08:28:41.122] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 690ms
2025-12-17T08:28:41.127805357Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ¤– AI transition decision: '0'
2025-12-17T08:28:41.127811857Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ“Š Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc)...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-17T08:28:41.127821061Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - Selected transition index: 0
2025-12-17T08:28:41.127826686Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-17T08:28:41.127832123Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 697ms
2025-12-17T08:28:41.127836774Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - â±ï¸ [08:28:41.122] âœ… Node selected, about to process content...
2025-12-17T08:28:41.127845484Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 3:28 AM EST in content
2025-12-17T08:28:41.127861692Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T08:28:41.127867182Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T08:28:41.127871859Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T08:28:41.127876359Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with True in content
2025-12-17T08:28:41.127880955Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T08:28:41.128351786Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T08:28:41.128362616Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T08:28:41.128368238Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T08:28:41.128373452Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T08:28:41.128378837Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-17T08:28:41.128386149Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-17T08:28:41.128391088Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - â±ï¸ [08:28:41.122] ğŸ“„ About to process content (mode=script, length=89)
2025-12-17T08:28:41.128396595Z [err]  2025-12-17 08:28:41,122 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T08:28:41.128401356Z [err]  2025-12-17 08:28:41,122 - server - INFO - ğŸ“¤ Sentence arrived from LLM: This is Jake......
2025-12-17T08:28:41.128405809Z [err]  2025-12-17 08:28:41,122 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 794ms
2025-12-17T08:28:41.128409764Z [err]  2025-12-17 08:28:41,122 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T08:28:41.128414355Z [err]  2025-12-17 08:28:41,122 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:_CkKvOSbq2KQuJplz..., session=FOUND
2025-12-17T08:28:41.128418899Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T08:28:41.128422750Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T08:28:41.129212644Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - ğŸ’¾ Storing node ID 1763159750250 in conversation history
2025-12-17T08:28:41.129218990Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - LLM response (0.70s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-17T08:28:41.129223486Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - Total latency: 0.70s
2025-12-17T08:28:41.129227611Z [err]  2025-12-17 08:28:41,123 - server - INFO - âœ… LLM finished in 795ms, TTS tasks already running in background
2025-12-17T08:28:41.129236215Z [err]  2025-12-17 08:28:41,123 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 795ms
2025-12-17T08:28:41.129241915Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: This is Jake......
2025-12-17T08:28:41.129248974Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸ“¤ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-17T08:28:41.129255265Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:_CkKvOSbq2KQuJplz..., session=FOUND
2025-12-17T08:28:41.129260419Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T08:28:41.129266528Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T08:28:41.129272759Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-17T08:28:41.129278409Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (user responded)
2025-12-17T08:28:41.129283924Z [err]  2025-12-17 08:28:41,123 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T08:28:41.129897914Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T08:28:41.129904609Z [err]  2025-12-17 08:28:41,123 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T08:28:41.129910080Z [err]  2025-12-17 08:28:41,123 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T08:28:41.129915056Z [err]  2025-12-17 08:28:41,123 - persistent_tts_service - INFO - ğŸ¤ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Streaming sentence #2: This is Jake......
2025-12-17T08:28:41.340159185Z [err]  2025-12-17 08:28:41,338 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T08:28:41.340166804Z [err]  2025-12-17 08:28:41,338 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+215ms
2025-12-17T08:28:41.340173103Z [err]  2025-12-17 08:28:41,338 - persistent_tts_service - INFO - ğŸ“¤ Sending 8173 bytes of audio (52 chunks, 1.0s duration) via WebSocket
2025-12-17T08:28:41.340179495Z [err]  2025-12-17 08:28:41,338 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:41.340186188Z [err]  2025-12-17 08:28:41,338 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.0s (total: 1.0s from now)
2025-12-17T08:28:41.344599826Z [err]  2025-12-17 08:28:41,340 - persistent_tts_service - INFO - âœ… Sent 52 audio chunks via WebSocket
2025-12-17T08:28:42.965780104Z [err]  2025-12-17 08:28:42,840 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.5s ago), marking agent as done speaking
2025-12-17T08:28:42.965787682Z [err]  2025-12-17 08:28:42,840 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765960122.8403435 for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:42.965793333Z [err]  2025-12-17 08:28:42,840 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:43.341123365Z [err]  2025-12-17 08:28:43,338 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T08:28:43.341131346Z [err]  2025-12-17 08:28:43,338 - persistent_tts_service - INFO - âœ… [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Finished streaming sentence #2: 1 chunks received
2025-12-17T08:28:43.341137283Z [err]  2025-12-17 08:28:43,338 - persistent_tts_service - INFO - ğŸ¤ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2025-12-17T08:28:43.895161349Z [err]  2025-12-17 08:28:43,784 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:43.895162409Z [err]  2025-12-17 08:28:43,784 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.0s (total: 3.5s from now)
2025-12-17T08:28:43.895175390Z [err]  2025-12-17 08:28:43,786 - persistent_tts_service - INFO - âœ… Sent 103 audio chunks via WebSocket
2025-12-17T08:28:43.895187142Z [err]  2025-12-17 08:28:43,619 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.6s (total: 1.6s from now)
2025-12-17T08:28:43.895199656Z [err]  2025-12-17 08:28:43,621 - persistent_tts_service - INFO - âœ… Sent 82 audio chunks via WebSocket
2025-12-17T08:28:43.895208226Z [err]  2025-12-17 08:28:43,784 - persistent_tts_service - INFO - ğŸ“¤ Sending 16347 bytes of audio (103 chunks, 2.0s duration) via WebSocket
2025-12-17T08:28:43.895234459Z [err]  2025-12-17 08:28:43,619 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T08:28:43.895240774Z [err]  2025-12-17 08:28:43,619 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+280ms
2025-12-17T08:28:43.895247985Z [err]  2025-12-17 08:28:43,619 - persistent_tts_service - INFO - ğŸ“¤ Sending 13003 bytes of audio (82 chunks, 1.6s duration) via WebSocket
2025-12-17T08:28:43.895253364Z [err]  2025-12-17 08:28:43,619 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:44.537501125Z [err]  2025-12-17 08:28:44,536 - server - INFO - ğŸ¤ Soniox receiver alive - 12 messages received in last 10s
2025-12-17T08:28:44.544910080Z [err]  2025-12-17 08:28:44,540 - server - INFO - ğŸ“¤ Audio flowing: 546 packets sent to Soniox (5s update)
2025-12-17T08:28:45.352476514Z [err]  2025-12-17 08:28:45,350 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (1.9s left)
2025-12-17T08:28:45.789081982Z [err]  2025-12-17 08:28:45,785 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T08:28:45.789087697Z [err]  2025-12-17 08:28:45,785 - persistent_tts_service - INFO - âœ… [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Finished streaming sentence #3: 2 chunks received
2025-12-17T08:28:45.789092918Z [err]  2025-12-17 08:28:45,785 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T08:28:45.789097285Z [err]  2025-12-17 08:28:45,785 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T08:28:45.789100985Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5457ms from user stop ğŸš€
2025-12-17T08:28:45.789104782Z [err]  2025-12-17 08:28:45,785 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:45.789109337Z [err]  2025-12-17 08:28:45,785 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T08:28:45.789113689Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T08:28:45.789117815Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T08:28:45.789121903Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] STT: 8ms (provider: soniox, model: stt-rt-v3)
2025-12-17T08:28:45.789125825Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 795ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T08:28:45.789129570Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 4662ms (provider: elevenlabs, websocket: False)
2025-12-17T08:28:45.789133396Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5457ms (user stopped â†’ play_audio_url called)
2025-12-17T08:28:45.789222204Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T08:28:45.789226062Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T08:28:45.789229715Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T08:28:45.789234365Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T08:28:45.789238291Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T08:28:45.789242788Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 5757ms estimated
2025-12-17T08:28:45.789246803Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-17T08:28:45.789252431Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Yeah....'
2025-12-17T08:28:45.789256767Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-17T08:28:45.789261098Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T08:28:45.789334443Z [err]  2025-12-17 08:28:45,785 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T08:28:45.865597721Z [err]  2025-12-17 08:28:45,856 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (1.4s left)
2025-12-17T08:28:45.982282164Z [err]  2025-12-17 08:28:45,977 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1303ms)
2025-12-17T08:28:45.982287594Z [err]  2025-12-17 08:28:45,977 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T08:28:47.370549502Z [err]  2025-12-17 08:28:47,368 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T08:28:47.370557296Z [err]  2025-12-17 08:28:47,368 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765960127.3686 for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:47.370563940Z [err]  2025-12-17 08:28:47,368 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:47.605074430Z [err]  2025-12-17 08:28:47,588 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T08:28:49.483076191Z [inf]  100.64.0.7:44190 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 404
2025-12-17T08:28:49.563602764Z [err]  2025-12-17 08:28:49,559 - server - INFO - ğŸ“¤ Audio flowing: 797 packets sent to Soniox (5s update)
2025-12-17T08:28:50.169686778Z [err]  2025-12-17 08:28:50,167 - server - INFO - ğŸ”¤ RAW TOKENS: [" S"?]
2025-12-17T08:28:50.169695045Z [err]  2025-12-17 08:28:50,167 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:50.169700745Z [err]  2025-12-17 08:28:50,167 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (user started speaking)
2025-12-17T08:28:50.169706404Z [err]  2025-12-17 08:28:50,167 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:50.169711908Z [err]  2025-12-17 08:28:50,167 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'S' | Generating: False
2025-12-17T08:28:50.300217266Z [err]  2025-12-17 08:28:50,296 - server - INFO - ğŸ”¤ RAW TOKENS: [" S"?, "ure"?]
2025-12-17T08:28:50.300225344Z [err]  2025-12-17 08:28:50,297 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Sure' | Generating: False
2025-12-17T08:28:50.374419160Z [err]  2025-12-17 08:28:50,365 - server - INFO - ğŸ”¤ RAW TOKENS: [" S"âœ“, "ure"âœ“, "."âœ“, "<end>"âœ“]
2025-12-17T08:28:50.374425056Z [err]  2025-12-17 08:28:50,365 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T08:28:50.374429246Z [err]  2025-12-17 08:28:50,365 - server - INFO - ğŸ§¹ Cleaned transcript: ' S ure .' -> 'Sure.'
2025-12-17T08:28:50.374432972Z [err]  2025-12-17 08:28:50,366 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Sure.' (3 tokens)
2025-12-17T08:28:50.374436759Z [err]  2025-12-17 08:28:50,366 - server - INFO - ğŸ¤ Soniox final transcript: 'Sure.'
2025-12-17T08:28:50.374441163Z [err]  2025-12-17 08:28:50,366 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T08:28:50.374445045Z [err]  2025-12-17 08:28:50,366 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T08:28:50.374448589Z [err]  2025-12-17 08:28:50,366 - server - INFO - â±ï¸ [08:28:50.366] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Sure.'
2025-12-17T08:28:50.374452223Z [err]  2025-12-17 08:28:50,366 - server - INFO - â±ï¸ [08:28:50.366] STT endpoint detection latency: 6ms
2025-12-17T08:28:50.374455711Z [err]  2025-12-17 08:28:50,366 - server - INFO - â±ï¸ [08:28:50.366] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T08:28:50.374460902Z [err]  2025-12-17 08:28:50,368 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (TTL: 3600s)
2025-12-17T08:28:50.374465328Z [err]  2025-12-17 08:28:50,368 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T08:28:50.374468935Z [err]  2025-12-17 08:28:50,368 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Sure.' - Processing...
2025-12-17T08:28:50.384873132Z [err]  2025-12-17 08:28:50,378 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Sure.
2025-12-17T08:28:50.384884566Z [err]  2025-12-17 08:28:50,378 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:50.384892200Z [err]  2025-12-17 08:28:50,380 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T08:28:50.384898459Z [err]  2025-12-17 08:28:50,380 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T08:28:50.384904690Z [err]  2025-12-17 08:28:50,383 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+21ms
2025-12-17T08:28:50.384911859Z [err]  2025-12-17 08:28:50,383 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 21ms (Soniox model: stt-rt-v3)
2025-12-17T08:28:50.384918187Z [err]  2025-12-17 08:28:50,383 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T08:28:50.384923616Z [err]  2025-12-17 08:28:50,383 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T08:28:50.384929471Z [err]  2025-12-17 08:28:50,383 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:50.400384471Z [err]  2025-12-17 08:28:50,393 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T08:28:50.481153478Z [err]  2025-12-17 08:28:50,479 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T08:28:50.481153509Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ“ User's response captured: 'Sure....'
2025-12-17T08:28:50.481163790Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [08:28:50.479] ğŸ“¥ process_user_input() ENTRY - text: 'Sure....'
2025-12-17T08:28:50.481165577Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 0ms
2025-12-17T08:28:50.481172367Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [08:28:50.479] â© About to call _process_call_flow_streaming()
2025-12-17T08:28:50.481179862Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [08:28:50.479] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T08:28:50.481187915Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [08:28:50.479] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T08:28:50.481195234Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - Flow processing - History length: 5, Is first: False
2025-12-17T08:28:50.481202576Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763159750250
2025-12-17T08:28:50.481209901Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [08:28:50.479] ğŸ”€ About to call _follow_transition() for: Sure....
2025-12-17T08:28:50.481218002Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - Evaluating transitions from Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) for message: Sure.
2025-12-17T08:28:50.481225886Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ¤ AUTO-TRANSITION AFTER RESPONSE enabled - user spoke, transitioning to: 1763161849799
2025-12-17T08:28:50.481234648Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - âœ… Auto-transitioned (after response) to: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic
2025-12-17T08:28:50.482804190Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with True in content
2025-12-17T08:28:50.482813287Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T08:28:50.482815915Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - â±ï¸ [08:28:50.479] âœ… Node selected, about to process content...
2025-12-17T08:28:50.482820401Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T08:28:50.482823116Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 3:28 AM EST in content
2025-12-17T08:28:50.482827237Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - Using flow node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic (type: conversation, mode: script)
2025-12-17T08:28:50.482828694Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T08:28:50.482830929Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T08:28:50.482836811Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T08:28:50.482837077Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T08:28:50.482843721Z [err]  2025-12-17 08:28:50,479 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T08:28:50.482844088Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T08:28:50.482851035Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 260 chars) - will return text instantly
2025-12-17T08:28:50.484856939Z [err]  2025-12-17 08:28:50,480 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 99ms
2025-12-17T08:28:50.484862779Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - â±ï¸ [08:28:50.480] ğŸ“„ About to process content (mode=script, length=260)
2025-12-17T08:28:50.484868279Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-17T08:28:50.484871042Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T08:28:50.484876788Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸ“¤ Sentence arrived from LLM: I know this call is out of the blue, but do you ha...
2025-12-17T08:28:50.484879059Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-17T08:28:50.484885682Z [err]  2025-12-17 08:28:50,480 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 99ms
2025-12-17T08:28:50.484887704Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:_CkKvOSbq2KQuJplz..., session=FOUND
2025-12-17T08:28:50.484891723Z [err]  2025-12-17 08:28:50,480 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T08:28:50.484895531Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T08:28:50.484898546Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:_CkKvOSbq2KQuJplz..., session=FOUND
2025-12-17T08:28:50.484903242Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T08:28:50.484905680Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T08:28:50.484910991Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T08:28:50.485945863Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: I know this call is out of the blue, but do you ha...
2025-12-17T08:28:50.485946688Z [err]  2025-12-17 08:28:50,480 - persistent_tts_service - INFO - ğŸ¤ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Streaming sentence #4: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-17T08:28:50.485954053Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (user responded)
2025-12-17T08:28:50.485963757Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T08:28:50.485964872Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T08:28:50.485971003Z [err]  2025-12-17 08:28:50,480 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T08:28:50.485972382Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - ğŸ’¾ Storing node ID 1763161849799 in conversation history
2025-12-17T08:28:50.485978087Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - LLM response (0.00s): Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stacking income without stacking hours. I know this call is out of the blue, but do you have just 25 seconds for me to explain why I'm reaching out today specifically?
2025-12-17T08:28:50.485981166Z [err]  2025-12-17 08:28:50,480 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T08:28:50.485993629Z [err]  2025-12-17 08:28:50,480 - calling_service - INFO - Total latency: 0.00s
2025-12-17T08:28:50.485998664Z [err]  2025-12-17 08:28:50,480 - server - INFO - âœ… LLM finished in 96ms, TTS tasks already running in background
2025-12-17T08:28:50.923421194Z [err]  2025-12-17 08:28:50,895 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (0.8s left)
2025-12-17T08:28:50.923441490Z [err]  2025-12-17 08:28:50,790 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T08:28:50.923448466Z [err]  2025-12-17 08:28:50,790 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+310ms
2025-12-17T08:28:50.923456292Z [err]  2025-12-17 08:28:50,790 - persistent_tts_service - INFO - ğŸ“¤ Sending 7431 bytes of audio (47 chunks, 0.9s duration) via WebSocket
2025-12-17T08:28:50.923462720Z [err]  2025-12-17 08:28:50,790 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:50.923468912Z [err]  2025-12-17 08:28:50,790 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2025-12-17T08:28:50.923474572Z [err]  2025-12-17 08:28:50,791 - persistent_tts_service - INFO - âœ… Sent 47 audio chunks via WebSocket
2025-12-17T08:28:50.982666319Z [err]  2025-12-17 08:28:50,981 - persistent_tts_service - INFO - ğŸ“¤ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T08:28:50.982675808Z [err]  2025-12-17 08:28:50,981 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:50.982681769Z [err]  2025-12-17 08:28:50,981 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 2.5s from now)
2025-12-17T08:28:50.988194161Z [err]  2025-12-17 08:28:50,982 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T08:28:50.988202667Z [err]  2025-12-17 08:28:50,983 - persistent_tts_service - INFO - ğŸ“¤ Sending 1811 bytes of audio (12 chunks, 0.2s duration) via WebSocket
2025-12-17T08:28:50.988209458Z [err]  2025-12-17 08:28:50,983 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:50.988215140Z [err]  2025-12-17 08:28:50,983 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.2s (total: 2.7s from now)
2025-12-17T08:28:50.988221121Z [err]  2025-12-17 08:28:50,983 - persistent_tts_service - INFO - âœ… Sent 12 audio chunks via WebSocket
2025-12-17T08:28:51.171359200Z [err]  2025-12-17 08:28:51,168 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T08:28:51.171365657Z [err]  2025-12-17 08:28:51,168 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:51.171369540Z [err]  2025-12-17 08:28:51,168 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 4.2s from now)
2025-12-17T08:28:51.171373822Z [err]  2025-12-17 08:28:51,169 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T08:28:51.181669650Z [err]  2025-12-17 08:28:51,177 - persistent_tts_service - INFO - ğŸ“¤ Sending 3297 bytes of audio (21 chunks, 0.4s duration) via WebSocket
2025-12-17T08:28:51.181674699Z [err]  2025-12-17 08:28:51,177 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:51.181679932Z [err]  2025-12-17 08:28:51,177 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.4s (total: 4.6s from now)
2025-12-17T08:28:51.181684413Z [err]  2025-12-17 08:28:51,177 - persistent_tts_service - INFO - âœ… Sent 21 audio chunks via WebSocket
2025-12-17T08:28:51.404872166Z [err]  2025-12-17 08:28:51,403 - persistent_tts_service - INFO - ğŸ“¤ Sending 15233 bytes of audio (96 chunks, 1.9s duration) via WebSocket
2025-12-17T08:28:51.404878150Z [err]  2025-12-17 08:28:51,404 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:51.404883425Z [err]  2025-12-17 08:28:51,404 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.9s (total: 6.3s from now)
2025-12-17T08:28:51.412486066Z [err]  2025-12-17 08:28:51,405 - persistent_tts_service - INFO - âœ… Sent 96 audio chunks via WebSocket
2025-12-17T08:28:53.410064487Z [err]  2025-12-17 08:28:53,403 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T08:28:53.410072249Z [err]  2025-12-17 08:28:53,403 - persistent_tts_service - INFO - âœ… [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Finished streaming sentence #4: 6 chunks received
2025-12-17T08:28:53.410077953Z [err]  2025-12-17 08:28:53,403 - persistent_tts_service - INFO - ğŸ¤ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Streaming sentence #5: I know this call is out of the blue, but do you ha...
2025-12-17T08:28:53.850759212Z [err]  2025-12-17 08:28:53,673 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T08:28:53.850764609Z [err]  2025-12-17 08:28:53,673 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+269ms
2025-12-17T08:28:53.850770090Z [err]  2025-12-17 08:28:53,673 - persistent_tts_service - INFO - ğŸ“¤ Sending 10402 bytes of audio (66 chunks, 1.3s duration) via WebSocket
2025-12-17T08:28:53.850778308Z [err]  2025-12-17 08:28:53,673 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:53.850783856Z [err]  2025-12-17 08:28:53,673 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.3s (total: 5.3s from now)
2025-12-17T08:28:53.850790468Z [err]  2025-12-17 08:28:53,674 - persistent_tts_service - INFO - âœ… Sent 66 audio chunks via WebSocket
2025-12-17T08:28:53.870511402Z [err]  2025-12-17 08:28:53,868 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T08:28:53.870518026Z [err]  2025-12-17 08:28:53,868 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:53.870522248Z [err]  2025-12-17 08:28:53,868 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 6.9s from now)
2025-12-17T08:28:53.870525866Z [err]  2025-12-17 08:28:53,869 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T08:28:53.872116383Z [err]  2025-12-17 08:28:53,870 - persistent_tts_service - INFO - ğŸ“¤ Sending 1811 bytes of audio (12 chunks, 0.2s duration) via WebSocket
2025-12-17T08:28:53.872125166Z [err]  2025-12-17 08:28:53,870 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:53.872132071Z [err]  2025-12-17 08:28:53,870 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.2s (total: 7.1s from now)
2025-12-17T08:28:53.872138228Z [err]  2025-12-17 08:28:53,870 - persistent_tts_service - INFO - âœ… Sent 12 audio chunks via WebSocket
2025-12-17T08:28:54.060047636Z [err]  2025-12-17 08:28:54,050 - persistent_tts_service - INFO - ğŸ“¤ Sending 23034 bytes of audio (144 chunks, 2.9s duration) via WebSocket
2025-12-17T08:28:54.060054366Z [err]  2025-12-17 08:28:54,050 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:28:54.060059268Z [err]  2025-12-17 08:28:54,050 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.9s (total: 9.8s from now)
2025-12-17T08:28:54.060063924Z [err]  2025-12-17 08:28:54,052 - persistent_tts_service - INFO - âœ… Sent 144 audio chunks via WebSocket
2025-12-17T08:28:54.563466018Z [err]  2025-12-17 08:28:54,560 - server - INFO - ğŸ“¤ Audio flowing: 1047 packets sent to Soniox (5s update)
2025-12-17T08:28:54.956371339Z [err]  2025-12-17 08:28:54,844 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 1 words - 'Th'
2025-12-17T08:28:54.956429145Z [err]  2025-12-17 08:28:54,708 - server - INFO - ğŸ¤ Soniox receiver alive - 12 messages received in last 10s
2025-12-17T08:28:54.956434111Z [err]  2025-12-17 08:28:54,844 - server - INFO - ğŸ”¤ RAW TOKENS: [" Th"?]
2025-12-17T08:28:54.956439230Z [err]  2025-12-17 08:28:54,844 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (user started speaking)
2025-12-17T08:28:54.956443506Z [err]  2025-12-17 08:28:54,844 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:54.956448471Z [err]  2025-12-17 08:28:54,844 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Th' | Generating: True
2025-12-17T08:28:54.968160410Z [err]  2025-12-17 08:28:54,966 - server - INFO - ğŸ”¤ RAW TOKENS: [" Th"âœ“, "an"âœ“, "ks."âœ“, "<end>"âœ“]
2025-12-17T08:28:54.968167308Z [err]  2025-12-17 08:28:54,966 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T08:28:54.968172678Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ§¹ Cleaned transcript: ' Th an ks.' -> 'Than ks.'
2025-12-17T08:28:54.968177406Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Than ks.' (3 tokens)
2025-12-17T08:28:54.968182354Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ¯ User speaking while TTS is_speaking=True - INTERRUPTION POSSIBLE
2025-12-17T08:28:54.968182557Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ¤ Soniox final transcript: 'Than ks.'
2025-12-17T08:28:54.968191113Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ” FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=True, time_until_done=8.9s, generating=True, playbacks=0, is_active=True
2025-12-17T08:28:54.968196700Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ”• FILTERING 2-word/filler 'Than ks.' - NOT calling on_final_transcript
2025-12-17T08:28:54.968202240Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ”• SKIPPING endpoint for 2-word/filler 'Than ks.' (tts_speaking=True, is_active=True)
2025-12-17T08:28:54.968207182Z [err]  2025-12-17 08:28:54,967 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:54.968212730Z [err]  2025-12-17 08:28:54,967 - server - INFO - ğŸ‘¤ Marked user stopped speaking (filtered utterance)
2025-12-17T08:28:55.424998921Z [err]  2025-12-17 08:28:55,419 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (8.4s left)
2025-12-17T08:28:55.927628299Z [err]  2025-12-17 08:28:55,922 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (7.9s left)
2025-12-17T08:28:56.053299023Z [err]  2025-12-17 08:28:56,050 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T08:28:56.053307348Z [err]  2025-12-17 08:28:56,050 - persistent_tts_service - INFO - âœ… [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Finished streaming sentence #5: 4 chunks received
2025-12-17T08:28:56.053313257Z [err]  2025-12-17 08:28:56,050 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T08:28:56.053319780Z [err]  2025-12-17 08:28:56,050 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T08:28:56.053325179Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5666ms from user stop ğŸš€
2025-12-17T08:28:56.053330883Z [err]  2025-12-17 08:28:56,050 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:28:56.053336638Z [err]  2025-12-17 08:28:56,050 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T08:28:56.053341775Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T08:28:56.053347490Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T08:28:56.053353340Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING] STT: 21ms (provider: soniox, model: stt-rt-v3)
2025-12-17T08:28:56.053362108Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 96ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T08:28:56.053369483Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 5570ms (provider: elevenlabs, websocket: False)
2025-12-17T08:28:56.053375805Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5670ms (user stopped â†’ play_audio_url called)
2025-12-17T08:28:56.055127509Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T08:28:56.055136371Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T08:28:56.055142061Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T08:28:56.055146834Z [err]  2025-12-17 08:28:56,050 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T08:28:56.055151343Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T08:28:56.055155797Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 5970ms estimated
2025-12-17T08:28:56.055159687Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 260 chars, 2 sentences
2025-12-17T08:28:56.055272443Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Sure....'
2025-12-17T08:28:56.055280612Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'Well, uh, I don't know if you could yet, but, I'm calling be...'
2025-12-17T08:28:56.055285762Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T08:28:56.055290490Z [err]  2025-12-17 08:28:56,051 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T08:28:56.247489850Z [err]  2025-12-17 08:28:56,242 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 617ms)
2025-12-17T08:28:56.247495474Z [err]  2025-12-17 08:28:56,242 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T08:28:59.571371119Z [err]  2025-12-17 08:28:59,567 - server - INFO - ğŸ“¤ Audio flowing: 1297 packets sent to Soniox (5s update)
2025-12-17T08:29:00.051915718Z [inf]  100.64.0.8:21496 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 404
2025-12-17T08:29:00.461592273Z [err]  2025-12-17 08:29:00,450 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (3.4s left)
2025-12-17T08:29:00.952823634Z [err]  2025-12-17 08:29:00,951 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (2.9s left)
2025-12-17T08:29:03.972111099Z [err]  2025-12-17 08:29:03,969 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T08:29:03.972122631Z [err]  2025-12-17 08:29:03,969 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765960143.969949 for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:03.972130355Z [err]  2025-12-17 08:29:03,969 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:04.144149029Z [err]  2025-12-17 08:29:04,140 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T08:29:04.597385296Z [err]  2025-12-17 08:29:04,581 - server - INFO - ğŸ“¤ Audio flowing: 1548 packets sent to Soniox (5s update)
2025-12-17T08:29:04.879429289Z [err]  2025-12-17 08:29:04,717 - server - INFO - ğŸ¤ Soniox receiver alive - 11 messages received in last 10s
2025-12-17T08:29:06.132666554Z [err]  2025-12-17 08:29:06,130 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"?]
2025-12-17T08:29:06.132673678Z [err]  2025-12-17 08:29:06,130 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:06.132678662Z [err]  2025-12-17 08:29:06,130 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (user started speaking)
2025-12-17T08:29:06.132682486Z [err]  2025-12-17 08:29:06,130 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:06.132686309Z [err]  2025-12-17 08:29:06,130 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Go' | Generating: False
2025-12-17T08:29:06.224930146Z [err]  2025-12-17 08:29:06,223 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"?, " a"?]
2025-12-17T08:29:06.224938338Z [err]  2025-12-17 08:29:06,224 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Go a' | Generating: False
2025-12-17T08:29:06.370579824Z [err]  2025-12-17 08:29:06,367 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"?, " a"?, "he"?]
2025-12-17T08:29:06.370585752Z [err]  2025-12-17 08:29:06,368 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Go a he' | Generating: False
2025-12-17T08:29:06.486222037Z [err]  2025-12-17 08:29:06,481 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"âœ“, " a"âœ“, "he"âœ“, "ad."âœ“, "<end>"âœ“]
2025-12-17T08:29:06.486231800Z [err]  2025-12-17 08:29:06,481 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T08:29:06.486240780Z [err]  2025-12-17 08:29:06,482 - server - INFO - ğŸ§¹ Cleaned transcript: ' Go  a he ad.' -> 'Go ahead.'
2025-12-17T08:29:06.486252020Z [err]  2025-12-17 08:29:06,482 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Go ahead.' (4 tokens)
2025-12-17T08:29:06.486257855Z [err]  2025-12-17 08:29:06,482 - server - INFO - ğŸ¤ Soniox final transcript: 'Go ahead.'
2025-12-17T08:29:06.486264525Z [err]  2025-12-17 08:29:06,482 - server - INFO - ğŸ” FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T08:29:06.486271163Z [err]  2025-12-17 08:29:06,482 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T08:29:06.486278018Z [err]  2025-12-17 08:29:06,482 - server - INFO - â±ï¸ [08:29:06.482] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Go ahead.'
2025-12-17T08:29:06.486283785Z [err]  2025-12-17 08:29:06,482 - server - INFO - â±ï¸ [08:29:06.482] STT endpoint detection latency: 3ms
2025-12-17T08:29:06.486290027Z [err]  2025-12-17 08:29:06,482 - server - INFO - â±ï¸ [08:29:06.482] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T08:29:06.487480291Z [err]  2025-12-17 08:29:06,485 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (TTL: 3600s)
2025-12-17T08:29:06.487485163Z [err]  2025-12-17 08:29:06,485 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T08:29:06.487490496Z [err]  2025-12-17 08:29:06,485 - server - INFO - âœ… Agent SILENT - User said 2 word(s): 'Go ahead.' - Processing...
2025-12-17T08:29:06.503480463Z [err]  2025-12-17 08:29:06,495 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Go ahead.
2025-12-17T08:29:06.503486663Z [err]  2025-12-17 08:29:06,495 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:06.503490841Z [err]  2025-12-17 08:29:06,495 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T08:29:06.503495898Z [err]  2025-12-17 08:29:06,495 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T08:29:06.503500371Z [err]  2025-12-17 08:29:06,495 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+16ms
2025-12-17T08:29:06.503504797Z [err]  2025-12-17 08:29:06,495 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 16ms (Soniox model: stt-rt-v3)
2025-12-17T08:29:06.503509969Z [err]  2025-12-17 08:29:06,495 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T08:29:06.503513810Z [err]  2025-12-17 08:29:06,495 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T08:29:06.503517696Z [err]  2025-12-17 08:29:06,495 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:06.592959036Z [err]  2025-12-17 08:29:06,590 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T08:29:06.592971975Z [err]  2025-12-17 08:29:06,590 - calling_service - INFO - â±ï¸ [08:29:06.590] ğŸ“¥ process_user_input() ENTRY - text: 'Go ahead....'
2025-12-17T08:29:06.592995395Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - â±ï¸ [08:29:06.591] â© About to call _process_call_flow_streaming()
2025-12-17T08:29:06.593000781Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - â±ï¸ [08:29:06.591] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T08:29:06.593005877Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - â±ï¸ [08:29:06.591] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T08:29:06.593010702Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - Flow processing - History length: 7, Is first: False
2025-12-17T08:29:06.593015495Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763161849799
2025-12-17T08:29:06.593019989Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - â±ï¸ [08:29:06.591] ğŸ”€ About to call _follow_transition() for: Go ahead....
2025-12-17T08:29:06.593027156Z [err]  2025-12-17 08:29:06,591 - calling_service - INFO - Evaluating transitions from Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic for message: Go ahead.
2025-12-17T08:29:06.604426845Z [err]  2025-12-17 08:29:06,598 - calling_service - INFO - â±ï¸ [08:29:06.598] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-17T08:29:06.988205703Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 3:29 AM EST in content
2025-12-17T08:29:06.988213109Z [err]  2025-12-17 08:29:06,982 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T08:29:06.988219218Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T08:29:06.988226139Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - â±ï¸ [08:29:06.984] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 386ms
2025-12-17T08:29:06.988233789Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T08:29:06.988237273Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ¤– AI transition decision: '0'
2025-12-17T08:29:06.988244716Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T08:29:06.988247593Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ“Š Available transitions: ['Agrees|consents (yes|sure|okay|hear more|call cons...', 'Any objection or non compliance that isn\'t a "I do...', 'NO (flat out)|No recall (done quickly) AND no othe...', "I'm Busy, or requests to call back responses from ..."]
2025-12-17T08:29:06.988252955Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - Selected transition index: 0
2025-12-17T08:29:06.988258471Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - Transition: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic -> N_IntroduceModel_And_AskQuestions_V3_Adaptive
2025-12-17T08:29:06.988263212Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 393ms
2025-12-17T08:29:06.988268115Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - â±ï¸ [08:29:06.984] âœ… Node selected, about to process content...
2025-12-17T08:29:06.989403472Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with True in content
2025-12-17T08:29:06.989407579Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T08:29:06.989411041Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T08:29:06.989415615Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T08:29:06.989420212Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T08:29:06.989423817Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T08:29:06.989428176Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 164 chars) - will return text instantly
2025-12-17T08:29:06.989432345Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - Using flow node: N_IntroduceModel_And_AskQuestions_V3_Adaptive (type: conversation, mode: script)
2025-12-17T08:29:06.989436146Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - â±ï¸ [08:29:06.984] ğŸ“„ About to process content (mode=script, length=164)
2025-12-17T08:29:06.989439999Z [err]  2025-12-17 08:29:06,984 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T08:29:06.989443999Z [err]  2025-12-17 08:29:06,984 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Okay, in a nutshell, we set up passive income webs...
2025-12-17T08:29:06.989447541Z [err]  2025-12-17 08:29:06,984 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 489ms
2025-12-17T08:29:06.989451111Z [err]  2025-12-17 08:29:06,984 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T08:29:06.989454781Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:_CkKvOSbq2KQuJplz..., session=FOUND
2025-12-17T08:29:06.990497545Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T08:29:06.990503800Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T08:29:06.990508460Z [err]  2025-12-17 08:29:06,985 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 489ms
2025-12-17T08:29:06.990512499Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: Okay, in a nutshell, we set up passive income webs...
2025-12-17T08:29:06.990516674Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸ“¤ Sentence arrived from LLM: What questions come to mind as soon as you hear so...
2025-12-17T08:29:06.990520650Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:_CkKvOSbq2KQuJplz..., session=FOUND
2025-12-17T08:29:06.990524731Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T08:29:06.990528832Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T08:29:06.990532849Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: What questions come to mind as soon as you hear so...
2025-12-17T08:29:06.990536707Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (user responded)
2025-12-17T08:29:06.990540757Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T08:29:06.990544555Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - ğŸ’¾ Storing node ID 1763163400676 in conversation history
2025-12-17T08:29:06.990548229Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - LLM response (0.39s): Okay, in a nutshell, we set up passive income websites, and we let them produce income for you. What questions come to mind as soon as you hear something like that?
2025-12-17T08:29:06.996666793Z [err]  2025-12-17 08:29:06,985 - calling_service - INFO - Total latency: 0.39s
2025-12-17T08:29:06.996677393Z [err]  2025-12-17 08:29:06,985 - server - INFO - âœ… LLM finished in 490ms, TTS tasks already running in background
2025-12-17T08:29:06.996685686Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T08:29:06.996695046Z [err]  2025-12-17 08:29:06,985 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T08:29:06.996702351Z [err]  2025-12-17 08:29:06,985 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T08:29:06.996709720Z [err]  2025-12-17 08:29:06,985 - persistent_tts_service - INFO - ğŸ¤ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Streaming sentence #6: Okay, in a nutshell, we set up passive income webs...
2025-12-17T08:29:07.280085416Z [err]  2025-12-17 08:29:07,273 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T08:29:07.280090321Z [err]  2025-12-17 08:29:07,273 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+288ms
2025-12-17T08:29:07.280095083Z [err]  2025-12-17 08:29:07,273 - persistent_tts_service - INFO - ğŸ“¤ Sending 11146 bytes of audio (70 chunks, 1.4s duration) via WebSocket
2025-12-17T08:29:07.280100015Z [err]  2025-12-17 08:29:07,273 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:29:07.280103754Z [err]  2025-12-17 08:29:07,273 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.4s (total: 1.4s from now)
2025-12-17T08:29:07.280108136Z [err]  2025-12-17 08:29:07,274 - persistent_tts_service - INFO - âœ… Sent 70 audio chunks via WebSocket
2025-12-17T08:29:07.480927619Z [err]  2025-12-17 08:29:07,477 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:29:07.480938261Z [err]  2025-12-17 08:29:07,477 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.6s (total: 2.8s from now)
2025-12-17T08:29:07.480944428Z [err]  2025-12-17 08:29:07,478 - persistent_tts_service - INFO - âœ… Sent 82 audio chunks via WebSocket
2025-12-17T08:29:07.480961621Z [err]  2025-12-17 08:29:07,477 - persistent_tts_service - INFO - ğŸ“¤ Sending 13003 bytes of audio (82 chunks, 1.6s duration) via WebSocket
2025-12-17T08:29:07.634628850Z [err]  2025-12-17 08:29:07,632 - persistent_tts_service - INFO - ğŸ“¤ Sending 14489 bytes of audio (91 chunks, 1.8s duration) via WebSocket
2025-12-17T08:29:07.634634325Z [err]  2025-12-17 08:29:07,632 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:29:07.634639551Z [err]  2025-12-17 08:29:07,632 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.8s (total: 4.5s from now)
2025-12-17T08:29:07.635684822Z [err]  2025-12-17 08:29:07,633 - persistent_tts_service - INFO - âœ… Sent 91 audio chunks via WebSocket
2025-12-17T08:29:09.583334786Z [err]  2025-12-17 08:29:09,582 - server - INFO - ğŸ“¤ Audio flowing: 1798 packets sent to Soniox (5s update)
2025-12-17T08:29:09.635682871Z [err]  2025-12-17 08:29:09,632 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T08:29:09.635689149Z [err]  2025-12-17 08:29:09,632 - persistent_tts_service - INFO - âœ… [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Finished streaming sentence #6: 3 chunks received
2025-12-17T08:29:09.635693828Z [err]  2025-12-17 08:29:09,632 - persistent_tts_service - INFO - ğŸ¤ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Streaming sentence #7: What questions come to mind as soon as you hear so...
2025-12-17T08:29:09.933816773Z [err]  2025-12-17 08:29:09,932 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T08:29:09.933826903Z [err]  2025-12-17 08:29:09,932 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+300ms
2025-12-17T08:29:09.933834041Z [err]  2025-12-17 08:29:09,932 - persistent_tts_service - INFO - ğŸ“¤ Sending 12632 bytes of audio (79 chunks, 1.6s duration) via WebSocket
2025-12-17T08:29:09.933840210Z [err]  2025-12-17 08:29:09,932 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:29:09.933845308Z [err]  2025-12-17 08:29:09,932 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.6s (total: 3.7s from now)
2025-12-17T08:29:09.934851723Z [err]  2025-12-17 08:29:09,933 - persistent_tts_service - INFO - âœ… Sent 79 audio chunks via WebSocket
2025-12-17T08:29:10.002616601Z [err]  2025-12-17 08:29:10,000 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (3.7s left)
2025-12-17T08:29:10.099888096Z [err]  2025-12-17 08:29:10,096 - persistent_tts_service - INFO - ğŸ“¤ Sending 14489 bytes of audio (91 chunks, 1.8s duration) via WebSocket
2025-12-17T08:29:10.099896567Z [err]  2025-12-17 08:29:10,096 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T08:29:10.099902168Z [err]  2025-12-17 08:29:10,096 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.8s (total: 5.4s from now)
2025-12-17T08:29:10.099907518Z [err]  2025-12-17 08:29:10,097 - persistent_tts_service - INFO - âœ… Sent 91 audio chunks via WebSocket
2025-12-17T08:29:10.502814287Z [err]  2025-12-17 08:29:10,501 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (5.0s left)
2025-12-17T08:29:10.925477033Z [inf]  100.64.0.3:38306 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 404
2025-12-17T08:29:12.100467475Z [err]  2025-12-17 08:29:12,096 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T08:29:12.100474550Z [err]  2025-12-17 08:29:12,097 - persistent_tts_service - INFO - âœ… [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] Finished streaming sentence #7: 2 chunks received
2025-12-17T08:29:12.100479082Z [err]  2025-12-17 08:29:12,097 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T08:29:12.100483581Z [err]  2025-12-17 08:29:12,097 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T08:29:12.100487941Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5601ms from user stop ğŸš€
2025-12-17T08:29:12.100492299Z [err]  2025-12-17 08:29:12,097 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:12.100497065Z [err]  2025-12-17 08:29:12,097 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T08:29:12.100501589Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T08:29:12.100506135Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T08:29:12.100510486Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] STT: 16ms (provider: soniox, model: stt-rt-v3)
2025-12-17T08:29:12.100514695Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 490ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T08:29:12.100518809Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 5112ms (provider: elevenlabs, websocket: False)
2025-12-17T08:29:12.100523004Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5602ms (user stopped â†’ play_audio_url called)
2025-12-17T08:29:12.102270978Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T08:29:12.102289860Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T08:29:12.102323234Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T08:29:12.102335254Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T08:29:12.102341633Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T08:29:12.102348474Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T08:29:12.102355248Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T08:29:12.102363324Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 5902ms estimated
2025-12-17T08:29:12.102373325Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 164 chars, 2 sentences
2025-12-17T08:29:12.102381169Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Go ahead....'
2025-12-17T08:29:12.102385865Z [err]  2025-12-17 08:29:12,097 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'Okay, in a nutshell, we set up passive income websites, and ...'
2025-12-17T08:29:12.291518395Z [err]  2025-12-17 08:29:12,289 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: N_IntroduceModel_And_AskQuestions_V3_Adaptive, Dead Air: 1006ms)
2025-12-17T08:29:12.291522729Z [err]  2025-12-17 08:29:12,289 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T08:29:14.603762461Z [err]  2025-12-17 08:29:14,600 - server - INFO - ğŸ“¤ Audio flowing: 2049 packets sent to Soniox (5s update)
2025-12-17T08:29:15.263404213Z [err]  2025-12-17 08:29:15,256 - server - INFO - ğŸ¤ Soniox receiver alive - 13 messages received in last 10s
2025-12-17T08:29:15.532838925Z [err]  2025-12-17 08:29:15,531 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.0s ago), marking agent as done speaking
2025-12-17T08:29:15.532845801Z [err]  2025-12-17 08:29:15,531 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765960155.5317461 for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:15.532851496Z [err]  2025-12-17 08:29:15,531 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:16.029070949Z [err]  2025-12-17 08:29:15,781 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T08:29:17.458995896Z [err]  2025-12-17 08:29:17,454 - server - INFO - ğŸ“ Telnyx WebSocket disconnected. Sent 2180 total packets
2025-12-17T08:29:17.459003345Z [err]  [2025-12-17 08:29:17 +0000] [6] [INFO] connection closed
2025-12-17T08:29:17.459007664Z [err]  2025-12-17 08:29:17,456 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T08:29:17.459011508Z [err]  2025-12-17 08:29:17,456 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.hangup', 'id': 'c4587cc3-bc93-4cc0-86f8-ab476727626e', 'occurred_at': '2025-12-17T08:29:17.163241Z', 'payload': {'call_control_id': 'v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'call_leg_id': '5cbaced4-db22-11f0-ac87-02420aef98a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '8.89', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '2206', 'skip_packet_count': '19'}, 'outbound': {'packet_count': '2191', 'skip_packet_count': '0'}}, 'call_session_id': '5cb76668-db22-11f0-b191-02420aef98a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T08:29:17.163241Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-17T08:28:28.043230Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T08:29:17.459018495Z [err]  2025-12-17 08:29:17,456 - server - INFO - ğŸ¯ Event type: call.hangup, Call ID: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:17.459023390Z [err]  2025-12-17 08:29:17,456 - server - INFO - ğŸ“¨ ================================================
2025-12-17T08:29:17.459027636Z [err]  2025-12-17 08:29:17,456 - server - INFO - ğŸ“ Call ended: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:17.459031484Z [err]  2025-12-17 08:29:17,456 - server - INFO - ğŸ“ Hangup cause: normal_clearing
2025-12-17T08:29:17.631892495Z [err]  2025-12-17 08:29:17,630 - server - INFO - ğŸ“ Updated call log: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.003605469Z [err]  2025-12-17 08:29:17,720 - server - INFO - âœ… Finalized call log: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA (duration=44s, status=completed)
2025-12-17T08:29:18.003611904Z [inf]  100.64.0.5:40684 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T08:29:18.003618201Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T08:29:18.003624132Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T08:29:18.003630500Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '09628c49-9b49-4744-8aea-ee50084a7dc6', 'occurred_at': '2025-12-17T08:29:17.203236Z', 'payload': {'call_control_id': 'v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'call_leg_id': '5cbaced4-db22-11f0-ac87-02420aef98a0', 'call_session_id': '5cb76668-db22-11f0-b191-02420aef98a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T08:29:17.203236Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'vHvt_S4S2Q', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T08:29:18.003637439Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '07fb73da-d6e0-4b79-bfd6-470aea9c5bdb', 'occurred_at': '2025-12-17T08:29:17.357431Z', 'payload': {'call_control_id': 'v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'call_leg_id': '5cbaced4-db22-11f0-ac87-02420aef98a0', 'call_session_id': '5cb76668-db22-11f0-b191-02420aef98a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': 'f34fa29c-dd31-473a-8a04-52783c3d5bd2', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T08:29:18.007330614Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ¯ Event type: call.playback.ended, Call ID: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.007338649Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ¯ Event type: streaming.stopped, Call ID: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.007350597Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ“¨ ================================================
2025-12-17T08:29:18.007357625Z [err]  2025-12-17 08:29:17,788 - server - INFO - ğŸ“¨ ================================================
2025-12-17T08:29:18.007363486Z [err]  2025-12-17 08:29:17,793 - redis_service - INFO - â– Removed playback vHvt_S4S2Q, 0 remaining for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.007369703Z [err]  2025-12-17 08:29:17,793 - server - INFO - ğŸ”Š Redis: Removed playback vHvt_S4S2Q, 0 remaining
2025-12-17T08:29:18.007375170Z [err]  2025-12-17 08:29:17,793 - server - INFO - ğŸ”Š ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-17T08:29:18.007380756Z [err]  2025-12-17 08:29:17,793 - server - INFO - â±ï¸ CLEARED playback_expected_end_time - agent is definitely done speaking
2025-12-17T08:29:18.007386113Z [err]  2025-12-17 08:29:17,795 - server - INFO - âœ… Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-17T08:29:18.007391978Z [err]  2025-12-17 08:29:17,795 - server - INFO - âœ… Found session locally: agent_speaking=False, user_speaking=False
2025-12-17T08:29:18.007397514Z [err]  2025-12-17 08:29:17,795 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765960157.7951083 for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.007403352Z [err]  2025-12-17 08:29:17,795 - server - INFO - â±ï¸ Silence timer STARTED (local, agent wasn't marked as speaking)
2025-12-17T08:29:18.007409014Z [inf]  100.64.0.5:40702 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T08:29:18.010318020Z [err]  2025-12-17 08:29:17,808 - server - INFO - ğŸ“¦ Saved 11 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2025-12-17T08:29:18.462193783Z [err]  2025-12-17 08:29:18,457 - server - INFO - ğŸ“Š Auto-added call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-17T08:29:18.636940478Z [err]  2025-12-17 08:29:18,634 - server - INFO - ğŸ“¤ Sending post-call webhook to: http://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-17T08:29:18.637833415Z [err]  2025-12-17 08:29:18,637 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.637840354Z [err]  2025-12-17 08:29:18,637 - server - INFO - ğŸ“‡ [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-17T08:29:18.637845819Z [err]  2025-12-17 08:29:18,637 - server - INFO - ğŸ“‡ [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-17T08:29:18.943324028Z [inf]  100.64.0.6:40058 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T08:29:18.943331628Z [err]  2025-12-17 08:29:18,812 - server - INFO - ğŸ” Starting QC analysis for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.943359916Z [err]  2025-12-17 08:29:18,724 - server - INFO - ğŸ“‡ [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-17T08:29:18.943365076Z [err]  2025-12-17 08:29:18,810 - server - INFO - ğŸ“‡ [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=28750bac-e16d-4c5f-abd6-ec6d72376c5b, to_number=+17708336397
2025-12-17T08:29:18.943381171Z [err]  2025-12-17 08:29:18,810 - server - INFO - ğŸ“‡ [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=28750bac-e16d-4c5f-abd6-ec6d72376c5b, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3-copy
2025-12-17T08:29:18.943397330Z [err]  2025-12-17 08:29:18,810 - server - INFO - ğŸ“‡ [HANGUP] Agent info keys: None
2025-12-17T08:29:18.943407431Z [err]  2025-12-17 08:29:18,810 - server - INFO - ğŸš€ Triggered QC analysis for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.943416681Z [err]  2025-12-17 08:29:18,810 - server - INFO - ğŸ“Š Triggered Campaign QC for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.943426090Z [err]  2025-12-17 08:29:18,810 - server - INFO - ğŸ“‡ Triggered CRM update for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.943439720Z [err]  2025-12-17 08:29:18,810 - server - INFO - âœ… Closed persistent TTS session for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.943449645Z [err]  2025-12-17 08:29:18,811 - redis_service - INFO - ğŸ§¹ Deleted call data from Redis: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.943460854Z [err]  2025-12-17 08:29:18,811 - server - INFO - ğŸ§¹ Cleaned up call session from Redis and memory: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.944873783Z [err]  2025-12-17 08:29:18,812 - server - INFO - ğŸ” [AUTO-QC] Starting campaign QC check for call=v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=28750bac-e16d-4c5f-abd6-ec6d72376c5b
2025-12-17T08:29:18.944883489Z [err]  2025-12-17 08:29:18,813 - server - INFO - ğŸ“‡ CRM update starting for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T08:29:18.944913186Z [err]  2025-12-17 08:29:18,813 - server - INFO - ğŸ“‡ Normalized phone: +17708336397
2025-12-17T08:29:18.944935937Z [err]  2025-12-17 08:29:18,813 - server - INFO - ğŸ“‡ CRM: Got 11 variables from active session
2025-12-17T08:29:18.944943324Z [err]  2025-12-17 08:29:18,899 - server - INFO - ğŸ“ Converted transcript from 8 messages to 623 characters
2025-12-17T08:29:18.959875861Z [err]  2025-12-17 08:29:18,959 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T08:29:18.959882202Z [err]  2025-12-17 08:29:18,959 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'ca798a0b-6201-47a9-b26b-b580c1c57b6c', 'occurred_at': '2025-12-17T08:29:18.739020Z', 'payload': {'call_control_id': 'v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'call_leg_id': '5cbaced4-db22-11f0-ac87-02420aef98a0', 'call_session_id': '5cb76668-db22-11f0-b191-02420aef98a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T08:29:17.264757Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-17T08:29:17.264757Z', 'recording_id': 'e9032536-add1-4983-8fde-f3e9bbaad4a7', 'recording_started_at': '2025-12-17T08:28:35.657480Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/5cbaced4-db22-11f0-ac87-02420aef98a0-1765960114751603.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T082918Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=22322aa3a2f53e292a2cf828389a9db6977ada82749b0aec318f74ac2876ec0b'}, 'start_time': '2025-12-17T08:28:35.657480Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T08:29:18.959886782Z [err]  2025-12-17 08:29:18,959 - server - INFO - ğŸ¯ Event type: call.recording.saved, Call ID: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.959891311Z [err]  2025-12-17 08:29:18,959 - server - INFO - ğŸ“¨ ================================================
2025-12-17T08:29:18.961070034Z [err]  2025-12-17 08:29:18,959 - server - INFO - ğŸ™ï¸ Recording saved for call: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.964802847Z [err]  2025-12-17 08:29:18,963 - redis_service - WARNING - âš ï¸ Call data not found in Redis: v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:18.964808585Z [err]  2025-12-17 08:29:18,963 - server - INFO - ğŸ” Recording check: download_url=True, channels=dual, recording_id=e9032536-add1-4983-8fde-f3e9bbaad4a7, call_data=False
2025-12-17T08:29:18.994732128Z [err]  2025-12-17 08:29:18,985 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T08:29:19.045375810Z [err]  2025-12-17 08:29:19,044 - httpx - INFO - HTTP Request: POST http://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 502 Bad Gateway"
2025-12-17T08:29:19.046787681Z [err]  2025-12-17 08:29:19,045 - server - WARNING - âš ï¸ Post-call webhook returned status 502: <!DOCTYPE html>
2025-12-17T08:29:19.046795617Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2025-12-17T08:29:19.046802331Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2025-12-17T08:29:19.046823952Z [err]  <!--[if IE 8]>    <html class="no-
2025-12-17T08:29:19.056661692Z [err]  2025-12-17 08:29:19,052 - server - INFO - ğŸ’¾ Saved recording URL and ID to database: e9032536-add1-4983-8fde-f3e9bbaad4a7
2025-12-17T08:29:19.056667804Z [err]  2025-12-17 08:29:19,052 - server - INFO - âœ… Entering dual-channel processing
2025-12-17T08:29:19.056672213Z [err]  2025-12-17 08:29:19,052 - server - INFO - ğŸ“¥ Downloading DUAL-CHANNEL recording...
2025-12-17T08:29:19.074057997Z [err]  2025-12-17 08:29:19,071 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-17T08:29:19.162534320Z [err]  2025-12-17 08:29:19,157 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-17T08:29:19.162543282Z [err]  2025-12-17 08:29:19,157 - qc_agents.orchestrator - INFO - âœ… Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T08:29:19.162548520Z [err]  2025-12-17 08:29:19,157 - qc_agents.orchestrator - INFO - ğŸ” Running Commitment Detector on call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:19.399244421Z [err]  2025-12-17 08:29:19,394 - server - INFO - ğŸ” [AUTO-QC] Call log found: transcript_turns=8, logs_count=10, status=completed
2025-12-17T08:29:19.400292998Z [err]  2025-12-17 08:29:19,399 - server - INFO - ğŸ“‡ CRM: Got 11 extracted variables
2025-12-17T08:29:19.400300782Z [err]  2025-12-17 08:29:19,399 - server - INFO - ğŸ“‡ CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2025-12-17T08:29:19.473077800Z [err]  2025-12-17 08:29:19,471 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/5cbaced4-db22-11f0-ac87-02420aef98a0-1765960114751603.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T082918Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=22322aa3a2f53e292a2cf828389a9db6977ada82749b0aec318f74ac2876ec0b "HTTP/1.1 200 OK"
2025-12-17T08:29:19.576717862Z [err]  2025-12-17 08:29:19,575 - server - INFO - ğŸ“‡ CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-17T08:29:20.040631647Z [err]  2025-12-17 08:29:19,740 - server - INFO - ğŸ” [AUTO-QC] Agent found: name=JK First Caller-optimizer3-copy, has_auto_qc_settings=True
2025-12-17T08:29:20.040636626Z [err]  2025-12-17 08:29:19,756 - server - INFO - âœ… Downloaded 166599 bytes
2025-12-17T08:29:20.040641756Z [err]  2025-12-17 08:29:19,828 - server - INFO - ğŸ“Š [AUTO-QC] Running full QC analysis: call=v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA â†’ campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-17T08:29:20.040646570Z [err]  2025-12-17 08:29:19,828 - server - INFO - ğŸ“Š [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-17T08:29:20.040653406Z [err]  2025-12-17 08:29:19,828 - server - ERROR - âŒ [AUTO-QC] Error in campaign QC for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T08:29:20.040665660Z [err]  2025-12-17 08:29:19,828 - server - ERROR - âŒ [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-17T08:29:20.040671483Z [err]    File "/app/backend/server.py", line 9510, in trigger_campaign_qc_for_call
2025-12-17T08:29:20.040676070Z [err]      await run_full_qc_analysis(
2025-12-17T08:29:20.040681369Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-17T08:29:20.040685848Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T08:29:20.040690984Z [err]  
2025-12-17T08:29:20.040696106Z [err]  2025-12-17 08:29:19,984 - server - INFO - âœ… Split into 2 channels
2025-12-17T08:29:20.040700835Z [err]  2025-12-17 08:29:19,984 - server - INFO - ğŸ¤ Using STT provider: soniox for interruption detection
2025-12-17T08:29:20.040706046Z [err]  2025-12-17 08:29:19,985 - server - INFO - ğŸ“Š Channel 0: 914364 bytes
2025-12-17T08:29:20.040711422Z [err]  2025-12-17 08:29:19,985 - server - ERROR - âŒ No Soniox API key available
2025-12-17T08:29:20.040887569Z [err]  2025-12-17 08:29:19,985 - server - INFO - âŒ Channel 0: No speech
2025-12-17T08:29:20.040891501Z [err]  2025-12-17 08:29:19,985 - server - INFO - ğŸ“Š Channel 1: 914364 bytes
2025-12-17T08:29:20.040897510Z [err]  2025-12-17 08:29:19,985 - server - ERROR - âŒ No Soniox API key available
2025-12-17T08:29:20.040902198Z [err]  2025-12-17 08:29:19,985 - server - INFO - âŒ Channel 1: No speech
2025-12-17T08:29:20.040906817Z [err]  2025-12-17 08:29:19,985 - server - WARNING - âš ï¸ No speech in any channel
2025-12-17T08:29:20.040911132Z [inf]  100.64.0.2:57094 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T08:29:20.052522437Z [err]  2025-12-17 08:29:20,050 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=2.3s, checkin_count=0/2
2025-12-17T08:29:20.558775730Z [err]  2025-12-17 08:29:20,552 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=2.8s, checkin_count=0/2
2025-12-17T08:29:21.348484669Z [inf]  100.64.0.8:21496 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 404
2025-12-17T08:29:25.084433004Z [err]  2025-12-17 08:29:25,065 - calling_service - INFO - â° Check-in triggered after 7.3s silence (threshold: 7s)
2025-12-17T08:29:25.084437976Z [err]  2025-12-17 08:29:25,066 - calling_service - INFO - ğŸ’¬ Sending check-in #1/2: Are you still there?
2025-12-17T08:29:25.084442827Z [err]  2025-12-17 08:29:25,066 - dead_air_monitor - INFO - ğŸ’¬ Sending check-in after 7.3s silence: Are you still there?
2025-12-17T08:29:25.084447750Z [err]  2025-12-17 08:29:25,066 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:25.084453414Z [err]  2025-12-17 08:29:25,066 - telnyx_service - INFO - ğŸ”Š Speaking text on call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA: Are you still there?...
2025-12-17T08:29:25.084459294Z [err]  2025-12-17 08:29:25,066 - telnyx_service - INFO - ğŸ” Agent config provided: True
2025-12-17T08:29:25.084466105Z [err]  2025-12-17 08:29:25,066 - telnyx_service - INFO - ğŸ” TTS provider from settings: elevenlabs
2025-12-17T08:29:25.084471442Z [err]  2025-12-17 08:29:25,066 - telnyx_service - INFO - ğŸ” WebSocket TTS: False
2025-12-17T08:29:25.084479993Z [err]  2025-12-17 08:29:25,066 - telnyx_service - INFO - ğŸ™ï¸ Attempting elevenlabs TTS (REST)
2025-12-17T08:29:25.084484356Z [err]  2025-12-17 08:29:25,066 - server - INFO - â±ï¸ [08:29:25.066] ğŸ”Š TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-17T08:29:25.084487990Z [err]  2025-12-17 08:29:25,066 - server - INFO - âš¡ Using Flash v2.5 (fastest - 75ms)
2025-12-17T08:29:25.084492202Z [err]  2025-12-17 08:29:25,066 - server - INFO - ğŸ™ï¸ ElevenLabs streaming TTS: voice=f5HLTX707KIM4SzJYzSz, model=eleven_flash_v2_5, speed=1.1, normalization=on, ssml=False
2025-12-17T08:29:25.162516218Z [err]  2025-12-17 08:29:25,160 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T08:29:25.162523089Z [err]  2025-12-17 08:29:25,160 - server - INFO - ğŸ“¦ ElevenLabs Request Payload:
2025-12-17T08:29:25.162529044Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Text length: 20 chars
2025-12-17T08:29:25.162535471Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Text content: 'Are you still there?'
2025-12-17T08:29:25.162542124Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-17T08:29:25.162548109Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Model: eleven_flash_v2_5
2025-12-17T08:29:25.162552225Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Voice ID: f5HLTX707KIM4SzJYzSz
2025-12-17T08:29:25.162556285Z [err]  2025-12-17 08:29:25,160 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/f5HLTX707KIM4SzJYzSz/stream
2025-12-17T08:29:25.162561288Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_flash_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': False, 'optimize_streaming_latency': 4}
2025-12-17T08:29:25.162565765Z [err]  2025-12-17 08:29:25,160 - server - INFO - ğŸ”Œ Attempting ElevenLabs connection (attempt 1/2)
2025-12-17T08:29:25.162572170Z [err]  2025-12-17 08:29:25,160 - server - INFO -    Timeout: 10.0s
2025-12-17T08:29:25.170904430Z [err]  2025-12-17 08:29:25,169 - server - INFO -    âœ“ HTTP client created (0.008s)
2025-12-17T08:29:25.170914332Z [err]  2025-12-17 08:29:25,169 - server - INFO -    â†’ Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-17T08:29:25.464637697Z [err]  2025-12-17 08:29:25,460 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/f5HLTX707KIM4SzJYzSz/stream "HTTP/1.1 200 OK"
2025-12-17T08:29:25.464647478Z [err]  2025-12-17 08:29:25,460 - server - INFO -    âœ“ Connection established (0.300s) [TARGET: <200ms]
2025-12-17T08:29:25.464653055Z [err]  2025-12-17 08:29:25,460 - server - INFO -    âœ“ Response status: 200
2025-12-17T08:29:25.464657480Z [err]  2025-12-17 08:29:25,460 - server - INFO -    â†’ Streaming audio chunks...
2025-12-17T08:29:25.482668255Z [err]  2025-12-17 08:29:25,472 - server - INFO -    âœ“ FIRST CHUNK received (0.312s, 1038 bytes) [TARGET: <300ms]
2025-12-17T08:29:25.482675481Z [err]  2025-12-17 08:29:25,475 - server - INFO -    âœ“ ALL CHUNKS received: 58 chunks (0.314s)
2025-12-17T08:29:25.482680974Z [err]  2025-12-17 08:29:25,475 - server - INFO -    âœ“ Total audio size: 17181 bytes
2025-12-17T08:29:25.482685566Z [err]  2025-12-17 08:29:25,475 - server - INFO -    ğŸ“Š TTS API TIMING BREAKDOWN:
2025-12-17T08:29:25.482691124Z [err]  2025-12-17 08:29:25,475 - server - INFO -       - Connection: 300ms
2025-12-17T08:29:25.482695722Z [err]  2025-12-17 08:29:25,475 - server - INFO -       - First chunk: 312ms
2025-12-17T08:29:25.482701409Z [err]  2025-12-17 08:29:25,475 - server - INFO -       - All chunks: 314ms
2025-12-17T08:29:25.482705859Z [err]  2025-12-17 08:29:25,475 - server - INFO -       - Audio generation only: 12ms
2025-12-17T08:29:25.482711595Z [err]  2025-12-17 08:29:25,475 - server - INFO - â±ï¸ [08:29:25.475] ğŸ”Š TTS COMPLETE: 409ms, audio_size=17181 bytes
2025-12-17T08:29:25.482715527Z [err]  2025-12-17 08:29:25,475 - server - INFO - ğŸ’¾ TTS CACHED: elevenlabs:Are you still there?... (17181 bytes)
2025-12-17T08:29:25.482721723Z [err]  2025-12-17 08:29:25,475 - telnyx_service - INFO - â±ï¸  TTS generation time: 0.41s
2025-12-17T08:29:25.482725653Z [err]  2025-12-17 08:29:25,475 - telnyx_service - INFO - âœ… Generated 17181 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T08:29:25.482729547Z [err]  2025-12-17 08:29:25,475 - telnyx_service - INFO - ğŸ”— Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T08:29:25.935414558Z [err]      {
2025-12-17T08:29:25.935422992Z [err]        "code": "90018",
2025-12-17T08:29:25.935431121Z [err]        "title": "Call has already ended",
2025-12-17T08:29:25.935439339Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-17T08:29:25.935446715Z [err]      }
2025-12-17T08:29:25.935454271Z [err]    ]
2025-12-17T08:29:25.935464259Z [err]  2025-12-17 08:29:25,753 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T08:29:25.935466401Z [err]  }
2025-12-17T08:29:25.935471348Z [err]  2025-12-17 08:29:25,753 - telnyx_service - INFO - â±ï¸  Playback API call time: 0.28s
2025-12-17T08:29:25.935479757Z [err]  2025-12-17 08:29:25,754 - telnyx_service - INFO - ğŸ“¢ Using Telnyx built-in TTS
2025-12-17T08:29:25.935479840Z [err]  2025-12-17 08:29:25,753 - telnyx_service - ERROR - âŒ Telnyx playback failed: 422 - {
2025-12-17T08:29:25.935486249Z [err]    "errors": [
2025-12-17T08:29:26.024709062Z [err]  2025-12-17 08:29:26,018 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T08:29:26.024718474Z [err]  2025-12-17 08:29:26,019 - telnyx_service - ERROR - âŒ Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-17T08:29:26.024725973Z [err]  2025-12-17 08:29:26,019 - dead_air_monitor - INFO - âœ… Check-in message sent
2025-12-17T08:29:26.533044785Z [err]  2025-12-17 08:29:26,520 - dead_air_monitor - INFO - ğŸš© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-17T08:29:26.533049274Z [err]  2025-12-17 08:29:26,520 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765960166.5205245 for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:26.533053224Z [err]  2025-12-17 08:29:26,520 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:30.077281547Z [err]  2025-12-17 08:29:30,034 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=3.5s, checkin_count=1/2
2025-12-17T08:29:30.537415780Z [err]  2025-12-17 08:29:30,535 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=4.0s, checkin_count=1/2
2025-12-17T08:29:31.596466440Z [err]  2025-12-17 08:29:31,588 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T08:29:31.596472446Z [err]  2025-12-17 08:29:31,591 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T08:29:31.596476834Z [err]  2025-12-17 08:29:31,592 - qc_agents.orchestrator - INFO - ğŸ—ºï¸  Running Conversion Pathfinder on call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:32.016448472Z [inf]  100.64.0.9:61200 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 404
2025-12-17T08:29:33.549233361Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - âœ… Generated 17181 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T08:29:33.549235241Z [err]  2025-12-17 08:29:33,546 - calling_service - INFO - â° Check-in triggered after 7.0s silence (threshold: 7s)
2025-12-17T08:29:33.549240666Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - ğŸ”— Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T08:29:33.549243661Z [err]  2025-12-17 08:29:33,547 - calling_service - INFO - ğŸ’¬ Sending FINAL check-in #2/2: Are you still there?
2025-12-17T08:29:33.549248523Z [err]  2025-12-17 08:29:33,547 - calling_service - INFO - âš ï¸ Will end call if no response after next silence timeout
2025-12-17T08:29:33.549253044Z [err]  2025-12-17 08:29:33,547 - dead_air_monitor - INFO - ğŸ’¬ Sending check-in after 7.0s silence: Are you still there?
2025-12-17T08:29:33.549307031Z [err]  2025-12-17 08:29:33,547 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:33.549312085Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - ğŸ”Š Speaking text on call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA: Are you still there?...
2025-12-17T08:29:33.549316396Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - ğŸ” Agent config provided: True
2025-12-17T08:29:33.549320987Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - ğŸ” TTS provider from settings: elevenlabs
2025-12-17T08:29:33.549326110Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - ğŸ” WebSocket TTS: False
2025-12-17T08:29:33.549345100Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - ğŸ™ï¸ Attempting elevenlabs TTS (REST)
2025-12-17T08:29:33.549349502Z [err]  2025-12-17 08:29:33,547 - server - INFO - ğŸ’¾ TTS CACHE HIT: Returning cached audio (17181 bytes)
2025-12-17T08:29:33.549353999Z [err]  2025-12-17 08:29:33,547 - telnyx_service - INFO - â±ï¸  TTS generation time: 0.00s
2025-12-17T08:29:34.026260085Z [err]  2025-12-17 08:29:33,836 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T08:29:34.026264908Z [err]  2025-12-17 08:29:33,837 - telnyx_service - INFO - â±ï¸  Playback API call time: 0.29s
2025-12-17T08:29:34.026271269Z [err]  2025-12-17 08:29:33,837 - telnyx_service - ERROR - âŒ Telnyx playback failed: 422 - {
2025-12-17T08:29:34.026276380Z [err]    "errors": [
2025-12-17T08:29:34.026282794Z [err]      {
2025-12-17T08:29:34.026287052Z [err]        "code": "90018",
2025-12-17T08:29:34.026291335Z [err]        "title": "Call has already ended",
2025-12-17T08:29:34.026300013Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-17T08:29:34.026304489Z [err]      }
2025-12-17T08:29:34.026310535Z [err]    ]
2025-12-17T08:29:34.026314882Z [err]  }
2025-12-17T08:29:34.026321180Z [err]  2025-12-17 08:29:33,837 - telnyx_service - INFO - ğŸ“¢ Using Telnyx built-in TTS
2025-12-17T08:29:34.113259959Z [err]  2025-12-17 08:29:34,102 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T08:29:34.113270618Z [err]  2025-12-17 08:29:34,103 - telnyx_service - ERROR - âŒ Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-17T08:29:34.113277099Z [err]  2025-12-17 08:29:34,103 - dead_air_monitor - INFO - âœ… Check-in message sent
2025-12-17T08:29:37.416628560Z [err]  2025-12-17 08:29:37,409 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T08:29:37.428999875Z [err]  2025-12-17 08:29:37,421 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T08:29:37.429004883Z [err]  2025-12-17 08:29:37,421 - qc_agents.orchestrator - INFO - â­ Running Excellence Replicator on call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:37.449801864Z [err]  2025-12-17 08:29:37,448 - server - INFO - ğŸ¤ Soniox receiver alive - 3 messages received in last 10s
2025-12-17T08:29:37.449808905Z [err]  2025-12-17 08:29:37,448 - server - ERROR - âŒ Soniox error: {'tokens': [], 'final_audio_proc_ms': 38640, 'total_audio_proc_ms': 43440, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-17T08:29:37.449814829Z [err]  2025-12-17 08:29:37,448 - server - INFO - âœ… Soniox receive loop ended normally
2025-12-17T08:29:37.449821537Z [err]  2025-12-17 08:29:37,448 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring cancelled for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:37.449827241Z [err]  2025-12-17 08:29:37,448 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring stopped for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:37.449833549Z [err]  2025-12-17 08:29:37,448 - server - INFO - ğŸ”‡ Dead air monitoring task cancelled
2025-12-17T08:29:39.451804266Z [err]  2025-12-17 08:29:39,450 - soniox_service - ERROR - âŒ Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-17T08:29:39.451810924Z [err]  2025-12-17 08:29:39,450 - server - INFO - ğŸ”Œ Telnyx WebSocket disconnected
2025-12-17T08:29:42.410611724Z [inf]  100.64.0.4:25706 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 404
2025-12-17T08:29:43.089810271Z [err]  2025-12-17 08:29:43,034 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T08:29:43.089815316Z [err]  2025-12-17 08:29:43,035 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-17T08:29:43.129560124Z [err]  2025-12-17 08:29:43,128 - qc_agents.orchestrator - INFO - âœ… QC analysis stored for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:43.129568729Z [err]  2025-12-17 08:29:43,128 - server - INFO - âœ… QC analysis completed for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:43.129575445Z [err]  2025-12-17 08:29:43,128 - server - INFO - ğŸ“Š Scores: Commitment=50, Conversion=60, Excellence=50
2025-12-17T08:29:43.310421273Z [err]  2025-12-17 08:29:43,304 - server - INFO - ğŸ“Š Updated campaign_calls with QC scores for v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA
2025-12-17T08:29:43.482485894Z [err]  2025-12-17 08:29:43,481 - server - INFO - ğŸ“ˆ Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-17T08:29:43.638941015Z [err]  2025-12-17 08:29:43,569 - server - INFO - ğŸ·ï¸ Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-17T08:29:43.638945071Z [err]  2025-12-17 08:29:43,569 - server - ERROR - âŒ Error in auto appointment detection for call v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA: 'str' object has no attribute 'get'
2025-12-17T08:29:52.991998904Z [inf]  100.64.0.7:44190 - "GET /api/crm/analytics/call/v3%3A_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA HTTP/1.1" 200
2025-12-17T09:28:43.137309785Z [err]  2025-12-17 09:28:36,220 - elevenlabs_ws_service - ERROR - âŒ Error sending text to ElevenLabs: no close frame received or sent
2025-12-17T10:03:29.228929766Z [inf]  100.64.0.10:57312 - "GET / HTTP/1.1" 404
2025-12-17T10:11:30.571387633Z [inf]  100.64.0.8:52200 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-17T10:11:30.571393014Z [inf]  100.64.0.3:46262 - "POST /api/telnyx/call/outbound HTTP/1.1" 401
2025-12-17T10:14:10.342481193Z [inf]  100.64.0.6:52718 - "GET /api/auth/me HTTP/1.1" 401
2025-12-17T10:14:10.342488587Z [inf]  100.64.0.4:57506 - "OPTIONS /api/auth/login HTTP/1.1" 200
2025-12-17T10:14:11.114432737Z [inf]  100.64.0.6:52718 - "POST /api/auth/login HTTP/1.1" 200
2025-12-17T10:14:12.137945685Z [inf]  100.64.0.6:52718 - "GET /api/agents HTTP/1.1" 200
2025-12-17T10:14:18.736613551Z [inf]  100.64.0.9:44896 - "GET /api/agents HTTP/1.1" 200
2025-12-17T10:14:38.751055639Z [err]  2025-12-17 10:14:35,326 - server - INFO - ğŸŒ Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:14:38.751069692Z [err]  2025-12-17 10:14:35,417 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:38.751076020Z [err]  2025-12-17 10:14:35,503 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:38.751081523Z [err]  2025-12-17 10:14:35,537 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:14:38.751087037Z [err]  2025-12-17 10:14:35,537 - telnyx_service - INFO - ğŸ“ Initiating outbound call from +14048000152 to +17708336397
2025-12-17T10:14:38.751095380Z [err]  2025-12-17 10:14:35,537 - telnyx_service - INFO - ğŸ¤– Enabling AMD (premium mode)
2025-12-17T10:14:38.751101236Z [err]  2025-12-17 10:14:35,537 - telnyx_service - INFO - ğŸŒ Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:14:38.751110666Z [err]  2025-12-17 10:14:36,625 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-17T10:14:38.751117329Z [err]  2025-12-17 10:14:36,627 - telnyx_service - INFO - âœ… Call initiated: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:38.751123500Z [err]  2025-12-17 10:14:36,720 - server - INFO - ğŸ“ Created call log: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:38.751129177Z [err]  2025-12-17 10:14:36,736 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (TTL: 3600s)
2025-12-17T10:14:38.751134377Z [err]  2025-12-17 10:14:36,736 - server - INFO - ğŸ“¦ Call data stored in Redis and memory
2025-12-17T10:14:38.751139766Z [err]  2025-12-17 10:14:36,736 - server - INFO - ğŸ“ Outbound call initiated: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:38.752316359Z [inf]  100.64.0.6:52718 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-17T10:14:38.752320537Z [err]  2025-12-17 10:14:37,030 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:38.752324593Z [err]  2025-12-17 10:14:37,030 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.initiated', 'id': '6089dc6c-7cb7-4923-bb3f-7ce0895da08f', 'occurred_at': '2025-12-17T10:14:36.380567Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:38.752328550Z [err]  2025-12-17 10:14:37,030 - server - INFO - ğŸ¯ Event type: call.initiated, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:38.752332082Z [err]  2025-12-17 10:14:37,030 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:38.752337817Z [err]  2025-12-17 10:14:37,030 - server - INFO - ğŸ“ Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-17T10:14:38.752352918Z [inf]  100.64.0.7:41570 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:38.752357432Z [err]  2025-12-17 10:14:37,038 - server - INFO - ğŸ”ŒğŸ”ŒğŸ”Œ WEBSOCKET CONNECTION ATTEMPT
2025-12-17T10:14:38.752362130Z [err]  2025-12-17 10:14:37,038 - server - INFO -    Client: Address(host='100.64.0.8', port=32558)
2025-12-17T10:14:38.752366585Z [err]  2025-12-17 10:14:37,038 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'DWbqitVwCy3EkrAc7COh1Q==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-east4-eqdc4a', 'x-railway-request-id': 'OEK026RtTt2lxv6_BT7zVQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1765966476881', 'accept-encoding': 'gzip'}
2025-12-17T10:14:38.759275843Z [err]  2025-12-17 10:14:37,038 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-17T10:14:38.759290522Z [err]  2025-12-17 10:14:37,038 - server - INFO - ğŸ”Œ Incoming Telnyx WebSocket connection
2025-12-17T10:14:38.759298897Z [err]  [2025-12-17 10:14:37 +0000] [6] [INFO] ('100.64.0.8', 32558) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-17T10:14:38.759306136Z [err]  2025-12-17 10:14:37,038 - server - INFO - âœ… WebSocket accepted, waiting for Telnyx events
2025-12-17T10:14:38.759313428Z [err]  [2025-12-17 10:14:37 +0000] [6] [INFO] connection open
2025-12-17T10:14:38.759320799Z [err]  2025-12-17 10:14:37,189 - server - INFO - ğŸ“¬ Received Telnyx event: connected
2025-12-17T10:14:38.759327169Z [err]  2025-12-17 10:14:37,189 - server - INFO - ğŸ“ Telnyx connected event received, waiting for 'start'...
2025-12-17T10:14:40.190145713Z [err]  2025-12-17 10:14:40,187 - server - INFO - ğŸ“¬ Received Telnyx event: start
2025-12-17T10:14:40.190152338Z [err]  2025-12-17 10:14:40,187 - server - INFO - ğŸ¬ Stream started for call: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.199540249Z [err]  2025-12-17 10:14:40,198 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.201256756Z [err]  2025-12-17 10:14:40,199 - server - INFO - âœ… Call data found after 0s wait
2025-12-17T10:14:40.201264545Z [err]  2025-12-17 10:14:40,199 - server - INFO - â³ Session not found locally, waiting briefly for webhook...
2025-12-17T10:14:40.693063735Z [err]  2025-12-17 10:14:40,689 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:40.693067544Z [err]  2025-12-17 10:14:40,689 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.answered', 'id': 'a20425a4-8f67-4870-a09e-13d4e2839b15', 'occurred_at': '2025-12-17T10:14:39.940572Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-17T10:14:36.380567Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:40.693071767Z [err]  2025-12-17 10:14:40,689 - server - INFO - ğŸ¯ Event type: call.answered, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.693075940Z [err]  2025-12-17 10:14:40,689 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:40.693080347Z [err]  2025-12-17 10:14:40,689 - server - INFO - âœ… Call answered: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.700859582Z [err]  2025-12-17 10:14:40,698 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.700866043Z [err]  2025-12-17 10:14:40,699 - server - INFO - âš ï¸ Session still not found after wait, will create in worker
2025-12-17T10:14:40.700870973Z [err]  2025-12-17 10:14:40,699 - server - WARNING - âš ï¸ Session not found after waiting, creating in WebSocket worker...
2025-12-17T10:14:40.700875429Z [err]  2025-12-17 10:14:40,699 - server - INFO - âœ… Found call in Redis (multi-worker state sharing working)
2025-12-17T10:14:40.701041237Z [err]  2025-12-17 10:14:40,699 - server - INFO - ğŸ“ Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-17T10:14:40.710018885Z [err]  2025-12-17 10:14:40,704 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.710030605Z [err]  2025-12-17 10:14:40,705 - server - INFO - ğŸ“ Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:14:40.710037203Z [err]  2025-12-17 10:14:40,705 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:14:40.777408067Z [err]  2025-12-17 10:14:40,769 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:40.777414994Z [err]  2025-12-17 10:14:40,769 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.started', 'id': '363590e0-184f-4f15-8649-08bcc7f093a4', 'occurred_at': '2025-12-17T10:14:40.400575Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '05e8bcaf-616d-4b51-9e44-3ad229ed955d', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:40.777421588Z [err]  2025-12-17 10:14:40,769 - server - INFO - ğŸ¯ Event type: streaming.started, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:40.777429849Z [err]  2025-12-17 10:14:40,769 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:40.777440244Z [inf]  100.64.0.4:57506 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:40.797516307Z [err]  2025-12-17 10:14:40,792 - server - INFO - âœ… Call log updated
2025-12-17T10:14:40.797527261Z [err]  2025-12-17 10:14:40,793 - server - INFO - ğŸ”§ Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:14:40.814961620Z [err]  2025-12-17 10:14:40,806 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:14:40.814968007Z [err]  2025-12-17 10:14:40,807 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:14:40.814972414Z [err]  2025-12-17 10:14:40,807 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:14:40.814977506Z [err]  2025-12-17 10:14:40,807 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:14:40.814981509Z [err]  2025-12-17 10:14:40,808 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:14:41.243516679Z [err]  2025-12-17 10:14:40,878 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:41.243520892Z [err]  2025-12-17 10:14:40,901 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:41.243524466Z [err]  2025-12-17 10:14:40,910 - calling_service - INFO - âœ… LLM client pre-warmed in 102ms
2025-12-17T10:14:41.243528263Z [err]  2025-12-17 10:14:40,910 - server - INFO - âœ… Session created in WebSocket worker
2025-12-17T10:14:41.243531996Z [err]  2025-12-17 10:14:40,910 - server - INFO - ğŸ“ Call data loaded, starting SONIOX connection...
2025-12-17T10:14:41.243535900Z [err]  2025-12-17 10:14:40,910 - server - INFO - âœ… Initialized call_states for v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg with session reference
2025-12-17T10:14:41.243539689Z [err]  2025-12-17 10:14:40,964 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:41.243543304Z [err]  2025-12-17 10:14:40,964 - server - INFO - ğŸ”§ Creating Telnyx service with user's keys...
2025-12-17T10:14:41.243547044Z [err]  2025-12-17 10:14:40,988 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:14:41.243550933Z [err]  2025-12-17 10:14:41,005 - server - INFO - ğŸ”‘ Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-17T10:14:41.266547861Z [err]  2025-12-17 10:14:41,260 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg/actions/playback_start "HTTP/1.1 200 OK"
2025-12-17T10:14:41.266558213Z [err]  2025-12-17 10:14:41,261 - telnyx_service - INFO - âœ… Playing audio from URL, playback_id: R7LFn_1Jvg (loop=True, overlay=True)
2025-12-17T10:14:41.266565534Z [err]  2025-12-17 10:14:41,262 - server - WARNING - âš ï¸ Failed to start comfort noise: 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg'
2025-12-17T10:14:41.266572493Z [err]  2025-12-17 10:14:41,262 - telnyx_service - INFO - ğŸ™ï¸ Starting recording: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:41.536019162Z [err]  2025-12-17 10:14:41,533 - soniox_service - INFO - âœ… Connected to Soniox Real-Time STT
2025-12-17T10:14:41.536025958Z [err]  2025-12-17 10:14:41,533 - soniox_service - INFO - âš™ï¸  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-17T10:14:41.536032316Z [err]  2025-12-17 10:14:41,533 - soniox_service - INFO - âš™ï¸  Endpoint detection: True, Speaker diarization: False
2025-12-17T10:14:41.536037321Z [err]  2025-12-17 10:14:41,533 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring started for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:41.537117126Z [err]  2025-12-17 10:14:41,535 - server - INFO - âœ… Started forwarding audio (8kHz mulaw â†’ Soniox, NO BUFFERING)
2025-12-17T10:14:42.734478728Z [err]  2025-12-17 10:14:42,730 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg/actions/record_start "HTTP/1.1 200 OK"
2025-12-17T10:14:42.736102377Z [err]  2025-12-17 10:14:42,734 - server - INFO - ğŸ™ï¸ Call recording started for v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:42.736114252Z [err]  2025-12-17 10:14:42,734 - server - INFO - ğŸ”§ Creating call session for v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg...
2025-12-17T10:14:42.736122570Z [err]  2025-12-17 10:14:42,734 - server - INFO - ğŸ” Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:14:42.736130174Z [err]  2025-12-17 10:14:42,734 - server - INFO - ğŸ”§ Calling create_call_session() - START
2025-12-17T10:14:42.736137006Z [err]  2025-12-17 10:14:42,734 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:14:42.736861734Z [err]  2025-12-17 10:14:42,735 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:42.736868029Z [err]  2025-12-17 10:14:42,735 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.started', 'id': '5e0a1966-c9bb-4f6c-94e4-7667a5191a8b', 'occurred_at': '2025-12-17T10:14:41.400574Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'R7LFn_1Jvg', 'start_time': '2025-12-17T10:14:41.400574Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:42.736874110Z [err]  2025-12-17 10:14:42,736 - server - INFO - ğŸ¯ Event type: call.playback.started, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:42.736879183Z [err]  2025-12-17 10:14:42,736 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:42.740260992Z [inf]  100.64.0.6:52718 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:42.828736665Z [err]  2025-12-17 10:14:42,820 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:14:42.828742520Z [err]  2025-12-17 10:14:42,820 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:14:42.835353994Z [err]  2025-12-17 10:14:42,834 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:14:42.835361121Z [err]  2025-12-17 10:14:42,834 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:14:42.835366227Z [err]  2025-12-17 10:14:42,834 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:14:43.188374776Z [err]  2025-12-17 10:14:42,956 - server - INFO - âœ… Session stored in worker memory (not Redis)
2025-12-17T10:14:43.188385035Z [err]  2025-12-17 10:14:42,957 - redis_service - INFO - âœ… Marked session ready in Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:43.188392153Z [err]  2025-12-17 10:14:42,957 - server - INFO - ğŸ¤– AI session created for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:43.188398802Z [err]  2025-12-17 10:14:42,957 - server - INFO - ğŸ“¦ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-17T10:14:43.188405096Z [err]  2025-12-17 10:14:42,920 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:43.188415060Z [err]  2025-12-17 10:14:42,932 - calling_service - INFO - âœ… LLM client pre-warmed in 97ms
2025-12-17T10:14:43.188418230Z [err]  2025-12-17 10:14:42,957 - server - INFO - â­ï¸ Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-17T10:14:43.188421997Z [err]  2025-12-17 10:14:42,932 - server - INFO - ğŸ”§ Calling create_call_session() - COMPLETE
2025-12-17T10:14:43.188428547Z [err]  2025-12-17 10:14:42,932 - server - INFO - âœ… Session object created: CallSession
2025-12-17T10:14:43.188431129Z [err]  2025-12-17 10:14:42,957 - server - INFO - ğŸ‘¤ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-17T10:14:43.188434280Z [err]  2025-12-17 10:14:42,956 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (TTL: 3600s)
2025-12-17T10:14:43.188439529Z [err]  2025-12-17 10:14:42,956 - server - INFO - âœ… Serializable call_data synced to Redis (agent_id, user_id)
2025-12-17T10:14:43.189277938Z [err]  2025-12-17 10:14:42,957 - server - INFO - ğŸ‘‚ User speaks first - waiting for user input...
2025-12-17T10:14:43.189282823Z [err]  2025-12-17 10:14:43,187 - server - INFO - ğŸ”¤ RAW TOKENS: ["Hell"âœ“, "o."âœ“, "<end>"âœ“]
2025-12-17T10:14:43.189285475Z [err]  2025-12-17 10:14:42,957 - server - ERROR - Error processing webhook: cannot access local variable 'asyncio' where it is not associated with a value
2025-12-17T10:14:43.189292715Z [err]  2025-12-17 10:14:43,187 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:14:43.189295573Z [inf]  100.64.0.2:31810 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:43.189301282Z [err]  2025-12-17 10:14:43,187 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Hell o.' (2 tokens)
2025-12-17T10:14:43.189304462Z [err]  2025-12-17 10:14:43,052 - server - INFO - ğŸ”¤ RAW TOKENS: ["Hell"?]
2025-12-17T10:14:43.189307729Z [err]  2025-12-17 10:14:43,188 - server - INFO - ğŸ¤ Soniox final transcript: 'Hell o.'
2025-12-17T10:14:43.189311144Z [err]  2025-12-17 10:14:43,052 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (user started speaking)
2025-12-17T10:14:43.189315199Z [err]  2025-12-17 10:14:43,188 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:kg4o0eXPSvnRTCdv2... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA'])
2025-12-17T10:14:43.189317477Z [err]  2025-12-17 10:14:43,052 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:43.189322819Z [err]  2025-12-17 10:14:43,052 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Hell' | Generating: False
2025-12-17T10:14:43.189324440Z [err]  2025-12-17 10:14:43,188 - server - INFO - ğŸ” FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:14:43.190393216Z [err]  2025-12-17 10:14:43,188 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:kg4o0eXPSvnRTCdv2... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA'])
2025-12-17T10:14:43.190399437Z [err]  2025-12-17 10:14:43,188 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:14:43.190403545Z [err]  2025-12-17 10:14:43,188 - server - INFO - â±ï¸ [10:14:43.188] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Hell o.'
2025-12-17T10:14:43.190407342Z [err]  2025-12-17 10:14:43,188 - server - INFO - â±ï¸ [10:14:43.188] STT endpoint detection latency: 15ms
2025-12-17T10:14:43.190412706Z [err]  2025-12-17 10:14:43,188 - server - INFO - â±ï¸ [10:14:43.188] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:14:43.190416420Z [err]  2025-12-17 10:14:43,189 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (TTL: 3600s)
2025-12-17T10:14:43.190420079Z [err]  2025-12-17 10:14:43,189 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:14:43.190423935Z [err]  2025-12-17 10:14:43,189 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:kg4o0eXPSvnRTCdv2... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA'])
2025-12-17T10:14:43.190427792Z [err]  2025-12-17 10:14:43,189 - server - INFO - âœ… Agent SILENT - User said 2 word(s): 'Hell o.' - Processing...
2025-12-17T10:14:43.200962153Z [err]  2025-12-17 10:14:43,199 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Hell o.
2025-12-17T10:14:43.200970247Z [err]  2025-12-17 10:14:43,199 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:43.200975187Z [err]  2025-12-17 10:14:43,199 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:14:43.200980091Z [err]  2025-12-17 10:14:43,199 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+7ms
2025-12-17T10:14:43.200984822Z [err]  2025-12-17 10:14:43,199 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 7ms (Soniox model: stt-rt-v3)
2025-12-17T10:14:43.200990761Z [err]  2025-12-17 10:14:43,199 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:14:43.200995348Z [err]  2025-12-17 10:14:43,199 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:14:43.200999900Z [err]  2025-12-17 10:14:43,199 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:43.297699045Z [err]  2025-12-17 10:14:43,295 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:14:43.297703882Z [err]  2025-12-17 10:14:43,295 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:kg4o0eXPSvnRTCdv2... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA'])
2025-12-17T10:14:43.297708992Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - â±ï¸ [10:14:43.295] ğŸ“¥ process_user_input() ENTRY - text: 'Hell o....'
2025-12-17T10:14:43.297712872Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - â±ï¸ [10:14:43.295] â© About to call _process_call_flow_streaming()
2025-12-17T10:14:43.297716758Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - â±ï¸ [10:14:43.295] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:14:43.297720896Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - â±ï¸ [10:14:43.295] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:14:43.297724878Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-17T10:14:43.297731202Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - â±ï¸ [10:14:43.295] âœ… Node selected, about to process content...
2025-12-17T10:14:43.297735606Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:14 AM EST in content
2025-12-17T10:14:43.297739850Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:14:43.297743796Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:14:43.297748204Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:14:43.297752430Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:14:43.299323097Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:14:43.299328809Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:14:43.299333598Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:14:43.299338241Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:14:43.299342788Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:14:43.299348315Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-17T10:14:43.299354323Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-17T10:14:43.299358446Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:14:43.299364317Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - â±ï¸ [10:14:43.295] ğŸ“„ About to process content (mode=script, length=9)
2025-12-17T10:14:43.299370202Z [err]  2025-12-17 10:14:43,295 - calling_service - INFO - ğŸ“¤ Streaming script as 1 sentence(s)
2025-12-17T10:14:43.299374348Z [err]  2025-12-17 10:14:43,296 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Kendrick?...
2025-12-17T10:14:43.299378493Z [err]  2025-12-17 10:14:43,296 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 96ms
2025-12-17T10:14:43.299382592Z [err]  2025-12-17 10:14:43,296 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:14:43.299386602Z [err]  2025-12-17 10:14:43,296 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:kg4o0eXPSvnRTCdv2... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA'])
2025-12-17T10:14:43.300190745Z [err]  2025-12-17 10:14:43,296 - server - INFO - âš¡ ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-17T10:14:43.389996988Z [err]  2025-12-17 10:14:43,388 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:43.493676236Z [err]  2025-12-17 10:14:43,482 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:43.592810987Z [err]  2025-12-17 10:14:43,591 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:43.625976837Z [err]  2025-12-17 10:14:43,621 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:14:43.625985860Z [err]  2025-12-17 10:14:43,621 - server - INFO - âœ… ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-17T10:14:43.625991628Z [err]  2025-12-17 10:14:43,621 - persistent_tts_service - INFO - ğŸ™ï¸ Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-17T10:14:43.625997350Z [err]  2025-12-17 10:14:43,621 - persistent_tts_service - INFO - ğŸ”Œ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Establishing persistent TTS WebSocket...
2025-12-17T10:14:43.626003111Z [err]  2025-12-17 10:14:43,621 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-17T10:14:43.626008458Z [err]  2025-12-17 10:14:43,621 - elevenlabs_ws_service - INFO - ğŸ”Œ Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-17T10:14:43.626013672Z [err]  2025-12-17 10:14:43,621 - elevenlabs_ws_service - INFO - ğŸ™ï¸ Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-17T10:14:43.762712408Z [err]  2025-12-17 10:14:43,760 - elevenlabs_ws_service - INFO - âœ… Connected to ElevenLabs WebSocket
2025-12-17T10:14:43.762719458Z [err]  2025-12-17 10:14:43,760 - elevenlabs_ws_service - INFO - ğŸ“¤ Sent BOS message with voice settings
2025-12-17T10:14:43.762724864Z [err]  2025-12-17 10:14:43,760 - persistent_tts_service - INFO - âœ… [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Persistent TTS WebSocket established
2025-12-17T10:14:43.762730321Z [err]  2025-12-17 10:14:43,760 - persistent_tts_service - INFO - ğŸ”Š [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Comfort noise loop started
2025-12-17T10:14:43.762735662Z [err]  2025-12-17 10:14:43,760 - persistent_tts_service - INFO - âœ… Created persistent TTS session for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:43.762739982Z [err]  2025-12-17 10:14:43,760 - server - INFO - âœ… ON-DEMAND: Persistent TTS session created successfully!
2025-12-17T10:14:43.762745348Z [err]  2025-12-17 10:14:43,760 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:kg4o0eXPSvnRTCdv2..., session=FOUND
2025-12-17T10:14:43.762750091Z [err]  2025-12-17 10:14:43,760 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:14:43.762754474Z [err]  2025-12-17 10:14:43,760 - server - INFO - ğŸµ TTS task #1 started at +464ms
2025-12-17T10:14:43.762759175Z [err]  2025-12-17 10:14:43,760 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 561ms
2025-12-17T10:14:43.762763680Z [err]  2025-12-17 10:14:43,760 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/1: Kendrick?...
2025-12-17T10:14:43.762768051Z [err]  2025-12-17 10:14:43,760 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (user responded)
2025-12-17T10:14:43.762778006Z [err]  2025-12-17 10:14:43,760 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:14:43.764170720Z [err]  2025-12-17 10:14:43,760 - calling_service - INFO - ğŸ’¾ Storing node ID 2 in conversation history
2025-12-17T10:14:43.764185315Z [err]  2025-12-17 10:14:43,760 - calling_service - INFO - LLM response (0.47s): Kendrick?
2025-12-17T10:14:43.764192487Z [err]  2025-12-17 10:14:43,760 - calling_service - INFO - Total latency: 0.47s
2025-12-17T10:14:43.764199613Z [err]  2025-12-17 10:14:43,760 - server - INFO - âœ… LLM finished in 561ms, TTS tasks already running in background
2025-12-17T10:14:43.764206311Z [err]  2025-12-17 10:14:43,760 - server - INFO - ğŸµ Streaming 1 TTS chunks as they complete...
2025-12-17T10:14:43.764213719Z [err]  2025-12-17 10:14:43,760 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:14:43.764221119Z [err]  2025-12-17 10:14:43,760 - server - INFO -    1 sentences queued and playing seamlessly
2025-12-17T10:14:43.764227384Z [err]  2025-12-17 10:14:43,761 - persistent_tts_service - INFO - ğŸµ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Playback consumer started
2025-12-17T10:14:43.764233525Z [err]  2025-12-17 10:14:43,761 - persistent_tts_service - INFO - ğŸ’“ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Starting TTS keep-alive loop (every 15s)
2025-12-17T10:14:43.764239731Z [err]  2025-12-17 10:14:43,761 - persistent_tts_service - INFO - ğŸ”Š [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Starting comfort noise loop
2025-12-17T10:14:43.764246060Z [err]  2025-12-17 10:14:43,761 - persistent_tts_service - INFO - ğŸ¤ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Streaming sentence #1: Kendrick?...
2025-12-17T10:14:44.158302150Z [err]  2025-12-17 10:14:44,013 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:14:44.158310307Z [err]  2025-12-17 10:14:44,013 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+252ms
2025-12-17T10:14:44.158319612Z [err]  2025-12-17 10:14:44,013 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTFA (Time To First Audio Playback): 252ms
2025-12-17T10:14:44.158324440Z [err]  2025-12-17 10:14:44,013 - persistent_tts_service - INFO - ğŸ“¤ Sending 7043 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2025-12-17T10:14:44.158328945Z [err]  2025-12-17 10:14:44,013 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:14:44.158333663Z [err]  2025-12-17 10:14:44,014 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2025-12-17T10:14:44.158338248Z [err]  2025-12-17 10:14:44,014 - persistent_tts_service - INFO - âœ… Sent 45 audio chunks via WebSocket
2025-12-17T10:14:44.158343229Z [err]  2025-12-17 10:14:44,049 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:44.158348467Z [err]  2025-12-17 10:14:44,050 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '2dc3ca31-9059-4f50-a065-8d1a76c39526', 'occurred_at': '2025-12-17T10:14:43.540576Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:44.158356096Z [err]  2025-12-17 10:14:44,050 - server - INFO - ğŸ¯ Event type: call.machine.premium.detection.ended, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:44.160180601Z [err]  2025-12-17 10:14:44,050 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:44.160191886Z [inf]  100.64.0.6:52718 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:45.217893785Z [err]  2025-12-17 10:14:45,015 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:14:45.217900040Z [err]  2025-12-17 10:14:45,118 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.2s ago), marking agent as done speaking
2025-12-17T10:14:45.217905288Z [err]  2025-12-17 10:14:45,118 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966485.1187985 for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:45.217909975Z [err]  2025-12-17 10:14:45,118 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:46.232068643Z [err]  2025-12-17 10:14:46,014 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:14:46.232074072Z [err]  2025-12-17 10:14:46,014 - persistent_tts_service - INFO - âœ… [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Finished streaming sentence #1: 1 chunks received
2025-12-17T10:14:46.232080373Z [err]  2025-12-17 10:14:46,014 - server - INFO - âœ… All 1 persistent TTS streams completed
2025-12-17T10:14:46.232086414Z [err]  2025-12-17 10:14:46,015 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:14:46.232092633Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 2815ms from user stop ğŸš€
2025-12-17T10:14:46.232098813Z [err]  2025-12-17 10:14:46,015 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:46.232105182Z [err]  2025-12-17 10:14:46,015 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:14:46.232110957Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:14:46.232116715Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:14:46.232122408Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] STT: 7ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:14:46.232128134Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 561ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:14:46.232142769Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 2719ms (provider: elevenlabs, websocket: False)
2025-12-17T10:14:46.232149905Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 2815ms (user stopped â†’ play_audio_url called)
2025-12-17T10:14:46.232323921Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:14:46.232331953Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:14:46.232339244Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:14:46.232347405Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:14:46.232353561Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:14:46.232359901Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 3115ms estimated
2025-12-17T10:14:46.232366611Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2025-12-17T10:14:46.232372422Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Hell o....'
2025-12-17T10:14:46.232378407Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'Kendrick?...'
2025-12-17T10:14:46.232384130Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:14:46.232390913Z [err]  2025-12-17 10:14:46,015 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:14:46.232397026Z [err]  2025-12-17 10:14:46,206 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1068ms)
2025-12-17T10:14:46.232402967Z [err]  2025-12-17 10:14:46,206 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:14:46.536874108Z [err]  2025-12-17 10:14:46,535 - server - INFO - ğŸ“¤ Audio flowing: 295 packets sent to Soniox (5s update)
2025-12-17T10:14:47.477276725Z [err]  2025-12-17 10:14:47,475 - server - INFO - ğŸ”¤ RAW TOKENS: [" Ye"?]
2025-12-17T10:14:47.477281604Z [err]  2025-12-17 10:14:47,475 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (user started speaking)
2025-12-17T10:14:47.477285727Z [err]  2025-12-17 10:14:47,475 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:47.477290340Z [err]  2025-12-17 10:14:47,475 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2025-12-17T10:14:47.584230408Z [err]  2025-12-17 10:14:47,583 - server - INFO - ğŸ”¤ RAW TOKENS: [" Ye"âœ“, "ah."âœ“, "<end>"âœ“]
2025-12-17T10:14:47.584239736Z [err]  2025-12-17 10:14:47,583 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:14:47.585831484Z [err]  2025-12-17 10:14:47,583 - server - INFO - ğŸ§¹ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2025-12-17T10:14:47.585835048Z [err]  2025-12-17 10:14:47,584 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (TTL: 3600s)
2025-12-17T10:14:47.585838746Z [err]  2025-12-17 10:14:47,583 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-17T10:14:47.585841845Z [err]  2025-12-17 10:14:47,584 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:14:47.585844838Z [err]  2025-12-17 10:14:47,583 - server - INFO - ğŸ¤ Soniox final transcript: 'Yeah.'
2025-12-17T10:14:47.585847909Z [err]  2025-12-17 10:14:47,585 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-17T10:14:47.585850508Z [err]  2025-12-17 10:14:47,583 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:14:47.585854833Z [err]  2025-12-17 10:14:47,584 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:14:47.585859215Z [err]  2025-12-17 10:14:47,584 - server - INFO - â±ï¸ [10:14:47.584] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-17T10:14:47.585863434Z [err]  2025-12-17 10:14:47,584 - server - INFO - â±ï¸ [10:14:47.584] STT endpoint detection latency: 11ms
2025-12-17T10:14:47.585867943Z [err]  2025-12-17 10:14:47,584 - server - INFO - â±ï¸ [10:14:47.584] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:14:47.599592011Z [err]  2025-12-17 10:14:47,596 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:14:47.599598664Z [err]  2025-12-17 10:14:47,595 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-17T10:14:47.599603209Z [err]  2025-12-17 10:14:47,596 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:47.599607228Z [err]  2025-12-17 10:14:47,595 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:47.599614891Z [err]  2025-12-17 10:14:47,596 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:14:47.599620885Z [err]  2025-12-17 10:14:47,596 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:14:47.599625583Z [err]  2025-12-17 10:14:47,596 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+2ms
2025-12-17T10:14:47.599635842Z [err]  2025-12-17 10:14:47,596 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 2ms (Soniox model: stt-rt-v3)
2025-12-17T10:14:47.599640277Z [err]  2025-12-17 10:14:47,596 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:14:47.692938739Z [err]  2025-12-17 10:14:47,691 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:14:47.692941964Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-17T10:14:47.692947560Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - â±ï¸ [10:14:47.691] ğŸ“¥ process_user_input() ENTRY - text: 'Yeah....'
2025-12-17T10:14:47.692954563Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - â±ï¸ [10:14:47.691] â© About to call _process_call_flow_streaming()
2025-12-17T10:14:47.692960125Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - â±ï¸ [10:14:47.691] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:14:47.692965876Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - â±ï¸ [10:14:47.691] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:14:47.692970919Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-17T10:14:47.692976359Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 2
2025-12-17T10:14:47.692981894Z [err]  2025-12-17 10:14:47,691 - calling_service - INFO - â±ï¸ [10:14:47.691] ğŸ”€ About to call _follow_transition() for: Yeah....
2025-12-17T10:14:47.702588936Z [err]  2025-12-17 10:14:47,700 - calling_service - INFO - â±ï¸ [10:14:47.700] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-17T10:14:48.209295660Z [err]  2025-12-17 10:14:48,203 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:14:48.209308544Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - â±ï¸ [10:14:48.204] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 503ms
2025-12-17T10:14:48.209317010Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ¤– AI transition decision: '0'
2025-12-17T10:14:48.209323873Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ“Š Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc)...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-17T10:14:48.209330842Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - Selected transition index: 0
2025-12-17T10:14:48.209337654Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-17T10:14:48.209347248Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 513ms
2025-12-17T10:14:48.209354493Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - â±ï¸ [10:14:48.204] âœ… Node selected, about to process content...
2025-12-17T10:14:48.209364429Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:14 AM EST in content
2025-12-17T10:14:48.209371864Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:14:48.209377897Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:14:48.209384691Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:14:48.209391648Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:14:48.210526945Z [err]  2025-12-17 10:14:48,204 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:14:48.210530719Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸ“¤ Sentence arrived from LLM: This is Jake......
2025-12-17T10:14:48.210534716Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:14:48.210540747Z [err]  2025-12-17 10:14:48,205 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 609ms
2025-12-17T10:14:48.210541097Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:14:48.210549273Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:14:48.210549330Z [err]  2025-12-17 10:14:48,205 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:14:48.210558218Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:kg4o0eXPSvnRTCdv2..., session=FOUND
2025-12-17T10:14:48.210559373Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:14:48.210565531Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-17T10:14:48.210566933Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:14:48.210570520Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-17T10:14:48.210574951Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - â±ï¸ [10:14:48.205] ğŸ“„ About to process content (mode=script, length=89)
2025-12-17T10:14:48.210578908Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T10:14:48.211585974Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:14:48.211595042Z [err]  2025-12-17 10:14:48,205 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 609ms
2025-12-17T10:14:48.211597981Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (user responded)
2025-12-17T10:14:48.211602316Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: This is Jake......
2025-12-17T10:14:48.211608816Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸ“¤ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-17T10:14:48.211609164Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:14:48.211616054Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:kg4o0eXPSvnRTCdv2..., session=FOUND
2025-12-17T10:14:48.211618032Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ’¾ Storing node ID 1763159750250 in conversation history
2025-12-17T10:14:48.211624337Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:14:48.211626878Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - LLM response (0.51s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-17T10:14:48.211630113Z [err]  2025-12-17 10:14:48,205 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T10:14:48.211635194Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - Total latency: 0.51s
2025-12-17T10:14:48.211636121Z [err]  2025-12-17 10:14:48,205 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-17T10:14:48.211642647Z [err]  2025-12-17 10:14:48,206 - server - INFO - âœ… LLM finished in 609ms, TTS tasks already running in background
2025-12-17T10:14:48.212393268Z [err]  2025-12-17 10:14:48,206 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T10:14:48.212398219Z [err]  2025-12-17 10:14:48,206 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:14:48.212401996Z [err]  2025-12-17 10:14:48,206 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T10:14:48.212405939Z [err]  2025-12-17 10:14:48,206 - persistent_tts_service - INFO - ğŸ¤ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Streaming sentence #2: This is Jake......
2025-12-17T10:14:48.459198951Z [err]  2025-12-17 10:14:48,457 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:14:48.459205445Z [err]  2025-12-17 10:14:48,457 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+251ms
2025-12-17T10:14:48.459209496Z [err]  2025-12-17 10:14:48,457 - persistent_tts_service - INFO - ğŸ“¤ Sending 8545 bytes of audio (54 chunks, 1.1s duration) via WebSocket
2025-12-17T10:14:48.459213184Z [err]  2025-12-17 10:14:48,457 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:14:48.459217316Z [err]  2025-12-17 10:14:48,457 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-17T10:14:48.459221708Z [err]  2025-12-17 10:14:48,458 - persistent_tts_service - INFO - âœ… Sent 54 audio chunks via WebSocket
2025-12-17T10:14:49.671161563Z [err]  2025-12-17 10:14:49,670 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T10:14:49.671169158Z [err]  2025-12-17 10:14:49,670 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966489.6706154 for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:49.671177192Z [err]  2025-12-17 10:14:49,670 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:50.177158803Z [err]  2025-12-17 10:14:50,174 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=0/2
2025-12-17T10:14:50.463797552Z [err]  2025-12-17 10:14:50,457 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:14:50.463811435Z [err]  2025-12-17 10:14:50,457 - persistent_tts_service - INFO - âœ… [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Finished streaming sentence #2: 1 chunks received
2025-12-17T10:14:50.463816607Z [err]  2025-12-17 10:14:50,457 - persistent_tts_service - INFO - ğŸ¤ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2025-12-17T10:14:50.677613104Z [err]  2025-12-17 10:14:50,676 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=0/2
2025-12-17T10:14:50.795752732Z [err]  2025-12-17 10:14:50,793 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:14:50.795759497Z [err]  2025-12-17 10:14:50,793 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+336ms
2025-12-17T10:14:50.795765756Z [err]  2025-12-17 10:14:50,793 - persistent_tts_service - INFO - ğŸ“¤ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:14:50.795770487Z [err]  2025-12-17 10:14:50,793 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:14:50.795775553Z [err]  2025-12-17 10:14:50,793 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2025-12-17T10:14:50.795780129Z [err]  2025-12-17 10:14:50,794 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:14:50.797088074Z [err]  2025-12-17 10:14:50,795 - persistent_tts_service - INFO - ğŸ“¤ Sending 697 bytes of audio (5 chunks, 0.1s duration) via WebSocket
2025-12-17T10:14:50.797094171Z [err]  2025-12-17 10:14:50,795 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:14:50.797098913Z [err]  2025-12-17 10:14:50,795 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.1s (total: 1.8s from now)
2025-12-17T10:14:50.797102788Z [err]  2025-12-17 10:14:50,795 - persistent_tts_service - INFO - âœ… Sent 5 audio chunks via WebSocket
2025-12-17T10:14:51.145054194Z [err]  2025-12-17 10:14:50,966 - persistent_tts_service - INFO - ğŸ“¤ Sending 18576 bytes of audio (117 chunks, 2.3s duration) via WebSocket
2025-12-17T10:14:51.145061326Z [err]  2025-12-17 10:14:50,966 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:14:51.145068372Z [err]  2025-12-17 10:14:50,966 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.3s (total: 4.0s from now)
2025-12-17T10:14:51.145076370Z [err]  2025-12-17 10:14:50,968 - persistent_tts_service - INFO - âœ… Sent 117 audio chunks via WebSocket
2025-12-17T10:14:51.542564503Z [err]  2025-12-17 10:14:51,539 - server - INFO - ğŸ“¤ Audio flowing: 543 packets sent to Soniox (5s update)
2025-12-17T10:14:52.142613107Z [err]  2025-12-17 10:14:52,108 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966492.1087902 for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.142625181Z [err]  2025-12-17 10:14:52,108 - server - INFO - â±ï¸ Silence timer STARTED (fallback, agent wasn't marked as speaking)
2025-12-17T10:14:52.143019245Z [err]  2025-12-17 10:14:51,886 - server - INFO - ğŸ¤ Soniox receiver alive - 13 messages received in last 10s
2025-12-17T10:14:52.143024186Z [err]  2025-12-17 10:14:52,099 - server - INFO - ğŸ“ Telnyx WebSocket disconnected. Sent 563 total packets
2025-12-17T10:14:52.143029389Z [err]  [2025-12-17 10:14:52 +0000] [6] [INFO] connection closed
2025-12-17T10:14:52.143034334Z [err]  2025-12-17 10:14:52,100 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:52.143039683Z [err]  2025-12-17 10:14:52,100 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'ecd13cdf-5800-4b63-8385-09d0e8b39353', 'occurred_at': '2025-12-17T10:14:51.860566Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:14:51.860566Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'R7LFn_1Jvg', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:52.143045120Z [err]  2025-12-17 10:14:52,100 - server - INFO - ğŸ¯ Event type: call.playback.ended, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.143050109Z [err]  2025-12-17 10:14:52,100 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:52.143055445Z [err]  2025-12-17 10:14:52,103 - redis_service - INFO - â– Removed playback R7LFn_1Jvg, 0 remaining for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.143060740Z [err]  2025-12-17 10:14:52,103 - server - INFO - ğŸ”Š Redis: Removed playback R7LFn_1Jvg, 0 remaining
2025-12-17T10:14:52.143206576Z [err]  2025-12-17 10:14:52,103 - server - INFO - ğŸ”Š ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-17T10:14:52.143212514Z [err]  2025-12-17 10:14:52,108 - server - INFO - âœ… Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-17T10:14:52.143220057Z [inf]  100.64.0.6:52718 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:52.143225713Z [err]  2025-12-17 10:14:52,108 - server - INFO - âœ… Found session in active_telnyx_calls (local worker)
2025-12-17T10:14:52.326227724Z [err]  2025-12-17 10:14:52,323 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:52.326240336Z [err]  2025-12-17 10:14:52,323 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.hangup', 'id': 'a9dc0166-cc4c-4b2b-b02c-b18e525c36c6', 'occurred_at': '2025-12-17T10:14:51.820563Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '64.69', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '588', 'skip_packet_count': '15'}, 'outbound': {'packet_count': '570', 'skip_packet_count': '0'}}, 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:14:51.820563Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-17T10:14:36.380567Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:52.326248001Z [err]  2025-12-17 10:14:52,323 - server - INFO - ğŸ¯ Event type: call.hangup, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.326254563Z [err]  2025-12-17 10:14:52,323 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:52.326261851Z [err]  2025-12-17 10:14:52,323 - server - INFO - ğŸ“ Call ended: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.326268464Z [err]  2025-12-17 10:14:52,323 - server - INFO - ğŸ“ Hangup cause: normal_clearing
2025-12-17T10:14:52.344717475Z [err]  2025-12-17 10:14:52,342 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:52.344724028Z [err]  2025-12-17 10:14:52,343 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '499f3b14-d23e-484a-b063-6bbc2d923154', 'occurred_at': '2025-12-17T10:14:52.088225Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '05e8bcaf-616d-4b51-9e44-3ad229ed955d', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:52.344728695Z [err]  2025-12-17 10:14:52,343 - server - INFO - ğŸ¯ Event type: streaming.stopped, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.344733597Z [err]  2025-12-17 10:14:52,343 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:52.344739310Z [inf]  100.64.0.7:41570 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:52.503594629Z [err]  2025-12-17 10:14:52,501 - server - INFO - ğŸ“ Updated call log: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:52.593476942Z [err]  2025-12-17 10:14:52,590 - server - INFO - âœ… Finalized call log: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg (duration=11s, status=completed)
2025-12-17T10:14:52.685497341Z [err]  2025-12-17 10:14:52,678 - server - INFO - ğŸ“¦ Saved 11 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2025-12-17T10:14:53.143772629Z [err]  2025-12-17 10:14:52,966 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:14:53.143777742Z [err]  2025-12-17 10:14:52,966 - persistent_tts_service - INFO - âœ… [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] Finished streaming sentence #3: 3 chunks received
2025-12-17T10:14:53.143782339Z [err]  2025-12-17 10:14:52,966 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T10:14:53.143786396Z [err]  2025-12-17 10:14:52,967 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:14:53.143790976Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5370ms from user stop ğŸš€
2025-12-17T10:14:53.143798592Z [err]  2025-12-17 10:14:52,967 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.143802948Z [err]  2025-12-17 10:14:52,967 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:14:53.143807672Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:14:53.143813186Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:14:53.143817954Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] STT: 2ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:14:53.143822651Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 609ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:14:53.143826691Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 4761ms (provider: elevenlabs, websocket: False)
2025-12-17T10:14:53.143833188Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5370ms (user stopped â†’ play_audio_url called)
2025-12-17T10:14:53.145681312Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:14:53.145689012Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:14:53.145695243Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:14:53.145700709Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:14:53.145707569Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:14:53.145713395Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 5670ms estimated
2025-12-17T10:14:53.145719702Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-17T10:14:53.145725346Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Yeah....'
2025-12-17T10:14:53.145731081Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-17T10:14:53.145736646Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:14:53.145742039Z [err]  2025-12-17 10:14:52,967 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:14:53.158823892Z [err]  2025-12-17 10:14:53,157 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1111ms)
2025-12-17T10:14:53.158828867Z [err]  2025-12-17 10:14:53,157 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:14:53.188904777Z [err]  2025-12-17 10:14:53,186 - dead_air_monitor - INFO - ğŸš© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-17T10:14:53.188910956Z [err]  2025-12-17 10:14:53,186 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966493.18662 for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.188915121Z [err]  2025-12-17 10:14:53,186 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.328171729Z [err]  2025-12-17 10:14:53,322 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:14:53.328180443Z [err]  2025-12-17 10:14:53,322 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '9ac33c25-da0b-4a20-926c-fa777b3cfdfd', 'occurred_at': '2025-12-17T10:14:52.845710Z', 'payload': {'call_control_id': 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg', 'call_leg_id': '3052ce6e-db31-11f0-811c-02420aef97a0', 'call_session_id': '304fa608-db31-11f0-90d3-02420aef97a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:14:51.918862Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-17T10:14:51.918862Z', 'recording_id': '76529f07-af46-4529-a0cb-4790df54ca9a', 'recording_started_at': '2025-12-17T10:14:42.451553Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/3052ce6e-db31-11f0-811c-02420aef97a0-1765966481544768.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T101452Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=99ea394df8e96cf68bab02da3cec607ac4c563b614266534505983647905c7bd'}, 'start_time': '2025-12-17T10:14:42.451553Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:14:53.328194128Z [err]  2025-12-17 10:14:53,322 - server - INFO - ğŸ¯ Event type: call.recording.saved, Call ID: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.328198788Z [err]  2025-12-17 10:14:53,323 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:14:53.328203188Z [err]  2025-12-17 10:14:53,323 - server - INFO - ğŸ™ï¸ Recording saved for call: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.328209136Z [err]  2025-12-17 10:14:53,323 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.329101427Z [err]  2025-12-17 10:14:53,323 - server - INFO - ğŸ” Recording check: download_url=True, channels=dual, recording_id=76529f07-af46-4529-a0cb-4790df54ca9a, call_data=True
2025-12-17T10:14:53.370416985Z [err]  2025-12-17 10:14:53,368 - server - INFO - ğŸ“Š Auto-added call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-17T10:14:53.554028712Z [err]  2025-12-17 10:14:53,546 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.554033873Z [err]  2025-12-17 10:14:53,546 - server - INFO - ğŸ“‡ [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-17T10:14:53.554038449Z [err]  2025-12-17 10:14:53,546 - server - INFO - ğŸ“‡ [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-17T10:14:53.636605811Z [err]  2025-12-17 10:14:53,633 - server - INFO - ğŸ“‡ [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-17T10:14:53.720809198Z [err]  2025-12-17 10:14:53,718 - server - INFO - ğŸ“‡ [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-17T10:14:53.720815797Z [err]  2025-12-17 10:14:53,719 - server - INFO - ğŸ“‡ [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-17T10:14:53.720820791Z [err]  2025-12-17 10:14:53,719 - server - INFO - ğŸ“‡ [HANGUP] Agent info keys: None
2025-12-17T10:14:53.720827941Z [err]  2025-12-17 10:14:53,719 - server - INFO - ğŸš€ Triggered QC analysis for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.720832478Z [err]  2025-12-17 10:14:53,719 - server - INFO - ğŸ“Š Triggered Campaign QC for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.720837317Z [err]  2025-12-17 10:14:53,719 - server - INFO - ğŸ“‡ Triggered CRM update for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.720841507Z [err]  2025-12-17 10:14:53,719 - server - INFO - âœ… Closed persistent TTS session for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.721959842Z [err]  2025-12-17 10:14:53,720 - redis_service - INFO - ğŸ§¹ Deleted call data from Redis: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.721964888Z [err]  2025-12-17 10:14:53,720 - server - INFO - ğŸ§¹ Cleaned up call session from Redis and memory: v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.721968703Z [inf]  100.64.0.3:60076 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:53.721972980Z [err]  2025-12-17 10:14:53,720 - server - INFO - ğŸ” Starting QC analysis for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:53.721976964Z [err]  2025-12-17 10:14:53,720 - server - INFO - ğŸ” [AUTO-QC] Starting campaign QC check for call=v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-17T10:14:53.725018081Z [err]  2025-12-17 10:14:53,722 - server - INFO - ğŸ“‡ CRM update starting for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:14:53.725025870Z [err]  2025-12-17 10:14:53,722 - server - INFO - ğŸ“‡ Normalized phone: +17708336397
2025-12-17T10:14:53.725031680Z [err]  2025-12-17 10:14:53,722 - server - INFO - ğŸ“‡ CRM: Got 11 variables from active session
2025-12-17T10:14:53.809322389Z [err]  2025-12-17 10:14:53,807 - server - INFO - ğŸ“ Converted transcript from 4 messages to 147 characters
2025-12-17T10:14:54.201208498Z [err]  2025-12-17 10:14:53,893 - server - INFO - ğŸ“‡ CRM: Got 11 extracted variables
2025-12-17T10:14:54.201216397Z [err]  2025-12-17 10:14:54,068 - server - INFO - ğŸ“‡ CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-17T10:14:54.201218607Z [err]  2025-12-17 10:14:53,893 - server - INFO - ğŸ“‡ CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2025-12-17T10:14:54.201225033Z [err]  2025-12-17 10:14:53,914 - server - INFO - ğŸ’¾ Saved recording URL and ID to database: 76529f07-af46-4529-a0cb-4790df54ca9a
2025-12-17T10:14:54.201232335Z [err]  2025-12-17 10:14:53,915 - server - INFO - âœ… Entering dual-channel processing
2025-12-17T10:14:54.201237825Z [err]  2025-12-17 10:14:53,915 - server - INFO - ğŸ“¥ Downloading DUAL-CHANNEL recording...
2025-12-17T10:14:54.229155841Z [err]  2025-12-17 10:14:54,226 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/3052ce6e-db31-11f0-811c-02420aef97a0-1765966481544768.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T101452Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=99ea394df8e96cf68bab02da3cec607ac4c563b614266534505983647905c7bd "HTTP/1.1 200 OK"
2025-12-17T10:14:54.279598478Z [err]  2025-12-17 10:14:54,278 - server - INFO - ğŸ” [AUTO-QC] Call log found: transcript_turns=4, logs_count=6, status=completed
2025-12-17T10:14:54.311621802Z [err]  2025-12-17 10:14:54,309 - server - INFO - âœ… Downloaded 38077 bytes
2025-12-17T10:14:54.586522861Z [err]  2025-12-17 10:14:54,581 - server - INFO - ğŸ“Š Channel 1: 205964 bytes
2025-12-17T10:14:54.586536627Z [err]  2025-12-17 10:14:54,581 - server - INFO - âœ… Split into 2 channels
2025-12-17T10:14:54.586537168Z [err]  2025-12-17 10:14:54,581 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:14:54.586544397Z [err]  2025-12-17 10:14:54,581 - server - INFO - ğŸ¤ Using STT provider: soniox for interruption detection
2025-12-17T10:14:54.586544900Z [err]  2025-12-17 10:14:54,581 - server - INFO - âŒ Channel 1: No speech
2025-12-17T10:14:54.586551590Z [err]  2025-12-17 10:14:54,581 - server - INFO - ğŸ“Š Channel 0: 205964 bytes
2025-12-17T10:14:54.586552587Z [err]  2025-12-17 10:14:54,581 - server - WARNING - âš ï¸ No speech in any channel
2025-12-17T10:14:54.586558041Z [err]  2025-12-17 10:14:54,581 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:14:54.586561977Z [inf]  100.64.0.6:52718 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:14:54.586566293Z [err]  2025-12-17 10:14:54,581 - server - INFO - âŒ Channel 0: No speech
2025-12-17T10:14:54.586569800Z [err]  2025-12-17 10:14:54,582 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:14:54.676665094Z [err]  2025-12-17 10:14:54,675 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-17T10:14:54.715828927Z [err]  2025-12-17 10:14:54,712 - server - INFO - ğŸ” [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-17T10:14:54.774863476Z [err]  2025-12-17 10:14:54,767 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-17T10:14:54.774868252Z [err]  2025-12-17 10:14:54,767 - qc_agents.orchestrator - INFO - âœ… Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:14:54.774873767Z [err]  2025-12-17 10:14:54,767 - qc_agents.orchestrator - INFO - ğŸ” Running Commitment Detector on call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:14:54.805545608Z [err]  2025-12-17 10:14:54,799 - server - INFO - ğŸ“Š [AUTO-QC] Running full QC analysis: call=v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg â†’ campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-17T10:14:54.805552729Z [err]  2025-12-17 10:14:54,799 - server - INFO - ğŸ“Š [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-17T10:14:54.805558121Z [err]  2025-12-17 10:14:54,799 - server - ERROR - âŒ [AUTO-QC] Error in campaign QC for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:14:54.805563712Z [err]  2025-12-17 10:14:54,800 - server - ERROR - âŒ [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-17T10:14:54.805570394Z [err]    File "/app/backend/server.py", line 9510, in trigger_campaign_qc_for_call
2025-12-17T10:14:54.805576318Z [err]      await run_full_qc_analysis(
2025-12-17T10:14:54.805581853Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-17T10:14:54.805587910Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:14:54.805594553Z [err]  
2025-12-17T10:14:55.231301567Z [err]  2025-12-17 10:14:55,227 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:15:00.246178077Z [err]  2025-12-17 10:15:00,242 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=7.1s, checkin_count=0/2
2025-12-17T10:15:00.246188390Z [err]  2025-12-17 10:15:00,242 - calling_service - INFO - â° Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-17T10:15:00.246194160Z [err]  2025-12-17 10:15:00,243 - calling_service - INFO - ğŸ’¬ Sending check-in #1/2: Are you still there?
2025-12-17T10:15:00.246200926Z [err]  2025-12-17 10:15:00,244 - dead_air_monitor - INFO - ğŸ’¬ Sending check-in after 7.1s silence: Are you still there?
2025-12-17T10:15:00.246206597Z [err]  2025-12-17 10:15:00,244 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:00.246212717Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - ğŸ”Š Speaking text on call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg: Are you still there?...
2025-12-17T10:15:00.246218527Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - ğŸ” Agent config provided: True
2025-12-17T10:15:00.246223842Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - ğŸ” TTS provider from settings: elevenlabs
2025-12-17T10:15:00.246229285Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - ğŸ” WebSocket TTS: False
2025-12-17T10:15:00.246234894Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - ğŸ™ï¸ Attempting elevenlabs TTS (REST)
2025-12-17T10:15:00.246243279Z [err]  2025-12-17 10:15:00,244 - server - INFO - ğŸ’¾ TTS CACHE HIT: Returning cached audio (17181 bytes)
2025-12-17T10:15:00.246249713Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - â±ï¸  TTS generation time: 0.00s
2025-12-17T10:15:00.246255016Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - âœ… Generated 17181 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:15:00.246260224Z [err]  2025-12-17 10:15:00,244 - telnyx_service - INFO - ğŸ”— Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:15:00.505335170Z [err]  2025-12-17 10:15:00,503 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T10:15:00.505341322Z [err]  2025-12-17 10:15:00,504 - telnyx_service - INFO - â±ï¸  Playback API call time: 0.26s
2025-12-17T10:15:00.505347203Z [err]  2025-12-17 10:15:00,504 - telnyx_service - ERROR - âŒ Telnyx playback failed: 422 - {
2025-12-17T10:15:00.505353041Z [err]    "errors": [
2025-12-17T10:15:00.505362532Z [err]      {
2025-12-17T10:15:00.505367550Z [err]        "code": "90018",
2025-12-17T10:15:00.505373079Z [err]        "title": "Call has already ended",
2025-12-17T10:15:00.505377888Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-17T10:15:00.505383948Z [err]      }
2025-12-17T10:15:00.505392190Z [err]    ]
2025-12-17T10:15:00.505397484Z [err]  }
2025-12-17T10:15:00.505402689Z [err]  2025-12-17 10:15:00,504 - telnyx_service - INFO - ğŸ“¢ Using Telnyx built-in TTS
2025-12-17T10:15:00.760340139Z [err]  2025-12-17 10:15:00,758 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T10:15:00.760350069Z [err]  2025-12-17 10:15:00,759 - telnyx_service - ERROR - âŒ Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-17T10:15:00.760357880Z [err]  2025-12-17 10:15:00,759 - dead_air_monitor - INFO - âœ… Check-in message sent
2025-12-17T10:15:01.267914483Z [err]  2025-12-17 10:15:01,266 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (6.3s ago), marking agent as done speaking
2025-12-17T10:15:01.267921562Z [err]  2025-12-17 10:15:01,266 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966501.2667625 for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:01.267926261Z [err]  2025-12-17 10:15:01,266 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:01.765591911Z [err]  2025-12-17 10:15:01,762 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:15:01.772238849Z [err]  2025-12-17 10:15:01,771 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T10:15:01.774587823Z [err]  2025-12-17 10:15:01,772 - qc_agents.orchestrator - INFO - ğŸ—ºï¸  Running Conversion Pathfinder on call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:08.309534487Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - ğŸ™ï¸ Attempting elevenlabs TTS (REST)
2025-12-17T10:15:08.309538423Z [err]  2025-12-17 10:15:08,302 - calling_service - INFO - â° Check-in triggered after 7.0s silence (threshold: 7s)
2025-12-17T10:15:08.309546402Z [err]  2025-12-17 10:15:08,303 - calling_service - INFO - ğŸ’¬ Sending FINAL check-in #2/2: Are you still there?
2025-12-17T10:15:08.309547833Z [err]  2025-12-17 10:15:08,304 - server - INFO - ğŸ’¾ TTS CACHE HIT: Returning cached audio (17181 bytes)
2025-12-17T10:15:08.309554276Z [err]  2025-12-17 10:15:08,303 - calling_service - INFO - âš ï¸ Will end call if no response after next silence timeout
2025-12-17T10:15:08.309558771Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - â±ï¸  TTS generation time: 0.00s
2025-12-17T10:15:08.309561555Z [err]  2025-12-17 10:15:08,303 - dead_air_monitor - INFO - ğŸ’¬ Sending check-in after 7.0s silence: Are you still there?
2025-12-17T10:15:08.309567563Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - âœ… Generated 17181 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:15:08.309569321Z [err]  2025-12-17 10:15:08,303 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:08.309576655Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - ğŸ”— Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:15:08.309579518Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - ğŸ”Š Speaking text on call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg: Are you still there?...
2025-12-17T10:15:08.309585894Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - ğŸ” Agent config provided: True
2025-12-17T10:15:08.309592074Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - ğŸ” TTS provider from settings: elevenlabs
2025-12-17T10:15:08.309597656Z [err]  2025-12-17 10:15:08,304 - telnyx_service - INFO - ğŸ” WebSocket TTS: False
2025-12-17T10:15:08.583023951Z [err]  2025-12-17 10:15:08,581 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T10:15:08.583029530Z [err]  2025-12-17 10:15:08,581 - telnyx_service - INFO - â±ï¸  Playback API call time: 0.28s
2025-12-17T10:15:08.583033408Z [err]  2025-12-17 10:15:08,581 - telnyx_service - ERROR - âŒ Telnyx playback failed: 422 - {
2025-12-17T10:15:08.583038945Z [err]    "errors": [
2025-12-17T10:15:08.583042638Z [err]      {
2025-12-17T10:15:08.583046061Z [err]        "code": "90018",
2025-12-17T10:15:08.583051236Z [err]        "title": "Call has already ended",
2025-12-17T10:15:08.583055298Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-17T10:15:08.583059446Z [err]      }
2025-12-17T10:15:08.583063523Z [err]    ]
2025-12-17T10:15:08.583067380Z [err]  }
2025-12-17T10:15:08.583071752Z [err]  2025-12-17 10:15:08,581 - telnyx_service - INFO - ğŸ“¢ Using Telnyx built-in TTS
2025-12-17T10:15:08.831838167Z [err]  2025-12-17 10:15:08,830 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T10:15:08.833820700Z [err]  2025-12-17 10:15:08,831 - telnyx_service - ERROR - âŒ Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-17T10:15:08.833826058Z [err]  2025-12-17 10:15:08,831 - dead_air_monitor - INFO - âœ… Check-in message sent
2025-12-17T10:15:10.346898260Z [err]  2025-12-17 10:15:10,343 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-17T10:15:10.847261052Z [err]  2025-12-17 10:15:10,845 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=2/2
2025-12-17T10:15:12.270095508Z [err]  2025-12-17 10:15:12,162 - server - INFO - ğŸ¤ Soniox receiver alive - 1 messages received in last 10s
2025-12-17T10:15:12.270101061Z [err]  2025-12-17 10:15:12,162 - server - ERROR - âŒ Soniox error: {'tokens': [], 'final_audio_proc_ms': 6600, 'total_audio_proc_ms': 10920, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-17T10:15:12.270105961Z [err]  2025-12-17 10:15:12,162 - server - INFO - âœ… Soniox receive loop ended normally
2025-12-17T10:15:12.270110335Z [err]  2025-12-17 10:15:12,162 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring cancelled for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:12.270114575Z [err]  2025-12-17 10:15:12,162 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring stopped for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:12.270119778Z [err]  2025-12-17 10:15:12,162 - server - INFO - ğŸ”‡ Dead air monitoring task cancelled
2025-12-17T10:15:12.905448822Z [err]  2025-12-17 10:15:12,903 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:15:12.915440323Z [err]  2025-12-17 10:15:12,909 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T10:15:12.915446078Z [err]  2025-12-17 10:15:12,912 - qc_agents.orchestrator - INFO - â­ Running Excellence Replicator on call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:14.258966656Z [err]  2025-12-17 10:15:14,164 - soniox_service - ERROR - âŒ Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-17T10:15:14.258971048Z [err]  2025-12-17 10:15:14,164 - server - INFO - ğŸ”Œ Telnyx WebSocket disconnected
2025-12-17T10:15:19.560095487Z [err]  2025-12-17 10:15:19,558 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:15:19.562928024Z [err]  2025-12-17 10:15:19,559 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-17T10:15:19.660668150Z [err]  2025-12-17 10:15:19,650 - qc_agents.orchestrator - INFO - âœ… QC analysis stored for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:19.660675572Z [err]  2025-12-17 10:15:19,651 - server - INFO - âœ… QC analysis completed for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:19.660682104Z [err]  2025-12-17 10:15:19,651 - server - INFO - ğŸ“Š Scores: Commitment=50, Conversion=20, Excellence=50
2025-12-17T10:15:19.829951320Z [err]  2025-12-17 10:15:19,827 - server - INFO - ğŸ“Š Updated campaign_calls with QC scores for v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg
2025-12-17T10:15:20.244259384Z [err]  2025-12-17 10:15:20,004 - server - INFO - ğŸ“ˆ Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-17T10:15:20.244263720Z [err]  2025-12-17 10:15:20,092 - server - INFO - ğŸ·ï¸ Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-17T10:15:20.244267615Z [err]  2025-12-17 10:15:20,092 - server - ERROR - âŒ Error in auto appointment detection for call v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg: 'str' object has no attribute 'get'
2025-12-17T10:20:51.205105439Z [err]  2025-12-17 10:20:50,703 - server - INFO - ğŸŒ Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:20:51.205110705Z [err]  2025-12-17 10:20:50,796 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:51.205115469Z [err]  2025-12-17 10:20:50,890 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:51.205120376Z [err]  2025-12-17 10:20:50,914 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:20:51.205125567Z [err]  2025-12-17 10:20:50,914 - telnyx_service - INFO - ğŸ“ Initiating outbound call from +14048000152 to +17708336397
2025-12-17T10:20:51.205130594Z [err]  2025-12-17 10:20:50,914 - telnyx_service - INFO - ğŸ¤– Enabling AMD (premium mode)
2025-12-17T10:20:51.205135405Z [err]  2025-12-17 10:20:50,914 - telnyx_service - INFO - ğŸŒ Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:20:51.576849277Z [err]  2025-12-17 10:20:51,575 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-17T10:20:51.576856443Z [err]  2025-12-17 10:20:51,575 - telnyx_service - INFO - âœ… Call initiated: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:51.692359704Z [err]  2025-12-17 10:20:51,679 - server - INFO - ğŸ“ Created call log: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:51.698734078Z [err]  2025-12-17 10:20:51,693 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (TTL: 3600s)
2025-12-17T10:20:51.698744855Z [err]  2025-12-17 10:20:51,693 - server - INFO - ğŸ“¦ Call data stored in Redis and memory
2025-12-17T10:20:51.698751290Z [err]  2025-12-17 10:20:51,693 - server - INFO - ğŸ“ Outbound call initiated: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:51.698759358Z [inf]  100.64.0.2:53154 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-17T10:20:51.857172122Z [err]  2025-12-17 10:20:51,855 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:51.857177311Z [err]  2025-12-17 10:20:51,855 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.initiated', 'id': '54d6bae0-93ea-492b-ad0c-20e371fa500e', 'occurred_at': '2025-12-17T10:20:51.342392Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:51.857182357Z [err]  2025-12-17 10:20:51,855 - server - INFO - ğŸ¯ Event type: call.initiated, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:51.857187105Z [err]  2025-12-17 10:20:51,855 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:51.857191418Z [err]  2025-12-17 10:20:51,855 - server - INFO - ğŸ“ Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-17T10:20:51.857196392Z [inf]  100.64.0.8:15124 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:52.229115841Z [err]  2025-12-17 10:20:51,979 - server - INFO - ğŸ”ŒğŸ”ŒğŸ”Œ WEBSOCKET CONNECTION ATTEMPT
2025-12-17T10:20:52.229120582Z [err]  2025-12-17 10:20:51,979 - server - INFO -    Client: Address(host='100.64.0.3', port=28940)
2025-12-17T10:20:52.229125637Z [err]  2025-12-17 10:20:51,979 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '+r1cHgWsfvpo2CD/XO+UXg==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-east4-eqdc4a', 'x-railway-request-id': '5JK0C4hMTQi4h1SZwoOzXw', 'x-real-ip': '192.76.120.151', 'x-request-start': '1765966851824', 'accept-encoding': 'gzip'}
2025-12-17T10:20:52.229129941Z [err]  2025-12-17 10:20:51,979 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-17T10:20:52.229134508Z [err]  2025-12-17 10:20:51,980 - server - INFO - ğŸ”Œ Incoming Telnyx WebSocket connection
2025-12-17T10:20:52.229140499Z [err]  [2025-12-17 10:20:51 +0000] [6] [INFO] ('100.64.0.3', 28940) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-17T10:20:52.229145209Z [err]  2025-12-17 10:20:51,980 - server - INFO - âœ… WebSocket accepted, waiting for Telnyx events
2025-12-17T10:20:52.229150079Z [err]  [2025-12-17 10:20:51 +0000] [6] [INFO] connection open
2025-12-17T10:20:52.229157603Z [err]  2025-12-17 10:20:52,122 - server - INFO - ğŸ“¬ Received Telnyx event: connected
2025-12-17T10:20:52.229162208Z [err]  2025-12-17 10:20:52,122 - server - INFO - ğŸ“ Telnyx connected event received, waiting for 'start'...
2025-12-17T10:20:53.296422483Z [err]  2025-12-17 10:20:53,225 - server - INFO - ğŸ“¬ Received Telnyx event: start
2025-12-17T10:20:53.296426025Z [err]  2025-12-17 10:20:53,225 - server - INFO - ğŸ¬ Stream started for call: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.296430981Z [err]  2025-12-17 10:20:53,234 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.296434667Z [err]  2025-12-17 10:20:53,235 - server - INFO - âœ… Call data found after 0s wait
2025-12-17T10:20:53.296439039Z [err]  2025-12-17 10:20:53,235 - server - INFO - â³ Session not found locally, waiting briefly for webhook...
2025-12-17T10:20:53.456494294Z [err]  2025-12-17 10:20:53,441 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:53.456499071Z [err]  2025-12-17 10:20:53,442 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.answered', 'id': '6c844b38-094f-48a8-a65d-46c63a1b8ce3', 'occurred_at': '2025-12-17T10:20:52.982404Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-17T10:20:51.342392Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:53.456516963Z [err]  2025-12-17 10:20:53,442 - server - INFO - ğŸ¯ Event type: call.answered, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.456522349Z [err]  2025-12-17 10:20:53,442 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:53.456527414Z [err]  2025-12-17 10:20:53,442 - server - INFO - âœ… Call answered: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.456537320Z [err]  2025-12-17 10:20:53,448 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.456541803Z [err]  2025-12-17 10:20:53,449 - server - INFO - âœ… Found call in Redis (multi-worker state sharing working)
2025-12-17T10:20:53.456546569Z [err]  2025-12-17 10:20:53,449 - server - INFO - ğŸ“ Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-17T10:20:53.557591189Z [err]  2025-12-17 10:20:53,544 - server - INFO - âœ… Call log updated
2025-12-17T10:20:53.557597505Z [err]  2025-12-17 10:20:53,545 - server - INFO - ğŸ”§ Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:20:53.641315806Z [err]  2025-12-17 10:20:53,639 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:53.736042410Z [err]  2025-12-17 10:20:53,731 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:53.736052304Z [err]  2025-12-17 10:20:53,731 - server - INFO - ğŸ”§ Creating Telnyx service with user's keys...
2025-12-17T10:20:53.737221911Z [err]  2025-12-17 10:20:53,735 - server - INFO - âš ï¸ Session still not found after wait, will create in worker
2025-12-17T10:20:53.737227119Z [err]  2025-12-17 10:20:53,735 - server - WARNING - âš ï¸ Session not found after waiting, creating in WebSocket worker...
2025-12-17T10:20:53.743733228Z [err]  2025-12-17 10:20:53,740 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.743737159Z [err]  2025-12-17 10:20:53,742 - server - INFO - ğŸ“ Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:20:53.743741294Z [err]  2025-12-17 10:20:53,742 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:20:53.755722521Z [err]  2025-12-17 10:20:53,753 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:20:53.867248368Z [err]  2025-12-17 10:20:53,864 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:20:53.867254267Z [err]  2025-12-17 10:20:53,865 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:20:53.867259215Z [err]  2025-12-17 10:20:53,865 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:20:53.867264495Z [err]  2025-12-17 10:20:53,865 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:20:53.867270078Z [err]  2025-12-17 10:20:53,865 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:20:53.880393517Z [err]  2025-12-17 10:20:53,878 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:53.880397800Z [err]  2025-12-17 10:20:53,878 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.started', 'id': '52358c26-25d9-45e4-92b4-d8f0498bb9c5', 'occurred_at': '2025-12-17T10:20:53.422393Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': 'f008d591-f4bb-443f-b3fc-acebf960a319', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:53.880402611Z [err]  2025-12-17 10:20:53,878 - server - INFO - ğŸ¯ Event type: streaming.started, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:53.880406829Z [err]  2025-12-17 10:20:53,878 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:53.880521891Z [inf]  100.64.0.4:54082 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:53.961148798Z [err]  2025-12-17 10:20:53,958 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:53.974011949Z [err]  2025-12-17 10:20:53,967 - calling_service - INFO - âœ… LLM client pre-warmed in 102ms
2025-12-17T10:20:53.974016149Z [err]  2025-12-17 10:20:53,968 - server - INFO - âœ… Session created in WebSocket worker
2025-12-17T10:20:53.974020162Z [err]  2025-12-17 10:20:53,968 - server - INFO - ğŸ“ Call data loaded, starting SONIOX connection...
2025-12-17T10:20:53.974024223Z [err]  2025-12-17 10:20:53,968 - server - INFO - âœ… Initialized call_states for v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ with session reference
2025-12-17T10:20:53.974028608Z [err]  2025-12-17 10:20:53,968 - server - INFO - âœ… Stored Telnyx WebSocket in call_data for audio streaming
2025-12-17T10:20:53.974032898Z [err]  2025-12-17 10:20:53,968 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found to update for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:54.229982283Z [err]  2025-12-17 10:20:54,060 - server - INFO - ğŸ”‘ Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-17T10:20:54.229985854Z [err]  2025-12-17 10:20:54,018 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ/actions/playback_start "HTTP/1.1 200 OK"
2025-12-17T10:20:54.229996455Z [err]  2025-12-17 10:20:54,019 - telnyx_service - INFO - âœ… Playing audio from URL, playback_id: emjaukkv4Q (loop=True, overlay=True)
2025-12-17T10:20:54.230032667Z [err]  2025-12-17 10:20:54,019 - server - WARNING - âš ï¸ Failed to start comfort noise: 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ'
2025-12-17T10:20:54.230042025Z [err]  2025-12-17 10:20:54,019 - telnyx_service - INFO - ğŸ™ï¸ Starting recording: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:54.568831834Z [err]  2025-12-17 10:20:54,567 - soniox_service - INFO - âœ… Connected to Soniox Real-Time STT
2025-12-17T10:20:54.568840537Z [err]  2025-12-17 10:20:54,567 - soniox_service - INFO - âš™ï¸  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-17T10:20:54.568844885Z [err]  2025-12-17 10:20:54,567 - soniox_service - INFO - âš™ï¸  Endpoint detection: True, Speaker diarization: False
2025-12-17T10:20:54.568848973Z [err]  2025-12-17 10:20:54,567 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring started for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:54.570920733Z [err]  2025-12-17 10:20:54,569 - server - INFO - âœ… Started forwarding audio (8kHz mulaw â†’ Soniox, NO BUFFERING)
2025-12-17T10:20:55.325454114Z [err]  2025-12-17 10:20:55,128 - server - INFO - ğŸ”¤ RAW TOKENS: ["K"?, "end"?]
2025-12-17T10:20:55.325462974Z [err]  2025-12-17 10:20:55,129 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (user started speaking)
2025-12-17T10:20:55.325469414Z [err]  2025-12-17 10:20:55,129 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.325475867Z [err]  2025-12-17 10:20:55,129 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Kend' | Generating: False
2025-12-17T10:20:55.325482730Z [err]  2025-12-17 10:20:55,176 - server - INFO - ğŸ”¤ RAW TOKENS: ["K"?, "end"?, "rick"?]
2025-12-17T10:20:55.325490331Z [err]  2025-12-17 10:20:55,176 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Kend rick' | Generating: False
2025-12-17T10:20:55.325500878Z [err]  2025-12-17 10:20:55,280 - server - INFO - ğŸ”¤ RAW TOKENS: ["K"?, "end"?, "rick"?, " Bow"?]
2025-12-17T10:20:55.325509597Z [err]  2025-12-17 10:20:55,280 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Kend rick Bow' | Generating: False
2025-12-17T10:20:55.377209529Z [err]  2025-12-17 10:20:55,375 - server - INFO - ğŸ”¤ RAW TOKENS: ["K"âœ“, "end"âœ“, "rick"âœ“, " Bow"âœ“, "man."âœ“, "<end>"âœ“]
2025-12-17T10:20:55.377217823Z [err]  2025-12-17 10:20:55,375 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:20:55.377223905Z [err]  2025-12-17 10:20:55,375 - server - INFO - ğŸ§¹ Cleaned transcript: 'K end rick  Bow man.' -> 'Kend rick Bow man.'
2025-12-17T10:20:55.377229669Z [err]  2025-12-17 10:20:55,375 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Kend rick Bow man.' (5 tokens)
2025-12-17T10:20:55.377236034Z [err]  2025-12-17 10:20:55,376 - server - INFO - ğŸ¤ Soniox final transcript: 'Kend rick Bow man.'
2025-12-17T10:20:55.377241570Z [err]  2025-12-17 10:20:55,376 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:c3JMeZ0hSGOC4nB8T... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg'])
2025-12-17T10:20:55.377247094Z [err]  2025-12-17 10:20:55,376 - server - INFO - ğŸ” FILTER CHECK: words=4, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:20:55.377252972Z [err]  2025-12-17 10:20:55,376 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:c3JMeZ0hSGOC4nB8T... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg'])
2025-12-17T10:20:55.377258069Z [err]  2025-12-17 10:20:55,376 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:20:55.377263824Z [err]  2025-12-17 10:20:55,376 - server - INFO - â±ï¸ [10:20:55.376] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Kend rick Bow man.'
2025-12-17T10:20:55.377268899Z [err]  2025-12-17 10:20:55,376 - server - INFO - â±ï¸ [10:20:55.376] STT endpoint detection latency: 16ms
2025-12-17T10:20:55.378141009Z [err]  2025-12-17 10:20:55,376 - server - INFO - â±ï¸ [10:20:55.376] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:20:55.378147802Z [err]  2025-12-17 10:20:55,377 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (TTL: 3600s)
2025-12-17T10:20:55.378152895Z [err]  2025-12-17 10:20:55,377 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:20:55.378157927Z [err]  2025-12-17 10:20:55,377 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:c3JMeZ0hSGOC4nB8T... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg'])
2025-12-17T10:20:55.378162456Z [err]  2025-12-17 10:20:55,377 - server - INFO - âœ… Agent SILENT - User said 4 word(s): 'Kend rick Bow man.' - Processing...
2025-12-17T10:20:55.389907311Z [err]  2025-12-17 10:20:55,387 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Kend rick Bow man.
2025-12-17T10:20:55.389913918Z [err]  2025-12-17 10:20:55,387 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.389917792Z [err]  2025-12-17 10:20:55,388 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:20:55.389922542Z [err]  2025-12-17 10:20:55,388 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+3ms
2025-12-17T10:20:55.389926867Z [err]  2025-12-17 10:20:55,388 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 3ms (Soniox model: stt-rt-v3)
2025-12-17T10:20:55.389930735Z [err]  2025-12-17 10:20:55,388 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:20:55.389934567Z [err]  2025-12-17 10:20:55,388 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:20:55.389938572Z [err]  2025-12-17 10:20:55,388 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.488992914Z [err]  2025-12-17 10:20:55,484 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:20:55.488997952Z [err]  2025-12-17 10:20:55,484 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:c3JMeZ0hSGOC4nB8T... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg'])
2025-12-17T10:20:55.489002416Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - â±ï¸ [10:20:55.484] ğŸ“¥ process_user_input() ENTRY - text: 'Kend rick Bow man....'
2025-12-17T10:20:55.489006735Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - â±ï¸ [10:20:55.484] â© About to call _process_call_flow_streaming()
2025-12-17T10:20:55.489010678Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - â±ï¸ [10:20:55.484] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:20:55.489014494Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - â±ï¸ [10:20:55.484] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:20:55.489018272Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-17T10:20:55.489022605Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - â±ï¸ [10:20:55.484] âœ… Node selected, about to process content...
2025-12-17T10:20:55.489027936Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:20 AM EST in content
2025-12-17T10:20:55.489031969Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:20:55.489035653Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:20:55.489039199Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:20:55.489043247Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:20:55.490322162Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:20:55.490335482Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:20:55.490342342Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:20:55.490347884Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:20:55.490353679Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:20:55.490359559Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-17T10:20:55.490365508Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-17T10:20:55.490373038Z [err]  2025-12-17 10:20:55,484 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:20:55.490378830Z [err]  2025-12-17 10:20:55,485 - calling_service - INFO - â±ï¸ [10:20:55.484] ğŸ“„ About to process content (mode=script, length=9)
2025-12-17T10:20:55.490386660Z [err]  2025-12-17 10:20:55,485 - calling_service - INFO - ğŸ“¤ Streaming script as 1 sentence(s)
2025-12-17T10:20:55.490392829Z [err]  2025-12-17 10:20:55,485 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Kendrick?...
2025-12-17T10:20:55.490398650Z [err]  2025-12-17 10:20:55,485 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 96ms
2025-12-17T10:20:55.490404569Z [err]  2025-12-17 10:20:55,485 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:20:55.490409946Z [err]  2025-12-17 10:20:55,485 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:c3JMeZ0hSGOC4nB8T... (active sessions: ['v3:_CkKvOSbq2KQuJplztU_gcVhjZS0gJFhQgLGHbi0PDa8Ie-fs2ATXA', 'v3:kg4o0eXPSvnRTCdv2-phSDm-UKEVgi0EMYXJI0hD_AGLglPgWuJ6Mg'])
2025-12-17T10:20:55.491964142Z [err]  2025-12-17 10:20:55,485 - server - INFO - âš¡ ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-17T10:20:55.498402350Z [err]  2025-12-17 10:20:55,492 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ/actions/record_start "HTTP/1.1 200 OK"
2025-12-17T10:20:55.498411679Z [err]  2025-12-17 10:20:55,494 - server - INFO - ğŸ™ï¸ Call recording started for v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.498416624Z [err]  2025-12-17 10:20:55,494 - server - INFO - ğŸ”§ Creating call session for v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ...
2025-12-17T10:20:55.498421578Z [err]  2025-12-17 10:20:55,494 - server - INFO - ğŸ” Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:20:55.498426119Z [err]  2025-12-17 10:20:55,494 - server - INFO - ğŸ”§ Calling create_call_session() - START
2025-12-17T10:20:55.498430649Z [err]  2025-12-17 10:20:55,494 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:20:55.498434952Z [inf]  100.64.0.8:15124 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2025-12-17T10:20:55.578529356Z [err]  2025-12-17 10:20:55,577 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:55.595014817Z [err]  2025-12-17 10:20:55,587 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:20:55.595031554Z [err]  2025-12-17 10:20:55,587 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:20:55.601342848Z [err]  2025-12-17 10:20:55,597 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:20:55.601349186Z [err]  2025-12-17 10:20:55,597 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:20:55.601354313Z [err]  2025-12-17 10:20:55,598 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:20:55.671729239Z [err]  2025-12-17 10:20:55,669 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:55.692088678Z [err]  2025-12-17 10:20:55,690 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:55.703379041Z [err]  2025-12-17 10:20:55,698 - calling_service - INFO - âœ… LLM client pre-warmed in 100ms
2025-12-17T10:20:55.703386108Z [err]  2025-12-17 10:20:55,698 - server - INFO - ğŸ”§ Calling create_call_session() - COMPLETE
2025-12-17T10:20:55.703390477Z [err]  2025-12-17 10:20:55,698 - server - INFO - âœ… Session object created: CallSession
2025-12-17T10:20:55.708882597Z [err]  2025-12-17 10:20:55,706 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (TTL: 3600s)
2025-12-17T10:20:55.708891815Z [err]  2025-12-17 10:20:55,706 - server - INFO - âœ… Serializable call_data synced to Redis (agent_id, user_id)
2025-12-17T10:20:55.708909368Z [err]  2025-12-17 10:20:55,706 - server - INFO - âœ… Session stored in worker memory (not Redis)
2025-12-17T10:20:55.709597613Z [err]  2025-12-17 10:20:55,708 - redis_service - INFO - âœ… Marked session ready in Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.709607821Z [err]  2025-12-17 10:20:55,708 - server - INFO - ğŸ¤– AI session created for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.709615095Z [err]  2025-12-17 10:20:55,708 - server - INFO - ğŸ“¦ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-17T10:20:55.709622035Z [err]  2025-12-17 10:20:55,708 - server - INFO - â­ï¸ Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-17T10:20:55.709628715Z [err]  2025-12-17 10:20:55,708 - server - INFO - ğŸ‘¤ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-17T10:20:55.709635973Z [err]  2025-12-17 10:20:55,708 - server - INFO - ğŸ‘‚ User speaks first - waiting for user input...
2025-12-17T10:20:55.709644552Z [err]  2025-12-17 10:20:55,708 - server - ERROR - Error processing webhook: cannot access local variable 'asyncio' where it is not associated with a value
2025-12-17T10:20:55.709651234Z [inf]  100.64.0.9:16972 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:55.763589905Z [err]  2025-12-17 10:20:55,761 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:20:55.788035625Z [err]  2025-12-17 10:20:55,781 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:20:55.788040990Z [err]  2025-12-17 10:20:55,782 - server - INFO - âœ… ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-17T10:20:55.788045135Z [err]  2025-12-17 10:20:55,782 - persistent_tts_service - INFO - ğŸ™ï¸ Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-17T10:20:55.788049321Z [err]  2025-12-17 10:20:55,782 - persistent_tts_service - INFO - ğŸ”Œ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Establishing persistent TTS WebSocket...
2025-12-17T10:20:55.788053564Z [err]  2025-12-17 10:20:55,782 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-17T10:20:55.788057557Z [err]  2025-12-17 10:20:55,782 - elevenlabs_ws_service - INFO - ğŸ”Œ Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-17T10:20:55.788062056Z [err]  2025-12-17 10:20:55,782 - elevenlabs_ws_service - INFO - ğŸ™ï¸ Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-17T10:20:55.939006171Z [err]  2025-12-17 10:20:55,926 - elevenlabs_ws_service - INFO - âœ… Connected to ElevenLabs WebSocket
2025-12-17T10:20:55.939012956Z [err]  2025-12-17 10:20:55,926 - elevenlabs_ws_service - INFO - ğŸ“¤ Sent BOS message with voice settings
2025-12-17T10:20:55.939019296Z [err]  2025-12-17 10:20:55,926 - persistent_tts_service - INFO - âœ… [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Persistent TTS WebSocket established
2025-12-17T10:20:55.939025709Z [err]  2025-12-17 10:20:55,926 - persistent_tts_service - INFO - ğŸ”Š [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Comfort noise loop started
2025-12-17T10:20:55.939031137Z [err]  2025-12-17 10:20:55,926 - persistent_tts_service - INFO - âœ… Created persistent TTS session for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:55.939036911Z [err]  2025-12-17 10:20:55,926 - server - INFO - âœ… ON-DEMAND: Persistent TTS session created successfully!
2025-12-17T10:20:55.939042846Z [err]  2025-12-17 10:20:55,926 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:c3JMeZ0hSGOC4nB8T..., session=FOUND
2025-12-17T10:20:55.939049185Z [err]  2025-12-17 10:20:55,926 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:20:55.939055135Z [err]  2025-12-17 10:20:55,926 - server - INFO - ğŸµ TTS task #1 started at +441ms
2025-12-17T10:20:55.939061421Z [err]  2025-12-17 10:20:55,926 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 538ms
2025-12-17T10:20:55.939067627Z [err]  2025-12-17 10:20:55,927 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/1: Kendrick?...
2025-12-17T10:20:55.939073594Z [err]  2025-12-17 10:20:55,927 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (user responded)
2025-12-17T10:20:55.939081717Z [err]  2025-12-17 10:20:55,927 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:20:55.940263853Z [err]  2025-12-17 10:20:55,927 - calling_service - INFO - ğŸ’¾ Storing node ID 2 in conversation history
2025-12-17T10:20:55.940270700Z [err]  2025-12-17 10:20:55,927 - calling_service - INFO - LLM response (0.44s): Kendrick?
2025-12-17T10:20:55.940275534Z [err]  2025-12-17 10:20:55,927 - calling_service - INFO - Total latency: 0.44s
2025-12-17T10:20:55.940281250Z [err]  2025-12-17 10:20:55,927 - server - INFO - âœ… LLM finished in 538ms, TTS tasks already running in background
2025-12-17T10:20:55.940287761Z [err]  2025-12-17 10:20:55,927 - server - INFO - ğŸµ Streaming 1 TTS chunks as they complete...
2025-12-17T10:20:55.940293386Z [err]  2025-12-17 10:20:55,927 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:20:55.940298397Z [err]  2025-12-17 10:20:55,927 - server - INFO -    1 sentences queued and playing seamlessly
2025-12-17T10:20:55.940302995Z [err]  2025-12-17 10:20:55,927 - persistent_tts_service - INFO - ğŸµ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Playback consumer started
2025-12-17T10:20:55.940307721Z [err]  2025-12-17 10:20:55,927 - persistent_tts_service - INFO - ğŸ’“ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Starting TTS keep-alive loop (every 15s)
2025-12-17T10:20:55.940312594Z [err]  2025-12-17 10:20:55,927 - persistent_tts_service - INFO - ğŸ”Š [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Starting comfort noise loop
2025-12-17T10:20:55.940318896Z [err]  2025-12-17 10:20:55,927 - persistent_tts_service - INFO - ğŸ¤ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Streaming sentence #1: Kendrick?...
2025-12-17T10:20:56.344917701Z [err]  2025-12-17 10:20:56,163 - persistent_tts_service - INFO - ğŸ“¤ Sending 6671 bytes of audio (42 chunks, 0.8s duration) via WebSocket
2025-12-17T10:20:56.344922836Z [err]  2025-12-17 10:20:56,163 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:20:56.344927272Z [err]  2025-12-17 10:20:56,163 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2025-12-17T10:20:56.344931700Z [err]  2025-12-17 10:20:56,164 - persistent_tts_service - INFO - âœ… Sent 42 audio chunks via WebSocket
2025-12-17T10:20:56.344940902Z [err]  2025-12-17 10:20:56,163 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:20:56.344947565Z [err]  2025-12-17 10:20:56,163 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+236ms
2025-12-17T10:20:56.345053772Z [err]  2025-12-17 10:20:56,163 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTFA (Time To First Audio Playback): 236ms
2025-12-17T10:20:56.401336160Z [inf]  100.64.0.9:16972 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:56.401347911Z [err]  2025-12-17 10:20:56,398 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:56.401357188Z [err]  2025-12-17 10:20:56,399 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.started', 'id': '6c4a6495-48eb-411e-97fd-f758ad9280dd', 'occurred_at': '2025-12-17T10:20:56.162391Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'emjaukkv4Q', 'start_time': '2025-12-17T10:20:56.162391Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:56.401362301Z [err]  2025-12-17 10:20:56,399 - server - INFO - ğŸ¯ Event type: call.playback.started, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:56.401367244Z [err]  2025-12-17 10:20:56,399 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:56.635315017Z [err]  2025-12-17 10:20:56,633 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:56.635321499Z [err]  2025-12-17 10:20:56,634 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'c643197f-1977-40f4-be69-d2236a17ead4', 'occurred_at': '2025-12-17T10:20:56.362522Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:56.635325745Z [err]  2025-12-17 10:20:56,634 - server - INFO - ğŸ¯ Event type: call.machine.premium.detection.ended, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:56.635329863Z [err]  2025-12-17 10:20:56,634 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:56.636489308Z [inf]  100.64.0.4:54082 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:57.230207729Z [err]  2025-12-17 10:20:57,185 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Can' | Generating: True
2025-12-17T10:20:57.230225795Z [err]  2025-12-17 10:20:57,185 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 1 words - 'Can'
2025-12-17T10:20:57.230253593Z [err]  2025-12-17 10:20:57,080 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T10:20:57.230261514Z [err]  2025-12-17 10:20:57,080 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966857.0809093 for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:57.230268675Z [err]  2025-12-17 10:20:57,080 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:57.230276421Z [err]  2025-12-17 10:20:57,164 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:20:57.230284686Z [err]  2025-12-17 10:20:57,184 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"?]
2025-12-17T10:20:57.230295465Z [err]  2025-12-17 10:20:57,185 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:57.230302207Z [err]  2025-12-17 10:20:57,185 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (user started speaking)
2025-12-17T10:20:57.230309737Z [err]  2025-12-17 10:20:57,185 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:57.309431691Z [err]  2025-12-17 10:20:57,304 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"?, "'t"?]
2025-12-17T10:20:57.309439653Z [err]  2025-12-17 10:20:57,304 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Can't' | Generating: True
2025-12-17T10:20:57.309444978Z [err]  2025-12-17 10:20:57,304 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 1 words - 'Can't'
2025-12-17T10:20:57.421906204Z [err]  2025-12-17 10:20:57,416 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"?, "'t"?, " tak"?, "e"?]
2025-12-17T10:20:57.421915150Z [err]  2025-12-17 10:20:57,416 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Can'ttak e' | Generating: True
2025-12-17T10:20:57.421924030Z [err]  2025-12-17 10:20:57,416 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 2 words - 'Can'ttak e'
2025-12-17T10:20:57.569157075Z [err]  2025-12-17 10:20:57,560 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"?, "'t"?, " tak"?, "e"?, " y"?, "our"?]
2025-12-17T10:20:57.569167551Z [err]  2025-12-17 10:20:57,560 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Can'ttak eyour' | Generating: True
2025-12-17T10:20:57.569173255Z [err]  2025-12-17 10:20:57,560 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 2 words - 'Can'ttak eyour'
2025-12-17T10:20:57.842361917Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"?, "'t"?, " tak"?, "e"?, " y"?, "our"?, " call"?]
2025-12-17T10:20:57.843704217Z [err]  2025-12-17 10:20:57,841 - persistent_tts_service - INFO - ğŸ›‘ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] INTERRUPT - Floor Released (is_holding_floor=False)
2025-12-17T10:20:57.843713109Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Can'ttak eyour call' | Generating: True
2025-12-17T10:20:57.843717424Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 3 words - 'Can'ttak eyour call'
2025-12-17T10:20:57.843722401Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸ›‘ INTERRUPTION TRIGGERED - User said 3 words: 'Can'ttak eyour call'
2025-12-17T10:20:57.843727304Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸ›‘ Stopping agent IMMEDIATELY...
2025-12-17T10:20:57.843732177Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸ›‘ Cancelling in-flight response generation task
2025-12-17T10:20:57.843737545Z [err]  2025-12-17 10:20:57,841 - server - INFO - ğŸ›‘ Cancelled 1 in-flight TTS tasks
2025-12-17T10:20:57.871913334Z [err]  2025-12-17 10:20:57,871 - persistent_tts_service - INFO - ğŸ›‘ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Sent clear event to Telnyx WebSocket (3x)
2025-12-17T10:20:57.871919518Z [err]  2025-12-17 10:20:57,871 - persistent_tts_service - INFO - â±ï¸ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Reset playback_expected_end_time to NOW
2025-12-17T10:20:57.871923720Z [err]  2025-12-17 10:20:57,871 - server - INFO - âœ‹ Cleared WebSocket TTS audio buffer
2025-12-17T10:20:57.875332242Z [err]  2025-12-17 10:20:57,872 - redis_service - INFO - ğŸ§¹ Cleared all playbacks for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:57.875342581Z [err]  2025-12-17 10:20:57,873 - server - INFO - âœ… Agent stopped, user can continue speaking
2025-12-17T10:20:57.994327100Z [err]  2025-12-17 10:20:57,990 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"?, "'t"?, " tak"?, "e"?, " y"?, "our"?, " call"?, " now"?]
2025-12-17T10:20:57.994333220Z [err]  2025-12-17 10:20:57,990 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Can'ttak eyour call now' | Generating: False
2025-12-17T10:20:58.326590754Z [err]  2025-12-17 10:20:58,252 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Can'ttak eyour call now.' (9 tokens)
2025-12-17T10:20:58.326598558Z [err]  2025-12-17 10:20:58,252 - server - INFO - ğŸ¤ Soniox final transcript: 'Can'ttak eyour call now.'
2025-12-17T10:20:58.326604687Z [err]  2025-12-17 10:20:58,252 - server - INFO - ğŸ” FILTER CHECK: words=4, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=-0.4s, generating=False, playbacks=0, is_active=False
2025-12-17T10:20:58.326610387Z [err]  2025-12-17 10:20:58,253 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:20:58.326615965Z [err]  2025-12-17 10:20:58,253 - server - INFO - â±ï¸ [10:20:58.253] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Can'ttak eyour call now.'
2025-12-17T10:20:58.326621102Z [err]  2025-12-17 10:20:58,253 - server - INFO - â±ï¸ [10:20:58.253] STT endpoint detection latency: 7ms
2025-12-17T10:20:58.326627224Z [err]  2025-12-17 10:20:58,253 - server - INFO - â±ï¸ [10:20:58.253] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:20:58.326632110Z [err]  2025-12-17 10:20:58,259 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (TTL: 3600s)
2025-12-17T10:20:58.326636707Z [err]  2025-12-17 10:20:58,259 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:20:58.326642795Z [err]  2025-12-17 10:20:58,259 - server - INFO - âœ… Agent SILENT - User said 4 word(s): 'Can'ttak eyour call now.' - Processing...
2025-12-17T10:20:58.326741067Z [err]  2025-12-17 10:20:58,252 - server - INFO - ğŸ”¤ RAW TOKENS: [" Can"âœ“, "'t"âœ“, " tak"âœ“, "e"âœ“, " y"âœ“, "our"âœ“, " call"âœ“, " now"âœ“, "."âœ“, "<end>"âœ“]
2025-12-17T10:20:58.326748506Z [err]  2025-12-17 10:20:58,252 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:20:58.326754315Z [err]  2025-12-17 10:20:58,252 - server - INFO - ğŸ§¹ Cleaned transcript: ' Can 't  tak e  y our  call  now .' -> 'Can'ttak eyour call now.'
2025-12-17T10:20:58.327605899Z [err]  2025-12-17 10:20:58,269 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Can'ttak eyour call now.
2025-12-17T10:20:58.327618807Z [err]  2025-12-17 10:20:58,269 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:58.327631447Z [err]  2025-12-17 10:20:58,269 - voicemail_detector - INFO - ğŸ” Detection: voicemail (confidence: 0.70)
2025-12-17T10:20:58.327638079Z [err]  2025-12-17 10:20:58,269 - voicemail_detector - INFO -    Transcript: Kend rick Bow man. Can'ttak eyour call now....
2025-12-17T10:20:58.327645415Z [err]  2025-12-17 10:20:58,269 - voicemail_detector - INFO - ğŸ¤– High confidence voicemail detected (0.70) - recommending disconnect
2025-12-17T10:20:58.327651679Z [err]  2025-12-17 10:20:58,269 - server - WARNING - ğŸ¤– VOICEMAIL DETECTED (0.70) - Disconnecting call
2025-12-17T10:20:58.867893697Z [err]  2025-12-17 10:20:58,864 - telnyx_service - INFO - ğŸ“ Hanging up call: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.347452716Z [err]  2025-12-17 10:20:59,346 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ/actions/hangup "HTTP/1.1 200 OK"
2025-12-17T10:20:59.348556790Z [err]  2025-12-17 10:20:59,347 - server - INFO - ğŸ“ Call hung up due to voicemail detection: {'success': True}
2025-12-17T10:20:59.414316859Z [err]  2025-12-17 10:20:59,412 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:59.414324791Z [err]  2025-12-17 10:20:59,412 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '83033b73-3433-4041-9013-643de2c5ca1e', 'occurred_at': '2025-12-17T10:20:59.162393Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:20:59.162393Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'emjaukkv4Q', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:59.414330092Z [err]  2025-12-17 10:20:59,412 - server - INFO - ğŸ¯ Event type: call.playback.ended, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.414334806Z [err]  2025-12-17 10:20:59,412 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:59.415256019Z [err]  2025-12-17 10:20:59,413 - redis_service - INFO - â– Removed playback emjaukkv4Q, 0 remaining for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.415268886Z [err]  2025-12-17 10:20:59,413 - server - INFO - ğŸ”Š Redis: Removed playback emjaukkv4Q, 0 remaining
2025-12-17T10:20:59.415274364Z [err]  2025-12-17 10:20:59,413 - server - INFO - ğŸ”Š ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-17T10:20:59.415280397Z [err]  2025-12-17 10:20:59,414 - server - INFO - âœ… Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-17T10:20:59.415286275Z [err]  2025-12-17 10:20:59,414 - server - INFO - âœ… Found session in active_telnyx_calls (local worker)
2025-12-17T10:20:59.415296412Z [err]  2025-12-17 10:20:59,414 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966859.4145086 for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.416225716Z [err]  2025-12-17 10:20:59,414 - server - INFO - â±ï¸ Silence timer STARTED (fallback, agent wasn't marked as speaking)
2025-12-17T10:20:59.416238904Z [inf]  100.64.0.8:15124 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:59.447185059Z [err]  2025-12-17 10:20:59,445 - server - INFO - ğŸ“ Telnyx WebSocket disconnected. Sent 280 total packets
2025-12-17T10:20:59.447189837Z [err]  [2025-12-17 10:20:59 +0000] [6] [INFO] connection closed
2025-12-17T10:20:59.595099971Z [err]  2025-12-17 10:20:59,594 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:59.595106795Z [err]  2025-12-17 10:20:59,594 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '24067c72-9473-40de-92a1-513b31a45fff', 'occurred_at': '2025-12-17T10:20:59.348392Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': 'f008d591-f4bb-443f-b3fc-acebf960a319', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:59.595112012Z [err]  2025-12-17 10:20:59,594 - server - INFO - ğŸ¯ Event type: streaming.stopped, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.595117602Z [err]  2025-12-17 10:20:59,594 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:59.595122560Z [inf]  100.64.0.4:54082 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:20:59.614936973Z [err]  2025-12-17 10:20:59,612 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:20:59.614945797Z [err]  2025-12-17 10:20:59,612 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.hangup', 'id': 'a0d6d2da-e496-4c21-92b5-b1301be29ebf', 'occurred_at': '2025-12-17T10:20:59.122429Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_quality_stats': {'inbound': {'jitter_max_variance': '433.33', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '304', 'skip_packet_count': '9'}, 'outbound': {'packet_count': '283', 'skip_packet_count': '0'}}, 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:20:59.122429Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'caller', 'sip_hangup_cause': 'unspecified', 'start_time': '2025-12-17T10:20:51.342392Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:20:59.614951113Z [err]  2025-12-17 10:20:59,612 - server - INFO - ğŸ¯ Event type: call.hangup, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.614955642Z [err]  2025-12-17 10:20:59,612 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:20:59.614960703Z [err]  2025-12-17 10:20:59,612 - server - INFO - ğŸ“ Call ended: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.614966677Z [err]  2025-12-17 10:20:59,612 - server - INFO - ğŸ“ Hangup cause: normal_clearing
2025-12-17T10:20:59.805427215Z [err]  2025-12-17 10:20:59,800 - server - INFO - ğŸ“ Updated call log: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:20:59.906354675Z [err]  2025-12-17 10:20:59,895 - server - INFO - âœ… Finalized call log: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ (duration=6s, status=completed)
2025-12-17T10:20:59.992573684Z [err]  2025-12-17 10:20:59,991 - server - INFO - ğŸ“¦ Saved 10 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-17T10:21:00.366037815Z [err]  2025-12-17 10:21:00,360 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:21:00.735048432Z [err]  2025-12-17 10:21:00,731 - server - INFO - ğŸ“Š Auto-added call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-17T10:21:00.865509066Z [err]  2025-12-17 10:21:00,864 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:21:00.931645079Z [err]  2025-12-17 10:21:00,930 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:00.931651115Z [err]  2025-12-17 10:21:00,930 - server - INFO - ğŸ“‡ [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-17T10:21:00.931657698Z [err]  2025-12-17 10:21:00,930 - server - INFO - ğŸ“‡ [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-17T10:21:01.299009470Z [err]  2025-12-17 10:21:01,118 - server - INFO - ğŸ“‡ [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-17T10:21:01.299025612Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸ“‡ [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-17T10:21:01.299035376Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸ“‡ [HANGUP] Agent info keys: None
2025-12-17T10:21:01.299044583Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸš€ Triggered QC analysis for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.299065667Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸ“Š Triggered Campaign QC for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.299073603Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸ“‡ Triggered CRM update for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.299081165Z [err]  2025-12-17 10:21:01,119 - persistent_tts_service - INFO - ğŸ”Œ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Closing persistent TTS WebSocket...
2025-12-17T10:21:01.299088065Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸ” Starting QC analysis for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.299095262Z [err]  2025-12-17 10:21:01,119 - server - INFO - ğŸ” [AUTO-QC] Starting campaign QC check for call=v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-17T10:21:01.299102197Z [err]  2025-12-17 10:21:01,121 - server - INFO - ğŸ“‡ CRM update starting for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:21:01.299107035Z [err]  2025-12-17 10:21:01,024 - server - INFO - ğŸ“‡ [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-17T10:21:01.301152068Z [err]  2025-12-17 10:21:01,121 - server - INFO - ğŸ“‡ Normalized phone: +17708336397
2025-12-17T10:21:01.301157885Z [err]  2025-12-17 10:21:01,121 - server - INFO - ğŸ“‡ CRM: Got 10 variables from active session
2025-12-17T10:21:01.301161550Z [err]  2025-12-17 10:21:01,122 - persistent_tts_service - INFO - ğŸ›‘ [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Playback consumer shutting down
2025-12-17T10:21:01.301165419Z [err]  2025-12-17 10:21:01,213 - server - INFO - ğŸ“ Converted transcript from 1 messages to 24 characters
2025-12-17T10:21:01.301168890Z [err]  2025-12-17 10:21:01,257 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:21:01.301173346Z [err]  2025-12-17 10:21:01,257 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'd68011b5-5b3f-46a7-9959-2240b9f16ef5', 'occurred_at': '2025-12-17T10:21:00.785743Z', 'payload': {'call_control_id': 'v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ', 'call_leg_id': '0ffd46c0-db32-11f0-8078-02420aef97a0', 'call_session_id': '0ffa1bbc-db32-11f0-bbe9-02420aef97a0', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:20:59.224926Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-17T10:20:59.224926Z', 'recording_id': '00fb0942-bac3-4683-9a37-31c6335b6657', 'recording_started_at': '2025-12-17T10:20:55.215729Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/0ffd46c0-db32-11f0-8078-02420aef97a0-1765966854307686.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T102100Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=b5f8f5aef39f3e9d6a47239c073f55d7a1979fdec8629e7d1994b8fd0e709c0c'}, 'start_time': '2025-12-17T10:20:55.215729Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:21:01.302193263Z [err]  2025-12-17 10:21:01,257 - server - INFO - ğŸ¯ Event type: call.recording.saved, Call ID: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.302197939Z [err]  2025-12-17 10:21:01,257 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:21:01.302201598Z [err]  2025-12-17 10:21:01,257 - server - INFO - ğŸ™ï¸ Recording saved for call: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.302205223Z [err]  2025-12-17 10:21:01,279 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.302209445Z [err]  2025-12-17 10:21:01,279 - server - INFO - ğŸ” Recording check: download_url=True, channels=dual, recording_id=00fb0942-bac3-4683-9a37-31c6335b6657, call_data=True
2025-12-17T10:21:01.309963677Z [err]  2025-12-17 10:21:01,307 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:01.408499934Z [err]  2025-12-17 10:21:01,403 - server - INFO - ğŸ’¾ Saved recording URL and ID to database: 00fb0942-bac3-4683-9a37-31c6335b6657
2025-12-17T10:21:01.408506243Z [err]  2025-12-17 10:21:01,403 - server - INFO - âœ… Entering dual-channel processing
2025-12-17T10:21:01.408510825Z [err]  2025-12-17 10:21:01,403 - server - INFO - ğŸ“¥ Downloading DUAL-CHANNEL recording...
2025-12-17T10:21:01.508984765Z [err]  2025-12-17 10:21:01,494 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-17T10:21:01.587537355Z [err]  2025-12-17 10:21:01,586 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-17T10:21:01.587545726Z [err]  2025-12-17 10:21:01,586 - qc_agents.orchestrator - INFO - âœ… Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:21:01.587551074Z [err]  2025-12-17 10:21:01,586 - qc_agents.orchestrator - INFO - ğŸ” Running Commitment Detector on call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:01.698444189Z [err]  2025-12-17 10:21:01,694 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/0ffd46c0-db32-11f0-8078-02420aef97a0-1765966854307686.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T102100Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=b5f8f5aef39f3e9d6a47239c073f55d7a1979fdec8629e7d1994b8fd0e709c0c "HTTP/1.1 200 OK"
2025-12-17T10:21:01.698454059Z [err]  2025-12-17 10:21:01,695 - server - INFO - ğŸ“‡ CRM: Got 10 extracted variables
2025-12-17T10:21:01.698462048Z [err]  2025-12-17 10:21:01,695 - server - INFO - ğŸ“‡ CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-17T10:21:01.698468548Z [err]  2025-12-17 10:21:01,696 - server - INFO - âœ… Downloaded 16134 bytes
2025-12-17T10:21:01.898652203Z [err]  2025-12-17 10:21:01,897 - server - INFO - âŒ Channel 1: No speech
2025-12-17T10:21:01.898655493Z [err]  2025-12-17 10:21:01,896 - server - INFO - âœ… Split into 2 channels
2025-12-17T10:21:01.898661575Z [err]  2025-12-17 10:21:01,896 - server - INFO - ğŸ¤ Using STT provider: soniox for interruption detection
2025-12-17T10:21:01.898662595Z [err]  2025-12-17 10:21:01,897 - server - WARNING - âš ï¸ No speech in any channel
2025-12-17T10:21:01.898668705Z [err]  2025-12-17 10:21:01,896 - server - INFO - ğŸ“Š Channel 0: 84524 bytes
2025-12-17T10:21:01.898670315Z [inf]  100.64.0.3:40974 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:01.898674858Z [err]  2025-12-17 10:21:01,897 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:21:01.898679104Z [err]  2025-12-17 10:21:01,897 - server - INFO - âŒ Channel 0: No speech
2025-12-17T10:21:01.898684711Z [err]  2025-12-17 10:21:01,897 - server - INFO - ğŸ“Š Channel 1: 84524 bytes
2025-12-17T10:21:01.898690018Z [err]  2025-12-17 10:21:01,897 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:21:01.915329096Z [err]  2025-12-17 10:21:01,913 - server - INFO - ğŸ” [AUTO-QC] Call log found: transcript_turns=1, logs_count=2, status=completed
2025-12-17T10:21:02.005454119Z [err]  2025-12-17 10:21:02,002 - server - INFO - ğŸ“‡ CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-17T10:21:02.343305542Z [inf]  100.64.0.2:53154 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:02.343554638Z [err]  2025-12-17 10:21:02,231 - elevenlabs_ws_service - INFO - ğŸ”Œ Closed ElevenLabs WebSocket connection
2025-12-17T10:21:02.343560665Z [err]  2025-12-17 10:21:02,231 - persistent_tts_service - INFO - âœ… [Call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ] Persistent TTS WebSocket closed
2025-12-17T10:21:02.343566745Z [err]  2025-12-17 10:21:02,231 - persistent_tts_service - INFO - âœ… Closed persistent TTS session for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:02.343572080Z [err]  2025-12-17 10:21:02,231 - server - INFO - âœ… Closed persistent TTS session for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:02.343576220Z [err]  2025-12-17 10:21:02,233 - redis_service - INFO - ğŸ§¹ Deleted call data from Redis: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:02.343580781Z [err]  2025-12-17 10:21:02,233 - server - INFO - ğŸ§¹ Cleaned up call session from Redis and memory: v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:02.345027218Z [err]  2025-12-17 10:21:02,344 - server - INFO - ğŸ” [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-17T10:21:02.433473551Z [err]  2025-12-17 10:21:02,431 - server - INFO - ğŸ“Š [AUTO-QC] Running full QC analysis: call=v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ â†’ campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-17T10:21:02.433478689Z [err]  2025-12-17 10:21:02,432 - server - INFO - ğŸ“Š [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-17T10:21:02.433485007Z [err]  2025-12-17 10:21:02,432 - server - ERROR - âŒ [AUTO-QC] Error in campaign QC for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:21:02.435941937Z [err]  2025-12-17 10:21:02,433 - server - ERROR - âŒ [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-17T10:21:02.435948674Z [err]    File "/app/backend/server.py", line 9510, in trigger_campaign_qc_for_call
2025-12-17T10:21:02.435955003Z [err]      await run_full_qc_analysis(
2025-12-17T10:21:02.435960135Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-17T10:21:02.435964608Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:21:02.435969171Z [err]  
2025-12-17T10:21:08.587873881Z [err]  2025-12-17 10:21:08,581 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:21:08.592924230Z [err]  2025-12-17 10:21:08,587 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T10:21:08.592931511Z [err]  2025-12-17 10:21:08,588 - qc_agents.orchestrator - INFO - ğŸ—ºï¸  Running Conversion Pathfinder on call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:10.450011457Z [err]  2025-12-17 10:21:10,447 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:21:10.954709863Z [err]  2025-12-17 10:21:10,949 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:21:12.500607947Z [err]  2025-12-17 10:21:12,499 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:21:12.509648660Z [err]  2025-12-17 10:21:12,504 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T10:21:12.509656677Z [err]  2025-12-17 10:21:12,505 - qc_agents.orchestrator - INFO - â­ Running Excellence Replicator on call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:15.369662154Z [err]  2025-12-17 10:21:15,321 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:21:15.369667602Z [err]  2025-12-17 10:21:15,326 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-17T10:21:15.422966150Z [err]  2025-12-17 10:21:15,420 - qc_agents.orchestrator - INFO - âœ… QC analysis stored for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:15.422974163Z [err]  2025-12-17 10:21:15,420 - server - INFO - âœ… QC analysis completed for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:15.422980996Z [err]  2025-12-17 10:21:15,420 - server - INFO - ğŸ“Š Scores: Commitment=50, Conversion=0, Excellence=50
2025-12-17T10:21:15.681669165Z [err]  2025-12-17 10:21:15,679 - server - INFO - ğŸ“Š Updated campaign_calls with QC scores for v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:15.860373753Z [err]  2025-12-17 10:21:15,854 - server - INFO - ğŸ“ˆ Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-17T10:21:15.942684583Z [err]  2025-12-17 10:21:15,941 - server - INFO - ğŸ·ï¸ Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-17T10:21:15.942689305Z [err]  2025-12-17 10:21:15,941 - server - ERROR - âŒ Error in auto appointment detection for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ: 'str' object has no attribute 'get'
2025-12-17T10:21:19.681596979Z [err]  2025-12-17 10:21:19,676 - server - INFO - ğŸ¤ Soniox receiver alive - 15 messages received in last 10s
2025-12-17T10:21:19.681606899Z [err]  2025-12-17 10:21:19,676 - server - ERROR - âŒ Soniox error: {'tokens': [], 'final_audio_proc_ms': 4320, 'total_audio_proc_ms': 5160, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-17T10:21:19.681615069Z [err]  2025-12-17 10:21:19,676 - server - INFO - âœ… Soniox receive loop ended normally
2025-12-17T10:21:19.681630590Z [err]  2025-12-17 10:21:19,676 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring cancelled for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:19.681635523Z [err]  2025-12-17 10:21:19,676 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring stopped for call v3:c3JMeZ0hSGOC4nB8TYWpDJd_aKkFEF7JlLwm6hb9uM2SbH7X2pOUkQ
2025-12-17T10:21:19.681640544Z [err]  2025-12-17 10:21:19,676 - server - INFO - ğŸ”‡ Dead air monitoring task cancelled
2025-12-17T10:21:21.682329012Z [err]  2025-12-17 10:21:21,679 - soniox_service - ERROR - âŒ Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-17T10:21:21.682337235Z [err]  2025-12-17 10:21:21,679 - server - INFO - ğŸ”Œ Telnyx WebSocket disconnected
2025-12-17T10:21:41.681923971Z [err]  2025-12-17 10:21:34,500 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:21:41.681928411Z [inf]  100.64.0.7:33136 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-17T10:21:41.681933661Z [err]  2025-12-17 10:21:33,493 - server - INFO - ğŸŒ Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:21:41.681936147Z [err]  2025-12-17 10:21:34,500 - server - INFO - ğŸ“¦ Call data stored in Redis and memory
2025-12-17T10:21:41.681939323Z [err]  2025-12-17 10:21:33,580 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:41.681945230Z [err]  2025-12-17 10:21:34,500 - server - INFO - ğŸ“ Outbound call initiated: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:41.681945292Z [err]  2025-12-17 10:21:33,667 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:41.681952102Z [err]  2025-12-17 10:21:33,691 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:21:41.681957127Z [err]  2025-12-17 10:21:33,692 - telnyx_service - INFO - ğŸ“ Initiating outbound call from +14048000152 to +17708336397
2025-12-17T10:21:41.681961672Z [err]  2025-12-17 10:21:33,692 - telnyx_service - INFO - ğŸ¤– Enabling AMD (premium mode)
2025-12-17T10:21:41.681966150Z [err]  2025-12-17 10:21:33,692 - telnyx_service - INFO - ğŸŒ Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:21:41.681970277Z [err]  2025-12-17 10:21:34,402 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-17T10:21:41.681977181Z [err]  2025-12-17 10:21:34,402 - telnyx_service - INFO - âœ… Call initiated: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:41.681981008Z [err]  2025-12-17 10:21:34,491 - server - INFO - ğŸ“ Created call log: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:41.683233158Z [inf]  100.64.0.2:53154 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-17T10:21:41.683237948Z [err]  2025-12-17 10:21:34,640 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:21:41.683241879Z [err]  2025-12-17 10:21:34,640 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.initiated', 'id': 'd535450d-8d29-4e3f-82a6-6c3284eafc7a', 'occurred_at': '2025-12-17T10:21:34.258841Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:21:41.683245512Z [err]  2025-12-17 10:21:34,640 - server - INFO - ğŸ¯ Event type: call.initiated, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:41.683250376Z [err]  2025-12-17 10:21:34,640 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:21:41.683253972Z [err]  2025-12-17 10:21:34,640 - server - INFO - ğŸ“ Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-17T10:21:41.683257608Z [inf]  100.64.0.4:54082 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:41.683260982Z [err]  2025-12-17 10:21:34,778 - server - INFO - ğŸ”ŒğŸ”ŒğŸ”Œ WEBSOCKET CONNECTION ATTEMPT
2025-12-17T10:21:41.683264331Z [err]  2025-12-17 10:21:34,778 - server - INFO -    Client: Address(host='100.64.0.8', port=13130)
2025-12-17T10:21:41.683267891Z [err]  2025-12-17 10:21:34,778 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'd0+Elk8ZyRxE5RtqoDQn8w==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-east4-eqdc4a', 'x-railway-request-id': 'T1vGVA_HSWiy-aT7BT7zVQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1765966894621', 'accept-encoding': 'gzip'}
2025-12-17T10:21:41.687943320Z [err]  2025-12-17 10:21:34,922 - server - INFO - ğŸ“ Telnyx connected event received, waiting for 'start'...
2025-12-17T10:21:41.687954537Z [err]  2025-12-17 10:21:34,778 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-17T10:21:41.687959095Z [err]  2025-12-17 10:21:34,778 - server - INFO - ğŸ”Œ Incoming Telnyx WebSocket connection
2025-12-17T10:21:41.687963193Z [err]  [2025-12-17 10:21:34 +0000] [3] [INFO] ('100.64.0.8', 13130) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-17T10:21:41.687967992Z [err]  2025-12-17 10:21:34,778 - server - INFO - âœ… WebSocket accepted, waiting for Telnyx events
2025-12-17T10:21:41.687971920Z [err]  [2025-12-17 10:21:34 +0000] [3] [INFO] connection open
2025-12-17T10:21:41.687975521Z [err]  2025-12-17 10:21:34,922 - server - INFO - ğŸ“¬ Received Telnyx event: connected
2025-12-17T10:21:48.525790468Z [err]  2025-12-17 10:21:48,340 - server - INFO - ğŸ“¬ Received Telnyx event: start
2025-12-17T10:21:48.525799171Z [err]  2025-12-17 10:21:48,353 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.525799855Z [err]  2025-12-17 10:21:48,340 - server - INFO - ğŸ¬ Stream started for call: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.525805544Z [err]  2025-12-17 10:21:48,343 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:21:48.525812723Z [err]  2025-12-17 10:21:48,343 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.answered', 'id': '835dfbed-dc0e-42e9-ba8b-860c07a016bf', 'occurred_at': '2025-12-17T10:21:48.138811Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-17T10:21:34.258841Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:21:48.525813739Z [err]  2025-12-17 10:21:48,353 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.525818565Z [err]  2025-12-17 10:21:48,344 - server - INFO - ğŸ¯ Event type: call.answered, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.525825849Z [err]  2025-12-17 10:21:48,344 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:21:48.525827404Z [err]  2025-12-17 10:21:48,354 - server - INFO - âœ… Found call in Redis (multi-worker state sharing working)
2025-12-17T10:21:48.525831495Z [err]  2025-12-17 10:21:48,344 - server - INFO - âœ… Call answered: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.527741114Z [err]  2025-12-17 10:21:48,354 - server - INFO - ğŸ“ Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-17T10:21:48.527757800Z [err]  2025-12-17 10:21:48,357 - server - INFO - âœ… Call data found after 0s wait
2025-12-17T10:21:48.527762988Z [err]  2025-12-17 10:21:48,357 - server - INFO - â³ Session not found locally, waiting briefly for webhook...
2025-12-17T10:21:48.527767063Z [err]  2025-12-17 10:21:48,444 - server - INFO - âœ… Call log updated
2025-12-17T10:21:48.527771008Z [err]  2025-12-17 10:21:48,444 - server - INFO - ğŸ”§ Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:21:48.532759870Z [err]  2025-12-17 10:21:48,531 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:48.619916567Z [err]  2025-12-17 10:21:48,618 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:48.619925471Z [err]  2025-12-17 10:21:48,618 - server - INFO - ğŸ”§ Creating Telnyx service with user's keys...
2025-12-17T10:21:48.623263164Z [err]  2025-12-17 10:21:48,621 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:21:48.623271924Z [err]  2025-12-17 10:21:48,621 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.started', 'id': 'd9d6aa9a-2522-44ed-8907-cdff8b337f3f', 'occurred_at': '2025-12-17T10:21:48.478808Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '881c001a-8204-4751-a291-102feeada3de', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:21:48.623278668Z [err]  2025-12-17 10:21:48,621 - server - INFO - ğŸ¯ Event type: streaming.started, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.623286008Z [err]  2025-12-17 10:21:48,621 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:21:48.623295592Z [inf]  100.64.0.9:16972 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:48.641038518Z [err]  2025-12-17 10:21:48,639 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:21:48.864697139Z [err]  2025-12-17 10:21:48,857 - server - INFO - âš ï¸ Session still not found after wait, will create in worker
2025-12-17T10:21:48.864705627Z [err]  2025-12-17 10:21:48,857 - server - WARNING - âš ï¸ Session not found after waiting, creating in WebSocket worker...
2025-12-17T10:21:48.872183998Z [err]  2025-12-17 10:21:48,869 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.872192295Z [err]  2025-12-17 10:21:48,870 - server - INFO - ğŸ“ Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:21:48.872198617Z [err]  2025-12-17 10:21:48,870 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:21:48.905364580Z [err]  2025-12-17 10:21:48,903 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg/actions/playback_start "HTTP/1.1 200 OK"
2025-12-17T10:21:48.905370176Z [err]  2025-12-17 10:21:48,904 - telnyx_service - INFO - âœ… Playing audio from URL, playback_id: I4IeedsURw (loop=True, overlay=True)
2025-12-17T10:21:48.905374920Z [err]  2025-12-17 10:21:48,904 - server - WARNING - âš ï¸ Failed to start comfort noise: 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg'
2025-12-17T10:21:48.905379592Z [err]  2025-12-17 10:21:48,904 - telnyx_service - INFO - ğŸ™ï¸ Starting recording: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:48.964701423Z [err]  2025-12-17 10:21:48,963 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:21:48.964712041Z [err]  2025-12-17 10:21:48,963 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:21:48.966113037Z [err]  2025-12-17 10:21:48,963 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:21:48.966121516Z [err]  2025-12-17 10:21:48,963 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:21:48.966142436Z [err]  2025-12-17 10:21:48,964 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:21:49.058375925Z [err]  2025-12-17 10:21:49,056 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:49.069777121Z [err]  2025-12-17 10:21:49,064 - calling_service - INFO - âœ… LLM client pre-warmed in 100ms
2025-12-17T10:21:49.069781852Z [err]  2025-12-17 10:21:49,064 - server - INFO - âœ… Session created in WebSocket worker
2025-12-17T10:21:49.069786780Z [err]  2025-12-17 10:21:49,064 - server - INFO - ğŸ“ Call data loaded, starting SONIOX connection...
2025-12-17T10:21:49.069791698Z [err]  2025-12-17 10:21:49,065 - server - INFO - âœ… Initialized call_states for v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg with session reference
2025-12-17T10:21:49.409503599Z [err]  2025-12-17 10:21:49,161 - server - INFO - ğŸ”‘ Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-17T10:21:49.409507741Z [err]  2025-12-17 10:21:49,308 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg/actions/record_start "HTTP/1.1 200 OK"
2025-12-17T10:21:49.409511913Z [err]  2025-12-17 10:21:49,309 - server - INFO - ğŸ™ï¸ Call recording started for v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:49.409516019Z [err]  2025-12-17 10:21:49,309 - server - INFO - ğŸ”§ Creating call session for v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg...
2025-12-17T10:21:49.409520107Z [err]  2025-12-17 10:21:49,309 - server - INFO - ğŸ” Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:21:49.409526121Z [err]  2025-12-17 10:21:49,309 - server - INFO - ğŸ”§ Calling create_call_session() - START
2025-12-17T10:21:49.409530119Z [err]  2025-12-17 10:21:49,309 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:21:49.409533937Z [err]  2025-12-17 10:21:49,397 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:21:49.409543031Z [err]  2025-12-17 10:21:49,398 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:21:49.409546868Z [err]  2025-12-17 10:21:49,398 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:21:49.409550945Z [err]  2025-12-17 10:21:49,398 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:21:49.409554725Z [err]  2025-12-17 10:21:49,398 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:21:49.409573401Z [inf]  100.64.0.11:46158 - "GET /api/tts-audio/comfort_noise_continuous.mp3 HTTP/1.1" 200
2025-12-17T10:21:49.489100728Z [err]  2025-12-17 10:21:49,485 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:49.494360174Z [err]  2025-12-17 10:21:49,493 - calling_service - INFO - âœ… LLM client pre-warmed in 95ms
2025-12-17T10:21:49.494365215Z [err]  2025-12-17 10:21:49,493 - server - INFO - ğŸ”§ Calling create_call_session() - COMPLETE
2025-12-17T10:21:49.494369062Z [err]  2025-12-17 10:21:49,493 - server - INFO - âœ… Session object created: CallSession
2025-12-17T10:21:49.513834060Z [err]  2025-12-17 10:21:49,511 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:21:49.513843153Z [err]  2025-12-17 10:21:49,511 - server - INFO - âœ… Serializable call_data synced to Redis (agent_id, user_id)
2025-12-17T10:21:49.513849245Z [err]  2025-12-17 10:21:49,511 - server - INFO - âœ… Session stored in worker memory (not Redis)
2025-12-17T10:21:49.518704084Z [err]  2025-12-17 10:21:49,516 - redis_service - INFO - âœ… Marked session ready in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:49.518714596Z [err]  2025-12-17 10:21:49,516 - server - INFO - ğŸ¤– AI session created for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:49.518724138Z [err]  2025-12-17 10:21:49,516 - server - INFO - ğŸ“¦ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-17T10:21:49.518729845Z [err]  2025-12-17 10:21:49,516 - server - INFO - â­ï¸ Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-17T10:21:49.519932655Z [err]  2025-12-17 10:21:49,516 - server - INFO - ğŸ‘¤ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-17T10:21:49.519945100Z [err]  2025-12-17 10:21:49,516 - server - INFO - ğŸ‘‚ User speaks first - waiting for user input...
2025-12-17T10:21:49.519951258Z [err]  2025-12-17 10:21:49,516 - server - ERROR - Error processing webhook: cannot access local variable 'asyncio' where it is not associated with a value
2025-12-17T10:21:49.519958329Z [inf]  100.64.0.3:40974 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:49.674365774Z [err]  2025-12-17 10:21:49,670 - soniox_service - INFO - âœ… Connected to Soniox Real-Time STT
2025-12-17T10:21:49.674372734Z [err]  2025-12-17 10:21:49,671 - soniox_service - INFO - âš™ï¸  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-17T10:21:49.674378372Z [err]  2025-12-17 10:21:49,671 - soniox_service - INFO - âš™ï¸  Endpoint detection: True, Speaker diarization: False
2025-12-17T10:21:49.693377143Z [err]  2025-12-17 10:21:49,692 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:21:49.693384372Z [err]  2025-12-17 10:21:49,692 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring started for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:49.695482550Z [err]  2025-12-17 10:21:49,693 - server - INFO - âœ… Started forwarding audio (8kHz mulaw â†’ Soniox, NO BUFFERING)
2025-12-17T10:21:50.421734825Z [err]  2025-12-17 10:21:50,196 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:21:50.553196273Z [err]  2025-12-17 10:21:50,551 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:21:50.553209124Z [err]  2025-12-17 10:21:50,551 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'ae77370c-9ca5-45a6-9f3f-00c44031765c', 'occurred_at': '2025-12-17T10:21:50.398825Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'I4IeedsURw', 'start_time': '2025-12-17T10:21:50.398825Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:21:50.553221289Z [err]  2025-12-17 10:21:50,551 - server - INFO - ğŸ¯ Event type: call.playback.started, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:50.553230222Z [err]  2025-12-17 10:21:50,551 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:21:50.553238036Z [inf]  100.64.0.9:16972 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:50.557199158Z [err]  2025-12-17 10:21:50,552 - server - INFO - ğŸ”¤ RAW TOKENS: ["H"?]
2025-12-17T10:21:50.557214533Z [err]  2025-12-17 10:21:50,555 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:21:50.557223294Z [err]  2025-12-17 10:21:50,556 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:50.557230463Z [err]  2025-12-17 10:21:50,556 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'H' | Generating: False
2025-12-17T10:21:50.630202150Z [err]  2025-12-17 10:21:50,626 - server - INFO - ğŸ”¤ RAW TOKENS: ["H"?, "ello"?]
2025-12-17T10:21:50.630210324Z [err]  2025-12-17 10:21:50,627 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Hello' | Generating: False
2025-12-17T10:21:50.700692206Z [err]  2025-12-17 10:21:50,699 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=0/2
2025-12-17T10:21:50.795534546Z [err]  2025-12-17 10:21:50,785 - server - INFO - ğŸ”¤ RAW TOKENS: ["H"âœ“, "ello"âœ“, "?"âœ“, "<end>"âœ“]
2025-12-17T10:21:50.795541741Z [err]  2025-12-17 10:21:50,785 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:21:50.795546598Z [err]  2025-12-17 10:21:50,786 - server - INFO - ğŸ§¹ Cleaned transcript: 'H ello ?' -> 'Hello?'
2025-12-17T10:21:50.795552665Z [err]  2025-12-17 10:21:50,786 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Hello?' (3 tokens)
2025-12-17T10:21:50.795558389Z [err]  2025-12-17 10:21:50,786 - server - INFO - ğŸ¤ Soniox final transcript: 'Hello?'
2025-12-17T10:21:50.795562860Z [err]  2025-12-17 10:21:50,786 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:iCGbXO2sdex363tJp... (active sessions: [])
2025-12-17T10:21:50.795567019Z [err]  2025-12-17 10:21:50,786 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:21:50.795572203Z [err]  2025-12-17 10:21:50,786 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:iCGbXO2sdex363tJp... (active sessions: [])
2025-12-17T10:21:50.795579601Z [err]  2025-12-17 10:21:50,786 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:21:50.795584063Z [err]  2025-12-17 10:21:50,786 - server - INFO - â±ï¸ [10:21:50.786] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Hello?'
2025-12-17T10:21:50.795588208Z [err]  2025-12-17 10:21:50,786 - server - INFO - â±ï¸ [10:21:50.786] STT endpoint detection latency: 16ms
2025-12-17T10:21:50.795593128Z [err]  2025-12-17 10:21:50,786 - server - INFO - â±ï¸ [10:21:50.786] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:21:50.795596767Z [err]  2025-12-17 10:21:50,787 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:21:50.797565752Z [err]  2025-12-17 10:21:50,787 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:21:50.797578041Z [err]  2025-12-17 10:21:50,788 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:iCGbXO2sdex363tJp... (active sessions: [])
2025-12-17T10:21:50.797584043Z [err]  2025-12-17 10:21:50,788 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2025-12-17T10:21:50.804758287Z [err]  2025-12-17 10:21:50,799 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Hello?
2025-12-17T10:21:50.804763661Z [err]  2025-12-17 10:21:50,799 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:50.804768168Z [err]  2025-12-17 10:21:50,799 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:21:50.804772421Z [err]  2025-12-17 10:21:50,799 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+9ms
2025-12-17T10:21:50.804776862Z [err]  2025-12-17 10:21:50,799 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 9ms (Soniox model: stt-rt-v3)
2025-12-17T10:21:50.804781045Z [err]  2025-12-17 10:21:50,799 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:21:50.804785603Z [err]  2025-12-17 10:21:50,799 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:21:50.804790599Z [err]  2025-12-17 10:21:50,799 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:50.895561149Z [err]  2025-12-17 10:21:50,894 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:21:50.895567663Z [err]  2025-12-17 10:21:50,894 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:iCGbXO2sdex363tJp... (active sessions: [])
2025-12-17T10:21:50.895572301Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - â±ï¸ [10:21:50.894] ğŸ“¥ process_user_input() ENTRY - text: 'Hello?...'
2025-12-17T10:21:50.895576068Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - â±ï¸ [10:21:50.894] â© About to call _process_call_flow_streaming()
2025-12-17T10:21:50.895580358Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - â±ï¸ [10:21:50.894] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:21:50.895584552Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - â±ï¸ [10:21:50.894] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:21:50.895588962Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-17T10:21:50.895592667Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - â±ï¸ [10:21:50.894] âœ… Node selected, about to process content...
2025-12-17T10:21:50.895596581Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:21 AM EST in content
2025-12-17T10:21:50.895600833Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:21:50.895608268Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:21:50.895612066Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:21:50.895615755Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:21:50.896938371Z [err]  2025-12-17 10:21:50,895 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Kendrick?...
2025-12-17T10:21:50.896944937Z [err]  2025-12-17 10:21:50,895 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 96ms
2025-12-17T10:21:50.896951375Z [err]  2025-12-17 10:21:50,895 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:21:50.896958666Z [err]  2025-12-17 10:21:50,895 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found for call v3:iCGbXO2sdex363tJp... (active sessions: [])
2025-12-17T10:21:50.896963116Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:21:50.896976502Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:21:50.896982927Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:21:50.896987911Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:21:50.896993593Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:21:50.896998945Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-17T10:21:50.897003912Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-17T10:21:50.897008689Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:21:50.897013762Z [err]  2025-12-17 10:21:50,894 - calling_service - INFO - â±ï¸ [10:21:50.894] ğŸ“„ About to process content (mode=script, length=9)
2025-12-17T10:21:50.897019247Z [err]  2025-12-17 10:21:50,895 - calling_service - INFO - ğŸ“¤ Streaming script as 1 sentence(s)
2025-12-17T10:21:50.898517034Z [err]  2025-12-17 10:21:50,895 - server - INFO - âš¡ ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-17T10:21:50.997836252Z [err]  2025-12-17 10:21:50,987 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:51.082688534Z [err]  2025-12-17 10:21:51,079 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:51.539831609Z [err]  2025-12-17 10:21:51,193 - server - INFO - âœ… ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-17T10:21:51.539841079Z [err]  2025-12-17 10:21:51,193 - persistent_tts_service - INFO - ğŸ™ï¸ Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-17T10:21:51.539859933Z [err]  2025-12-17 10:21:51,193 - persistent_tts_service - INFO - ğŸ”Œ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Establishing persistent TTS WebSocket...
2025-12-17T10:21:51.539865227Z [err]  2025-12-17 10:21:51,193 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-17T10:21:51.539870439Z [err]  2025-12-17 10:21:51,193 - elevenlabs_ws_service - INFO - ğŸ”Œ Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-17T10:21:51.539959213Z [err]  2025-12-17 10:21:51,172 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:21:51.539965363Z [err]  2025-12-17 10:21:51,193 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:21:51.540166436Z [err]  2025-12-17 10:21:51,193 - elevenlabs_ws_service - INFO - ğŸ™ï¸ Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-17T10:21:51.540171731Z [err]  2025-12-17 10:21:51,341 - elevenlabs_ws_service - INFO - âœ… Connected to ElevenLabs WebSocket
2025-12-17T10:21:51.540178440Z [err]  2025-12-17 10:21:51,341 - elevenlabs_ws_service - INFO - ğŸ“¤ Sent BOS message with voice settings
2025-12-17T10:21:51.540183358Z [err]  2025-12-17 10:21:51,341 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Persistent TTS WebSocket established
2025-12-17T10:21:51.540188200Z [err]  2025-12-17 10:21:51,341 - persistent_tts_service - INFO - ğŸ”Š [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Comfort noise loop started
2025-12-17T10:21:51.541934730Z [err]  2025-12-17 10:21:51,341 - server - INFO - ğŸµ TTS task #1 started at +446ms
2025-12-17T10:21:51.541945443Z [err]  2025-12-17 10:21:51,341 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 542ms
2025-12-17T10:21:51.541947019Z [err]  2025-12-17 10:21:51,342 - server - INFO - âœ… LLM finished in 542ms, TTS tasks already running in background
2025-12-17T10:21:51.541955482Z [err]  2025-12-17 10:21:51,341 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/1: Kendrick?...
2025-12-17T10:21:51.541958638Z [err]  2025-12-17 10:21:51,342 - server - INFO - ğŸµ Streaming 1 TTS chunks as they complete...
2025-12-17T10:21:51.541963537Z [err]  2025-12-17 10:21:51,341 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:21:51.541971457Z [err]  2025-12-17 10:21:51,341 - persistent_tts_service - INFO - âœ… Created persistent TTS session for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:51.541973235Z [err]  2025-12-17 10:21:51,341 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:21:51.541979962Z [err]  2025-12-17 10:21:51,341 - server - INFO - âœ… ON-DEMAND: Persistent TTS session created successfully!
2025-12-17T10:21:51.541983978Z [err]  2025-12-17 10:21:51,341 - calling_service - INFO - ğŸ’¾ Storing node ID 2 in conversation history
2025-12-17T10:21:51.541987584Z [err]  2025-12-17 10:21:51,341 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:21:51.541992364Z [err]  2025-12-17 10:21:51,341 - calling_service - INFO - LLM response (0.45s): Kendrick?
2025-12-17T10:21:51.541996212Z [err]  2025-12-17 10:21:51,341 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:21:51.542000656Z [err]  2025-12-17 10:21:51,341 - calling_service - INFO - Total latency: 0.45s
2025-12-17T10:21:51.544821132Z [err]  2025-12-17 10:21:51,342 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:21:51.544827894Z [err]  2025-12-17 10:21:51,342 - server - INFO -    1 sentences queued and playing seamlessly
2025-12-17T10:21:51.544833574Z [err]  2025-12-17 10:21:51,342 - persistent_tts_service - INFO - ğŸµ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Playback consumer started
2025-12-17T10:21:51.544839690Z [err]  2025-12-17 10:21:51,342 - persistent_tts_service - INFO - ğŸ’“ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Starting TTS keep-alive loop (every 15s)
2025-12-17T10:21:51.544845335Z [err]  2025-12-17 10:21:51,342 - persistent_tts_service - INFO - ğŸ”Š [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Starting comfort noise loop
2025-12-17T10:21:51.544851125Z [err]  2025-12-17 10:21:51,342 - comfort_noise - INFO - ğŸµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-17T10:21:52.008615732Z [err]  2025-12-17 10:21:51,998 - comfort_noise - INFO - âœ… Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-17T10:21:52.117834240Z [err]  2025-12-17 10:21:52,110 - comfort_noise - INFO - âœ… Generated mulaw comfort noise: 240000 bytes
2025-12-17T10:21:52.117846827Z [err]  2025-12-17 10:21:52,110 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #1: Kendrick?...
2025-12-17T10:21:52.117854348Z [err]  2025-12-17 10:21:52,113 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:21:52.119028960Z [inf]  100.64.0.9:16972 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:21:52.119039537Z [err]  2025-12-17 10:21:52,113 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'd82f4a90-c159-49cb-815e-2311ffcbe931', 'occurred_at': '2025-12-17T10:21:51.458838Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:21:52.119047095Z [err]  2025-12-17 10:21:52,113 - server - INFO - ğŸ¯ Event type: call.machine.premium.detection.ended, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:52.119052855Z [err]  2025-12-17 10:21:52,113 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:21:52.487325090Z [err]  2025-12-17 10:21:52,410 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:21:52.487329100Z [err]  2025-12-17 10:21:52,410 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+300ms
2025-12-17T10:21:52.487332894Z [err]  2025-12-17 10:21:52,410 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTFA (Time To First Audio Playback): 300ms
2025-12-17T10:21:52.487336881Z [err]  2025-12-17 10:21:52,410 - persistent_tts_service - INFO - ğŸ“¤ Sending 7043 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2025-12-17T10:21:52.487341461Z [err]  2025-12-17 10:21:52,411 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:21:52.487346341Z [err]  2025-12-17 10:21:52,411 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2025-12-17T10:21:52.487350332Z [err]  2025-12-17 10:21:52,411 - persistent_tts_service - INFO - âœ… Sent 45 audio chunks via WebSocket
2025-12-17T10:21:53.454463472Z [err]  2025-12-17 10:21:53,411 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:21:53.642667037Z [err]  2025-12-17 10:21:53,637 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.3s ago), marking agent as done speaking
2025-12-17T10:21:53.642672411Z [err]  2025-12-17 10:21:53,637 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966913.6372535 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:53.642677945Z [err]  2025-12-17 10:21:53,637 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:54.412771631Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 542ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:21:54.412781323Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 3516ms (provider: elevenlabs, websocket: False)
2025-12-17T10:21:54.412783709Z [err]  2025-12-17 10:21:54,411 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:21:54.412791622Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 3612ms (user stopped â†’ play_audio_url called)
2025-12-17T10:21:54.412796233Z [err]  2025-12-17 10:21:54,411 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #1: 1 chunks received
2025-12-17T10:21:54.412804517Z [err]  2025-12-17 10:21:54,411 - server - INFO - âœ… All 1 persistent TTS streams completed
2025-12-17T10:21:54.412811529Z [err]  2025-12-17 10:21:54,411 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:21:54.412817800Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 3612ms from user stop ğŸš€
2025-12-17T10:21:54.412825461Z [err]  2025-12-17 10:21:54,411 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:54.412831891Z [err]  2025-12-17 10:21:54,411 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:21:54.412838905Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:21:54.412845585Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:21:54.412853068Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] STT: 9ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:21:54.414102700Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:21:54.414114519Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:21:54.414120703Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:21:54.414126215Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:21:54.414131389Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:21:54.414137876Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 3912ms estimated
2025-12-17T10:21:54.414143709Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2025-12-17T10:21:54.414148679Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Hello?...'
2025-12-17T10:21:54.414153895Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'Kendrick?...'
2025-12-17T10:21:54.414159595Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:21:54.414166502Z [err]  2025-12-17 10:21:54,411 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:21:54.621145863Z [err]  2025-12-17 10:21:54,606 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1051ms)
2025-12-17T10:21:54.621152353Z [err]  2025-12-17 10:21:54,606 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:21:54.715451876Z [err]  2025-12-17 10:21:54,710 - server - INFO - ğŸ“¤ Audio flowing: 302 packets sent to Soniox (5s update)
2025-12-17T10:21:57.519992187Z [err]  2025-12-17 10:21:57,492 - server - INFO - ğŸ”¤ RAW TOKENS: [" Ye"?]
2025-12-17T10:21:57.519997661Z [err]  2025-12-17 10:21:57,492 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:21:57.520003030Z [err]  2025-12-17 10:21:57,492 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:57.520007939Z [err]  2025-12-17 10:21:57,492 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2025-12-17T10:21:57.638643913Z [err]  2025-12-17 10:21:57,631 - server - INFO - ğŸ”¤ RAW TOKENS: [" Ye"âœ“, "ah."âœ“, "<end>"âœ“]
2025-12-17T10:21:57.638650982Z [err]  2025-12-17 10:21:57,631 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:21:57.638655186Z [err]  2025-12-17 10:21:57,632 - server - INFO - ğŸ§¹ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2025-12-17T10:21:57.638661925Z [err]  2025-12-17 10:21:57,632 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Yeah.' (2 tokens)
2025-12-17T10:21:57.638667861Z [err]  2025-12-17 10:21:57,632 - server - INFO - ğŸ¤ Soniox final transcript: 'Yeah.'
2025-12-17T10:21:57.638673331Z [err]  2025-12-17 10:21:57,632 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:21:57.638677246Z [err]  2025-12-17 10:21:57,632 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:21:57.638682838Z [err]  2025-12-17 10:21:57,632 - server - INFO - â±ï¸ [10:21:57.632] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2025-12-17T10:21:57.638687997Z [err]  2025-12-17 10:21:57,632 - server - INFO - â±ï¸ [10:21:57.632] STT endpoint detection latency: 2ms
2025-12-17T10:21:57.638693520Z [err]  2025-12-17 10:21:57,632 - server - INFO - â±ï¸ [10:21:57.632] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:21:57.638698387Z [err]  2025-12-17 10:21:57,633 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:21:57.638702346Z [err]  2025-12-17 10:21:57,633 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:21:57.638706065Z [err]  2025-12-17 10:21:57,633 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2025-12-17T10:21:57.645082927Z [err]  2025-12-17 10:21:57,643 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Yeah.
2025-12-17T10:21:57.645090314Z [err]  2025-12-17 10:21:57,644 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:57.648053983Z [err]  2025-12-17 10:21:57,646 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:21:57.648059347Z [err]  2025-12-17 10:21:57,646 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:21:57.648064065Z [err]  2025-12-17 10:21:57,646 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+16ms
2025-12-17T10:21:57.648069502Z [err]  2025-12-17 10:21:57,646 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 16ms (Soniox model: stt-rt-v3)
2025-12-17T10:21:57.648074781Z [err]  2025-12-17 10:21:57,646 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:21:57.648079177Z [err]  2025-12-17 10:21:57,646 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:21:57.648083627Z [err]  2025-12-17 10:21:57,646 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:21:57.747220734Z [err]  2025-12-17 10:21:57,742 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:21:57.747232206Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - â±ï¸ [10:21:57.742] ğŸ“¥ process_user_input() ENTRY - text: 'Yeah....'
2025-12-17T10:21:57.747239476Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - â±ï¸ [10:21:57.742] â© About to call _process_call_flow_streaming()
2025-12-17T10:21:57.747245704Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - â±ï¸ [10:21:57.742] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:21:57.747251794Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - â±ï¸ [10:21:57.742] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:21:57.747258889Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-17T10:21:57.747265264Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 2
2025-12-17T10:21:57.747272654Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - â±ï¸ [10:21:57.742] ğŸ”€ About to call _follow_transition() for: Yeah....
2025-12-17T10:21:57.747277917Z [err]  2025-12-17 10:21:57,742 - calling_service - INFO - Evaluating transitions from Greeting for message: Yeah.
2025-12-17T10:21:57.752140340Z [err]  2025-12-17 10:21:57,750 - calling_service - INFO - â±ï¸ [10:21:57.750] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-17T10:21:58.807022356Z [err]  2025-12-17 10:21:58,805 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:21:58.818284066Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - â±ï¸ [10:21:58.814] âœ… Node selected, about to process content...
2025-12-17T10:21:58.818297377Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - â±ï¸ [10:21:58.814] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 1064ms
2025-12-17T10:21:58.818298034Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:21 AM EST in content
2025-12-17T10:21:58.818306507Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:21:58.818317236Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - ğŸ¤– AI transition decision: '0'
2025-12-17T10:21:58.818319634Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:21:58.818332695Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - ğŸ“Š Available transitions: ['Confirms name (Yes|Speaking|This is he/she|etc)...', 'Wrong number (No John here|Wrong number|etc)...', "The customer says let's set an appointment....", "Let's talk about my inances..."]
2025-12-17T10:21:58.818337017Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:21:58.818347281Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - Selected transition index: 0
2025-12-17T10:21:58.818352917Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:21:58.818357296Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - Transition: Greeting -> Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation)
2025-12-17T10:21:58.818365062Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:21:58.818368267Z [err]  2025-12-17 10:21:58,814 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 1072ms
2025-12-17T10:21:58.819258450Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:21:58.819268222Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:21:58.819273385Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:21:58.819277754Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:21:58.819282561Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2025-12-17T10:21:58.819287311Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2025-12-17T10:21:58.819291963Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - â±ï¸ [10:21:58.815] ğŸ“„ About to process content (mode=script, length=89)
2025-12-17T10:21:58.819296247Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T10:21:58.819300872Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸ“¤ Sentence arrived from LLM: This is Jake......
2025-12-17T10:21:58.819306519Z [err]  2025-12-17 10:21:58,815 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 1168ms
2025-12-17T10:21:58.819311022Z [err]  2025-12-17 10:21:58,815 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:21:58.819315139Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:21:58.819319353Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:21:58.819324291Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:21:58.820163798Z [err]  2025-12-17 10:21:58,815 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 1168ms
2025-12-17T10:21:58.820171502Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: This is Jake......
2025-12-17T10:21:58.820180430Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸ“¤ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2025-12-17T10:21:58.820185475Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:21:58.820190353Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:21:58.820195575Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T10:21:58.820200449Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2025-12-17T10:21:58.820204459Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:21:58.820209339Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:21:58.820214876Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - ğŸ’¾ Storing node ID 1763159750250 in conversation history
2025-12-17T10:21:58.820222475Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - LLM response (1.07s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2025-12-17T10:21:58.820227585Z [err]  2025-12-17 10:21:58,815 - calling_service - INFO - Total latency: 1.07s
2025-12-17T10:21:58.820232202Z [err]  2025-12-17 10:21:58,815 - server - INFO - âœ… LLM finished in 1168ms, TTS tasks already running in background
2025-12-17T10:21:58.820752151Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T10:21:58.820759065Z [err]  2025-12-17 10:21:58,815 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:21:58.820763333Z [err]  2025-12-17 10:21:58,815 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T10:21:58.820767322Z [err]  2025-12-17 10:21:58,815 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #2: This is Jake......
2025-12-17T10:21:59.077612523Z [err]  2025-12-17 10:21:59,074 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:21:59.077636143Z [err]  2025-12-17 10:21:59,074 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+258ms
2025-12-17T10:21:59.077640826Z [err]  2025-12-17 10:21:59,074 - persistent_tts_service - INFO - ğŸ“¤ Sending 8173 bytes of audio (52 chunks, 1.0s duration) via WebSocket
2025-12-17T10:21:59.077646010Z [err]  2025-12-17 10:21:59,074 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:21:59.077650123Z [err]  2025-12-17 10:21:59,074 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.0s (total: 1.0s from now)
2025-12-17T10:21:59.077654912Z [err]  2025-12-17 10:21:59,075 - persistent_tts_service - INFO - âœ… Sent 52 audio chunks via WebSocket
2025-12-17T10:21:59.734273370Z [err]  2025-12-17 10:21:59,729 - server - INFO - ğŸ“¤ Audio flowing: 553 packets sent to Soniox (5s update)
2025-12-17T10:21:59.788200811Z [err]  2025-12-17 10:21:59,780 - server - INFO - ğŸ¤ Soniox receiver alive - 13 messages received in last 10s
2025-12-17T10:22:00.483924646Z [err]  2025-12-17 10:22:00,304 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.2s ago), marking agent as done speaking
2025-12-17T10:22:00.483930668Z [err]  2025-12-17 10:22:00,304 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966920.3049095 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:00.483936525Z [err]  2025-12-17 10:22:00,304 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:00.483942498Z [err]  2025-12-17 10:22:00,304 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:22:00.809727689Z [err]  2025-12-17 10:22:00,806 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=0/2
2025-12-17T10:22:01.080564763Z [err]  2025-12-17 10:22:01,074 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:01.080573464Z [err]  2025-12-17 10:22:01,075 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #2: 1 chunks received
2025-12-17T10:22:01.080579364Z [err]  2025-12-17 10:22:01,075 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2025-12-17T10:22:01.533981702Z [err]  2025-12-17 10:22:01,403 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.1s (total: 1.9s from now)
2025-12-17T10:22:01.533993605Z [err]  2025-12-17 10:22:01,403 - persistent_tts_service - INFO - âœ… Sent 7 audio chunks via WebSocket
2025-12-17T10:22:01.534006094Z [err]  2025-12-17 10:22:01,401 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2025-12-17T10:22:01.534011858Z [err]  2025-12-17 10:22:01,401 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+326ms
2025-12-17T10:22:01.534024631Z [err]  2025-12-17 10:22:01,401 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:01.534032158Z [err]  2025-12-17 10:22:01,401 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:01.534054122Z [err]  2025-12-17 10:22:01,402 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:22:01.534063109Z [err]  2025-12-17 10:22:01,401 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:01.534068255Z [err]  2025-12-17 10:22:01,403 - persistent_tts_service - INFO - ğŸ“¤ Sending 1068 bytes of audio (7 chunks, 0.1s duration) via WebSocket
2025-12-17T10:22:01.534075636Z [err]  2025-12-17 10:22:01,403 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:01.600342447Z [err]  2025-12-17 10:22:01,597 - persistent_tts_service - INFO - ğŸ“¤ Sending 19691 bytes of audio (124 chunks, 2.5s duration) via WebSocket
2025-12-17T10:22:01.600349495Z [err]  2025-12-17 10:22:01,597 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:01.600354692Z [err]  2025-12-17 10:22:01,598 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.5s (total: 4.1s from now)
2025-12-17T10:22:01.601132977Z [err]  2025-12-17 10:22:01,599 - persistent_tts_service - INFO - âœ… Sent 124 audio chunks via WebSocket
2025-12-17T10:22:03.599828209Z [err]  2025-12-17 10:22:03,598 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:03.599836012Z [err]  2025-12-17 10:22:03,598 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #3: 3 chunks received
2025-12-17T10:22:03.599837258Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 4783ms (provider: elevenlabs, websocket: False)
2025-12-17T10:22:03.599838579Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:03.599843809Z [err]  2025-12-17 10:22:03,598 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T10:22:03.599855566Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:22:03.599862042Z [err]  2025-12-17 10:22:03,598 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:22:03.599863789Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING] STT: 16ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:22:03.599868418Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5951ms from user stop ğŸš€
2025-12-17T10:22:03.599870112Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 1168ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:22:03.599871611Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5951ms (user stopped â†’ play_audio_url called)
2025-12-17T10:22:03.599875478Z [err]  2025-12-17 10:22:03,598 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:03.599881001Z [err]  2025-12-17 10:22:03,598 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:22:03.600905133Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:22:03.600905151Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:22:03.600913086Z [err]  2025-12-17 10:22:03,599 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:03.600913488Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 6251ms estimated
2025-12-17T10:22:03.600914546Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:22:03.600921553Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:22:03.600923690Z [err]  2025-12-17 10:22:03,599 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2025-12-17T10:22:03.600928511Z [err]  2025-12-17 10:22:03,598 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:22:03.600930391Z [err]  2025-12-17 10:22:03,599 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Yeah....'
2025-12-17T10:22:03.600935490Z [err]  2025-12-17 10:22:03,599 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2025-12-17T10:22:03.600940179Z [err]  2025-12-17 10:22:03,599 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:22:03.790587656Z [err]  2025-12-17 10:22:03,789 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 1684ms)
2025-12-17T10:22:03.790595325Z [err]  2025-12-17 10:22:03,789 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:22:04.732028715Z [err]  2025-12-17 10:22:04,730 - server - INFO - ğŸ“¤ Audio flowing: 803 packets sent to Soniox (5s update)
2025-12-17T10:22:05.910140242Z [err]  2025-12-17 10:22:05,908 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.2s ago), marking agent as done speaking
2025-12-17T10:22:05.910146382Z [err]  2025-12-17 10:22:05,908 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966925.9087994 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:05.910151091Z [err]  2025-12-17 10:22:05,908 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:06.023611974Z [err]  2025-12-17 10:22:06,021 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:22:08.458297550Z [err]  2025-12-17 10:22:08,252 - server - INFO - ğŸ”¤ RAW TOKENS: [" S"?]
2025-12-17T10:22:08.458304944Z [err]  2025-12-17 10:22:08,252 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:08.458310894Z [err]  2025-12-17 10:22:08,252 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:22:08.458315480Z [err]  2025-12-17 10:22:08,252 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:08.458320151Z [err]  2025-12-17 10:22:08,252 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'S' | Generating: False
2025-12-17T10:22:08.458328346Z [err]  2025-12-17 10:22:08,365 - server - INFO - ğŸ”¤ RAW TOKENS: [" S"?, "ure"?]
2025-12-17T10:22:08.458333157Z [err]  2025-12-17 10:22:08,366 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Sure' | Generating: False
2025-12-17T10:22:08.512914063Z [err]  2025-12-17 10:22:08,510 - server - INFO - ğŸ”¤ RAW TOKENS: [" S"âœ“, "ure"âœ“, "."âœ“, "<end>"âœ“]
2025-12-17T10:22:08.512921473Z [err]  2025-12-17 10:22:08,510 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:22:08.512927514Z [err]  2025-12-17 10:22:08,511 - server - INFO - ğŸ§¹ Cleaned transcript: ' S ure .' -> 'Sure.'
2025-12-17T10:22:08.512933782Z [err]  2025-12-17 10:22:08,511 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Sure.' (3 tokens)
2025-12-17T10:22:08.512942486Z [err]  2025-12-17 10:22:08,511 - server - INFO - ğŸ¤ Soniox final transcript: 'Sure.'
2025-12-17T10:22:08.512949266Z [err]  2025-12-17 10:22:08,511 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:22:08.512954648Z [err]  2025-12-17 10:22:08,511 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:22:08.512961242Z [err]  2025-12-17 10:22:08,511 - server - INFO - â±ï¸ [10:22:08.511] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Sure.'
2025-12-17T10:22:08.512967307Z [err]  2025-12-17 10:22:08,511 - server - INFO - â±ï¸ [10:22:08.511] STT endpoint detection latency: 1ms
2025-12-17T10:22:08.512975597Z [err]  2025-12-17 10:22:08,511 - server - INFO - â±ï¸ [10:22:08.511] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:22:08.522555256Z [err]  2025-12-17 10:22:08,520 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:22:08.522566130Z [err]  2025-12-17 10:22:08,520 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:22:08.522572719Z [err]  2025-12-17 10:22:08,520 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Sure.' - Processing...
2025-12-17T10:22:08.533339128Z [err]  2025-12-17 10:22:08,530 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:08.533349935Z [err]  2025-12-17 10:22:08,530 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:08.533361763Z [err]  2025-12-17 10:22:08,530 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:22:08.533372938Z [err]  2025-12-17 10:22:08,530 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:22:08.533376002Z [err]  2025-12-17 10:22:08,530 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 20ms (Soniox model: stt-rt-v3)
2025-12-17T10:22:08.533381671Z [err]  2025-12-17 10:22:08,530 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+20ms
2025-12-17T10:22:08.533394646Z [err]  2025-12-17 10:22:08,530 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:22:08.533400721Z [err]  2025-12-17 10:22:08,530 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:22:08.533418119Z [err]  2025-12-17 10:22:08,530 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Sure.
2025-12-17T10:22:08.628634745Z [err]  2025-12-17 10:22:08,626 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:22:08.628644420Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [10:22:08.627] ğŸ“¥ process_user_input() ENTRY - text: 'Sure....'
2025-12-17T10:22:08.628650696Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [10:22:08.627] â© About to call _process_call_flow_streaming()
2025-12-17T10:22:08.628655857Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [10:22:08.627] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:22:08.628660994Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [10:22:08.627] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:22:08.628667399Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - Flow processing - History length: 5, Is first: False
2025-12-17T10:22:08.628673284Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763159750250
2025-12-17T10:22:08.628674424Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ¤ AUTO-TRANSITION AFTER RESPONSE enabled - user spoke, transitioning to: 1763161849799
2025-12-17T10:22:08.628683019Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - âœ… Auto-transitioned (after response) to: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic
2025-12-17T10:22:08.628700435Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [10:22:08.627] ğŸ”€ About to call _follow_transition() for: Sure....
2025-12-17T10:22:08.628711788Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - Evaluating transitions from Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) for message: Sure.
2025-12-17T10:22:08.631798106Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:22:08.631802199Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ“ User's response captured: 'Sure....'
2025-12-17T10:22:08.631811935Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:22:08.631812453Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 0ms
2025-12-17T10:22:08.631820372Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - â±ï¸ [10:22:08.627] âœ… Node selected, about to process content...
2025-12-17T10:22:08.631823917Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 260 chars) - will return text instantly
2025-12-17T10:22:08.631828284Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:22 AM EST in content
2025-12-17T10:22:08.631833807Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:22:08.631838463Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:22:08.631842983Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:22:08.631863183Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:22:08.631868843Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:22:08.631872885Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:22:08.631877178Z [err]  2025-12-17 10:22:08,627 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:22:08.635357991Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - Using flow node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic (type: conversation, mode: script)
2025-12-17T10:22:08.635369127Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - â±ï¸ [10:22:08.628] ğŸ“„ About to process content (mode=script, length=260)
2025-12-17T10:22:08.635376969Z [err]  2025-12-17 10:22:08,628 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 97ms
2025-12-17T10:22:08.635378787Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T10:22:08.635389523Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-17T10:22:08.635390468Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-17T10:22:08.635391376Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:22:08.635400482Z [err]  2025-12-17 10:22:08,628 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 97ms
2025-12-17T10:22:08.635403256Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸ“¤ Sentence arrived from LLM: I know this call is out of the blue, but do you ha...
2025-12-17T10:22:08.635404897Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ’¾ Storing node ID 1763161849799 in conversation history
2025-12-17T10:22:08.635413277Z [err]  2025-12-17 10:22:08,628 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:22:08.635419176Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:08.635419577Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - LLM response (0.00s): Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stacking income without stacking hours. I know this call is out of the blue, but do you have just 25 seconds for me to explain why I'm reaching out today specifically?
2025-12-17T10:22:08.635430615Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:22:08.635430622Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - Total latency: 0.00s
2025-12-17T10:22:08.635432459Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:08.635444342Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T10:22:08.635446008Z [err]  2025-12-17 10:22:08,628 - server - INFO - âœ… LLM finished in 98ms, TTS tasks already running in background
2025-12-17T10:22:08.635451653Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:22:08.635457937Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: I know this call is out of the blue, but do you ha...
2025-12-17T10:22:08.635458521Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T10:22:08.635469215Z [err]  2025-12-17 10:22:08,628 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:22:08.635470305Z [err]  2025-12-17 10:22:08,628 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:22:08.635475033Z [err]  2025-12-17 10:22:08,629 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:22:08.635480540Z [err]  2025-12-17 10:22:08,629 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T10:22:08.635485634Z [err]  2025-12-17 10:22:08,629 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #4: Well, uh, I don't know if you could yet, but, I'm ...
2025-12-17T10:22:08.963614384Z [err]  2025-12-17 10:22:08,960 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:08.963623710Z [err]  2025-12-17 10:22:08,960 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+332ms
2025-12-17T10:22:08.963629625Z [err]  2025-12-17 10:22:08,960 - persistent_tts_service - INFO - ğŸ“¤ Sending 13746 bytes of audio (86 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:08.963634294Z [err]  2025-12-17 10:22:08,961 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:08.963638552Z [err]  2025-12-17 10:22:08,961 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2025-12-17T10:22:08.963644044Z [err]  2025-12-17 10:22:08,962 - persistent_tts_service - INFO - âœ… Sent 86 audio chunks via WebSocket
2025-12-17T10:22:09.170450171Z [err]  2025-12-17 10:22:09,169 - persistent_tts_service - INFO - âœ… Sent 9 audio chunks via WebSocket
2025-12-17T10:22:09.170480376Z [err]  2025-12-17 10:22:09,167 - persistent_tts_service - INFO - ğŸ“¤ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:09.170484866Z [err]  2025-12-17 10:22:09,167 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:09.170489332Z [err]  2025-12-17 10:22:09,167 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 3.2s from now)
2025-12-17T10:22:09.170493688Z [err]  2025-12-17 10:22:09,168 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:22:09.170498187Z [err]  2025-12-17 10:22:09,168 - persistent_tts_service - INFO - ğŸ“¤ Sending 1440 bytes of audio (9 chunks, 0.2s duration) via WebSocket
2025-12-17T10:22:09.170502718Z [err]  2025-12-17 10:22:09,168 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:09.170506690Z [err]  2025-12-17 10:22:09,168 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.2s (total: 3.4s from now)
2025-12-17T10:22:09.490873628Z [err]  2025-12-17 10:22:09,370 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:09.490880857Z [err]  2025-12-17 10:22:09,370 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 4.9s from now)
2025-12-17T10:22:09.490883009Z [err]  2025-12-17 10:22:09,370 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:09.490887531Z [err]  2025-12-17 10:22:09,372 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:22:09.490894890Z [err]  2025-12-17 10:22:09,379 - persistent_tts_service - INFO - ğŸ“¤ Sending 2554 bytes of audio (16 chunks, 0.3s duration) via WebSocket
2025-12-17T10:22:09.490901070Z [err]  2025-12-17 10:22:09,379 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:09.490907354Z [err]  2025-12-17 10:22:09,380 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.3s (total: 5.2s from now)
2025-12-17T10:22:09.490914677Z [err]  2025-12-17 10:22:09,380 - persistent_tts_service - INFO - âœ… Sent 16 audio chunks via WebSocket
2025-12-17T10:22:09.597710222Z [err]  2025-12-17 10:22:09,594 - persistent_tts_service - INFO - ğŸ“¤ Sending 15232 bytes of audio (96 chunks, 1.9s duration) via WebSocket
2025-12-17T10:22:09.597717900Z [err]  2025-12-17 10:22:09,595 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:09.597724853Z [err]  2025-12-17 10:22:09,595 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.9s (total: 6.9s from now)
2025-12-17T10:22:09.599471757Z [err]  2025-12-17 10:22:09,596 - persistent_tts_service - INFO - âœ… Sent 96 audio chunks via WebSocket
2025-12-17T10:22:09.735868181Z [err]  2025-12-17 10:22:09,733 - server - INFO - ğŸ“¤ Audio flowing: 1053 packets sent to Soniox (5s update)
2025-12-17T10:22:10.525641749Z [err]  2025-12-17 10:22:10,438 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (6.1s left)
2025-12-17T10:22:10.660992241Z [err]  2025-12-17 10:22:10,658 - server - INFO - ğŸ¤ Soniox receiver alive - 12 messages received in last 10s
2025-12-17T10:22:10.942286825Z [err]  2025-12-17 10:22:10,940 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (5.6s left)
2025-12-17T10:22:11.597857800Z [err]  2025-12-17 10:22:11,595 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:11.597865972Z [err]  2025-12-17 10:22:11,595 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #4: 6 chunks received
2025-12-17T10:22:11.597870972Z [err]  2025-12-17 10:22:11,595 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #5: I know this call is out of the blue, but do you ha...
2025-12-17T10:22:11.914411016Z [err]  2025-12-17 10:22:11,912 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:11.914423227Z [err]  2025-12-17 10:22:11,912 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+317ms
2025-12-17T10:22:11.914430617Z [err]  2025-12-17 10:22:11,912 - persistent_tts_service - INFO - ğŸ“¤ Sending 9288 bytes of audio (59 chunks, 1.2s duration) via WebSocket
2025-12-17T10:22:11.914436239Z [err]  2025-12-17 10:22:11,912 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:11.914442124Z [err]  2025-12-17 10:22:11,912 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.2s (total: 5.8s from now)
2025-12-17T10:22:11.915588681Z [err]  2025-12-17 10:22:11,913 - persistent_tts_service - INFO - âœ… Sent 59 audio chunks via WebSocket
2025-12-17T10:22:12.137285811Z [err]  2025-12-17 10:22:12,133 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:12.137290348Z [err]  2025-12-17 10:22:12,133 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:12.137294743Z [err]  2025-12-17 10:22:12,133 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 7.3s from now)
2025-12-17T10:22:12.137298564Z [err]  2025-12-17 10:22:12,134 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:22:12.137318698Z [err]  2025-12-17 10:22:12,134 - persistent_tts_service - INFO - ğŸ“¤ Sending 2183 bytes of audio (14 chunks, 0.3s duration) via WebSocket
2025-12-17T10:22:12.137322598Z [err]  2025-12-17 10:22:12,134 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:12.137327781Z [err]  2025-12-17 10:22:12,134 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.3s (total: 7.6s from now)
2025-12-17T10:22:12.137332380Z [err]  2025-12-17 10:22:12,134 - persistent_tts_service - INFO - âœ… Sent 14 audio chunks via WebSocket
2025-12-17T10:22:12.410069810Z [err]  2025-12-17 10:22:12,334 - persistent_tts_service - INFO - ğŸ“¤ Sending 26006 bytes of audio (163 chunks, 3.3s duration) via WebSocket
2025-12-17T10:22:12.410073786Z [err]  2025-12-17 10:22:12,334 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:12.410077826Z [err]  2025-12-17 10:22:12,334 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +3.3s (total: 10.6s from now)
2025-12-17T10:22:12.410082415Z [err]  2025-12-17 10:22:12,336 - persistent_tts_service - INFO - âœ… Sent 163 audio chunks via WebSocket
2025-12-17T10:22:14.520972588Z [err]  2025-12-17 10:22:14,334 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:22:14.520983597Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:14.520991646Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:22:14.520997769Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  [TIMING] STT: 20ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:22:14.521004404Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 98ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:22:14.521012855Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 5706ms (provider: elevenlabs, websocket: False)
2025-12-17T10:22:14.521019180Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5804ms (user stopped â†’ play_audio_url called)
2025-12-17T10:22:14.521034223Z [err]  2025-12-17 10:22:14,334 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:14.521039739Z [err]  2025-12-17 10:22:14,334 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #5: 4 chunks received
2025-12-17T10:22:14.521044521Z [err]  2025-12-17 10:22:14,334 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T10:22:14.521048517Z [err]  2025-12-17 10:22:14,334 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:22:14.521052713Z [err]  2025-12-17 10:22:14,334 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5803ms from user stop ğŸš€
2025-12-17T10:22:14.521056968Z [err]  2025-12-17 10:22:14,334 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:14.522558560Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'Well, uh, I don't know if you could yet, but, I'm calling be...'
2025-12-17T10:22:14.522567013Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:22:14.522567494Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:22:14.522569315Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:22:14.522576218Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:22:14.522578563Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:22:14.522583727Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:14.522584152Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:22:14.522591141Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 6104ms estimated
2025-12-17T10:22:14.522600167Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 260 chars, 2 sentences
2025-12-17T10:22:14.522607442Z [err]  2025-12-17 10:22:14,335 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Sure....'
2025-12-17T10:22:14.527788334Z [err]  2025-12-17 10:22:14,526 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 618ms)
2025-12-17T10:22:14.527795011Z [err]  2025-12-17 10:22:14,526 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:22:14.751576805Z [err]  2025-12-17 10:22:14,750 - server - INFO - ğŸ“¤ Audio flowing: 1304 packets sent to Soniox (5s update)
2025-12-17T10:22:15.488067350Z [err]  2025-12-17 10:22:15,482 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (7.5s left)
2025-12-17T10:22:15.994565553Z [err]  2025-12-17 10:22:15,984 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (7.0s left)
2025-12-17T10:22:19.757605647Z [err]  2025-12-17 10:22:19,755 - server - INFO - ğŸ“¤ Audio flowing: 1554 packets sent to Soniox (5s update)
2025-12-17T10:22:20.023843005Z [err]  2025-12-17 10:22:20,020 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (2.9s left)
2025-12-17T10:22:20.587747126Z [err]  2025-12-17 10:22:20,523 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (2.4s left)
2025-12-17T10:22:21.516410839Z [err]  2025-12-17 10:22:21,490 - server - INFO - ğŸ¤ Soniox receiver alive - 10 messages received in last 10s
2025-12-17T10:22:23.046992840Z [err]  2025-12-17 10:22:23,043 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T10:22:23.047006950Z [err]  2025-12-17 10:22:23,044 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966943.0440524 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:23.047013164Z [err]  2025-12-17 10:22:23,044 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:23.047019199Z [err]  2025-12-17 10:22:23,044 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:22:24.771252331Z [err]  2025-12-17 10:22:24,770 - server - INFO - ğŸ“¤ Audio flowing: 1805 packets sent to Soniox (5s update)
2025-12-17T10:22:24.835902255Z [err]  2025-12-17 10:22:24,834 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"?]
2025-12-17T10:22:24.835909001Z [err]  2025-12-17 10:22:24,834 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:24.835913365Z [err]  2025-12-17 10:22:24,834 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:22:24.835918268Z [err]  2025-12-17 10:22:24,834 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:24.835922539Z [err]  2025-12-17 10:22:24,834 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Go' | Generating: False
2025-12-17T10:22:24.961690375Z [err]  2025-12-17 10:22:24,958 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"?, " a"?]
2025-12-17T10:22:24.961702427Z [err]  2025-12-17 10:22:24,959 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Go a' | Generating: False
2025-12-17T10:22:25.078268611Z [err]  2025-12-17 10:22:25,073 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"?, " a"?, "he"?]
2025-12-17T10:22:25.078273335Z [err]  2025-12-17 10:22:25,073 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Go a he' | Generating: False
2025-12-17T10:22:25.570148394Z [err]  2025-12-17 10:22:25,341 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:22:25.570160576Z [err]  2025-12-17 10:22:25,342 - server - INFO - ğŸ§¹ Cleaned transcript: ' Go  a he ad.' -> 'Go ahead.'
2025-12-17T10:22:25.570173842Z [err]  2025-12-17 10:22:25,341 - server - INFO - ğŸ”¤ RAW TOKENS: [" Go"âœ“, " a"âœ“, "he"âœ“, "ad."âœ“, "<end>"âœ“]
2025-12-17T10:22:25.570184705Z [err]  2025-12-17 10:22:25,342 - server - INFO - â±ï¸ [10:22:25.342] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Go ahead.'
2025-12-17T10:22:25.570191744Z [err]  2025-12-17 10:22:25,342 - server - INFO - â±ï¸ [10:22:25.342] STT endpoint detection latency: 12ms
2025-12-17T10:22:25.570196786Z [err]  2025-12-17 10:22:25,342 - server - INFO - â±ï¸ [10:22:25.342] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:22:25.570203069Z [err]  2025-12-17 10:22:25,344 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:22:25.570207590Z [err]  2025-12-17 10:22:25,344 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:22:25.570213366Z [err]  2025-12-17 10:22:25,345 - server - INFO - âœ… Agent SILENT - User said 2 word(s): 'Go ahead.' - Processing...
2025-12-17T10:22:25.570218718Z [err]  2025-12-17 10:22:25,355 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Go ahead.
2025-12-17T10:22:25.570249799Z [err]  2025-12-17 10:22:25,342 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Go ahead.' (4 tokens)
2025-12-17T10:22:25.570257310Z [err]  2025-12-17 10:22:25,342 - server - INFO - ğŸ¤ Soniox final transcript: 'Go ahead.'
2025-12-17T10:22:25.570263356Z [err]  2025-12-17 10:22:25,342 - server - INFO - ğŸ” FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:22:25.570269674Z [err]  2025-12-17 10:22:25,342 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:22:25.570937216Z [err]  2025-12-17 10:22:25,355 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:25.570943118Z [err]  2025-12-17 10:22:25,355 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:22:25.570948811Z [err]  2025-12-17 10:22:25,355 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:22:25.570954453Z [err]  2025-12-17 10:22:25,355 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+25ms
2025-12-17T10:22:25.570960196Z [err]  2025-12-17 10:22:25,355 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 25ms (Soniox model: stt-rt-v3)
2025-12-17T10:22:25.570965729Z [err]  2025-12-17 10:22:25,355 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:22:25.570971769Z [err]  2025-12-17 10:22:25,355 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:22:25.570977457Z [err]  2025-12-17 10:22:25,355 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:25.570983543Z [err]  2025-12-17 10:22:25,452 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:22:25.570989351Z [err]  2025-12-17 10:22:25,452 - calling_service - INFO - â±ï¸ [10:22:25.452] ğŸ“¥ process_user_input() ENTRY - text: 'Go ahead....'
2025-12-17T10:22:25.570994533Z [err]  2025-12-17 10:22:25,452 - calling_service - INFO - â±ï¸ [10:22:25.452] â© About to call _process_call_flow_streaming()
2025-12-17T10:22:25.570999896Z [err]  2025-12-17 10:22:25,452 - calling_service - INFO - â±ï¸ [10:22:25.452] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:22:25.571005439Z [err]  2025-12-17 10:22:25,452 - calling_service - INFO - â±ï¸ [10:22:25.452] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:22:25.571010910Z [err]  2025-12-17 10:22:25,452 - calling_service - INFO - Flow processing - History length: 7, Is first: False
2025-12-17T10:22:25.572642328Z [err]  2025-12-17 10:22:25,452 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763161849799
2025-12-17T10:22:25.572648272Z [err]  2025-12-17 10:22:25,453 - calling_service - INFO - â±ï¸ [10:22:25.453] ğŸ”€ About to call _follow_transition() for: Go ahead....
2025-12-17T10:22:25.572654015Z [err]  2025-12-17 10:22:25,453 - calling_service - INFO - Evaluating transitions from Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic for message: Go ahead.
2025-12-17T10:22:25.572791730Z [err]  2025-12-17 10:22:25,463 - calling_service - INFO - â±ï¸ [10:22:25.463] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 4 options
2025-12-17T10:22:25.946696437Z [err]  2025-12-17 10:22:25,941 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:22:25.946703828Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - â±ï¸ [10:22:25.942] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 479ms
2025-12-17T10:22:25.946708511Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - ğŸ¤– AI transition decision: '0'
2025-12-17T10:22:25.946714090Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - ğŸ“Š Available transitions: ['Agrees|consents (yes|sure|okay|hear more|call cons...', 'Any objection or non compliance that isn\'t a "I do...', 'NO (flat out)|No recall (done quickly) AND no othe...', "I'm Busy, or requests to call back responses from ..."]
2025-12-17T10:22:25.946718933Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - Selected transition index: 0
2025-12-17T10:22:25.946723321Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - Transition: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic -> N_IntroduceModel_And_AskQuestions_V3_Adaptive
2025-12-17T10:22:25.946727774Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 489ms
2025-12-17T10:22:25.946732046Z [err]  2025-12-17 10:22:25,942 - calling_service - INFO - â±ï¸ [10:22:25.942] âœ… Node selected, about to process content...
2025-12-17T10:22:25.946736346Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:22 AM EST in content
2025-12-17T10:22:25.946740668Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:22:25.946745115Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:22:25.946749496Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:22:25.947946538Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:22:25.947958661Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:22:25.947965684Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:22:25.947971677Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:22:25.947977958Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:22:25.947984473Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:22:25.947992039Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - âœ… Using explicit SCRIPT mode (length: 164 chars) - will return text instantly
2025-12-17T10:22:25.947997268Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - Using flow node: N_IntroduceModel_And_AskQuestions_V3_Adaptive (type: conversation, mode: script)
2025-12-17T10:22:25.948003089Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - â±ï¸ [10:22:25.943] ğŸ“„ About to process content (mode=script, length=164)
2025-12-17T10:22:25.948009557Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ“¤ Streaming script as 2 sentence(s)
2025-12-17T10:22:25.948015522Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Okay, in a nutshell, we set up passive income webs...
2025-12-17T10:22:25.948021753Z [err]  2025-12-17 10:22:25,943 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 587ms
2025-12-17T10:22:25.948026651Z [err]  2025-12-17 10:22:25,943 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:22:25.948031071Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:25.948961805Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:22:25.948972623Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:22:25.948986008Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ’¾ Storing node ID 1763163400676 in conversation history
2025-12-17T10:22:25.948986255Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:22:25.948997260Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:22:25.948997724Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - LLM response (0.49s): Okay, in a nutshell, we set up passive income websites, and we let them produce income for you. What questions come to mind as soon as you hear something like that?
2025-12-17T10:22:25.949005235Z [err]  2025-12-17 10:22:25,943 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 587ms
2025-12-17T10:22:25.949011045Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ“¤ Streamed script sentence 1/2: Okay, in a nutshell, we set up passive income webs...
2025-12-17T10:22:25.949016112Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸ“¤ Sentence arrived from LLM: What questions come to mind as soon as you hear so...
2025-12-17T10:22:25.949022674Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:25.949028541Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:22:25.949032651Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T10:22:25.949037387Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - ğŸ“¤ Streamed script sentence 2/2: What questions come to mind as soon as you hear so...
2025-12-17T10:22:25.950324797Z [err]  2025-12-17 10:22:25,943 - calling_service - INFO - Total latency: 0.49s
2025-12-17T10:22:25.950332322Z [err]  2025-12-17 10:22:25,943 - server - INFO - âœ… LLM finished in 588ms, TTS tasks already running in background
2025-12-17T10:22:25.950337703Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸµ Streaming 2 TTS chunks as they complete...
2025-12-17T10:22:25.950343212Z [err]  2025-12-17 10:22:25,943 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:22:25.950348060Z [err]  2025-12-17 10:22:25,943 - server - INFO -    2 sentences queued and playing seamlessly
2025-12-17T10:22:25.950353004Z [err]  2025-12-17 10:22:25,943 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #6: Okay, in a nutshell, we set up passive income webs...
2025-12-17T10:22:26.582642013Z [err]  2025-12-17 10:22:26,299 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:26.582649895Z [err]  2025-12-17 10:22:26,299 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+356ms
2025-12-17T10:22:26.582658967Z [err]  2025-12-17 10:22:26,299 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:26.582666491Z [err]  2025-12-17 10:22:26,299 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:26.582675085Z [err]  2025-12-17 10:22:26,299 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2025-12-17T10:22:26.582682136Z [err]  2025-12-17 10:22:26,300 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:22:26.582690153Z [err]  2025-12-17 10:22:26,304 - persistent_tts_service - INFO - ğŸ“¤ Sending 5154 bytes of audio (33 chunks, 0.6s duration) via WebSocket
2025-12-17T10:22:26.582697344Z [err]  2025-12-17 10:22:26,304 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:26.582706563Z [err]  2025-12-17 10:22:26,304 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.6s (total: 2.4s from now)
2025-12-17T10:22:26.582718880Z [err]  2025-12-17 10:22:26,304 - persistent_tts_service - INFO - âœ… Sent 33 audio chunks via WebSocket
2025-12-17T10:22:26.582726975Z [err]  2025-12-17 10:22:26,510 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:22:26.582734935Z [err]  2025-12-17 10:22:26,510 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:26.586461949Z [err]  2025-12-17 10:22:26,510 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 3.9s from now)
2025-12-17T10:22:26.586471595Z [err]  2025-12-17 10:22:26,511 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:22:26.586479495Z [err]  2025-12-17 10:22:26,512 - persistent_tts_service - INFO - ğŸ“¤ Sending 697 bytes of audio (5 chunks, 0.1s duration) via WebSocket
2025-12-17T10:22:26.586486276Z [err]  2025-12-17 10:22:26,512 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:26.586491132Z [err]  2025-12-17 10:22:26,512 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.1s (total: 4.0s from now)
2025-12-17T10:22:26.586496528Z [err]  2025-12-17 10:22:26,512 - persistent_tts_service - INFO - âœ… Sent 5 audio chunks via WebSocket
2025-12-17T10:22:26.703831290Z [err]  2025-12-17 10:22:26,700 - persistent_tts_service - INFO - ğŸ“¤ Sending 14117 bytes of audio (89 chunks, 1.8s duration) via WebSocket
2025-12-17T10:22:26.703840861Z [err]  2025-12-17 10:22:26,700 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:26.703858752Z [err]  2025-12-17 10:22:26,700 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.8s (total: 5.5s from now)
2025-12-17T10:22:26.703872504Z [err]  2025-12-17 10:22:26,701 - persistent_tts_service - INFO - âœ… Sent 89 audio chunks via WebSocket
2025-12-17T10:22:28.702912042Z [err]  2025-12-17 10:22:28,701 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:28.702918242Z [err]  2025-12-17 10:22:28,701 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #6: 5 chunks received
2025-12-17T10:22:28.702922773Z [err]  2025-12-17 10:22:28,701 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #7: What questions come to mind as soon as you hear so...
2025-12-17T10:22:29.039362706Z [err]  2025-12-17 10:22:29,032 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:29.039373237Z [err]  2025-12-17 10:22:29,033 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+331ms
2025-12-17T10:22:29.039379011Z [err]  2025-12-17 10:22:29,034 - persistent_tts_service - INFO - ğŸ“¤ Sending 9660 bytes of audio (61 chunks, 1.2s duration) via WebSocket
2025-12-17T10:22:29.039384824Z [err]  2025-12-17 10:22:29,034 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:29.039390381Z [err]  2025-12-17 10:22:29,034 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.2s (total: 4.4s from now)
2025-12-17T10:22:29.039395821Z [err]  2025-12-17 10:22:29,037 - persistent_tts_service - INFO - âœ… Sent 61 audio chunks via WebSocket
2025-12-17T10:22:29.181762517Z [err]  2025-12-17 10:22:29,180 - server - INFO - ğŸ”¤ RAW TOKENS: [" Th"?]
2025-12-17T10:22:29.181768072Z [err]  2025-12-17 10:22:29,180 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:22:29.181772566Z [err]  2025-12-17 10:22:29,180 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:29.181776488Z [err]  2025-12-17 10:22:29,180 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Th' | Generating: True
2025-12-17T10:22:29.181782214Z [err]  2025-12-17 10:22:29,180 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 1 words - 'Th'
2025-12-17T10:22:29.215588696Z [err]  2025-12-17 10:22:29,208 - persistent_tts_service - INFO - ğŸ“¤ Sending 14489 bytes of audio (91 chunks, 1.8s duration) via WebSocket
2025-12-17T10:22:29.215594767Z [err]  2025-12-17 10:22:29,208 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:29.215599173Z [err]  2025-12-17 10:22:29,208 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.8s (total: 6.1s from now)
2025-12-17T10:22:29.215603728Z [err]  2025-12-17 10:22:29,209 - persistent_tts_service - INFO - âœ… Sent 91 audio chunks via WebSocket
2025-12-17T10:22:29.542993221Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ” FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=True, time_until_done=5.9s, generating=True, playbacks=0, is_active=True
2025-12-17T10:22:29.543001850Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ”• FILTERING 2-word/filler 'Than ks.' - NOT calling on_final_transcript
2025-12-17T10:22:29.543008915Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ”• SKIPPING endpoint for 2-word/filler 'Than ks.' (tts_speaking=True, is_active=True)
2025-12-17T10:22:29.543018884Z [err]  2025-12-17 10:22:29,375 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:29.543027997Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ‘¤ Marked user stopped speaking (filtered utterance)
2025-12-17T10:22:29.543112886Z [err]  2025-12-17 10:22:29,306 - server - INFO - ğŸ”¤ RAW TOKENS: [" Th"?, "an"?]
2025-12-17T10:22:29.543119873Z [err]  2025-12-17 10:22:29,307 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Than' | Generating: True
2025-12-17T10:22:29.543125057Z [err]  2025-12-17 10:22:29,307 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 1 words - 'Than'
2025-12-17T10:22:29.543131376Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ”¤ RAW TOKENS: [" Th"âœ“, "an"âœ“, "ks."âœ“, "<end>"âœ“]
2025-12-17T10:22:29.543138428Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:22:29.543144748Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ§¹ Cleaned transcript: ' Th an ks.' -> 'Than ks.'
2025-12-17T10:22:29.543150445Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Than ks.' (3 tokens)
2025-12-17T10:22:29.543156260Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ¤ Soniox final transcript: 'Than ks.'
2025-12-17T10:22:29.543162118Z [err]  2025-12-17 10:22:29,375 - server - INFO - ğŸ¯ User speaking while TTS is_speaking=True - INTERRUPTION POSSIBLE
2025-12-17T10:22:29.772040238Z [err]  2025-12-17 10:22:29,770 - server - INFO - ğŸ“¤ Audio flowing: 2055 packets sent to Soniox (5s update)
2025-12-17T10:22:30.093960782Z [err]  2025-12-17 10:22:30,091 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (5.2s left)
2025-12-17T10:22:30.598051703Z [err]  2025-12-17 10:22:30,596 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (4.7s left)
2025-12-17T10:22:31.211272217Z [err]  2025-12-17 10:22:31,208 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:31.211272454Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 588ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:22:31.211281719Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 5265ms (provider: elevenlabs, websocket: False)
2025-12-17T10:22:31.211283536Z [err]  2025-12-17 10:22:31,208 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #7: 2 chunks received
2025-12-17T10:22:31.211291938Z [err]  2025-12-17 10:22:31,209 - server - INFO - âœ… All 2 persistent TTS streams completed
2025-12-17T10:22:31.211292136Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 5853ms (user stopped â†’ play_audio_url called)
2025-12-17T10:22:31.211298985Z [err]  2025-12-17 10:22:31,209 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:22:31.211305796Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 5853ms from user stop ğŸš€
2025-12-17T10:22:31.211312548Z [err]  2025-12-17 10:22:31,209 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:31.211318670Z [err]  2025-12-17 10:22:31,209 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:22:31.211324747Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:31.211331117Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:22:31.211337515Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] STT: 25ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:22:31.212497414Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:22:31.212504669Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:22:31.212510733Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:22:31.212516720Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:22:31.212522539Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:22:31.212528259Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 6153ms estimated
2025-12-17T10:22:31.212534786Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 164 chars, 2 sentences
2025-12-17T10:22:31.212540927Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Go ahead....'
2025-12-17T10:22:31.212547095Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: 'Okay, in a nutshell, we set up passive income websites, and ...'
2025-12-17T10:22:31.212553515Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:22:31.212559992Z [err]  2025-12-17 10:22:31,209 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:31.460257696Z [err]  2025-12-17 10:22:31,399 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: N_IntroduceModel_And_AskQuestions_V3_Adaptive, Dead Air: 1113ms)
2025-12-17T10:22:31.460263726Z [err]  2025-12-17 10:22:31,399 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:22:31.551251963Z [err]  2025-12-17 10:22:31,549 - server - INFO - ğŸ¤ Soniox receiver alive - 15 messages received in last 10s
2025-12-17T10:22:34.808813920Z [err]  2025-12-17 10:22:34,790 - server - INFO - ğŸ“¤ Audio flowing: 2306 packets sent to Soniox (5s update)
2025-12-17T10:22:35.523901564Z [err]  2025-12-17 10:22:35,309 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:22:35.640860536Z [err]  2025-12-17 10:22:35,638 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.4s ago), marking agent as done speaking
2025-12-17T10:22:35.640868075Z [err]  2025-12-17 10:22:35,638 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966955.6385424 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:35.640873918Z [err]  2025-12-17 10:22:35,638 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:39.811490751Z [err]  2025-12-17 10:22:39,810 - server - INFO - ğŸ“¤ Audio flowing: 2557 packets sent to Soniox (5s update)
2025-12-17T10:22:39.876773136Z [err]  2025-12-17 10:22:39,873 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?]
2025-12-17T10:22:39.876786414Z [err]  2025-12-17 10:22:39,874 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:39.876796460Z [err]  2025-12-17 10:22:39,874 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:22:39.876803307Z [err]  2025-12-17 10:22:39,874 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:39.876810061Z [err]  2025-12-17 10:22:39,874 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'U' | Generating: False
2025-12-17T10:22:39.958552615Z [err]  2025-12-17 10:22:39,953 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?]
2025-12-17T10:22:39.958566810Z [err]  2025-12-17 10:22:39,953 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um,' | Generating: False
2025-12-17T10:22:40.158446644Z [err]  2025-12-17 10:22:40,156 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=0/2
2025-12-17T10:22:40.660511077Z [err]  2025-12-17 10:22:40,657 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=0/2
2025-12-17T10:22:40.836921339Z [err]  2025-12-17 10:22:40,832 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?]
2025-12-17T10:22:40.836928125Z [err]  2025-12-17 10:22:40,833 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how' | Generating: False
2025-12-17T10:22:40.895451437Z [err]  2025-12-17 10:22:40,888 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?, " do"?]
2025-12-17T10:22:40.895456877Z [err]  2025-12-17 10:22:40,888 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how do' | Generating: False
2025-12-17T10:22:41.023430404Z [err]  2025-12-17 10:22:41,018 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?, " do"?, " I"?]
2025-12-17T10:22:41.023436595Z [err]  2025-12-17 10:22:41,019 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how do I' | Generating: False
2025-12-17T10:22:41.160785825Z [err]  2025-12-17 10:22:41,156 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?, " do"?, " I"?, " kn"?]
2025-12-17T10:22:41.160793256Z [err]  2025-12-17 10:22:41,156 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how do I kn' | Generating: False
2025-12-17T10:22:41.570859805Z [err]  2025-12-17 10:22:41,442 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?, " do"?, " I"?, " kn"?, "ow"?, " this"?]
2025-12-17T10:22:41.570868746Z [err]  2025-12-17 10:22:41,442 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how do I know this' | Generating: False
2025-12-17T10:22:41.570877451Z [err]  2025-12-17 10:22:41,313 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?, " do"?, " I"?, " kn"?, "ow"?]
2025-12-17T10:22:41.570884136Z [err]  2025-12-17 10:22:41,314 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how do I know' | Generating: False
2025-12-17T10:22:41.696871202Z [err]  2025-12-17 10:22:41,694 - server - INFO - ğŸ¤ Soniox receiver alive - 16 messages received in last 10s
2025-12-17T10:22:41.696877765Z [err]  2025-12-17 10:22:41,695 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " how"?, " do"?, " I"?, " kn"?, "ow"?, " this"?, " works"?]
2025-12-17T10:22:41.696882526Z [err]  2025-12-17 10:22:41,695 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, how do I know this works' | Generating: False
2025-12-17T10:22:42.023735105Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"âœ“, "m,"âœ“, " how"âœ“, " do"âœ“, " I"âœ“, " kn"âœ“, "ow"âœ“, " this"âœ“, " works"âœ“, "?"âœ“, "<end>"âœ“]
2025-12-17T10:22:42.023741293Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:22:42.023746385Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸ§¹ Cleaned transcript: ' U m,  how  do  I  kn ow  this  works ?' -> 'Um, how do I know this works?'
2025-12-17T10:22:42.023751102Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Um, how do I know this works?' (10 tokens)
2025-12-17T10:22:42.023756711Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸ¤ Soniox final transcript: 'Um, how do I know this works?'
2025-12-17T10:22:42.023761713Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸ” FILTER CHECK: words=7, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:22:42.023767216Z [err]  2025-12-17 10:22:42,019 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:22:42.023773384Z [err]  2025-12-17 10:22:42,020 - server - INFO - â±ï¸ [10:22:42.019] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Um, how do I know this works?'
2025-12-17T10:22:42.023782275Z [err]  2025-12-17 10:22:42,020 - server - INFO - â±ï¸ [10:22:42.019] STT endpoint detection latency: 10ms
2025-12-17T10:22:42.023782341Z [err]  2025-12-17 10:22:42,021 - server - INFO - âœ… Agent SILENT - User said 7 word(s): 'Um, how do I know this works?' - Processing...
2025-12-17T10:22:42.023790237Z [err]  2025-12-17 10:22:42,020 - server - INFO - â±ï¸ [10:22:42.019] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:22:42.023795115Z [err]  2025-12-17 10:22:42,021 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:22:42.023799433Z [err]  2025-12-17 10:22:42,021 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:22:42.036966110Z [err]  2025-12-17 10:22:42,032 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Um, how do I know this works?
2025-12-17T10:22:42.036976868Z [err]  2025-12-17 10:22:42,032 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:42.036987666Z [err]  2025-12-17 10:22:42,032 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:22:42.036996084Z [err]  2025-12-17 10:22:42,032 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:22:42.037007433Z [err]  2025-12-17 10:22:42,032 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+3ms
2025-12-17T10:22:42.037016980Z [err]  2025-12-17 10:22:42,032 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 3ms (Soniox model: stt-rt-v3)
2025-12-17T10:22:42.037025007Z [err]  2025-12-17 10:22:42,033 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:22:42.037031214Z [err]  2025-12-17 10:22:42,033 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:22:42.037038501Z [err]  2025-12-17 10:22:42,033 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:42.131186505Z [err]  2025-12-17 10:22:42,128 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:22:42.131194924Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] ğŸ“¥ process_user_input() ENTRY - text: 'Um, how do I know this works?...'
2025-12-17T10:22:42.131204472Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] â© About to call _process_call_flow_streaming()
2025-12-17T10:22:42.131209191Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:22:42.131213601Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:22:42.131218333Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - Flow processing - History length: 9, Is first: False
2025-12-17T10:22:42.131224533Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763163400676
2025-12-17T10:22:42.131229124Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] ğŸ”€ About to call _follow_transition() for: Um, how do I know this works?...
2025-12-17T10:22:42.131233462Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - Evaluating transitions from N_IntroduceModel_And_AskQuestions_V3_Adaptive for message: Um, how do I know this works?
2025-12-17T10:22:42.131245181Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ¤ AUTO-TRANSITION AFTER RESPONSE enabled - user spoke, transitioning to: 1763206946898
2025-12-17T10:22:42.131251075Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - âœ… Auto-transitioned (after response) to: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive
2025-12-17T10:22:42.131256239Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ“ User's response captured: 'Um, how do I know this works?...'
2025-12-17T10:22:42.133272551Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:22:42.133283824Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:22:42.133291500Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 0ms
2025-12-17T10:22:42.133294358Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:22:42.133301324Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] âœ… Node selected, about to process content...
2025-12-17T10:22:42.133303900Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:22:42.133308026Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:22 AM EST in content
2025-12-17T10:22:42.133315073Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - Using flow node: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive (type: conversation, mode: prompt)
2025-12-17T10:22:42.133318308Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:22:42.133324576Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:22:42.133329037Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:22:42.133333669Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:22:42.133338414Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:22:42.133343636Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:22:42.134537265Z [err]  2025-12-17 10:22:42,129 - calling_service - INFO - â±ï¸ [10:22:42.129] ğŸ“„ About to process content (mode=prompt, length=4560)
2025-12-17T10:22:42.140825354Z [err]  2025-12-17 10:22:42,138 - calling_service - INFO - âš¡ PARALLEL MODE: Running KB + analysis simultaneously
2025-12-17T10:22:42.142370217Z [err]  2025-12-17 10:22:42,140 - kb_router - INFO - ğŸš¦ KB Router: USE KB (factual question pattern matched)
2025-12-17T10:22:42.142376676Z [err]  2025-12-17 10:22:42,140 - rag_service - INFO - ğŸ“Š Dynamic top_k: 3 (medium query: 7 words, 1 questions)
2025-12-17T10:22:42.149252207Z [err]  2025-12-17 10:22:42,145 - rag_service - WARNING - âš ï¸ ChromaDB collection not found for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb: Collection [kb_667cedd4] does not exist
2025-12-17T10:22:42.149259635Z [err]  2025-12-17 10:22:42,145 - rag_service - INFO - ğŸ“š ChromaDB: No chunks above threshold 0.35
2025-12-17T10:22:42.149263776Z [err]  2025-12-17 10:22:42,145 - calling_service - INFO - âš¡ ChromaDB empty, falling back to MongoDB retrieval
2025-12-17T10:22:42.149267546Z [err]  2025-12-17 10:22:42,145 - rag_service - ERROR - âŒ Error retrieving KB chunks: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-12-17T10:22:42.149271730Z [err]  Traceback (most recent call last):
2025-12-17T10:22:42.149278291Z [err]    File "/app/backend/rag_service.py", line 236, in retrieve_relevant_chunks_by_agent
2025-12-17T10:22:42.149282107Z [err]      if not db:
2025-12-17T10:22:42.149285949Z [err]    File "/root/.local/lib/python3.11/site-packages/pymongo/database.py", line 1339, in __bool__
2025-12-17T10:22:42.149290003Z [err]      raise NotImplementedError(
2025-12-17T10:22:42.149293588Z [err]  NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-12-17T10:22:42.149297841Z [err]  2025-12-17 10:22:42,146 - calling_service - INFO - âš¡ Parallel operations completed in 6ms
2025-12-17T10:22:42.149301892Z [err]  2025-12-17 10:22:42,146 - calling_service - INFO - ğŸ” Node 'N_KB_Q&A_With_StrategicNarrative_V3_Adaptive': use_parallel_llm=True
2025-12-17T10:22:42.150957161Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-17T10:22:42.150962869Z [err]  
2025-12-17T10:22:42.150967933Z [err]  If explaining ends in peri...
2025-12-17T10:22:42.150973953Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“ [SYSTEM MSG 2 - DYNAMIC CONTEXT] (5589 chars):
2025-12-17T10:22:42.150975423Z [err]  2025-12-17 10:22:42,148 - calling_service - INFO - âš¡ Parallel mode: Using condensed history (9/9 messages)
2025-12-17T10:22:42.150988238Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - â±ï¸ [10:22:42.148] ğŸ’¬ LLM REQUEST START: 9 conversation turns, 11415 system chars (KB cached)
2025-12-17T10:22:42.150995888Z [err]  If user asks to repeat info, rephrase naturallyâ€”never exact repeat.
2025-12-17T10:22:42.150996915Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â• LLM PROMPT BREAKDOWN â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:42.151007952Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“ [SYSTEM MSG 1 - GLOBAL PROMPT] (5826 chars):
2025-12-17T10:22:42.151009613Z [err]  
2025-12-17T10:22:42.151016229Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-17T10:22:42.151019195Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-17T10:22:42.151026296Z [err]  
2025-12-17T10:22:42.151028958Z [err]  
2025-12-17T10:22:42.151033043Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-17T10:22:42.151037761Z [err]  If asked about call number: "Company number."
2025-12-17T10:22:42.151039261Z [err]  
2025-12-17T10:22:42.151045535Z [err]  If user says a name, don't assume it's theirsâ€”wait for explicit correction.
2025-12-17T10:22:42.151047663Z [err]  
2025-12-17T10:22:42.151052730Z [err]  
2025-12-17T10:22:42.152787578Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“   Preview: 
2025-12-17T10:22:42.152798267Z [err]  
2025-12-17T10:22:42.152805754Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:22:42.152813815Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-17T10:22:42.152821378Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:22:42.152829031Z [err]  
2025-12-17T10:22:42.152836007Z [err]  USER COMMUNICATION STYLE: S type - adjust your response accordingly
2025-12-17T10:22:42.152849288Z [err]  CONVERSATION STATUS: Turn 5, objection handling phase
2025-12-17T10:22:42.152859358Z [err]  
2025-12-17T10:22:42.152868882Z [err]  This context is provided to help you focus. You still need to:
2025-12-17T10:22:42.152876715Z [err]  1. Generate a natural, contextual response
2025-12-17T10:22:42.152884446Z [err]  2. Evaluate transitions per your node instructions
2025-12-17T10:22:42.152892010Z [err]  
2025-12-17T10:22:42.152900333Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:22:42.152907784Z [err]  
2025-12-17T10:22:42.152914627Z [err]  # CURRENT CONTEXT
2025-12-17T10:22:42.152921298Z [err]  Customer: Kendrick
2025-12-17T10:22:42.152927954Z [err]  Variables: {"now": "Wednesday, December 17, 2025 at 5:22 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment...
2025-12-17T10:22:42.154281853Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“ [CONVERSATION HISTORY] (9 messages)
2025-12-17T10:22:42.154289664Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“   assistant: Okay, in a nutshell, we set up passive income websites, and we let them produce income for you. What...
2025-12-17T10:22:42.154295517Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“   user: Um, how do I know this works?...
2025-12-17T10:22:42.154301052Z [err]  2025-12-17 10:22:42,149 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:42.654303159Z [err]  2025-12-17 10:22:42,652 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:22:42.909349184Z [err]  2025-12-17 10:22:42,901 - calling_service - INFO - â±ï¸ [10:22:42.901] ğŸ’¬ LLM FIRST TOKEN: 752ms (grok grok-4-fast-non-reasoning)
2025-12-17T10:22:42.951046117Z [err]  2025-12-17 10:22:42,949 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #8: [N] That's a fair question,...
2025-12-17T10:22:42.951050777Z [err]  2025-12-17 10:22:42,949 - server - INFO - ğŸ“¤ Sentence arrived from LLM: [N] That's a fair question,...
2025-12-17T10:22:42.951058528Z [err]  2025-12-17 10:22:42,949 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 916ms
2025-12-17T10:22:42.951062999Z [err]  2025-12-17 10:22:42,949 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:22:42.951067761Z [err]  2025-12-17 10:22:42,949 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:42.951072104Z [err]  2025-12-17 10:22:42,949 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:22:42.951077587Z [err]  2025-12-17 10:22:42,949 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:22:42.951082654Z [err]  2025-12-17 10:22:42,949 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 916ms
2025-12-17T10:22:42.951086835Z [err]  2025-12-17 10:22:42,949 - calling_service - INFO - ğŸ“¤ Streamed sentence: [N] That's a fair question,...
2025-12-17T10:22:42.978929878Z [err]  2025-12-17 10:22:42,976 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Kendrick....
2025-12-17T10:22:42.978937829Z [err]  2025-12-17 10:22:42,977 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:42.978942767Z [err]  2025-12-17 10:22:42,977 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:22:42.978947341Z [err]  2025-12-17 10:22:42,977 - server - INFO - ğŸµ TTS task #2 started at +27ms
2025-12-17T10:22:42.978952233Z [err]  2025-12-17 10:22:42,977 - calling_service - INFO - ğŸ“¤ Streamed sentence: Kendrick....
2025-12-17T10:22:43.082810368Z [err]  2025-12-17 10:22:43,081 - server - INFO - ğŸ“¤ Sentence arrived from LLM: We've helped over seven thousand five hundred stud...
2025-12-17T10:22:43.082816369Z [err]  2025-12-17 10:22:43,081 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:43.082820594Z [err]  2025-12-17 10:22:43,081 - server - INFO - ğŸš€ Streaming sentence #3 via persistent WebSocket
2025-12-17T10:22:43.082824567Z [err]  2025-12-17 10:22:43,081 - server - INFO - ğŸµ TTS task #3 started at +132ms
2025-12-17T10:22:43.082828783Z [err]  2025-12-17 10:22:43,081 - calling_service - INFO - ğŸ“¤ Streamed sentence: We've helped over seven thousand five hundred stud...
2025-12-17T10:22:43.255261543Z [err]  2025-12-17 10:22:43,253 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:43.255267817Z [err]  2025-12-17 10:22:43,254 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+304ms
2025-12-17T10:22:43.255272731Z [err]  2025-12-17 10:22:43,254 - persistent_tts_service - INFO - ğŸ“¤ Sending 12632 bytes of audio (79 chunks, 1.6s duration) via WebSocket
2025-12-17T10:22:43.255277393Z [err]  2025-12-17 10:22:43,254 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:43.255282072Z [err]  2025-12-17 10:22:43,254 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.6s (total: 1.6s from now)
2025-12-17T10:22:43.256724735Z [err]  2025-12-17 10:22:43,255 - persistent_tts_service - INFO - âœ… Sent 79 audio chunks via WebSocket
2025-12-17T10:22:43.681252236Z [err]  2025-12-17 10:22:43,679 - server - INFO - ğŸ“¤ Sentence arrived from LLM: and they share their results in our Facebook group...
2025-12-17T10:22:43.681258859Z [err]  2025-12-17 10:22:43,679 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:43.681263565Z [err]  2025-12-17 10:22:43,679 - server - INFO - ğŸš€ Streaming sentence #4 via persistent WebSocket
2025-12-17T10:22:43.681268167Z [err]  2025-12-17 10:22:43,679 - server - INFO - ğŸµ TTS task #4 started at +730ms
2025-12-17T10:22:43.681272540Z [err]  2025-12-17 10:22:43,679 - calling_service - INFO - ğŸ“¤ Streamed sentence: and they share their results in our Facebook group...
2025-12-17T10:22:43.848182498Z [err]  2025-12-17 10:22:43,846 - server - INFO - ğŸ“¤ Sentence arrived from LLM: What part of the process are you most curious abou...
2025-12-17T10:22:43.848192706Z [err]  2025-12-17 10:22:43,846 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:22:43.848199140Z [err]  2025-12-17 10:22:43,846 - server - INFO - ğŸš€ Streaming sentence #5 via persistent WebSocket
2025-12-17T10:22:43.848204578Z [err]  2025-12-17 10:22:43,846 - server - INFO - ğŸµ TTS task #5 started at +897ms
2025-12-17T10:22:43.848215998Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - ğŸ“¤ Streamed final fragment: What part of the process are you most curious abou...
2025-12-17T10:22:43.848222323Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - â±ï¸ [TIMING] LLM_TOTAL: 1697ms for 248 chars (grok grok-4-fast-non-reasoning)
2025-12-17T10:22:43.848228382Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:22:43.848234707Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:22:43.848240208Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - ğŸ’¾ Storing node ID 1763206946898 in conversation history
2025-12-17T10:22:43.848246379Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - LLM response (1.72s): [N] That's a fair question, Kendrick. We've helped over seven thousand five hundred students get this up and running, and they share their results in our Facebook group. What part of the process are you most curious about to see if it fits for you?
2025-12-17T10:22:43.848252365Z [err]  2025-12-17 10:22:43,846 - calling_service - INFO - Total latency: 1.72s
2025-12-17T10:22:43.848258198Z [err]  2025-12-17 10:22:43,846 - server - INFO - âœ… LLM finished in 1813ms, TTS tasks already running in background
2025-12-17T10:22:43.848971285Z [err]  2025-12-17 10:22:43,846 - server - INFO - ğŸµ Streaming 5 TTS chunks as they complete...
2025-12-17T10:22:43.848979406Z [err]  2025-12-17 10:22:43,846 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:22:43.848989178Z [err]  2025-12-17 10:22:43,846 - server - INFO -    5 sentences queued and playing seamlessly
2025-12-17T10:22:44.845968516Z [err]  2025-12-17 10:22:44,832 - server - INFO - ğŸ“¤ Audio flowing: 2807 packets sent to Soniox (5s update)
2025-12-17T10:22:45.193674014Z [err]  2025-12-17 10:22:45,192 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.4s ago), marking agent as done speaking
2025-12-17T10:22:45.193681619Z [err]  2025-12-17 10:22:45,192 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966965.1922388 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:45.193687783Z [err]  2025-12-17 10:22:45,192 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:45.257656927Z [err]  2025-12-17 10:22:45,255 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:45.257665489Z [err]  2025-12-17 10:22:45,255 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #8: 1 chunks received
2025-12-17T10:22:45.257672825Z [err]  2025-12-17 10:22:45,255 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #9: Kendrick....
2025-12-17T10:22:45.536753921Z [err]  2025-12-17 10:22:45,525 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:45.536758218Z [err]  2025-12-17 10:22:45,525 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+270ms
2025-12-17T10:22:45.536762327Z [err]  2025-12-17 10:22:45,526 - persistent_tts_service - INFO - ğŸ“¤ Sending 6316 bytes of audio (40 chunks, 0.8s duration) via WebSocket
2025-12-17T10:22:45.536766572Z [err]  2025-12-17 10:22:45,526 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:45.536772206Z [err]  2025-12-17 10:22:45,526 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2025-12-17T10:22:45.536776994Z [err]  2025-12-17 10:22:45,527 - persistent_tts_service - INFO - âœ… Sent 40 audio chunks via WebSocket
2025-12-17T10:22:45.694939521Z [err]  2025-12-17 10:22:45,694 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (0.6s left)
2025-12-17T10:22:46.240351694Z [err]  2025-12-17 10:22:46,238 - server - INFO - ğŸ”¤ RAW TOKENS: [" Ban"?]
2025-12-17T10:22:46.240358359Z [err]  2025-12-17 10:22:46,239 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:46.240364198Z [err]  2025-12-17 10:22:46,239 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:22:46.240368469Z [err]  2025-12-17 10:22:46,239 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:46.240373448Z [err]  2025-12-17 10:22:46,239 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Ban' | Generating: True
2025-12-17T10:22:46.240379309Z [err]  2025-12-17 10:22:46,239 - server - INFO - ğŸš¦ BARGE-IN CHECK during response generation: 1 words - 'Ban'
2025-12-17T10:22:46.653047732Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ”¤ RAW TOKENS: [" Ban"âœ“, "ana."âœ“, "<end>"âœ“]
2025-12-17T10:22:46.653055625Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:22:46.653060665Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ§¹ Cleaned transcript: ' Ban ana.' -> 'Ban ana.'
2025-12-17T10:22:46.653066901Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Ban ana.' (2 tokens)
2025-12-17T10:22:46.653071658Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ¤ Soniox final transcript: 'Ban ana.'
2025-12-17T10:22:46.653076519Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ¯ User speaking while TTS is_speaking=True - INTERRUPTION POSSIBLE
2025-12-17T10:22:46.653082940Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ” FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=True, time_until_done=-0.3s, generating=True, playbacks=0, is_active=True
2025-12-17T10:22:46.653088924Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ”• FILTERING 2-word/filler 'Ban ana.' - NOT calling on_final_transcript
2025-12-17T10:22:46.653096064Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ”• SKIPPING endpoint for 2-word/filler 'Ban ana.' (tts_speaking=True, is_active=True)
2025-12-17T10:22:46.653102879Z [err]  2025-12-17 10:22:46,651 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:46.653108993Z [err]  2025-12-17 10:22:46,651 - server - INFO - ğŸ‘¤ Marked user stopped speaking (filtered utterance)
2025-12-17T10:22:47.528191415Z [err]  2025-12-17 10:22:47,526 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:47.528197274Z [err]  2025-12-17 10:22:47,526 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #9: 1 chunks received
2025-12-17T10:22:47.528202390Z [err]  2025-12-17 10:22:47,526 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #10: We've helped over seven thousand five hundred stud...
2025-12-17T10:22:47.861882123Z [err]  2025-12-17 10:22:47,857 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:47.861887446Z [err]  2025-12-17 10:22:47,858 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+331ms
2025-12-17T10:22:47.861892540Z [err]  2025-12-17 10:22:47,858 - persistent_tts_service - INFO - ğŸ“¤ Sending 11145 bytes of audio (70 chunks, 1.4s duration) via WebSocket
2025-12-17T10:22:47.861898698Z [err]  2025-12-17 10:22:47,858 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:47.861902867Z [err]  2025-12-17 10:22:47,858 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.4s (total: 1.4s from now)
2025-12-17T10:22:47.861907189Z [err]  2025-12-17 10:22:47,859 - persistent_tts_service - INFO - âœ… Sent 70 audio chunks via WebSocket
2025-12-17T10:22:48.046172775Z [err]  2025-12-17 10:22:48,044 - persistent_tts_service - INFO - ğŸ“¤ Sending 22291 bytes of audio (140 chunks, 2.8s duration) via WebSocket
2025-12-17T10:22:48.046180845Z [err]  2025-12-17 10:22:48,044 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:48.046187372Z [err]  2025-12-17 10:22:48,044 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.8s (total: 4.0s from now)
2025-12-17T10:22:48.047972365Z [err]  2025-12-17 10:22:48,045 - persistent_tts_service - INFO - âœ… Sent 140 audio chunks via WebSocket
2025-12-17T10:22:49.856440425Z [err]  2025-12-17 10:22:49,849 - server - INFO - ğŸ“¤ Audio flowing: 3058 packets sent to Soniox (5s update)
2025-12-17T10:22:50.051671599Z [err]  2025-12-17 10:22:50,045 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:50.051678189Z [err]  2025-12-17 10:22:50,045 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #10: 2 chunks received
2025-12-17T10:22:50.051683532Z [err]  2025-12-17 10:22:50,045 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #11: and they share their results in our Facebook group...
2025-12-17T10:22:50.267875550Z [err]  2025-12-17 10:22:50,224 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (1.8s left)
2025-12-17T10:22:50.602848279Z [err]  2025-12-17 10:22:50,370 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:50.602852669Z [err]  2025-12-17 10:22:50,370 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+325ms
2025-12-17T10:22:50.602857971Z [err]  2025-12-17 10:22:50,370 - persistent_tts_service - INFO - ğŸ“¤ Sending 8545 bytes of audio (54 chunks, 1.1s duration) via WebSocket
2025-12-17T10:22:50.602863114Z [err]  2025-12-17 10:22:50,370 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:50.602868084Z [err]  2025-12-17 10:22:50,370 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.1s (total: 2.7s from now)
2025-12-17T10:22:50.602872490Z [err]  2025-12-17 10:22:50,371 - persistent_tts_service - INFO - âœ… Sent 54 audio chunks via WebSocket
2025-12-17T10:22:50.602876814Z [err]  2025-12-17 10:22:50,547 - persistent_tts_service - INFO - ğŸ“¤ Sending 12260 bytes of audio (77 chunks, 1.5s duration) via WebSocket
2025-12-17T10:22:50.602881755Z [err]  2025-12-17 10:22:50,547 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:50.602886506Z [err]  2025-12-17 10:22:50,547 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.5s (total: 4.1s from now)
2025-12-17T10:22:50.602890918Z [err]  2025-12-17 10:22:50,548 - persistent_tts_service - INFO - âœ… Sent 77 audio chunks via WebSocket
2025-12-17T10:22:50.726409896Z [err]  2025-12-17 10:22:50,725 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (3.9s left)
2025-12-17T10:22:51.996640806Z [err]  2025-12-17 10:22:51,992 - server - INFO - ğŸ¤ Soniox receiver alive - 11 messages received in last 10s
2025-12-17T10:22:52.569936045Z [err]  2025-12-17 10:22:52,547 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:52.569948531Z [err]  2025-12-17 10:22:52,547 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #11: 2 chunks received
2025-12-17T10:22:52.569957899Z [err]  2025-12-17 10:22:52,547 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #12: What part of the process are you most curious abou...
2025-12-17T10:22:52.867121324Z [err]  2025-12-17 10:22:52,866 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:22:52.867129563Z [err]  2025-12-17 10:22:52,866 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+318ms
2025-12-17T10:22:52.867134758Z [err]  2025-12-17 10:22:52,866 - persistent_tts_service - INFO - ğŸ“¤ Sending 10774 bytes of audio (68 chunks, 1.3s duration) via WebSocket
2025-12-17T10:22:52.867140096Z [err]  2025-12-17 10:22:52,866 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:52.867145821Z [err]  2025-12-17 10:22:52,866 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.3s (total: 3.1s from now)
2025-12-17T10:22:52.868030253Z [err]  2025-12-17 10:22:52,867 - persistent_tts_service - INFO - âœ… Sent 68 audio chunks via WebSocket
2025-12-17T10:22:53.066784779Z [err]  2025-12-17 10:22:53,061 - persistent_tts_service - INFO - ğŸ“¤ Sending 22663 bytes of audio (142 chunks, 2.8s duration) via WebSocket
2025-12-17T10:22:53.066791436Z [err]  2025-12-17 10:22:53,061 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:22:53.066796158Z [err]  2025-12-17 10:22:53,061 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.8s (total: 5.8s from now)
2025-12-17T10:22:53.066800768Z [err]  2025-12-17 10:22:53,063 - persistent_tts_service - INFO - âœ… Sent 142 audio chunks via WebSocket
2025-12-17T10:22:54.872945172Z [err]  2025-12-17 10:22:54,869 - server - INFO - ğŸ“¤ Audio flowing: 3309 packets sent to Soniox (5s update)
2025-12-17T10:22:55.081124394Z [err]  2025-12-17 10:22:55,061 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:22:55.081132941Z [err]  2025-12-17 10:22:55,061 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #12: 2 chunks received
2025-12-17T10:22:55.081138336Z [err]  2025-12-17 10:22:55,061 - server - INFO - âœ… All 5 persistent TTS streams completed
2025-12-17T10:22:55.081144144Z [err]  2025-12-17 10:22:55,062 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:22:55.081148944Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 13029ms from user stop ğŸš€
2025-12-17T10:22:55.081153558Z [err]  2025-12-17 10:22:55,062 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:55.081157866Z [err]  2025-12-17 10:22:55,062 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:22:55.081162233Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:55.081166319Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:22:55.081172917Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] STT: 3ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:22:55.081177702Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 1813ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:22:55.081181874Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 12112ms (provider: elevenlabs, websocket: False)
2025-12-17T10:22:55.081185911Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 13029ms (user stopped â†’ play_audio_url called)
2025-12-17T10:22:55.081205114Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:22:55.081210029Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:22:55.081214166Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:22:55.081218718Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:22:55.081222720Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:22:55.081227498Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 13329ms estimated
2025-12-17T10:22:55.081231152Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 248 chars, 5 sentences
2025-12-17T10:22:55.081235047Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Um, how do I know this works?...'
2025-12-17T10:22:55.081239567Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: '[N] That's a fair question, Kendrick. We've helped over seve...'
2025-12-17T10:22:55.081243521Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:22:55.081248160Z [err]  2025-12-17 10:22:55,062 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:22:55.252318369Z [err]  2025-12-17 10:22:55,250 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (3.6s left)
2025-12-17T10:22:55.264756260Z [err]  2025-12-17 10:22:55,261 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive, Dead Air: 2316ms)
2025-12-17T10:22:55.264765770Z [err]  2025-12-17 10:22:55,261 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:22:55.757491006Z [err]  2025-12-17 10:22:55,756 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (3.1s left)
2025-12-17T10:22:58.950977273Z [err]  2025-12-17 10:22:58,948 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:22:59.295182877Z [err]  2025-12-17 10:22:59,290 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.5s ago), marking agent as done speaking
2025-12-17T10:22:59.295191972Z [err]  2025-12-17 10:22:59,291 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966979.2910113 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:59.295196767Z [err]  2025-12-17 10:22:59,291 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:22:59.872676011Z [err]  2025-12-17 10:22:59,870 - server - INFO - ğŸ“¤ Audio flowing: 3559 packets sent to Soniox (5s update)
2025-12-17T10:23:00.301839008Z [err]  2025-12-17 10:23:00,295 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=0/2
2025-12-17T10:23:00.798535450Z [err]  2025-12-17 10:23:00,796 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=1.5s, checkin_count=0/2
2025-12-17T10:23:02.031664784Z [err]  2025-12-17 10:23:02,012 - server - INFO - ğŸ¤ Soniox receiver alive - 10 messages received in last 10s
2025-12-17T10:23:02.031671313Z [err]  2025-12-17 10:23:02,012 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?]
2025-12-17T10:23:02.031676287Z [err]  2025-12-17 10:23:02,012 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:02.031680670Z [err]  2025-12-17 10:23:02,012 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:23:02.031685844Z [err]  2025-12-17 10:23:02,012 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:02.031691761Z [err]  2025-12-17 10:23:02,012 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'U' | Generating: False
2025-12-17T10:23:02.093202827Z [err]  2025-12-17 10:23:02,073 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?]
2025-12-17T10:23:02.093212240Z [err]  2025-12-17 10:23:02,074 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um,' | Generating: False
2025-12-17T10:23:03.029114940Z [err]  2025-12-17 10:23:03,026 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?]
2025-12-17T10:23:03.029121533Z [err]  2025-12-17 10:23:03,027 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, wh' | Generating: False
2025-12-17T10:23:03.233477887Z [err]  2025-12-17 10:23:03,229 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at"?]
2025-12-17T10:23:03.233484561Z [err]  2025-12-17 10:23:03,230 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what' | Generating: False
2025-12-17T10:23:03.672876317Z [err]  2025-12-17 10:23:03,420 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?]
2025-12-17T10:23:03.672883022Z [err]  2025-12-17 10:23:03,420 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh,' | Generating: False
2025-12-17T10:23:03.672887651Z [err]  2025-12-17 10:23:03,528 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?]
2025-12-17T10:23:03.672892622Z [err]  2025-12-17 10:23:03,528 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how' | Generating: False
2025-12-17T10:23:03.773201549Z [err]  2025-12-17 10:23:03,771 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?]
2025-12-17T10:23:03.777243419Z [err]  2025-12-17 10:23:03,772 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, lik' | Generating: False
2025-12-17T10:23:03.916489740Z [err]  2025-12-17 10:23:03,914 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?]
2025-12-17T10:23:03.916496298Z [err]  2025-12-17 10:23:03,914 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like,' | Generating: False
2025-12-17T10:23:03.971866186Z [err]  2025-12-17 10:23:03,970 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?]
2025-12-17T10:23:03.971877369Z [err]  2025-12-17 10:23:03,970 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how' | Generating: False
2025-12-17T10:23:04.110545798Z [err]  2025-12-17 10:23:04,103 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?]
2025-12-17T10:23:04.110551935Z [err]  2025-12-17 10:23:04,103 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do' | Generating: False
2025-12-17T10:23:04.248387811Z [err]  2025-12-17 10:23:04,246 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?]
2025-12-17T10:23:04.248393291Z [err]  2025-12-17 10:23:04,246 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I' | Generating: False
2025-12-17T10:23:04.638984418Z [err]  2025-12-17 10:23:04,373 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?]
2025-12-17T10:23:04.638990047Z [err]  2025-12-17 10:23:04,373 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get' | Generating: False
2025-12-17T10:23:04.893406713Z [err]  2025-12-17 10:23:04,889 - server - INFO - ğŸ“¤ Audio flowing: 3810 packets sent to Soniox (5s update)
2025-12-17T10:23:05.053717885Z [err]  2025-12-17 10:23:05,052 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?]
2025-12-17T10:23:05.053723525Z [err]  2025-12-17 10:23:05,052 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac' | Generating: False
2025-12-17T10:23:05.214393590Z [err]  2025-12-17 10:23:05,211 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?]
2025-12-17T10:23:05.214406232Z [err]  2025-12-17 10:23:05,212 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess' | Generating: False
2025-12-17T10:23:05.619787684Z [err]  2025-12-17 10:23:05,434 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?]
2025-12-17T10:23:05.619793021Z [err]  2025-12-17 10:23:05,435 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to' | Generating: False
2025-12-17T10:23:05.703914965Z [err]  2025-12-17 10:23:05,692 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?]
2025-12-17T10:23:05.703920944Z [err]  2025-12-17 10:23:05,692 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to,' | Generating: False
2025-12-17T10:23:05.842005600Z [err]  2025-12-17 10:23:05,838 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?]
2025-12-17T10:23:05.842012570Z [err]  2025-12-17 10:23:05,839 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, lik' | Generating: False
2025-12-17T10:23:05.901077307Z [err]  2025-12-17 10:23:05,899 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?]
2025-12-17T10:23:05.901082340Z [err]  2025-12-17 10:23:05,900 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, like,' | Generating: False
2025-12-17T10:23:06.171808802Z [err]  2025-12-17 10:23:06,168 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?]
2025-12-17T10:23:06.171815172Z [err]  2025-12-17 10:23:06,169 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, like, the' | Generating: False
2025-12-17T10:23:06.280710097Z [err]  2025-12-17 10:23:06,279 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?]
2025-12-17T10:23:06.280715983Z [err]  2025-12-17 10:23:06,279 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, like, the Face' | Generating: False
2025-12-17T10:23:06.677005035Z [err]  2025-12-17 10:23:06,398 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?]
2025-12-17T10:23:06.677010478Z [err]  2025-12-17 10:23:06,398 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, like, the Face book' | Generating: False
2025-12-17T10:23:06.677016082Z [err]  2025-12-17 10:23:06,655 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?]
2025-12-17T10:23:06.677024213Z [err]  2025-12-17 10:23:06,655 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, like, the Face book group' | Generating: False
2025-12-17T10:23:06.851220623Z [err]  2025-12-17 10:23:06,847 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"?, "m,"?, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?]
2025-12-17T10:23:06.851228287Z [err]  2025-12-17 10:23:06,848 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'Um, what, Uh, how, like, how do I get ac cess to, like, the Face book group to' | Generating: False
2025-12-17T10:23:06.978365176Z [err]  2025-12-17 10:23:06,977 - server - INFO - ğŸ”¤ RAW TOKENS: [" U"âœ“, "m,"âœ“, " wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?]
2025-12-17T10:23:06.980210102Z [err]  2025-12-17 10:23:06,978 - server - INFO - ğŸ§¹ Cleaned transcript: ' U m,' -> 'Um,'
2025-12-17T10:23:06.980216896Z [err]  2025-12-17 10:23:06,978 - server - INFO - ğŸ“¥ FINAL TOKENS: 'Um,' (2 tokens)
2025-12-17T10:23:06.980222633Z [err]  2025-12-17 10:23:06,978 - server - INFO - ğŸ¤ Soniox final transcript: 'Um,'
2025-12-17T10:23:06.980228082Z [err]  2025-12-17 10:23:06,978 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:23:06.980233221Z [err]  2025-12-17 10:23:06,978 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to' | Generating: False
2025-12-17T10:23:06.980238296Z [err]  2025-12-17 10:23:06,978 - server - INFO - â±ï¸ [10:23:06.978] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'Um,'
2025-12-17T10:23:06.980243550Z [err]  2025-12-17 10:23:06,978 - server - INFO - â±ï¸ [10:23:06.978] STT endpoint detection latency: 8ms
2025-12-17T10:23:06.980248717Z [err]  2025-12-17 10:23:06,978 - server - INFO - â±ï¸ [10:23:06.978] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:23:06.981609339Z [err]  2025-12-17 10:23:06,979 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:23:06.981617186Z [err]  2025-12-17 10:23:06,979 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:23:06.981624330Z [err]  2025-12-17 10:23:06,979 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'Um,' - Processing...
2025-12-17T10:23:07.612888375Z [err]  2025-12-17 10:23:07,610 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?]
2025-12-17T10:23:07.612897809Z [err]  2025-12-17 10:23:07,611 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to,' | Generating: False
2025-12-17T10:23:07.762911143Z [err]  2025-12-17 10:23:07,761 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?]
2025-12-17T10:23:07.762916391Z [err]  2025-12-17 10:23:07,762 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to, y' | Generating: False
2025-12-17T10:23:07.831075108Z [err]  2025-12-17 10:23:07,829 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?]
2025-12-17T10:23:07.833469934Z [err]  2025-12-17 10:23:07,831 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to, you kn' | Generating: False
2025-12-17T10:23:07.938262602Z [err]  2025-12-17 10:23:07,932 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?, "ow,"?]
2025-12-17T10:23:07.938274498Z [err]  2025-12-17 10:23:07,932 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to, you know,' | Generating: False
2025-12-17T10:23:08.200695384Z [err]  2025-12-17 10:23:08,195 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?, "ow,"?, " che"?]
2025-12-17T10:23:08.200701876Z [err]  2025-12-17 10:23:08,196 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to, you know, che' | Generating: False
2025-12-17T10:23:08.312944591Z [err]  2025-12-17 10:23:08,304 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?, "ow,"?, " che"?, "ck"?]
2025-12-17T10:23:08.312950707Z [err]  2025-12-17 10:23:08,304 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to, you know, che ck' | Generating: False
2025-12-17T10:23:08.719453491Z [err]  2025-12-17 10:23:08,717 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"?, "at,"?, " u"?, "h,"?, " how"?, ","?, " lik"?, "e,"?, " how"?, " do"?, " I"?, " get"?, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?, "ow,"?, " che"?, "ck"?, " this"?]
2025-12-17T10:23:08.719463551Z [err]  2025-12-17 10:23:08,717 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'what, Uh, how, like, how do I get ac cess to, like, the Face book group to, you know, che ckthis' | Generating: False
2025-12-17T10:23:09.034874544Z [err]  2025-12-17 10:23:09,031 - server - INFO - ğŸ”¤ RAW TOKENS: [" wh"âœ“, "at,"âœ“, " u"âœ“, "h,"âœ“, " how"âœ“, ","âœ“, " lik"âœ“, "e,"âœ“, " how"âœ“, " do"âœ“, " I"âœ“, " get"âœ“, " ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?, "ow,"?, " che"?, "ck"?, " this"?]
2025-12-17T10:23:09.034883935Z [err]  2025-12-17 10:23:09,031 - server - INFO - ğŸ§¹ Cleaned transcript: ' wh at,  u h,  how ,  lik e,  how  do  I  get' -> 'what, Uh, how, like, how do I get'
2025-12-17T10:23:09.034890734Z [err]  2025-12-17 10:23:09,032 - server - INFO - ğŸ“¥ FINAL TOKENS: 'what, Uh, how, like, how do I get' (12 tokens)
2025-12-17T10:23:09.034896045Z [err]  2025-12-17 10:23:09,032 - server - INFO - ğŸ¤ Soniox final transcript: 'what, Uh, how, like, how do I get'
2025-12-17T10:23:09.034901978Z [err]  2025-12-17 10:23:09,032 - server - INFO - ğŸ” FILTER CHECK: words=8, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:23:09.034907745Z [err]  2025-12-17 10:23:09,032 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'ac cess to, like, the Face book group to, you know, che ckthis' | Generating: False
2025-12-17T10:23:09.034912852Z [err]  2025-12-17 10:23:09,032 - server - INFO - â±ï¸ [10:23:09.032] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'what, Uh, how, like, how do I get'
2025-12-17T10:23:09.034918315Z [err]  2025-12-17 10:23:09,032 - server - INFO - â±ï¸ [10:23:09.032] STT endpoint detection latency: 2ms
2025-12-17T10:23:09.034923853Z [err]  2025-12-17 10:23:09,032 - server - INFO - â±ï¸ [10:23:09.032] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:23:09.034929642Z [err]  2025-12-17 10:23:09,033 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:23:09.034934735Z [err]  2025-12-17 10:23:09,033 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:23:09.035986804Z [err]  2025-12-17 10:23:09,033 - server - INFO - âœ… Agent SILENT - User said 8 word(s): 'Um,what, Uh, how, like, how do I get' - Processing...
2025-12-17T10:23:09.893484248Z [err]  2025-12-17 10:23:09,891 - server - INFO - ğŸ“¤ Audio flowing: 4060 packets sent to Soniox (5s update)
2025-12-17T10:23:10.111007817Z [err]  2025-12-17 10:23:10,109 - server - INFO - ğŸ”¤ RAW TOKENS: [" ac"?, "cess"?, " to"?, ","?, " lik"?, "e,"?, " the"?, " Face"?, "book"?, " group"?, " to"?, ","?, " y"?, "ou"?, " kn"?, "ow,"?, " che"?, "ck"?, " this"?]
2025-12-17T10:23:10.113205703Z [err]  2025-12-17 10:23:10,110 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'ac cess to, like, the Face book group to, you know, che ckthis' | Generating: False
2025-12-17T10:23:10.667643272Z [err]  2025-12-17 10:23:10,347 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=True, silence=0.0s, checkin_count=0/2
2025-12-17T10:23:10.685444110Z [err]  2025-12-17 10:23:10,682 - server - INFO - ğŸ”¤ RAW TOKENS: [" ac"âœ“, "cess"âœ“, " to"âœ“, ","âœ“, " lik"âœ“, "e,"âœ“, " the"âœ“, " Face"âœ“, "book"âœ“, " group"âœ“, " to"âœ“, ","âœ“, " y"âœ“, "ou"âœ“, " kn"âœ“, "ow,"âœ“, " che"âœ“, "ck"âœ“, " this"âœ“]
2025-12-17T10:23:10.685452190Z [err]  2025-12-17 10:23:10,683 - server - INFO - ğŸ§¹ Cleaned transcript: ' ac cess  to ,  lik e,  the  Face book  group  to ,  y ou  kn ow,  che ck  this' -> 'ac cess to, like, the Face book group to, you know, che ckthis'
2025-12-17T10:23:10.685457483Z [err]  2025-12-17 10:23:10,683 - server - INFO - ğŸ“¥ FINAL TOKENS: 'ac cess to, like, the Face book group to, you know, che ckthis' (19 tokens)
2025-12-17T10:23:10.685462079Z [err]  2025-12-17 10:23:10,683 - server - INFO - ğŸ¤ Soniox final transcript: 'ac cess to, like, the Face book group to, you know, che ckthis'
2025-12-17T10:23:10.685466693Z [err]  2025-12-17 10:23:10,683 - server - INFO - ğŸ” FILTER CHECK: words=13, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:23:10.685471153Z [err]  2025-12-17 10:23:10,683 - server - INFO - â±ï¸ [10:23:10.683] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'ac cess to, like, the Face book group to, you know, che ckthis'
2025-12-17T10:23:10.685476114Z [err]  2025-12-17 10:23:10,683 - server - INFO - â±ï¸ [10:23:10.683] STT endpoint detection latency: 13ms
2025-12-17T10:23:10.685480565Z [err]  2025-12-17 10:23:10,683 - server - INFO - â±ï¸ [10:23:10.683] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:23:10.687392978Z [err]  2025-12-17 10:23:10,685 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:23:10.687399274Z [err]  2025-12-17 10:23:10,685 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:23:10.687403407Z [err]  2025-12-17 10:23:10,685 - server - INFO - âœ… Agent SILENT - User said 20 word(s): 'Um,what, Uh, how, like, how do I getac cess to, like, the Face book group to, you know, che ckthis' - Processing...
2025-12-17T10:23:10.688388426Z [err]  2025-12-17 10:23:10,686 - server - INFO - ğŸ”¤ RAW TOKENS: ["<end>"âœ“]
2025-12-17T10:23:10.688393644Z [err]  2025-12-17 10:23:10,686 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:23:10.688397667Z [err]  2025-12-17 10:23:10,686 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:23:10.698583483Z [err]  2025-12-17 10:23:10,697 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: Um,what, Uh, how, like, how do I getac cess to, like, the Face book group to, you know, che ckthis
2025-12-17T10:23:10.698589680Z [err]  2025-12-17 10:23:10,697 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:10.698595571Z [err]  2025-12-17 10:23:10,697 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:23:10.698600615Z [err]  2025-12-17 10:23:10,697 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:23:10.698605164Z [err]  2025-12-17 10:23:10,697 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+7ms
2025-12-17T10:23:10.698612655Z [err]  2025-12-17 10:23:10,697 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 7ms (Soniox model: stt-rt-v3)
2025-12-17T10:23:10.698618048Z [err]  2025-12-17 10:23:10,697 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:23:10.698622905Z [err]  2025-12-17 10:23:10,697 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:23:10.698627619Z [err]  2025-12-17 10:23:10,697 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:10.799588205Z [err]  2025-12-17 10:23:10,792 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:23:10.799593794Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - â±ï¸ [10:23:10.792] ğŸ“¥ process_user_input() ENTRY - text: 'Um,what, Uh, how, like, how do I getac cess to, li...'
2025-12-17T10:23:10.799598650Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - â±ï¸ [10:23:10.793] â© About to call _process_call_flow_streaming()
2025-12-17T10:23:10.799603765Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - â±ï¸ [10:23:10.793] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:23:10.799608319Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - â±ï¸ [10:23:10.793] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:23:10.799612761Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - Flow processing - History length: 11, Is first: False
2025-12-17T10:23:10.799617794Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763206946898
2025-12-17T10:23:10.799623132Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - ğŸ” PRE-TRANSITION: Extracting mandatory vars on CURRENT node N_KB_Q&A_With_StrategicNarrative_V3_Adaptive before transition
2025-12-17T10:23:10.799628163Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - ğŸ” Real-time extraction: Processing 2 variables
2025-12-17T10:23:10.799634125Z [err]  2025-12-17 10:23:10,793 - calling_service - INFO - ğŸ¤– Using configured LLM provider: grok (grok-4-fast-non-reasoning) for extraction
2025-12-17T10:23:10.858500516Z [err]  2025-12-17 10:23:10,851 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=True, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:23:11.148787762Z [err]  2025-12-17 10:23:11,147 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:23:11.150800770Z [err]  2025-12-17 10:23:11,148 - calling_service - INFO -   âœ“ has_discussed_income_potential: False (extracted in real-time)
2025-12-17T10:23:11.150806968Z [err]  2025-12-17 10:23:11,148 - calling_service - INFO -   âœ“ asked_upset: False (extracted in real-time)
2025-12-17T10:23:11.150812201Z [err]  2025-12-17 10:23:11,148 - calling_service - INFO - âœ… Real-time extraction complete: 2 variables
2025-12-17T10:23:11.150816688Z [err]  2025-12-17 10:23:11,148 - calling_service - INFO - âœ… PRE-TRANSITION: All mandatory vars satisfied on N_KB_Q&A_With_StrategicNarrative_V3_Adaptive - proceeding with transition
2025-12-17T10:23:11.150823155Z [err]  2025-12-17 10:23:11,148 - calling_service - INFO - â±ï¸ [10:23:11.148] ğŸ”€ About to call _follow_transition() for: Um,what, Uh, how, like, how do...
2025-12-17T10:23:11.150824528Z [err]  2025-12-17 10:23:11,148 - calling_service - INFO - Evaluating transitions from N_KB_Q&A_With_StrategicNarrative_V3_Adaptive for message: Um,what, Uh, how, like, how do I getac cess to, like, the Face book group to, you know, che ckthis
2025-12-17T10:23:11.159586213Z [err]  2025-12-17 10:23:11,156 - calling_service - INFO - â±ï¸ [10:23:11.156] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 1 options
2025-12-17T10:23:11.682337955Z [err]  2025-12-17 10:23:11,680 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:23:11.687810833Z [err]  2025-12-17 10:23:11,681 - calling_service - INFO - â±ï¸ [10:23:11.681] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 525ms
2025-12-17T10:23:11.687815496Z [err]  2025-12-17 10:23:11,681 - calling_service - INFO - ğŸ¤– AI transition decision: '-1'
2025-12-17T10:23:11.687821028Z [err]  2025-12-17 10:23:11,681 - calling_service - INFO - ğŸ“Š Available transitions: ['...would you honestly be upset if you had an extra...']
2025-12-17T10:23:11.687826948Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - Selected transition index: -1
2025-12-17T10:23:11.687832641Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-17T10:23:11.687838539Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - âš ï¸ No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-17T10:23:11.689630386Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ¯ Goal: Determine what has already been done in this node by being aware of the conversation context and the...
2025-12-17T10:23:11.689638951Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 533ms
2025-12-17T10:23:11.689644278Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - â±ï¸ [10:23:11.682] âœ… Node selected, about to process content...
2025-12-17T10:23:11.689649128Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:23 AM EST in content
2025-12-17T10:23:11.689654058Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:23:11.689659903Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:23:11.689665838Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - Using flow node: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive (type: conversation, mode: prompt)
2025-12-17T10:23:11.689667628Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:23:11.689676618Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:23:11.689683146Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - â±ï¸ [10:23:11.682] ğŸ“„ About to process content (mode=prompt, length=4560)
2025-12-17T10:23:11.689693542Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:23:11.689699046Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:23:11.689705032Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:23:11.689710405Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:23:11.689715643Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:23:11.689720387Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:23:11.689724993Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{has_discussed_income_potential}} with False in content
2025-12-17T10:23:11.689729411Z [err]  2025-12-17 10:23:11,682 - calling_service - INFO - ğŸ”§ Replaced {{asked_upset}} with False in content
2025-12-17T10:23:11.691450850Z [err]  2025-12-17 10:23:11,689 - calling_service - INFO - âš¡ PARALLEL MODE: Running KB + analysis simultaneously
2025-12-17T10:23:11.691455640Z [err]  2025-12-17 10:23:11,690 - kb_router - INFO - ğŸš¦ KB Router: USE KB (default for medium/long message)
2025-12-17T10:23:11.691459968Z [err]  2025-12-17 10:23:11,690 - rag_service - INFO - ğŸ“Š Dynamic top_k: 5 (complex query: 20 words, 2 questions, 0 topics)
2025-12-17T10:23:11.692789485Z [err]  2025-12-17 10:23:11,691 - rag_service - WARNING - âš ï¸ ChromaDB collection not found for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb: Collection [kb_667cedd4] does not exist
2025-12-17T10:23:11.692796950Z [err]  2025-12-17 10:23:11,691 - rag_service - INFO - ğŸ“š ChromaDB: No chunks above threshold 0.35
2025-12-17T10:23:11.692796952Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - â±ï¸ [10:23:11.692] ğŸ’¬ LLM REQUEST START: 11 conversation turns, 11478 system chars (KB cached)
2025-12-17T10:23:11.692801658Z [err]  2025-12-17 10:23:11,691 - calling_service - INFO - âš¡ ChromaDB empty, falling back to MongoDB retrieval
2025-12-17T10:23:11.692805939Z [err]  2025-12-17 10:23:11,691 - rag_service - ERROR - âŒ Error retrieving KB chunks: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-12-17T10:23:11.692810597Z [err]  Traceback (most recent call last):
2025-12-17T10:23:11.692814621Z [err]    File "/app/backend/rag_service.py", line 236, in retrieve_relevant_chunks_by_agent
2025-12-17T10:23:11.692818857Z [err]      if not db:
2025-12-17T10:23:11.692823142Z [err]    File "/root/.local/lib/python3.11/site-packages/pymongo/database.py", line 1339, in __bool__
2025-12-17T10:23:11.692828234Z [err]      raise NotImplementedError(
2025-12-17T10:23:11.692832815Z [err]  NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-12-17T10:23:11.692836846Z [err]  2025-12-17 10:23:11,691 - calling_service - INFO - âš¡ Parallel operations completed in 1ms
2025-12-17T10:23:11.692841317Z [err]  2025-12-17 10:23:11,691 - calling_service - INFO - ğŸ” Node 'N_KB_Q&A_With_StrategicNarrative_V3_Adaptive': use_parallel_llm=True
2025-12-17T10:23:11.692845630Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - âš¡ Parallel mode: Using condensed history (10/11 messages)
2025-12-17T10:23:11.694208101Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â• LLM PROMPT BREAKDOWN â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:11.694214770Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“ [SYSTEM MSG 1 - GLOBAL PROMPT] (5826 chars):
2025-12-17T10:23:11.694216092Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:23:11.694219653Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-17T10:23:11.694224508Z [err]  
2025-12-17T10:23:11.694228949Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-17T10:23:11.694234355Z [err]  
2025-12-17T10:23:11.694238975Z [err]  If user says a name, don't assume it's theirsâ€”wait for explicit correction.
2025-12-17T10:23:11.694243328Z [err]  
2025-12-17T10:23:11.694247822Z [err]  If user asks to repeat info, rephrase naturallyâ€”never exact repeat.
2025-12-17T10:23:11.694252070Z [err]  
2025-12-17T10:23:11.694256936Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-17T10:23:11.694261386Z [err]  
2025-12-17T10:23:11.694266138Z [err]  If asked about call number: "Company number."
2025-12-17T10:23:11.694270124Z [err]  
2025-12-17T10:23:11.694274603Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-17T10:23:11.694278722Z [err]  
2025-12-17T10:23:11.694283022Z [err]  If explaining ends in peri...
2025-12-17T10:23:11.694288639Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“ [SYSTEM MSG 2 - DYNAMIC CONTEXT] (5652 chars):
2025-12-17T10:23:11.694292503Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“   Preview: 
2025-12-17T10:23:11.694296383Z [err]  
2025-12-17T10:23:11.697665476Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-17T10:23:11.697671439Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:23:11.697677532Z [err]  
2025-12-17T10:23:11.697682349Z [err]  USER COMMUNICATION STYLE: C type - adjust your response accordingly
2025-12-17T10:23:11.697686549Z [err]  Customer: Kendrick
2025-12-17T10:23:11.697687138Z [err]  CONVERSATION STATUS: Turn 6, objection handling phase
2025-12-17T10:23:11.697692281Z [err]  
2025-12-17T10:23:11.697697499Z [err]  Variables: {"now": "Wednesday, December 17, 2025 at 5:23 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment...
2025-12-17T10:23:11.697698012Z [err]  This context is provided to help you focus. You still need to:
2025-12-17T10:23:11.697702717Z [err]  1. Generate a natural, contextual response
2025-12-17T10:23:11.697707787Z [err]  2. Evaluate transitions per your node instructions
2025-12-17T10:23:11.697708869Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“ [CONVERSATION HISTORY] (10 messages)
2025-12-17T10:23:11.697712395Z [err]  
2025-12-17T10:23:11.697718728Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“   assistant: [N] That's a fair question, Kendrick. We've helped over seven thousand five hundred students get thi...
2025-12-17T10:23:11.697719063Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:23:11.697726228Z [err]  
2025-12-17T10:23:11.697728768Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“   user: Um,what, Uh, how, like, how do I getac cess to, like, the Face book group to, you know, che ckthis...
2025-12-17T10:23:11.697731275Z [err]  # CURRENT CONTEXT
2025-12-17T10:23:11.699774565Z [err]  2025-12-17 10:23:11,692 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:12.049639684Z [err]  2025-12-17 10:23:12,042 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:23:12.295141037Z [err]  2025-12-17 10:23:12,283 - calling_service - INFO - â±ï¸ [10:23:12.283] ğŸ’¬ LLM FIRST TOKEN: 591ms (grok grok-4-fast-non-reasoning)
2025-12-17T10:23:12.330646237Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸ“¤ Sentence arrived from LLM: [N] Great question,...
2025-12-17T10:23:12.330650538Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:23:12.330655223Z [err]  2025-12-17 10:23:12,328 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 1630ms
2025-12-17T10:23:12.330661287Z [err]  2025-12-17 10:23:12,328 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:23:12.330662565Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸµ TTS task #2 started at +0ms
2025-12-17T10:23:12.330668335Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:12.330673669Z [err]  2025-12-17 10:23:12,328 - calling_service - INFO - ğŸ“¤ Streamed sentence: Kendrick....
2025-12-17T10:23:12.330673726Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:23:12.330680344Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:23:12.330682417Z [err]  2025-12-17 10:23:12,328 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #13: [N] Great question,...
2025-12-17T10:23:12.330685722Z [err]  2025-12-17 10:23:12,328 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 1630ms
2025-12-17T10:23:12.330690343Z [err]  2025-12-17 10:23:12,328 - calling_service - INFO - ğŸ“¤ Streamed sentence: [N] Great question,...
2025-12-17T10:23:12.330694919Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Kendrick....
2025-12-17T10:23:12.330699845Z [err]  2025-12-17 10:23:12,328 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:12.680087895Z [err]  2025-12-17 10:23:12,432 - server - INFO - ğŸ“¤ Sentence arrived from LLM: The Facebook group is for our students once they'r...
2025-12-17T10:23:12.680092941Z [err]  2025-12-17 10:23:12,432 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:12.680097858Z [err]  2025-12-17 10:23:12,432 - server - INFO - ğŸš€ Streaming sentence #3 via persistent WebSocket
2025-12-17T10:23:12.680102526Z [err]  2025-12-17 10:23:12,432 - server - INFO - ğŸµ TTS task #3 started at +104ms
2025-12-17T10:23:12.680106433Z [err]  2025-12-17 10:23:12,432 - calling_service - INFO - ğŸ“¤ Streamed sentence: The Facebook group is for our students once they'r...
2025-12-17T10:23:12.680111773Z [err]  2025-12-17 10:23:12,557 - server - INFO - ğŸ“¤ Sentence arrived from LLM: so you get access after joining to connect with ev...
2025-12-17T10:23:12.680116267Z [err]  2025-12-17 10:23:12,557 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:12.680120817Z [err]  2025-12-17 10:23:12,558 - server - INFO - ğŸš€ Streaming sentence #4 via persistent WebSocket
2025-12-17T10:23:12.680125500Z [err]  2025-12-17 10:23:12,558 - server - INFO - ğŸµ TTS task #4 started at +229ms
2025-12-17T10:23:12.680129891Z [err]  2025-12-17 10:23:12,558 - calling_service - INFO - ğŸ“¤ Streamed sentence: so you get access after joining to connect with ev...
2025-12-17T10:23:12.680133818Z [err]  2025-12-17 10:23:12,597 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Does that help,...
2025-12-17T10:23:12.680138106Z [err]  2025-12-17 10:23:12,597 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:12.680142558Z [err]  2025-12-17 10:23:12,597 - server - INFO - ğŸš€ Streaming sentence #5 via persistent WebSocket
2025-12-17T10:23:12.680146590Z [err]  2025-12-17 10:23:12,597 - server - INFO - ğŸµ TTS task #5 started at +269ms
2025-12-17T10:23:12.681241343Z [err]  2025-12-17 10:23:12,597 - calling_service - INFO - ğŸ“¤ Streamed sentence: Does that help,...
2025-12-17T10:23:12.681246594Z [err]  2025-12-17 10:23:12,621 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:12.681251275Z [err]  2025-12-17 10:23:12,621 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+292ms
2025-12-17T10:23:12.681255876Z [err]  2025-12-17 10:23:12,621 - persistent_tts_service - INFO - ğŸ“¤ Sending 9660 bytes of audio (61 chunks, 1.2s duration) via WebSocket
2025-12-17T10:23:12.681261074Z [err]  2025-12-17 10:23:12,621 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:12.681265460Z [err]  2025-12-17 10:23:12,621 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.2s (total: 1.2s from now)
2025-12-17T10:23:12.681273281Z [err]  2025-12-17 10:23:12,622 - persistent_tts_service - INFO - âœ… Sent 61 audio chunks via WebSocket
2025-12-17T10:23:12.819938898Z [err]  2025-12-17 10:23:12,812 - server - INFO - ğŸ“¤ Sentence arrived from LLM: or is there something specific about the proof you...
2025-12-17T10:23:12.820044269Z [err]  2025-12-17 10:23:12,812 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:12.820048799Z [err]  2025-12-17 10:23:12,812 - server - INFO - ğŸš€ Streaming sentence #6 via persistent WebSocket
2025-12-17T10:23:12.820053094Z [err]  2025-12-17 10:23:12,812 - server - INFO - ğŸµ TTS task #6 started at +484ms
2025-12-17T10:23:12.821483780Z [err]  2025-12-17 10:23:12,812 - calling_service - INFO - ğŸ“¤ Streamed final fragment: or is there something specific about the proof you...
2025-12-17T10:23:12.821488905Z [err]  2025-12-17 10:23:12,816 - calling_service - INFO - â±ï¸ [TIMING] LLM_TOTAL: 1124ms for 275 chars (grok grok-4-fast-non-reasoning)
2025-12-17T10:23:12.821494436Z [err]  2025-12-17 10:23:12,817 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:23:12.821498199Z [err]  2025-12-17 10:23:12,817 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:23:12.821503088Z [err]  2025-12-17 10:23:12,817 - calling_service - INFO - ğŸ’¾ Storing node ID 1763206946898 in conversation history
2025-12-17T10:23:12.821507076Z [err]  2025-12-17 10:23:12,817 - calling_service - INFO - LLM response (2.02s): [N] Great question, Kendrick. The Facebook group is for our students once they're in the program, so you get access after joining to connect with everyone and see real results firsthand. Does that help, or is there something specific about the proof you'd like me to clarify?
2025-12-17T10:23:12.821510853Z [err]  2025-12-17 10:23:12,817 - calling_service - INFO - Total latency: 2.02s
2025-12-17T10:23:12.821515552Z [err]  2025-12-17 10:23:12,817 - server - INFO - âœ… LLM finished in 2119ms, TTS tasks already running in background
2025-12-17T10:23:12.821520007Z [err]  2025-12-17 10:23:12,817 - server - INFO - ğŸµ Streaming 6 TTS chunks as they complete...
2025-12-17T10:23:12.821524002Z [err]  2025-12-17 10:23:12,817 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:23:12.821527779Z [err]  2025-12-17 10:23:12,817 - server - INFO -    6 sentences queued and playing seamlessly
2025-12-17T10:23:12.873526106Z [err]  2025-12-17 10:23:12,871 - server - INFO - ğŸ¤ Soniox receiver alive - 36 messages received in last 10s
2025-12-17T10:23:13.911414192Z [err]  2025-12-17 10:23:13,907 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T10:23:13.911418687Z [err]  2025-12-17 10:23:13,907 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765966993.907613 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:13.911423351Z [err]  2025-12-17 10:23:13,907 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:14.675763916Z [err]  2025-12-17 10:23:14,621 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:14.675772143Z [err]  2025-12-17 10:23:14,622 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #13: 1 chunks received
2025-12-17T10:23:14.675779231Z [err]  2025-12-17 10:23:14,622 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #14: Kendrick....
2025-12-17T10:23:14.902632946Z [err]  2025-12-17 10:23:14,891 - server - INFO - ğŸ“¤ Audio flowing: 4310 packets sent to Soniox (5s update)
2025-12-17T10:23:14.905375740Z [err]  2025-12-17 10:23:14,903 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:14.905383789Z [err]  2025-12-17 10:23:14,903 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+282ms
2025-12-17T10:23:14.905389579Z [err]  2025-12-17 10:23:14,903 - persistent_tts_service - INFO - ğŸ“¤ Sending 6315 bytes of audio (40 chunks, 0.8s duration) via WebSocket
2025-12-17T10:23:14.905394530Z [err]  2025-12-17 10:23:14,903 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:14.905399038Z [err]  2025-12-17 10:23:14,904 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2025-12-17T10:23:14.905404152Z [err]  2025-12-17 10:23:14,904 - persistent_tts_service - INFO - âœ… Sent 40 audio chunks via WebSocket
2025-12-17T10:23:16.909622028Z [err]  2025-12-17 10:23:16,905 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:16.909631506Z [err]  2025-12-17 10:23:16,905 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #14: 1 chunks received
2025-12-17T10:23:16.909637255Z [err]  2025-12-17 10:23:16,905 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #15: The Facebook group is for our students once they'r...
2025-12-17T10:23:17.238444265Z [err]  2025-12-17 10:23:17,236 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:17.238455895Z [err]  2025-12-17 10:23:17,236 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+331ms
2025-12-17T10:23:17.238461436Z [err]  2025-12-17 10:23:17,237 - persistent_tts_service - INFO - ğŸ“¤ Sending 11889 bytes of audio (75 chunks, 1.5s duration) via WebSocket
2025-12-17T10:23:17.238476069Z [err]  2025-12-17 10:23:17,237 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:17.238482111Z [err]  2025-12-17 10:23:17,237 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.5s (total: 1.5s from now)
2025-12-17T10:23:17.239645977Z [err]  2025-12-17 10:23:17,238 - persistent_tts_service - INFO - âœ… Sent 75 audio chunks via WebSocket
2025-12-17T10:23:17.684164099Z [err]  2025-12-17 10:23:17,425 - persistent_tts_service - INFO - ğŸ“¤ Sending 15232 bytes of audio (96 chunks, 1.9s duration) via WebSocket
2025-12-17T10:23:17.684170529Z [err]  2025-12-17 10:23:17,426 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:17.684176774Z [err]  2025-12-17 10:23:17,426 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.9s (total: 3.2s from now)
2025-12-17T10:23:17.684182218Z [err]  2025-12-17 10:23:17,427 - persistent_tts_service - INFO - âœ… Sent 96 audio chunks via WebSocket
2025-12-17T10:23:19.612293032Z [err]  2025-12-17 10:23:19,426 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:19.612300132Z [err]  2025-12-17 10:23:19,427 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #15: 2 chunks received
2025-12-17T10:23:19.612306944Z [err]  2025-12-17 10:23:19,427 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #16: so you get access after joining to connect with ev...
2025-12-17T10:23:19.787401431Z [err]  2025-12-17 10:23:19,780 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:19.787407738Z [err]  2025-12-17 10:23:19,780 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+354ms
2025-12-17T10:23:19.787413342Z [err]  2025-12-17 10:23:19,780 - persistent_tts_service - INFO - ğŸ“¤ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:23:19.787418871Z [err]  2025-12-17 10:23:19,781 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:19.787424980Z [err]  2025-12-17 10:23:19,781 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 2.6s from now)
2025-12-17T10:23:19.787431211Z [err]  2025-12-17 10:23:19,782 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:23:19.787438164Z [err]  2025-12-17 10:23:19,783 - persistent_tts_service - INFO - ğŸ“¤ Sending 10356 bytes of audio (65 chunks, 1.3s duration) via WebSocket
2025-12-17T10:23:19.787448371Z [err]  2025-12-17 10:23:19,783 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:19.787454789Z [err]  2025-12-17 10:23:19,783 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.3s (total: 3.9s from now)
2025-12-17T10:23:19.787459969Z [err]  2025-12-17 10:23:19,784 - persistent_tts_service - INFO - âœ… Sent 65 audio chunks via WebSocket
2025-12-17T10:23:19.921376802Z [err]  2025-12-17 10:23:19,913 - server - INFO - ğŸ“¤ Audio flowing: 4561 packets sent to Soniox (5s update)
2025-12-17T10:23:20.017078066Z [err]  2025-12-17 10:23:20,004 - persistent_tts_service - INFO - ğŸ“¤ Sending 23034 bytes of audio (144 chunks, 2.9s duration) via WebSocket
2025-12-17T10:23:20.017088623Z [err]  2025-12-17 10:23:20,004 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:20.017097558Z [err]  2025-12-17 10:23:20,004 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.9s (total: 6.5s from now)
2025-12-17T10:23:20.017105358Z [err]  2025-12-17 10:23:20,005 - persistent_tts_service - INFO - âœ… Sent 144 audio chunks via WebSocket
2025-12-17T10:23:20.698807509Z [err]  2025-12-17 10:23:20,429 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (6.1s left)
2025-12-17T10:23:20.934174528Z [err]  2025-12-17 10:23:20,932 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (5.6s left)
2025-12-17T10:23:22.009585336Z [err]  2025-12-17 10:23:22,004 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:22.009592828Z [err]  2025-12-17 10:23:22,005 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #16: 3 chunks received
2025-12-17T10:23:22.009597974Z [err]  2025-12-17 10:23:22,005 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #17: Does that help,...
2025-12-17T10:23:22.291836121Z [err]  2025-12-17 10:23:22,290 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:22.291843530Z [err]  2025-12-17 10:23:22,290 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+285ms
2025-12-17T10:23:22.291895958Z [err]  2025-12-17 10:23:22,290 - persistent_tts_service - INFO - ğŸ“¤ Sending 9288 bytes of audio (59 chunks, 1.2s duration) via WebSocket
2025-12-17T10:23:22.291900964Z [err]  2025-12-17 10:23:22,290 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:22.293817924Z [err]  2025-12-17 10:23:22,290 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.2s (total: 5.4s from now)
2025-12-17T10:23:22.293826086Z [err]  2025-12-17 10:23:22,292 - persistent_tts_service - INFO - âœ… Sent 59 audio chunks via WebSocket
2025-12-17T10:23:23.678759674Z [err]  2025-12-17 10:23:23,677 - server - INFO - ğŸ¤ Soniox receiver alive - 10 messages received in last 10s
2025-12-17T10:23:24.299523329Z [err]  2025-12-17 10:23:24,291 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:24.299532374Z [err]  2025-12-17 10:23:24,291 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #17: 1 chunks received
2025-12-17T10:23:24.299538313Z [err]  2025-12-17 10:23:24,291 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #18: or is there something specific about the proof you...
2025-12-17T10:23:24.728319054Z [err]  2025-12-17 10:23:24,632 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:24.728322850Z [err]  2025-12-17 10:23:24,632 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+342ms
2025-12-17T10:23:24.728326714Z [err]  2025-12-17 10:23:24,633 - persistent_tts_service - INFO - ğŸ“¤ Sending 10403 bytes of audio (66 chunks, 1.3s duration) via WebSocket
2025-12-17T10:23:24.728330537Z [err]  2025-12-17 10:23:24,633 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:24.728334168Z [err]  2025-12-17 10:23:24,633 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.3s (total: 4.4s from now)
2025-12-17T10:23:24.728339272Z [err]  2025-12-17 10:23:24,634 - persistent_tts_service - INFO - âœ… Sent 66 audio chunks via WebSocket
2025-12-17T10:23:24.822112722Z [err]  2025-12-17 10:23:24,819 - persistent_tts_service - INFO - ğŸ“¤ Sending 17090 bytes of audio (107 chunks, 2.1s duration) via WebSocket
2025-12-17T10:23:24.822121336Z [err]  2025-12-17 10:23:24,819 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:24.822127594Z [err]  2025-12-17 10:23:24,820 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.1s (total: 6.3s from now)
2025-12-17T10:23:24.823487914Z [err]  2025-12-17 10:23:24,821 - persistent_tts_service - INFO - âœ… Sent 107 audio chunks via WebSocket
2025-12-17T10:23:24.931586675Z [err]  2025-12-17 10:23:24,930 - server - INFO - ğŸ“¤ Audio flowing: 4812 packets sent to Soniox (5s update)
2025-12-17T10:23:25.757933937Z [err]  2025-12-17 10:23:25,464 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (5.7s left)
2025-12-17T10:23:25.968737441Z [err]  2025-12-17 10:23:25,966 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (5.2s left)
2025-12-17T10:23:26.825084107Z [err]  2025-12-17 10:23:26,820 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:26.825091285Z [err]  2025-12-17 10:23:26,820 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #18: 2 chunks received
2025-12-17T10:23:26.825096175Z [err]  2025-12-17 10:23:26,820 - server - INFO - âœ… All 6 persistent TTS streams completed
2025-12-17T10:23:26.825101000Z [err]  2025-12-17 10:23:26,820 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:23:26.825105367Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 16122ms from user stop ğŸš€
2025-12-17T10:23:26.825110436Z [err]  2025-12-17 10:23:26,820 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:26.825115981Z [err]  2025-12-17 10:23:26,820 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:23:26.825120745Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:26.825125204Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:23:26.825130512Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] STT: 7ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:23:26.825134990Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 2119ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:23:26.825139303Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 14492ms (provider: elevenlabs, websocket: False)
2025-12-17T10:23:26.825143188Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 16122ms (user stopped â†’ play_audio_url called)
2025-12-17T10:23:26.826423496Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:23:26.826429453Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:23:26.826433973Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:23:26.826437908Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:23:26.826441943Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:23:26.826446136Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 16422ms estimated
2025-12-17T10:23:26.826449957Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 275 chars, 6 sentences
2025-12-17T10:23:26.826454097Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'Um,what, Uh, how, like, how do I getac cess to, like, the Fa...'
2025-12-17T10:23:26.826458386Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: '[N] Great question, Kendrick. The Facebook group is for our ...'
2025-12-17T10:23:26.826462363Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:23:26.826466852Z [err]  2025-12-17 10:23:26,820 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:27.017748422Z [err]  2025-12-17 10:23:27,013 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive, Dead Air: 2626ms)
2025-12-17T10:23:27.017755456Z [err]  2025-12-17 10:23:27,013 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:23:29.953106546Z [err]  2025-12-17 10:23:29,950 - server - INFO - ğŸ“¤ Audio flowing: 5063 packets sent to Soniox (5s update)
2025-12-17T10:23:30.003073682Z [err]  2025-12-17 10:23:30,000 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (1.1s left)
2025-12-17T10:23:30.748562052Z [err]  2025-12-17 10:23:30,502 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (0.6s left)
2025-12-17T10:23:31.344602535Z [err]  2025-12-17 10:23:31,335 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:23:31.684508080Z [err]  2025-12-17 10:23:31,508 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967011.508947 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:31.684516650Z [err]  2025-12-17 10:23:31,508 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:31.684644829Z [err]  2025-12-17 10:23:31,508 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.4s ago), marking agent as done speaking
2025-12-17T10:23:34.008092706Z [err]  2025-12-17 10:23:33,997 - server - INFO - ğŸ¤ Soniox receiver alive - 10 messages received in last 10s
2025-12-17T10:23:34.008098833Z [err]  2025-12-17 10:23:33,997 - server - INFO - ğŸ”¤ RAW TOKENS: [" N"?, "o,"?]
2025-12-17T10:23:34.008106586Z [err]  2025-12-17 10:23:33,998 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user started speaking) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:34.008111354Z [err]  2025-12-17 10:23:33,998 - calling_service - INFO - ğŸ”Š Silence timer reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user started speaking)
2025-12-17T10:23:34.008116777Z [err]  2025-12-17 10:23:33,998 - calling_service - INFO - ğŸ‘¤ User started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:34.008121185Z [err]  2025-12-17 10:23:33,998 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'No,' | Generating: False
2025-12-17T10:23:34.249059675Z [err]  2025-12-17 10:23:34,243 - server - INFO - ğŸ”¤ RAW TOKENS: [" N"?, "o,"?, " that"?, "'s"?]
2025-12-17T10:23:34.249066699Z [err]  2025-12-17 10:23:34,243 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'No, that's' | Generating: False
2025-12-17T10:23:34.377646448Z [err]  2025-12-17 10:23:34,375 - server - INFO - ğŸ”¤ RAW TOKENS: [" N"?, "o,"?, " that"?, "'s"?, " pr"?, "etty"?]
2025-12-17T10:23:34.377657967Z [err]  2025-12-17 10:23:34,376 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'No, that'spr etty' | Generating: False
2025-12-17T10:23:34.761669679Z [err]  2025-12-17 10:23:34,691 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'No, that'spr etty much it' | Generating: False
2025-12-17T10:23:34.761786165Z [err]  2025-12-17 10:23:34,504 - server - INFO - ğŸ”¤ RAW TOKENS: [" N"?, "o,"?, " that"?, "'s"?, " pr"?, "etty"?, " much"?]
2025-12-17T10:23:34.761792511Z [err]  2025-12-17 10:23:34,504 - server - INFO - ğŸ” PARTIAL TRANSCRIPT: 'No, that'spr etty much' | Generating: False
2025-12-17T10:23:34.761798465Z [err]  2025-12-17 10:23:34,690 - server - INFO - ğŸ”¤ RAW TOKENS: [" N"?, "o,"?, " that"?, "'s"?, " pr"?, "etty"?, " much"?, " it"?]
2025-12-17T10:23:34.956353171Z [err]  2025-12-17 10:23:34,951 - server - INFO - ğŸ“¤ Audio flowing: 5313 packets sent to Soniox (5s update)
2025-12-17T10:23:34.977126398Z [err]  2025-12-17 10:23:34,971 - server - INFO - ğŸ”¤ RAW TOKENS: [" N"âœ“, "o,"âœ“, " that"âœ“, "'s"âœ“, " pr"âœ“, "etty"âœ“, " much"âœ“, " it"âœ“, "."âœ“, "<end>"âœ“]
2025-12-17T10:23:34.977137626Z [err]  2025-12-17 10:23:34,971 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:23:34.977142679Z [err]  2025-12-17 10:23:34,971 - server - INFO - ğŸ§¹ Cleaned transcript: ' N o,  that 's  pr etty  much  it .' -> 'No, that'spr etty much it.'
2025-12-17T10:23:34.977149822Z [err]  2025-12-17 10:23:34,972 - server - INFO - ğŸ“¥ FINAL TOKENS: 'No, that'spr etty much it.' (9 tokens)
2025-12-17T10:23:34.977154263Z [err]  2025-12-17 10:23:34,972 - server - INFO - ğŸ¤ Soniox final transcript: 'No, that'spr etty much it.'
2025-12-17T10:23:34.977158842Z [err]  2025-12-17 10:23:34,972 - server - INFO - ğŸ” FILTER CHECK: words=5, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-17T10:23:34.977164442Z [err]  2025-12-17 10:23:34,972 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:23:34.977170742Z [err]  2025-12-17 10:23:34,972 - server - INFO - â±ï¸ [10:23:34.972] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'No, that'spr etty much it.'
2025-12-17T10:23:34.977177779Z [err]  2025-12-17 10:23:34,972 - server - INFO - â±ï¸ [10:23:34.972] STT endpoint detection latency: 2ms
2025-12-17T10:23:34.977184668Z [err]  2025-12-17 10:23:34,972 - server - INFO - â±ï¸ [10:23:34.972] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:23:34.977191102Z [err]  2025-12-17 10:23:34,973 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:23:34.977197016Z [err]  2025-12-17 10:23:34,973 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:23:34.977202789Z [err]  2025-12-17 10:23:34,973 - server - INFO - âœ… Agent SILENT - User said 5 word(s): 'No, that'spr etty much it.' - Processing...
2025-12-17T10:23:34.984592083Z [err]  2025-12-17 10:23:34,984 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: No, that'spr etty much it.
2025-12-17T10:23:34.984599239Z [err]  2025-12-17 10:23:34,984 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:34.986158003Z [err]  2025-12-17 10:23:34,984 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:23:34.986167475Z [err]  2025-12-17 10:23:34,984 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:23:34.986173787Z [err]  2025-12-17 10:23:34,984 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+14ms
2025-12-17T10:23:34.986181025Z [err]  2025-12-17 10:23:34,984 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 14ms (Soniox model: stt-rt-v3)
2025-12-17T10:23:34.986187842Z [err]  2025-12-17 10:23:34,984 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:23:34.986193425Z [err]  2025-12-17 10:23:34,984 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:23:34.986198541Z [err]  2025-12-17 10:23:34,984 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:35.082520213Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - ğŸ” PRE-TRANSITION: Extracting mandatory vars on CURRENT node N_KB_Q&A_With_StrategicNarrative_V3_Adaptive before transition
2025-12-17T10:23:35.082529279Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - ğŸ” Real-time extraction: Processing 2 variables
2025-12-17T10:23:35.082534658Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO -   âœ“ has_discussed_income_potential: False (already extracted)
2025-12-17T10:23:35.082539344Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO -   âœ“ asked_upset: False (already extracted)
2025-12-17T10:23:35.082544120Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - âœ… All variables already extracted
2025-12-17T10:23:35.082549729Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - âœ… PRE-TRANSITION: All mandatory vars satisfied on N_KB_Q&A_With_StrategicNarrative_V3_Adaptive - proceeding with transition
2025-12-17T10:23:35.082586231Z [err]  2025-12-17 10:23:35,080 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:23:35.082592564Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - â±ï¸ [10:23:35.080] ğŸ“¥ process_user_input() ENTRY - text: 'No, that'spr etty much it....'
2025-12-17T10:23:35.082597877Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - â±ï¸ [10:23:35.080] â© About to call _process_call_flow_streaming()
2025-12-17T10:23:35.082603809Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - â±ï¸ [10:23:35.080] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:23:35.082610011Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - â±ï¸ [10:23:35.080] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:23:35.082615459Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - Flow processing - History length: 13, Is first: False
2025-12-17T10:23:35.082622643Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763206946898
2025-12-17T10:23:35.084249608Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - â±ï¸ [10:23:35.080] ğŸ”€ About to call _follow_transition() for: No, that'spr etty much it....
2025-12-17T10:23:35.084257562Z [err]  2025-12-17 10:23:35,080 - calling_service - INFO - Evaluating transitions from N_KB_Q&A_With_StrategicNarrative_V3_Adaptive for message: No, that'spr etty much it.
2025-12-17T10:23:35.090385149Z [err]  2025-12-17 10:23:35,088 - calling_service - INFO - â±ï¸ [10:23:35.088] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 1 options
2025-12-17T10:23:35.731955891Z [err]  2025-12-17 10:23:35,674 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:23:35.731961420Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - â±ï¸ [10:23:35.675] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 586ms
2025-12-17T10:23:35.731966814Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - ğŸ¤– AI transition decision: '-1'
2025-12-17T10:23:35.731974571Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - ğŸ“Š Available transitions: ['...would you honestly be upset if you had an extra...']
2025-12-17T10:23:35.731982980Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - Selected transition index: -1
2025-12-17T10:23:35.731989462Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-17T10:23:35.731995582Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - âš ï¸ No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-17T10:23:35.732002075Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - ğŸ¯ Goal: Determine what has already been done in this node by being aware of the conversation context and the...
2025-12-17T10:23:35.732009663Z [err]  2025-12-17 10:23:35,675 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 595ms
2025-12-17T10:23:35.732015170Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - â±ï¸ [10:23:35.676] âœ… Node selected, about to process content...
2025-12-17T10:23:35.732021345Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:23 AM EST in content
2025-12-17T10:23:35.732026939Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:23:35.732031510Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:23:35.732490251Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - Using flow node: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive (type: conversation, mode: prompt)
2025-12-17T10:23:35.732497029Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:23:35.732502737Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - â±ï¸ [10:23:35.676] ğŸ“„ About to process content (mode=prompt, length=4560)
2025-12-17T10:23:35.732508344Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - âš¡ PARALLEL MODE: Running KB + analysis simultaneously
2025-12-17T10:23:35.732515815Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:23:35.732524218Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:23:35.732529822Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:23:35.732534865Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:23:35.732539623Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:23:35.732545291Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:23:35.732549622Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:23:35.732553607Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{has_discussed_income_potential}} with False in content
2025-12-17T10:23:35.732558062Z [err]  2025-12-17 10:23:35,676 - calling_service - INFO - ğŸ”§ Replaced {{asked_upset}} with False in content
2025-12-17T10:23:35.733735321Z [err]  2025-12-17 10:23:35,684 - kb_router - INFO - ğŸš¦ KB Router: SKIP (simple chat pattern matched)
2025-12-17T10:23:35.733741538Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - âš¡ Skipping KB (reason: simple_chat)
2025-12-17T10:23:35.733746578Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - âš¡ Parallel operations completed in 0ms
2025-12-17T10:23:35.733751223Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ” Node 'N_KB_Q&A_With_StrategicNarrative_V3_Adaptive': use_parallel_llm=True
2025-12-17T10:23:35.733755405Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - âš¡ Parallel mode: Using condensed history (10/13 messages)
2025-12-17T10:23:35.733760518Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - â±ï¸ [10:23:35.684] ğŸ’¬ LLM REQUEST START: 13 conversation turns, 11478 system chars (KB cached)
2025-12-17T10:23:35.733768678Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â• LLM PROMPT BREAKDOWN â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:35.733773179Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“ [SYSTEM MSG 1 - GLOBAL PROMPT] (5826 chars):
2025-12-17T10:23:35.733777415Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-17T10:23:35.733781476Z [err]  
2025-12-17T10:23:35.733785363Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-17T10:23:35.733789460Z [err]  
2025-12-17T10:23:35.733793627Z [err]  If user says a name, don't assume it's theirsâ€”wait for explicit correction.
2025-12-17T10:23:35.733797589Z [err]  
2025-12-17T10:23:35.733801393Z [err]  If user asks to repeat info, rephrase naturallyâ€”never exact repeat.
2025-12-17T10:23:35.733805276Z [err]  
2025-12-17T10:23:35.733808998Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-17T10:23:35.735433446Z [err]  
2025-12-17T10:23:35.735442812Z [err]  
2025-12-17T10:23:35.735445043Z [err]  This context is provided to help you focus. You still need to:
2025-12-17T10:23:35.735455507Z [err]  1. Generate a natural, contextual response
2025-12-17T10:23:35.735464606Z [err]  2. Evaluate transitions per your node instructions
2025-12-17T10:23:35.735469464Z [err]  
2025-12-17T10:23:35.735475141Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:23:35.735546968Z [err]  If asked about call number: "Company number."
2025-12-17T10:23:35.735556256Z [err]  
2025-12-17T10:23:35.735563260Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-17T10:23:35.735570714Z [err]  
2025-12-17T10:23:35.735580376Z [err]  If explaining ends in peri...
2025-12-17T10:23:35.735586728Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“ [SYSTEM MSG 2 - DYNAMIC CONTEXT] (5652 chars):
2025-12-17T10:23:35.735593464Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“   Preview: 
2025-12-17T10:23:35.735602372Z [err]  
2025-12-17T10:23:35.735609566Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:23:35.735615353Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-17T10:23:35.735621691Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:23:35.735627872Z [err]  
2025-12-17T10:23:35.735633878Z [err]  USER COMMUNICATION STYLE: C type - adjust your response accordingly
2025-12-17T10:23:35.735639998Z [err]  CONVERSATION STATUS: Turn 7, objection handling phase
2025-12-17T10:23:35.736860542Z [err]  
2025-12-17T10:23:35.736875363Z [err]  # CURRENT CONTEXT
2025-12-17T10:23:35.736886717Z [err]  Customer: Kendrick
2025-12-17T10:23:35.736894459Z [err]  Variables: {"now": "Wednesday, December 17, 2025 at 5:23 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment...
2025-12-17T10:23:35.736900444Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“ [CONVERSATION HISTORY] (10 messages)
2025-12-17T10:23:35.736907847Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“   assistant: [N] Great question, Kendrick. The Facebook group is for our students once they're in the program, so...
2025-12-17T10:23:35.736915369Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“   user: No, that'spr etty much it....
2025-12-17T10:23:35.736922972Z [err]  2025-12-17 10:23:35,684 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:36.091953174Z [err]  2025-12-17 10:23:36,090 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:23:36.335860306Z [err]  2025-12-17 10:23:36,332 - calling_service - INFO - â±ï¸ [10:23:36.331] ğŸ’¬ LLM FIRST TOKEN: 647ms (grok grok-4-fast-non-reasoning)
2025-12-17T10:23:36.372926988Z [err]  2025-12-17 10:23:36,371 - server - INFO - ğŸ“¤ Sentence arrived from LLM: [N] Alright,...
2025-12-17T10:23:36.372933895Z [err]  2025-12-17 10:23:36,371 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 1387ms
2025-12-17T10:23:36.372938799Z [err]  2025-12-17 10:23:36,371 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:23:36.372942999Z [err]  2025-12-17 10:23:36,371 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.372948215Z [err]  2025-12-17 10:23:36,371 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:23:36.372953778Z [err]  2025-12-17 10:23:36,371 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:23:36.372958853Z [err]  2025-12-17 10:23:36,371 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 1387ms
2025-12-17T10:23:36.372966615Z [err]  2025-12-17 10:23:36,371 - calling_service - INFO - ğŸ“¤ Streamed sentence: [N] Alright,...
2025-12-17T10:23:36.372971013Z [err]  2025-12-17 10:23:36,371 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #19: [N] Alright,...
2025-12-17T10:23:36.397764917Z [err]  2025-12-17 10:23:36,395 - server - INFO - ğŸ“¤ Sentence arrived from LLM: perfect....
2025-12-17T10:23:36.397772216Z [err]  2025-12-17 10:23:36,395 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.397777887Z [err]  2025-12-17 10:23:36,395 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:23:36.397782538Z [err]  2025-12-17 10:23:36,395 - server - INFO - ğŸµ TTS task #2 started at +23ms
2025-12-17T10:23:36.397787544Z [err]  2025-12-17 10:23:36,395 - calling_service - INFO - ğŸ“¤ Streamed sentence: perfect....
2025-12-17T10:23:36.409911575Z [err]  2025-12-17 10:23:36,407 - server - INFO - ğŸ“¤ Sentence arrived from LLM: So to put some numbers on it,...
2025-12-17T10:23:36.409922895Z [err]  2025-12-17 10:23:36,407 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.409929128Z [err]  2025-12-17 10:23:36,407 - server - INFO - ğŸš€ Streaming sentence #3 via persistent WebSocket
2025-12-17T10:23:36.409934364Z [err]  2025-12-17 10:23:36,407 - server - INFO - ğŸµ TTS task #3 started at +36ms
2025-12-17T10:23:36.409939857Z [err]  2025-12-17 10:23:36,407 - calling_service - INFO - ğŸ“¤ Streamed sentence: So to put some numbers on it,...
2025-12-17T10:23:36.779639836Z [err]  2025-12-17 10:23:36,481 - server - INFO - ğŸš€ Streaming sentence #5 via persistent WebSocket
2025-12-17T10:23:36.779652371Z [err]  2025-12-17 10:23:36,481 - server - INFO - ğŸµ TTS task #5 started at +110ms
2025-12-17T10:23:36.779661508Z [err]  2025-12-17 10:23:36,481 - calling_service - INFO - ğŸ“¤ Streamed sentence: Most students aim for ten sites to start....
2025-12-17T10:23:36.779670864Z [err]  2025-12-17 10:23:36,497 - server - INFO - ğŸ“¤ Sentence arrived from LLM: With that in mind,...
2025-12-17T10:23:36.779677846Z [err]  2025-12-17 10:23:36,497 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.779685947Z [err]  2025-12-17 10:23:36,497 - server - INFO - ğŸš€ Streaming sentence #6 via persistent WebSocket
2025-12-17T10:23:36.779691532Z [err]  2025-12-17 10:23:36,462 - server - INFO - ğŸ“¤ Sentence arrived from LLM: each site can bring in five hundred to two thousan...
2025-12-17T10:23:36.779700421Z [err]  2025-12-17 10:23:36,462 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.779703551Z [err]  2025-12-17 10:23:36,497 - server - INFO - ğŸµ TTS task #6 started at +126ms
2025-12-17T10:23:36.779706906Z [err]  2025-12-17 10:23:36,462 - server - INFO - ğŸš€ Streaming sentence #4 via persistent WebSocket
2025-12-17T10:23:36.779712140Z [err]  2025-12-17 10:23:36,462 - server - INFO - ğŸµ TTS task #4 started at +90ms
2025-12-17T10:23:36.779716166Z [err]  2025-12-17 10:23:36,462 - calling_service - INFO - ğŸ“¤ Streamed sentence: each site can bring in five hundred to two thousan...
2025-12-17T10:23:36.779720314Z [err]  2025-12-17 10:23:36,481 - server - INFO - ğŸ“¤ Sentence arrived from LLM: Most students aim for ten sites to start....
2025-12-17T10:23:36.779724528Z [err]  2025-12-17 10:23:36,481 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.780143987Z [err]  2025-12-17 10:23:36,497 - calling_service - INFO - ğŸ“¤ Streamed sentence: With that in mind,...
2025-12-17T10:23:36.780151529Z [err]  2025-12-17 10:23:36,553 - server - INFO - ğŸ“¤ Sentence arrived from LLM: would you honestly be upset if you had an extra tw...
2025-12-17T10:23:36.780157929Z [err]  2025-12-17 10:23:36,553 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:23:36.780166865Z [err]  2025-12-17 10:23:36,553 - server - INFO - ğŸš€ Streaming sentence #7 via persistent WebSocket
2025-12-17T10:23:36.780173948Z [err]  2025-12-17 10:23:36,553 - server - INFO - ğŸµ TTS task #7 started at +181ms
2025-12-17T10:23:36.780180836Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - ğŸ“¤ Streamed final fragment: would you honestly be upset if you had an extra tw...
2025-12-17T10:23:36.780187133Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - â±ï¸ [TIMING] LLM_TOTAL: 868ms for 256 chars (grok grok-4-fast-non-reasoning)
2025-12-17T10:23:36.780196340Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:23:36.780202855Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - âœ… User responded to regular message, resetting counter
2025-12-17T10:23:36.780370947Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - ğŸ’¾ Storing node ID 1763206946898 in conversation history
2025-12-17T10:23:36.780380077Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - LLM response (1.47s): [N] Alright, perfect. So to put some numbers on it, each site can bring in five hundred to two thousand a month. Most students aim for ten sites to start. With that in mind, would you honestly be upset if you had an extra twenty thousand a month coming in?
2025-12-17T10:23:36.780387671Z [err]  2025-12-17 10:23:36,553 - calling_service - INFO - Total latency: 1.47s
2025-12-17T10:23:36.781419125Z [err]  2025-12-17 10:23:36,553 - server - INFO - âœ… LLM finished in 1569ms, TTS tasks already running in background
2025-12-17T10:23:36.781429033Z [err]  2025-12-17 10:23:36,553 - server - INFO - ğŸµ Streaming 7 TTS chunks as they complete...
2025-12-17T10:23:36.781435587Z [err]  2025-12-17 10:23:36,553 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:23:36.781442503Z [err]  2025-12-17 10:23:36,553 - server - INFO -    7 sentences queued and playing seamlessly
2025-12-17T10:23:36.781449503Z [err]  2025-12-17 10:23:36,714 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:36.781459088Z [err]  2025-12-17 10:23:36,714 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+342ms
2025-12-17T10:23:36.781465975Z [err]  2025-12-17 10:23:36,714 - persistent_tts_service - INFO - ğŸ“¤ Sending 9659 bytes of audio (61 chunks, 1.2s duration) via WebSocket
2025-12-17T10:23:36.781472210Z [err]  2025-12-17 10:23:36,714 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:36.781494136Z [err]  2025-12-17 10:23:36,714 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.2s (total: 1.2s from now)
2025-12-17T10:23:36.781500574Z [err]  2025-12-17 10:23:36,715 - persistent_tts_service - INFO - âœ… Sent 61 audio chunks via WebSocket
2025-12-17T10:23:38.047905009Z [err]  2025-12-17 10:23:38,041 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (0.1s ago), marking agent as done speaking
2025-12-17T10:23:38.047909249Z [err]  2025-12-17 10:23:38,041 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967018.0413582 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:38.047913371Z [err]  2025-12-17 10:23:38,041 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:38.773246736Z [err]  2025-12-17 10:23:38,714 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:38.773251168Z [err]  2025-12-17 10:23:38,714 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #19: 1 chunks received
2025-12-17T10:23:38.773255207Z [err]  2025-12-17 10:23:38,714 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #20: perfect....
2025-12-17T10:23:39.025989798Z [err]  2025-12-17 10:23:39,022 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:39.025994714Z [err]  2025-12-17 10:23:39,022 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+308ms
2025-12-17T10:23:39.025999243Z [err]  2025-12-17 10:23:39,022 - persistent_tts_service - INFO - ğŸ“¤ Sending 6688 bytes of audio (42 chunks, 0.8s duration) via WebSocket
2025-12-17T10:23:39.026058355Z [err]  2025-12-17 10:23:39,022 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:39.026063470Z [err]  2025-12-17 10:23:39,022 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2025-12-17T10:23:39.026068048Z [err]  2025-12-17 10:23:39,024 - persistent_tts_service - INFO - âœ… Sent 42 audio chunks via WebSocket
2025-12-17T10:23:39.980267224Z [err]  2025-12-17 10:23:39,970 - server - INFO - ğŸ“¤ Audio flowing: 5564 packets sent to Soniox (5s update)
2025-12-17T10:23:40.046970035Z [err]  2025-12-17 10:23:40,045 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=2.0s, checkin_count=0/2
2025-12-17T10:23:40.845900108Z [err]  2025-12-17 10:23:40,547 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=2.5s, checkin_count=0/2
2025-12-17T10:23:41.026450845Z [err]  2025-12-17 10:23:41,022 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:41.026458777Z [err]  2025-12-17 10:23:41,022 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #20: 1 chunks received
2025-12-17T10:23:41.026463988Z [err]  2025-12-17 10:23:41,022 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #21: So to put some numbers on it,...
2025-12-17T10:23:41.372953806Z [err]  2025-12-17 10:23:41,365 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:41.372962684Z [err]  2025-12-17 10:23:41,365 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+343ms
2025-12-17T10:23:41.372969661Z [err]  2025-12-17 10:23:41,365 - persistent_tts_service - INFO - ğŸ“¤ Sending 13003 bytes of audio (82 chunks, 1.6s duration) via WebSocket
2025-12-17T10:23:41.372975761Z [err]  2025-12-17 10:23:41,365 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:41.372980818Z [err]  2025-12-17 10:23:41,366 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.6s (total: 1.6s from now)
2025-12-17T10:23:41.372986677Z [err]  2025-12-17 10:23:41,367 - persistent_tts_service - INFO - âœ… Sent 82 audio chunks via WebSocket
2025-12-17T10:23:43.369144568Z [err]  2025-12-17 10:23:43,365 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:43.369156258Z [err]  2025-12-17 10:23:43,365 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #21: 1 chunks received
2025-12-17T10:23:43.369164201Z [err]  2025-12-17 10:23:43,365 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #22: each site can bring in five hundred to two thousan...
2025-12-17T10:23:43.818447275Z [err]  2025-12-17 10:23:43,689 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:43.818453926Z [err]  2025-12-17 10:23:43,689 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+324ms
2025-12-17T10:23:43.818459727Z [err]  2025-12-17 10:23:43,689 - persistent_tts_service - INFO - ğŸ“¤ Sending 11145 bytes of audio (70 chunks, 1.4s duration) via WebSocket
2025-12-17T10:23:43.818466322Z [err]  2025-12-17 10:23:43,690 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:43.818481286Z [err]  2025-12-17 10:23:43,690 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.4s (total: 1.4s from now)
2025-12-17T10:23:43.818487071Z [err]  2025-12-17 10:23:43,691 - persistent_tts_service - INFO - âœ… Sent 70 audio chunks via WebSocket
2025-12-17T10:23:43.924995830Z [err]  2025-12-17 10:23:43,922 - persistent_tts_service - INFO - ğŸ“¤ Sending 13747 bytes of audio (86 chunks, 1.7s duration) via WebSocket
2025-12-17T10:23:43.925003362Z [err]  2025-12-17 10:23:43,922 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:43.925009127Z [err]  2025-12-17 10:23:43,922 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 2.9s from now)
2025-12-17T10:23:43.926498865Z [err]  2025-12-17 10:23:43,924 - persistent_tts_service - INFO - âœ… Sent 86 audio chunks via WebSocket
2025-12-17T10:23:44.837986295Z [err]  2025-12-17 10:23:44,684 - server - INFO - ğŸ¤ Soniox receiver alive - 14 messages received in last 10s
2025-12-17T10:23:44.998508473Z [err]  2025-12-17 10:23:44,992 - server - INFO - ğŸ“¤ Audio flowing: 5815 packets sent to Soniox (5s update)
2025-12-17T10:23:45.095278677Z [err]  2025-12-17 10:23:45,090 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (1.7s left)
2025-12-17T10:23:45.775138793Z [err]  2025-12-17 10:23:45,611 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (1.2s left)
2025-12-17T10:23:45.925730791Z [err]  2025-12-17 10:23:45,922 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:45.925736859Z [err]  2025-12-17 10:23:45,922 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #22: 2 chunks received
2025-12-17T10:23:45.925741647Z [err]  2025-12-17 10:23:45,922 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #23: Most students aim for ten sites to start....
2025-12-17T10:23:46.245084065Z [err]  2025-12-17 10:23:46,244 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:46.245090617Z [err]  2025-12-17 10:23:46,244 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+322ms
2025-12-17T10:23:46.247278568Z [err]  2025-12-17 10:23:46,244 - persistent_tts_service - INFO - ğŸ“¤ Sending 19319 bytes of audio (121 chunks, 2.4s duration) via WebSocket
2025-12-17T10:23:46.247284432Z [err]  2025-12-17 10:23:46,244 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:46.247288754Z [err]  2025-12-17 10:23:46,244 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.4s (total: 3.0s from now)
2025-12-17T10:23:46.247292752Z [err]  2025-12-17 10:23:46,246 - persistent_tts_service - INFO - âœ… Sent 121 audio chunks via WebSocket
2025-12-17T10:23:48.246525060Z [err]  2025-12-17 10:23:48,244 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:48.246531479Z [err]  2025-12-17 10:23:48,244 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #23: 1 chunks received
2025-12-17T10:23:48.246536244Z [err]  2025-12-17 10:23:48,244 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #24: With that in mind,...
2025-12-17T10:23:48.820867111Z [err]  2025-12-17 10:23:48,551 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:48.820873087Z [err]  2025-12-17 10:23:48,551 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+306ms
2025-12-17T10:23:48.820880507Z [err]  2025-12-17 10:23:48,551 - persistent_tts_service - INFO - ğŸ“¤ Sending 9288 bytes of audio (59 chunks, 1.2s duration) via WebSocket
2025-12-17T10:23:48.820886531Z [err]  2025-12-17 10:23:48,551 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:48.820892602Z [err]  2025-12-17 10:23:48,551 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.2s (total: 1.8s from now)
2025-12-17T10:23:48.820898562Z [err]  2025-12-17 10:23:48,552 - persistent_tts_service - INFO - âœ… Sent 59 audio chunks via WebSocket
2025-12-17T10:23:50.014650875Z [err]  2025-12-17 10:23:50,010 - server - INFO - ğŸ“¤ Audio flowing: 6066 packets sent to Soniox (5s update)
2025-12-17T10:23:50.140967705Z [err]  2025-12-17 10:23:50,133 - telnyx_service - INFO - ğŸ” Agent config provided: True
2025-12-17T10:23:50.140978059Z [err]  2025-12-17 10:23:50,133 - telnyx_service - INFO - ğŸ” TTS provider from settings: elevenlabs
2025-12-17T10:23:50.140984189Z [err]  2025-12-17 10:23:50,133 - telnyx_service - INFO - ğŸ” WebSocket TTS: False
2025-12-17T10:23:50.140990377Z [err]  2025-12-17 10:23:50,133 - telnyx_service - INFO - ğŸ™ï¸ Attempting elevenlabs TTS (REST)
2025-12-17T10:23:50.140995517Z [err]  2025-12-17 10:23:50,133 - server - INFO - â±ï¸ [10:23:50.133] ğŸ”Š TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-17T10:23:50.141009740Z [err]  2025-12-17 10:23:50,132 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=12.1s, checkin_count=0/2
2025-12-17T10:23:50.141010149Z [err]  2025-12-17 10:23:50,133 - server - INFO - âš¡ Using Turbo v2.5 (high quality)
2025-12-17T10:23:50.141016567Z [err]  2025-12-17 10:23:50,132 - calling_service - INFO - â° Check-in triggered after 12.1s silence (threshold: 7s)
2025-12-17T10:23:50.141017594Z [err]  2025-12-17 10:23:50,133 - server - INFO - ğŸ™ï¸ ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-17T10:23:50.141279700Z [err]  2025-12-17 10:23:50,132 - calling_service - INFO - ğŸ’¬ Sending check-in #1/2: Are you still there?
2025-12-17T10:23:50.141284818Z [err]  2025-12-17 10:23:50,132 - dead_air_monitor - INFO - ğŸ’¬ Sending check-in after 12.1s silence: Are you still there?
2025-12-17T10:23:50.141289330Z [err]  2025-12-17 10:23:50,132 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:50.141296324Z [err]  2025-12-17 10:23:50,133 - telnyx_service - INFO - ğŸ”Š Speaking text on call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg: Are you still there?...
2025-12-17T10:23:50.229711451Z [err]  2025-12-17 10:23:50,225 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:23:50.229718438Z [err]  2025-12-17 10:23:50,225 - server - INFO - ğŸ“¦ ElevenLabs Request Payload:
2025-12-17T10:23:50.229722739Z [err]  2025-12-17 10:23:50,225 - server - INFO -    Text length: 20 chars
2025-12-17T10:23:50.229727344Z [err]  2025-12-17 10:23:50,225 - server - INFO -    Text content: 'Are you still there?'
2025-12-17T10:23:50.229732001Z [err]  2025-12-17 10:23:50,226 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-17T10:23:50.229734584Z [err]  2025-12-17 10:23:50,226 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-17T10:23:50.229736562Z [err]  2025-12-17 10:23:50,226 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-17T10:23:50.229741502Z [err]  2025-12-17 10:23:50,226 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-17T10:23:50.229743621Z [err]  2025-12-17 10:23:50,226 - server - INFO - ğŸ”Œ Attempting ElevenLabs connection (attempt 1/2)
2025-12-17T10:23:50.229747245Z [err]  2025-12-17 10:23:50,226 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-17T10:23:50.229756617Z [err]  2025-12-17 10:23:50,226 - server - INFO -    Timeout: 10.0s
2025-12-17T10:23:50.244426217Z [err]  2025-12-17 10:23:50,242 - server - INFO -    âœ“ HTTP client created (0.016s)
2025-12-17T10:23:50.244437209Z [err]  2025-12-17 10:23:50,243 - server - INFO -    â†’ Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-17T10:23:50.889726957Z [err]  2025-12-17 10:23:50,551 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:50.889731549Z [err]  2025-12-17 10:23:50,551 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #24: 1 chunks received
2025-12-17T10:23:50.889735946Z [err]  2025-12-17 10:23:50,551 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #25: would you honestly be upset if you had an extra tw...
2025-12-17T10:23:50.889739721Z [err]  2025-12-17 10:23:50,605 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-17T10:23:50.889744176Z [err]  2025-12-17 10:23:50,605 - server - INFO -    âœ“ Connection established (0.379s) [TARGET: <200ms]
2025-12-17T10:23:50.889748181Z [err]  2025-12-17 10:23:50,605 - server - INFO -    âœ“ Response status: 200
2025-12-17T10:23:50.889751945Z [err]  2025-12-17 10:23:50,605 - server - INFO -    â†’ Streaming audio chunks...
2025-12-17T10:23:50.889756134Z [err]  2025-12-17 10:23:50,614 - server - INFO -    âœ“ FIRST CHUNK received (0.388s, 1076 bytes) [TARGET: <300ms]
2025-12-17T10:23:50.889760344Z [err]  2025-12-17 10:23:50,623 - server - INFO -    âœ“ ALL CHUNKS received: 63 chunks (0.396s)
2025-12-17T10:23:50.889764633Z [err]  2025-12-17 10:23:50,623 - server - INFO -    âœ“ Total audio size: 17599 bytes
2025-12-17T10:23:50.889768754Z [err]  2025-12-17 10:23:50,623 - server - INFO -    ğŸ“Š TTS API TIMING BREAKDOWN:
2025-12-17T10:23:50.889773527Z [err]  2025-12-17 10:23:50,623 - server - INFO -       - Connection: 379ms
2025-12-17T10:23:50.889777367Z [err]  2025-12-17 10:23:50,623 - server - INFO -       - First chunk: 388ms
2025-12-17T10:23:50.889781112Z [err]  2025-12-17 10:23:50,623 - server - INFO -       - All chunks: 396ms
2025-12-17T10:23:50.894021017Z [err]  2025-12-17 10:23:50,623 - server - INFO -       - Audio generation only: 9ms
2025-12-17T10:23:50.894025986Z [err]  2025-12-17 10:23:50,623 - server - INFO - â±ï¸ [10:23:50.623] ğŸ”Š TTS COMPLETE: 490ms, audio_size=17599 bytes
2025-12-17T10:23:50.894030246Z [err]  2025-12-17 10:23:50,623 - server - INFO - ğŸ’¾ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2025-12-17T10:23:50.894035014Z [err]  2025-12-17 10:23:50,623 - telnyx_service - INFO - â±ï¸  TTS generation time: 0.49s
2025-12-17T10:23:50.894040510Z [err]  2025-12-17 10:23:50,624 - telnyx_service - INFO - âœ… Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:23:50.894046723Z [err]  2025-12-17 10:23:50,624 - telnyx_service - INFO - ğŸ”— Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:23:50.919378378Z [err]  2025-12-17 10:23:50,915 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg/actions/playback_start "HTTP/1.1 200 OK"
2025-12-17T10:23:50.919384594Z [err]  2025-12-17 10:23:50,915 - telnyx_service - INFO - â±ï¸  Playback API call time: 0.29s
2025-12-17T10:23:50.919384798Z [err]  2025-12-17 10:23:50,915 - telnyx_service - INFO - ğŸ¬ Playback ID: FQOH_vm_PQ
2025-12-17T10:23:50.919390107Z [err]  2025-12-17 10:23:50,915 - telnyx_service - INFO - â±ï¸  Total TTS latency: 0.78s
2025-12-17T10:23:50.919394199Z [err]  2025-12-17 10:23:50,915 - telnyx_service - INFO - âœ… Playing elevenlabs audio via Telnyx playback
2025-12-17T10:23:50.925068620Z [err]  2025-12-17 10:23:50,920 - redis_service - INFO - â• Added playback FQOH_vm_PQ to Redis for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:50.925082116Z [err]  2025-12-17 10:23:50,920 - server - INFO - ğŸ¬ Check-in playback ID: FQOH_vm_PQ (expected duration: 2.6s)
2025-12-17T10:23:50.925093185Z [err]  2025-12-17 10:23:50,920 - dead_air_monitor - INFO - âœ… Check-in message sent
2025-12-17T10:23:50.927561228Z [err]  2025-12-17 10:23:50,924 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:23:50.927574808Z [err]  2025-12-17 10:23:50,924 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+372ms
2025-12-17T10:23:50.927579326Z [err]  2025-12-17 10:23:50,924 - persistent_tts_service - INFO - ğŸ“¤ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2025-12-17T10:23:50.927585115Z [err]  2025-12-17 10:23:50,924 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:50.927589206Z [err]  2025-12-17 10:23:50,924 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.7s (total: 4.3s from now)
2025-12-17T10:23:50.927593489Z [err]  2025-12-17 10:23:50,925 - persistent_tts_service - INFO - âœ… Sent 87 audio chunks via WebSocket
2025-12-17T10:23:50.932175533Z [err]  2025-12-17 10:23:50,930 - persistent_tts_service - INFO - ğŸ“¤ Sending 3297 bytes of audio (21 chunks, 0.4s duration) via WebSocket
2025-12-17T10:23:50.932181888Z [err]  2025-12-17 10:23:50,930 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:50.932187179Z [err]  2025-12-17 10:23:50,930 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +0.4s (total: 4.7s from now)
2025-12-17T10:23:50.932197979Z [err]  2025-12-17 10:23:50,931 - persistent_tts_service - INFO - âœ… Sent 21 audio chunks via WebSocket
2025-12-17T10:23:51.238128490Z [err]  2025-12-17 10:23:51,229 - persistent_tts_service - INFO - ğŸ“¤ Sending 20062 bytes of audio (126 chunks, 2.5s duration) via WebSocket
2025-12-17T10:23:51.238137346Z [err]  2025-12-17 10:23:51,229 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:23:51.238142445Z [err]  2025-12-17 10:23:51,229 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +2.5s (total: 6.9s from now)
2025-12-17T10:23:51.238147796Z [err]  2025-12-17 10:23:51,230 - persistent_tts_service - INFO - âœ… Sent 126 audio chunks via WebSocket
2025-12-17T10:23:51.368226287Z [inf]  100.64.0.12:13746 - "GET /api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3 HTTP/1.1" 200
2025-12-17T10:23:52.212139519Z [inf]  100.64.0.5:42576 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:23:52.212147023Z [err]  2025-12-17 10:23:52,206 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:23:52.212151163Z [err]  2025-12-17 10:23:52,206 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.started', 'id': '4322f39c-3b4d-494a-9329-e8d3ddfb7cd5', 'occurred_at': '2025-12-17T10:23:51.718808Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3', 'overlay': False, 'playback_id': 'FQOH_vm_PQ'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:23:52.212155653Z [err]  2025-12-17 10:23:52,206 - server - INFO - ğŸ¯ Event type: call.playback.started, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:52.212159734Z [err]  2025-12-17 10:23:52,206 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:23:53.233415266Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 16858ms (provider: elevenlabs, websocket: False)
2025-12-17T10:23:53.233423370Z [err]  2025-12-17 10:23:53,229 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:23:53.233425420Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 18245ms (user stopped â†’ play_audio_url called)
2025-12-17T10:23:53.233432897Z [err]  2025-12-17 10:23:53,229 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #25: 3 chunks received
2025-12-17T10:23:53.233438472Z [err]  2025-12-17 10:23:53,229 - server - INFO - âœ… All 7 persistent TTS streams completed
2025-12-17T10:23:53.233444823Z [err]  2025-12-17 10:23:53,229 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:23:53.233455410Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 18245ms from user stop ğŸš€
2025-12-17T10:23:53.233461859Z [err]  2025-12-17 10:23:53,229 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:53.233466912Z [err]  2025-12-17 10:23:53,229 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:23:53.233472429Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:53.233477713Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:23:53.233486888Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] STT: 14ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:23:53.233493749Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 1569ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:23:53.234031502Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:23:53.234037574Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:23:53.234041848Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:23:53.234046461Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:23:53.234050297Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:23:53.234054167Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 18545ms estimated
2025-12-17T10:23:53.234059115Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 256 chars, 7 sentences
2025-12-17T10:23:53.234063262Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'No, that'spr etty much it....'
2025-12-17T10:23:53.234067550Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: '[N] Alright, perfect. So to put some numbers on it, each sit...'
2025-12-17T10:23:53.234071509Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:23:53.234076634Z [err]  2025-12-17 10:23:53,229 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:23:53.249289487Z [err]  2025-12-17 10:23:53,246 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:23:53.249293867Z [err]  2025-12-17 10:23:53,246 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'c5a8c48d-d440-4be5-9652-4a675c28e1c4', 'occurred_at': '2025-12-17T10:23:52.818807Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3', 'overlay': False, 'playback_id': 'FQOH_vm_PQ', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:23:53.249299595Z [err]  2025-12-17 10:23:53,246 - server - INFO - ğŸ¯ Event type: call.playback.ended, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:53.249304300Z [err]  2025-12-17 10:23:53,246 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:23:53.250309820Z [err]  2025-12-17 10:23:53,248 - redis_service - INFO - â– Removed playback FQOH_vm_PQ, 0 remaining for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:53.250316261Z [err]  2025-12-17 10:23:53,248 - server - INFO - ğŸ”Š Redis: Removed playback FQOH_vm_PQ, 0 remaining
2025-12-17T10:23:53.250321278Z [err]  2025-12-17 10:23:53,249 - server - INFO - ğŸ”Š ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-17T10:23:53.256591127Z [err]  2025-12-17 10:23:53,252 - server - INFO - âœ… Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-17T10:23:53.256600245Z [err]  2025-12-17 10:23:53,252 - server - INFO - âœ… Found session in active_telnyx_calls (local worker)
2025-12-17T10:23:53.256606408Z [err]  2025-12-17 10:23:53,252 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967033.2527862 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:53.256612340Z [err]  2025-12-17 10:23:53,252 - server - INFO - â±ï¸ Silence timer STARTED (fallback, agent wasn't marked as speaking)
2025-12-17T10:23:53.256618179Z [inf]  100.64.0.9:36088 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:23:53.424849240Z [err]  2025-12-17 10:23:53,422 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive, Dead Air: 2083ms)
2025-12-17T10:23:53.424858453Z [err]  2025-12-17 10:23:53,422 - server - INFO - ğŸ”Š Agent finished generating, 1 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:23:53.440724677Z [err]  2025-12-17 10:23:53,436 - dead_air_monitor - INFO - ğŸš© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-17T10:23:53.440733440Z [err]  2025-12-17 10:23:53,436 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967033.4367545 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:53.440738373Z [err]  2025-12-17 10:23:53,436 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:55.015979538Z [err]  2025-12-17 10:23:55,010 - server - INFO - ğŸ“¤ Audio flowing: 6313 packets sent to Soniox (5s update)
2025-12-17T10:23:55.444779752Z [err]  2025-12-17 10:23:55,443 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (2.7s left)
2025-12-17T10:23:55.461133918Z [err]  2025-12-17 10:23:55,457 - server - INFO - ğŸ¤ Soniox receiver alive - 10 messages received in last 10s
2025-12-17T10:23:55.946559244Z [err]  2025-12-17 10:23:55,944 - dead_air_monitor - INFO - ğŸ”‡ MONITOR: Skipping silence check - audio playing (2.2s left)
2025-12-17T10:23:58.472924708Z [err]  2025-12-17 10:23:58,464 - persistent_tts_service - INFO - ğŸ”‡ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] FLOOR RELEASED (is_holding_floor=False)
2025-12-17T10:23:59.827165187Z [err]  2025-12-17 10:23:59,756 - server - INFO - ğŸ”¤ RAW TOKENS: [" No."âœ“, "<end>"âœ“]
2025-12-17T10:23:59.827171224Z [err]  2025-12-17 10:23:59,756 - server - INFO - ğŸ¯ Endpoint detected: <end> token received
2025-12-17T10:23:59.827176859Z [err]  2025-12-17 10:23:59,756 - server - INFO - ğŸ§¹ Cleaned transcript: ' No.' -> 'No.'
2025-12-17T10:23:59.827185609Z [err]  2025-12-17 10:23:59,757 - server - INFO - ğŸ“¥ FINAL TOKENS: 'No.' (1 tokens)
2025-12-17T10:23:59.827191188Z [err]  2025-12-17 10:23:59,757 - server - INFO - ğŸ¤ Soniox final transcript: 'No.'
2025-12-17T10:23:59.827196871Z [err]  2025-12-17 10:23:59,757 - server - INFO - ğŸ” FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-1.6s, generating=False, playbacks=1, is_active=False
2025-12-17T10:23:59.827203059Z [err]  2025-12-17 10:23:59,757 - server - INFO - ğŸš€ Spawned tracked background task for endpoint processing
2025-12-17T10:23:59.827235896Z [err]  2025-12-17 10:23:59,757 - server - INFO - â±ï¸ [10:23:59.757] ğŸ“ FINAL TRANSCRIPT RECEIVED: 'No.'
2025-12-17T10:23:59.827245082Z [err]  2025-12-17 10:23:59,757 - server - INFO - â±ï¸ [10:23:59.757] STT endpoint detection latency: 7ms
2025-12-17T10:23:59.827250990Z [err]  2025-12-17 10:23:59,757 - server - INFO - â±ï¸ [10:23:59.757] ğŸ¤ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-17T10:23:59.827256610Z [err]  2025-12-17 10:23:59,758 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (TTL: 3600s)
2025-12-17T10:23:59.827262483Z [err]  2025-12-17 10:23:59,758 - server - INFO - ğŸ‘¤ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-17T10:23:59.827268447Z [err]  2025-12-17 10:23:59,758 - server - INFO - âš ï¸ Agent marked as speaking but audio done and not generating - treating as SILENT
2025-12-17T10:23:59.827274625Z [err]  2025-12-17 10:23:59,758 - server - INFO - âœ… Agent SILENT - User said 1 word(s): 'No.' - Processing...
2025-12-17T10:23:59.827337099Z [err]  2025-12-17 10:23:59,768 - server - INFO - ğŸ¤ Endpoint detected by Soniox - processing transcript: No.
2025-12-17T10:23:59.827343546Z [err]  2025-12-17 10:23:59,768 - calling_service - INFO - ğŸ‘¤ User stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:59.827351901Z [err]  2025-12-17 10:23:59,769 - server - INFO - âœ… User starting new turn - resetting agent speaking flag
2025-12-17T10:23:59.827357776Z [err]  2025-12-17 10:23:59,769 - server - INFO - â±ï¸ [TIMING] STT_START: User last audio packet received
2025-12-17T10:23:59.827365176Z [err]  2025-12-17 10:23:59,769 - server - INFO - â±ï¸ [TIMING] STT_END: Endpoint detected at T+18ms
2025-12-17T10:23:59.827372475Z [err]  2025-12-17 10:23:59,769 - server - INFO - â±ï¸ [TIMING] STT_LATENCY: 18ms (Soniox model: stt-rt-v3)
2025-12-17T10:23:59.827378444Z [err]  2025-12-17 10:23:59,769 - server - INFO - â±ï¸  USER STOPPED SPEAKING at T=0ms
2025-12-17T10:23:59.827384301Z [err]  2025-12-17 10:23:59,769 - server - INFO - ğŸ™ï¸ Agent generating response - interruption detection active
2025-12-17T10:23:59.827392310Z [err]  2025-12-17 10:23:59,769 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:59.865115777Z [err]  2025-12-17 10:23:59,863 - server - INFO - ğŸ“ Saved user transcript to database
2025-12-17T10:23:59.865119995Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - âœ… PRE-TRANSITION: All mandatory vars satisfied on N_KB_Q&A_With_StrategicNarrative_V3_Adaptive - proceeding with transition
2025-12-17T10:23:59.865122203Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - â±ï¸ [10:23:59.864] ğŸ“¥ process_user_input() ENTRY - text: 'No....'
2025-12-17T10:23:59.865126858Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - â±ï¸ [10:23:59.864] â© About to call _process_call_flow_streaming()
2025-12-17T10:23:59.865131352Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - â±ï¸ [10:23:59.864] ğŸ”€ Agent type: call_flow, calling flow processor...
2025-12-17T10:23:59.865135580Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - â±ï¸ [10:23:59.864] ğŸ”€ _process_call_flow_streaming() ENTRY
2025-12-17T10:23:59.865139398Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - Flow processing - History length: 15, Is first: False
2025-12-17T10:23:59.865143334Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - ğŸ” Using explicitly set current_node_id: 1763206946898
2025-12-17T10:23:59.865146985Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - ğŸ” PRE-TRANSITION: Extracting mandatory vars on CURRENT node N_KB_Q&A_With_StrategicNarrative_V3_Adaptive before transition
2025-12-17T10:23:59.865166799Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - ğŸ” Real-time extraction: Processing 2 variables
2025-12-17T10:23:59.865170932Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO -   âœ“ has_discussed_income_potential: False (already extracted)
2025-12-17T10:23:59.865174823Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO -   âœ“ asked_upset: False (already extracted)
2025-12-17T10:23:59.865178667Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - âœ… All variables already extracted
2025-12-17T10:23:59.866513348Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - â±ï¸ [10:23:59.864] ğŸ”€ About to call _follow_transition() for: No....
2025-12-17T10:23:59.866521716Z [err]  2025-12-17 10:23:59,864 - calling_service - INFO - Evaluating transitions from N_KB_Q&A_With_StrategicNarrative_V3_Adaptive for message: No.
2025-12-17T10:23:59.873626665Z [err]  2025-12-17 10:23:59,871 - calling_service - INFO - â±ï¸ [10:23:59.871] ğŸ”€ TRANSITION EVALUATION START - Calling LLM for 1 options
2025-12-17T10:23:59.959014467Z [err]  2025-12-17 10:23:59,957 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (1.8s ago), marking agent as done speaking
2025-12-17T10:23:59.959026874Z [err]  2025-12-17 10:23:59,957 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967039.9571385 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:23:59.959034131Z [err]  2025-12-17 10:23:59,957 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:00.012468592Z [err]  2025-12-17 10:24:00,010 - server - INFO - ğŸ“¤ Audio flowing: 6563 packets sent to Soniox (5s update)
2025-12-17T10:24:00.437916424Z [err]  2025-12-17 10:24:00,434 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:24:00.437923866Z [err]  2025-12-17 10:24:00,435 - calling_service - INFO - â±ï¸ [10:24:00.435] ğŸ”€ TRANSITION EVALUATION COMPLETE - took 564ms
2025-12-17T10:24:00.437929038Z [err]  2025-12-17 10:24:00,435 - calling_service - INFO - ğŸ¤– AI transition decision: '0'
2025-12-17T10:24:00.437935367Z [err]  2025-12-17 10:24:00,435 - calling_service - INFO - ğŸ“Š Available transitions: ['...would you honestly be upset if you had an extra...']
2025-12-17T10:24:00.437940566Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - Selected transition index: 0
2025-12-17T10:24:00.437945277Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - Transition: N_KB_Q&A_With_StrategicNarrative_V3_Adaptive -> N200_Super_WorkAndIncomeBackground_V3_Adaptive
2025-12-17T10:24:00.437949488Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - â±ï¸ [TIMING] TRANSITION_EVAL: 571ms
2025-12-17T10:24:00.437954138Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - â±ï¸ [10:24:00.436] âœ… Node selected, about to process content...
2025-12-17T10:24:00.437959844Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{now}} with Wednesday, December 17, 2025 at 5:23 AM EST in content
2025-12-17T10:24:00.437964899Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{customer_name}} with Kendrick in content
2025-12-17T10:24:00.437968872Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{callerName}} with  in content
2025-12-17T10:24:00.437973234Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{lead_id}} with None in content
2025-12-17T10:24:00.437977163Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{qc_tracking_enabled}} with False in content
2025-12-17T10:24:00.437982173Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{track_keywords}} with  in content
2025-12-17T10:24:00.439252987Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{expected_commitment}} with not_specified in content
2025-12-17T10:24:00.439261653Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{to_number}} with +17708336397 in content
2025-12-17T10:24:00.439267686Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{phone_number}} with +17708336397 in content
2025-12-17T10:24:00.439273543Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{email}} with None in content
2025-12-17T10:24:00.439278983Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{has_discussed_income_potential}} with False in content
2025-12-17T10:24:00.439284439Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ”§ Replaced {{asked_upset}} with False in content
2025-12-17T10:24:00.439290074Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - Using flow node: N200_Super_WorkAndIncomeBackground_V3_Adaptive (type: conversation, mode: prompt)
2025-12-17T10:24:00.439295808Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - ğŸ“š skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-17T10:24:00.439300860Z [err]  2025-12-17 10:24:00,436 - calling_service - INFO - â±ï¸ [10:24:00.436] ğŸ“„ About to process content (mode=prompt, length=4059)
2025-12-17T10:24:00.459244861Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - âš¡ PARALLEL MODE: Running KB + analysis simultaneously
2025-12-17T10:24:00.459251714Z [err]  2025-12-17 10:24:00,452 - kb_router - INFO - ğŸš¦ KB Router: SKIP (simple chat pattern matched)
2025-12-17T10:24:00.459255639Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - âš¡ Skipping KB (reason: simple_chat)
2025-12-17T10:24:00.459259522Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - âš¡ Parallel operations completed in 0ms
2025-12-17T10:24:00.459263341Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ” Node 'N200_Super_WorkAndIncomeBackground_V3_Adaptive': use_parallel_llm=True
2025-12-17T10:24:00.459268118Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - âš¡ Parallel mode: Using condensed history (10/15 messages)
2025-12-17T10:24:00.459273531Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - â±ï¸ [10:24:00.452] ğŸ’¬ LLM REQUEST START: 15 conversation turns, 10977 system chars (KB cached)
2025-12-17T10:24:00.459277609Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â• LLM PROMPT BREAKDOWN â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:24:00.459282088Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“ [SYSTEM MSG 1 - GLOBAL PROMPT] (5826 chars):
2025-12-17T10:24:00.459286083Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-17T10:24:00.459290689Z [err]  
2025-12-17T10:24:00.459294586Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-17T10:24:00.459298548Z [err]  
2025-12-17T10:24:00.459302852Z [err]  If user says a name, don't assume it's theirsâ€”wait for explicit correction.
2025-12-17T10:24:00.459306630Z [err]  
2025-12-17T10:24:00.459311298Z [err]  If user asks to repeat info, rephrase naturallyâ€”never exact repeat.
2025-12-17T10:24:00.461675987Z [err]  
2025-12-17T10:24:00.461686461Z [err]  USER COMMUNICATION STYLE: C type - adjust your response accordingly
2025-12-17T10:24:00.461690327Z [err]  
2025-12-17T10:24:00.461694126Z [err]  CONVERSATION STATUS: Turn 8, objection handling phase
2025-12-17T10:24:00.461696336Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-17T10:24:00.461702108Z [err]  
2025-12-17T10:24:00.461702925Z [err]  
2025-12-17T10:24:00.461710456Z [err]  If asked about call number: "Company number."
2025-12-17T10:24:00.461711636Z [err]  This context is provided to help you focus. You still need to:
2025-12-17T10:24:00.461715354Z [err]  
2025-12-17T10:24:00.461719624Z [err]  1. Generate a natural, contextual response
2025-12-17T10:24:00.461720547Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-17T10:24:00.461725236Z [err]  2. Evaluate transitions per your node instructions
2025-12-17T10:24:00.461726476Z [err]  
2025-12-17T10:24:00.461731251Z [err]  If explaining ends in peri...
2025-12-17T10:24:00.461735374Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“ [SYSTEM MSG 2 - DYNAMIC CONTEXT] (5151 chars):
2025-12-17T10:24:00.461739804Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“   Preview: 
2025-12-17T10:24:00.461745468Z [err]  
2025-12-17T10:24:00.461749551Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:24:00.461753623Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-17T10:24:00.461758382Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:24:00.464316628Z [err]  
2025-12-17T10:24:00.464322402Z [err]  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2025-12-17T10:24:00.464329067Z [err]  
2025-12-17T10:24:00.464334925Z [err]  # CURRENT CONTEXT
2025-12-17T10:24:00.464341106Z [err]  Customer: Kendrick
2025-12-17T10:24:00.464347204Z [err]  Variables: {"now": "Wednesday, December 17, 2025 at 5:23 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment...
2025-12-17T10:24:00.464353922Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“ [CONVERSATION HISTORY] (10 messages)
2025-12-17T10:24:00.464360671Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“   assistant: [N] Alright, perfect. So to put some numbers on it, each site can bring in five hundred to two thous...
2025-12-17T10:24:00.464367068Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“   user: No....
2025-12-17T10:24:00.464372428Z [err]  2025-12-17 10:24:00,452 - calling_service - INFO - ğŸ“ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:24:00.464380183Z [err]  2025-12-17 10:24:00,459 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=1/2
2025-12-17T10:24:00.848109673Z [err]  2025-12-17 10:24:00,843 - server - INFO - ğŸ“ Telnyx WebSocket disconnected. Sent 6598 total packets
2025-12-17T10:24:00.848117275Z [err]  [2025-12-17 10:24:00 +0000] [3] [INFO] connection closed
2025-12-17T10:24:00.848123215Z [err]  2025-12-17 10:24:00,845 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:24:00.860416085Z [err]  2025-12-17 10:24:00,858 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:24:00.860422489Z [err]  2025-12-17 10:24:00,858 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '8e2fc0a7-0f00-46ce-b3bb-9ad1be3590c9', 'occurred_at': '2025-12-17T10:24:00.746229Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '881c001a-8204-4751-a291-102feeada3de', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:24:00.860426881Z [err]  2025-12-17 10:24:00,858 - server - INFO - ğŸ¯ Event type: streaming.stopped, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:00.860431188Z [err]  2025-12-17 10:24:00,858 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:24:00.860435406Z [inf]  100.64.0.9:36088 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:24:00.989751599Z [err]  2025-12-17 10:24:00,960 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=1/2
2025-12-17T10:24:01.073196998Z [err]  2025-12-17 10:24:01,068 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:24:01.073204473Z [err]  2025-12-17 10:24:01,068 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '2d4cb673-1ac6-4787-b8bf-351f22186daa', 'occurred_at': '2025-12-17T10:24:00.698804Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:24:00.698804Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'I4IeedsURw', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:24:01.073208935Z [err]  2025-12-17 10:24:01,068 - server - INFO - ğŸ¯ Event type: call.playback.ended, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:01.073212913Z [err]  2025-12-17 10:24:01,068 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:24:01.073217202Z [err]  2025-12-17 10:24:01,070 - redis_service - INFO - â– Removed playback I4IeedsURw, 0 remaining for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:01.073221190Z [err]  2025-12-17 10:24:01,070 - server - INFO - ğŸ”Š Redis: Removed playback I4IeedsURw, 0 remaining
2025-12-17T10:24:01.073226260Z [err]  2025-12-17 10:24:01,070 - server - INFO - ğŸ”Š ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-17T10:24:01.073230556Z [err]  2025-12-17 10:24:01,070 - server - INFO - âœ… Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-17T10:24:01.073234421Z [err]  2025-12-17 10:24:01,070 - server - INFO - ğŸ’¡ Session not on this worker - Redis flag set for WebSocket worker to handle
2025-12-17T10:24:01.074217250Z [inf]  100.64.0.7:62276 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:24:01.081579681Z [err]  2025-12-17 10:24:01,077 - calling_service - INFO - â±ï¸ [10:24:01.077] ğŸ’¬ LLM FIRST TOKEN: 625ms (grok grok-4-fast-non-reasoning)
2025-12-17T10:24:01.089377183Z [err]  2025-12-17 10:24:01,084 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:24:01.089388462Z [err]  2025-12-17 10:24:01,085 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.hangup', 'id': '49450461-5182-4bdd-86d3-280ed69d780e', 'occurred_at': '2025-12-17T10:24:00.618803Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '0.41', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '6650', 'skip_packet_count': '17'}, 'outbound': {'packet_count': '6597', 'skip_packet_count': '0'}}, 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:24:00.618803Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-17T10:21:34.258841Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:24:01.089398220Z [err]  2025-12-17 10:24:01,085 - server - INFO - ğŸ¯ Event type: call.hangup, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:01.089404054Z [err]  2025-12-17 10:24:01,085 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:24:01.089409942Z [err]  2025-12-17 10:24:01,085 - server - INFO - ğŸ“ Call ended: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:01.089416688Z [err]  2025-12-17 10:24:01,085 - server - INFO - ğŸ“ Hangup cause: normal_clearing
2025-12-17T10:24:01.116061763Z [err]  2025-12-17 10:24:01,114 - server - INFO - ğŸ“¤ Sentence arrived from LLM: [H] Awesome,...
2025-12-17T10:24:01.116067750Z [err]  2025-12-17 10:24:01,114 - server - INFO - â±ï¸ [TIMING] TTFS (Time To First Sentence): 1345ms
2025-12-17T10:24:01.116072489Z [err]  2025-12-17 10:24:01,114 - server - INFO - âš¡ Starting REAL-TIME TTS for first sentence
2025-12-17T10:24:01.116078338Z [err]  2025-12-17 10:24:01,114 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:24:01.117556596Z [err]  2025-12-17 10:24:01,114 - server - INFO - ğŸš€ Streaming sentence #1 via persistent WebSocket
2025-12-17T10:24:01.117562448Z [err]  2025-12-17 10:24:01,114 - server - INFO - ğŸµ TTS task #1 started at +0ms
2025-12-17T10:24:01.117569540Z [err]  2025-12-17 10:24:01,114 - server - INFO - â±ï¸ [TIMING] TTFT_TTS (First TTS Task Started): 1345ms
2025-12-17T10:24:01.117573458Z [err]  2025-12-17 10:24:01,114 - calling_service - INFO - ğŸ“¤ Streamed sentence: [H] Awesome,...
2025-12-17T10:24:01.117577573Z [err]  2025-12-17 10:24:01,116 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #26: [H] Awesome,...
2025-12-17T10:24:01.175087467Z [err]  2025-12-17 10:24:01,172 - server - INFO - ğŸ“¤ Sentence arrived from LLM: that's the reaction we love to hear....
2025-12-17T10:24:01.175093870Z [err]  2025-12-17 10:24:01,172 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:24:01.175102048Z [err]  2025-12-17 10:24:01,172 - server - INFO - ğŸš€ Streaming sentence #2 via persistent WebSocket
2025-12-17T10:24:01.175106748Z [err]  2025-12-17 10:24:01,172 - server - INFO - ğŸµ TTS task #2 started at +58ms
2025-12-17T10:24:01.175110914Z [err]  2025-12-17 10:24:01,173 - calling_service - INFO - ğŸ“¤ Streamed sentence: that's the reaction we love to hear....
2025-12-17T10:24:01.192157709Z [err]  2025-12-17 10:24:01,190 - server - INFO - ğŸ“¤ Sentence arrived from LLM: So,...
2025-12-17T10:24:01.192167512Z [err]  2025-12-17 10:24:01,190 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:24:01.192173889Z [err]  2025-12-17 10:24:01,190 - server - INFO - ğŸš€ Streaming sentence #3 via persistent WebSocket
2025-12-17T10:24:01.192179057Z [err]  2025-12-17 10:24:01,190 - server - INFO - ğŸµ TTS task #3 started at +76ms
2025-12-17T10:24:01.192187517Z [err]  2025-12-17 10:24:01,190 - calling_service - INFO - ğŸ“¤ Streamed sentence: So,...
2025-12-17T10:24:01.211172396Z [err]  2025-12-17 10:24:01,209 - server - INFO - ğŸ“¤ Sentence arrived from LLM: are you working for someone right now,...
2025-12-17T10:24:01.211179524Z [err]  2025-12-17 10:24:01,209 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:24:01.211184961Z [err]  2025-12-17 10:24:01,209 - server - INFO - ğŸš€ Streaming sentence #4 via persistent WebSocket
2025-12-17T10:24:01.212332423Z [err]  2025-12-17 10:24:01,209 - server - INFO - ğŸµ TTS task #4 started at +95ms
2025-12-17T10:24:01.212342694Z [err]  2025-12-17 10:24:01,209 - calling_service - INFO - ğŸ“¤ Streamed sentence: are you working for someone right now,...
2025-12-17T10:24:01.256468230Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - Total latency: 1.39s
2025-12-17T10:24:01.256480045Z [err]  2025-12-17 10:24:01,251 - server - INFO - âœ… LLM finished in 1482ms, TTS tasks already running in background
2025-12-17T10:24:01.256535537Z [err]  2025-12-17 10:24:01,251 - server - INFO - ğŸ“¤ Sentence arrived from LLM: or do you run your own business?...
2025-12-17T10:24:01.256543905Z [err]  2025-12-17 10:24:01,251 - server - INFO - ğŸ” Persistent TTS lookup: call_id=v3:iCGbXO2sdex363tJp..., session=FOUND
2025-12-17T10:24:01.256554566Z [err]  2025-12-17 10:24:01,251 - server - INFO - ğŸš€ Streaming sentence #5 via persistent WebSocket
2025-12-17T10:24:01.256561181Z [err]  2025-12-17 10:24:01,251 - server - INFO - ğŸµ TTS task #5 started at +136ms
2025-12-17T10:24:01.256567945Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - ğŸ“¤ Streamed final fragment: or do you run your own business?...
2025-12-17T10:24:01.256575244Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - â±ï¸ [TIMING] LLM_TOTAL: 798ms for 125 chars (grok grok-4-fast-non-reasoning)
2025-12-17T10:24:01.256582513Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - â±ï¸ SILENCE TIMER RESET (user gave meaningful response) for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:01.256588947Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - ğŸ”Š Silence tracking reset for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (user responded)
2025-12-17T10:24:01.256595562Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - âœ… User gave meaningful response to check-in, resetting counter
2025-12-17T10:24:01.256602143Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - ğŸ’¾ Storing node ID 1763175810279 in conversation history
2025-12-17T10:24:01.256609247Z [err]  2025-12-17 10:24:01,251 - calling_service - INFO - LLM response (1.39s): [H] Awesome, that's the reaction we love to hear. So, are you working for someone right now, or do you run your own business?
2025-12-17T10:24:01.257637443Z [err]  2025-12-17 10:24:01,251 - server - INFO - ğŸµ Streaming 5 TTS chunks as they complete...
2025-12-17T10:24:01.257645666Z [err]  2025-12-17 10:24:01,251 - server - INFO - ğŸš€ Persistent TTS: Audio already streaming in background!
2025-12-17T10:24:01.257652185Z [err]  2025-12-17 10:24:01,251 - server - INFO -    5 sentences queued and playing seamlessly
2025-12-17T10:24:01.364129153Z [err]  2025-12-17 10:24:01,362 - server - INFO - ğŸ“ Updated call log: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:01.429383369Z [err]  2025-12-17 10:24:01,425 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:24:01.429395211Z [err]  2025-12-17 10:24:01,425 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+309ms
2025-12-17T10:24:01.429405097Z [err]  2025-12-17 10:24:01,425 - persistent_tts_service - INFO - ğŸ“¤ Sending 7802 bytes of audio (49 chunks, 1.0s duration) via WebSocket
2025-12-17T10:24:01.429410827Z [err]  2025-12-17 10:24:01,426 - persistent_tts_service - INFO - ğŸ™ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-17T10:24:01.429415911Z [err]  2025-12-17 10:24:01,426 - persistent_tts_service - INFO - â±ï¸ EXTEND playback_expected_end_time: +1.0s (total: 1.0s from now)
2025-12-17T10:24:01.429422172Z [err]  2025-12-17 10:24:01,426 - persistent_tts_service - ERROR - âŒ Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-12-17T10:24:01.459499797Z [err]  2025-12-17 10:24:01,457 - server - INFO - âœ… Finalized call log: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg (duration=132s, status=completed)
2025-12-17T10:24:01.874908490Z [err]  2025-12-17 10:24:01,554 - server - INFO - ğŸ“¦ Saved 12 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'has_discussed_income_potential', 'asked_upset']
2025-12-17T10:24:02.206580911Z [err]  2025-12-17 10:24:02,204 - server - INFO - ğŸ“Š Auto-added call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-17T10:24:02.417824932Z [err]  2025-12-17 10:24:02,399 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:02.417832584Z [err]  2025-12-17 10:24:02,399 - server - INFO - ğŸ“‡ [HANGUP] Data source: redis=Yes, memory=No
2025-12-17T10:24:02.417839271Z [err]  2025-12-17 10:24:02,399 - server - INFO - ğŸ“‡ [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-17T10:24:02.494762550Z [err]  2025-12-17 10:24:02,493 - server - INFO - ğŸ“‡ [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-17T10:24:02.923903172Z [err]  2025-12-17 10:24:02,585 - server - INFO - ğŸ” [AUTO-QC] Starting campaign QC check for call=v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-17T10:24:02.923915421Z [err]  2025-12-17 10:24:02,586 - server - INFO - ğŸ“‡ CRM update starting for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:24:02.923928983Z [err]  2025-12-17 10:24:02,585 - server - INFO - ğŸ“Š Triggered Campaign QC for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:02.923939123Z [err]  2025-12-17 10:24:02,584 - server - INFO - ğŸ“‡ [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-17T10:24:02.923945165Z [err]  2025-12-17 10:24:02,584 - server - INFO - ğŸ“‡ [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-17T10:24:02.923950112Z [err]  2025-12-17 10:24:02,584 - server - INFO - ğŸ“‡ [HANGUP] Agent info keys: None
2025-12-17T10:24:02.923956767Z [err]  2025-12-17 10:24:02,584 - server - INFO - ğŸš€ Triggered QC analysis for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:02.923957598Z [err]  2025-12-17 10:24:02,585 - server - INFO - ğŸ“‡ Triggered CRM update for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:02.923966954Z [err]  2025-12-17 10:24:02,585 - persistent_tts_service - INFO - ğŸ”Œ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Closing persistent TTS WebSocket...
2025-12-17T10:24:02.923973798Z [err]  2025-12-17 10:24:02,585 - server - INFO - ğŸ” Starting QC analysis for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:02.925681559Z [err]  2025-12-17 10:24:02,586 - server - INFO - ğŸ“‡ Normalized phone: +17708336397
2025-12-17T10:24:02.925694444Z [err]  2025-12-17 10:24:02,586 - server - INFO - ğŸ“‡ CRM: Got 12 variables from active session
2025-12-17T10:24:02.925702146Z [err]  2025-12-17 10:24:02,587 - persistent_tts_service - INFO - ğŸ›‘ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Playback consumer shutting down
2025-12-17T10:24:02.925707902Z [err]  2025-12-17 10:24:02,678 - server - INFO - ğŸ“ Converted transcript from 15 messages to 1621 characters
2025-12-17T10:24:02.925714419Z [err]  2025-12-17 10:24:02,769 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:24:02.925720965Z [err]  2025-12-17 10:24:02,861 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-17T10:24:02.957013723Z [err]  2025-12-17 10:24:02,953 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-17T10:24:02.957022545Z [err]  2025-12-17 10:24:02,953 - qc_agents.orchestrator - INFO - âœ… Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:24:02.957028544Z [err]  2025-12-17 10:24:02,953 - qc_agents.orchestrator - INFO - ğŸ” Running Commitment Detector on call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.235393575Z [err]  2025-12-17 10:24:03,234 - server - INFO - ğŸ“‡ CRM: Got 12 extracted variables
2025-12-17T10:24:03.235400096Z [err]  2025-12-17 10:24:03,234 - server - INFO - ğŸ“‡ CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'has_discussed_income_potential', 'asked_upset']
2025-12-17T10:24:03.251912906Z [err]  2025-12-17 10:24:03,250 - server - INFO - ğŸ” [AUTO-QC] Call log found: transcript_turns=15, logs_count=16, status=completed
2025-12-17T10:24:03.303665965Z [err]  2025-12-17 10:24:03,298 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:24:03.303672496Z [err]  2025-12-17 10:24:03,298 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '1ea97b8b-e213-429e-9fd3-522b2bb16385', 'occurred_at': '2025-12-17T10:24:03.177517Z', 'payload': {'call_control_id': 'v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg', 'call_leg_id': '29a09960-db32-11f0-a93d-02420aef991f', 'call_session_id': '299daf0c-db32-11f0-bbb5-02420aef991f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:24:00.701654Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-17T10:24:00.701654Z', 'recording_id': 'ca5c9c86-6d7a-40e2-8077-b2b6262f8c15', 'recording_started_at': '2025-12-17T10:21:49.175366Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/29a09960-db32-11f0-a93d-02420aef991f-1765966909106797.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T102403Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=81b7763d78b44c7e653cc9785b50c35654e66fc00b00e17c8221d0c0c09308bb'}, 'start_time': '2025-12-17T10:21:49.175366Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:24:03.303678007Z [err]  2025-12-17 10:24:03,298 - server - INFO - ğŸ¯ Event type: call.recording.saved, Call ID: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.303682402Z [err]  2025-12-17 10:24:03,298 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:24:03.303686936Z [err]  2025-12-17 10:24:03,298 - server - INFO - ğŸ™ï¸ Recording saved for call: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.303690859Z [err]  2025-12-17 10:24:03,300 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.312767352Z [err]  2025-12-17 10:24:03,300 - server - INFO - ğŸ” Recording check: download_url=True, channels=dual, recording_id=ca5c9c86-6d7a-40e2-8077-b2b6262f8c15, call_data=True
2025-12-17T10:24:03.396796820Z [err]  2025-12-17 10:24:03,395 - server - INFO - ğŸ’¾ Saved recording URL and ID to database: ca5c9c86-6d7a-40e2-8077-b2b6262f8c15
2025-12-17T10:24:03.396803176Z [err]  2025-12-17 10:24:03,395 - server - INFO - âœ… Entering dual-channel processing
2025-12-17T10:24:03.396808638Z [err]  2025-12-17 10:24:03,396 - server - INFO - ğŸ“¥ Downloading DUAL-CHANNEL recording...
2025-12-17T10:24:03.410011622Z [err]  2025-12-17 10:24:03,409 - server - INFO - ğŸ“‡ CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-17T10:24:03.434734812Z [err]  2025-12-17 10:24:03,426 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:24:03.434741713Z [err]  2025-12-17 10:24:03,427 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #26: 1 chunks received
2025-12-17T10:24:03.434746773Z [err]  2025-12-17 10:24:03,427 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #27: that's the reaction we love to hear....
2025-12-17T10:24:03.918646437Z [err]  2025-12-17 10:24:03,677 - server - INFO - ğŸ” [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-17T10:24:03.918651832Z [err]  2025-12-17 10:24:03,700 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/29a09960-db32-11f0-a93d-02420aef991f-1765966909106797.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T102403Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=81b7763d78b44c7e653cc9785b50c35654e66fc00b00e17c8221d0c0c09308bb "HTTP/1.1 200 OK"
2025-12-17T10:24:03.918656118Z [err]  2025-12-17 10:24:03,704 - elevenlabs_ws_service - INFO - ğŸ”Œ Closed ElevenLabs WebSocket connection
2025-12-17T10:24:03.918660582Z [err]  2025-12-17 10:24:03,704 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Persistent TTS WebSocket closed
2025-12-17T10:24:03.918665075Z [err]  2025-12-17 10:24:03,704 - persistent_tts_service - INFO - âœ… Closed persistent TTS session for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.918670151Z [err]  2025-12-17 10:24:03,704 - server - INFO - âœ… Closed persistent TTS session for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.918681599Z [err]  2025-12-17 10:24:03,704 - redis_service - INFO - ğŸ§¹ Deleted call data from Redis: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.918694788Z [err]  2025-12-17 10:24:03,704 - server - INFO - ğŸ§¹ Cleaned up call session from Redis and memory: v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:03.918700624Z [inf]  100.64.0.7:62284 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:24:03.918716079Z [err]  2025-12-17 10:24:03,705 - elevenlabs_ws_service - ERROR - âŒ Error sending text to ElevenLabs: sent 1000 (OK); then received 1000 (OK)
2025-12-17T10:24:03.919939572Z [err]  2025-12-17 10:24:03,764 - server - ERROR - âŒ [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-17T10:24:03.919941388Z [err]  2025-12-17 10:24:03,705 - elevenlabs_ws_service - ERROR - âŒ WebSocket not connected
2025-12-17T10:24:03.919948507Z [err]  2025-12-17 10:24:03,705 - elevenlabs_ws_service - ERROR - âŒ WebSocket not connected
2025-12-17T10:24:03.919953774Z [err]  2025-12-17 10:24:03,705 - persistent_tts_service - WARNING - âš ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #27 with 0 chunks received! (Time: 278ms)
2025-12-17T10:24:03.919958552Z [err]  2025-12-17 10:24:03,705 - persistent_tts_service - WARNING - âš ï¸ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] TTS WebSocket disconnected, attempting reconnection...
2025-12-17T10:24:03.919962876Z [err]  2025-12-17 10:24:03,705 - persistent_tts_service - INFO - ğŸ”„ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Attempting TTS WebSocket reconnection...
2025-12-17T10:24:03.919967233Z [err]  2025-12-17 10:24:03,705 - elevenlabs_ws_service - INFO - ğŸ”Œ Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-17T10:24:03.919971618Z [err]  2025-12-17 10:24:03,705 - elevenlabs_ws_service - INFO - ğŸ™ï¸ Voice settings: stability=0.4, similarity=0.75, style=0.2
2025-12-17T10:24:03.919976206Z [err]  2025-12-17 10:24:03,763 - server - INFO - ğŸ“Š [AUTO-QC] Running full QC analysis: call=v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg â†’ campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-17T10:24:03.919981222Z [err]  2025-12-17 10:24:03,764 - server - INFO - ğŸ“Š [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-17T10:24:03.919987070Z [err]  2025-12-17 10:24:03,764 - server - ERROR - âŒ [AUTO-QC] Error in campaign QC for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:24:03.920947277Z [err]    File "/app/backend/server.py", line 9510, in trigger_campaign_qc_for_call
2025-12-17T10:24:03.920965257Z [err]      await run_full_qc_analysis(
2025-12-17T10:24:03.920989291Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-17T10:24:03.920993747Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:24:03.921007519Z [err]  
2025-12-17T10:24:03.921011747Z [err]  2025-12-17 10:24:03,834 - elevenlabs_ws_service - INFO - âœ… Connected to ElevenLabs WebSocket
2025-12-17T10:24:03.921027761Z [err]  2025-12-17 10:24:03,835 - elevenlabs_ws_service - INFO - ğŸ“¤ Sent BOS message with voice settings
2025-12-17T10:24:03.921041072Z [err]  2025-12-17 10:24:03,835 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] TTS WebSocket reconnected
2025-12-17T10:24:03.921055764Z [err]  2025-12-17 10:24:03,835 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] TTS WebSocket reconnected successfully
2025-12-17T10:24:03.921059736Z [err]  2025-12-17 10:24:03,835 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #28: So,...
2025-12-17T10:24:03.921063154Z [err]  2025-12-17 10:24:03,835 - persistent_tts_service - INFO - ğŸ’“ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Starting TTS keep-alive loop (every 15s)
2025-12-17T10:24:04.047914536Z [err]  2025-12-17 10:24:04,040 - server - INFO - âœ… Downloaded 526462 bytes
2025-12-17T10:24:04.375778793Z [err]  2025-12-17 10:24:04,373 - server - INFO - âŒ Channel 1: No speech
2025-12-17T10:24:04.375779358Z [err]  2025-12-17 10:24:04,372 - server - INFO - âœ… Split into 2 channels
2025-12-17T10:24:04.375791573Z [err]  2025-12-17 10:24:04,373 - server - WARNING - âš ï¸ No speech in any channel
2025-12-17T10:24:04.375796567Z [err]  2025-12-17 10:24:04,372 - server - INFO - ğŸ¤ Using STT provider: soniox for interruption detection
2025-12-17T10:24:04.375801423Z [inf]  100.64.0.5:42576 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:24:04.375808220Z [err]  2025-12-17 10:24:04,372 - server - INFO - ğŸ“Š Channel 0: 2897884 bytes
2025-12-17T10:24:04.375808691Z [err]  2025-12-17 10:24:04,374 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:24:04.375816265Z [err]  2025-12-17 10:24:04,374 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+539ms
2025-12-17T10:24:04.375818145Z [err]  2025-12-17 10:24:04,372 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:24:04.375825106Z [err]  2025-12-17 10:24:04,372 - server - INFO - âŒ Channel 0: No speech
2025-12-17T10:24:04.375832040Z [err]  2025-12-17 10:24:04,373 - server - INFO - ğŸ“Š Channel 1: 2897884 bytes
2025-12-17T10:24:04.375838444Z [err]  2025-12-17 10:24:04,373 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:24:06.376885589Z [err]  2025-12-17 10:24:06,374 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:24:06.376895525Z [err]  2025-12-17 10:24:06,374 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #28: 1 chunks received
2025-12-17T10:24:06.376903225Z [err]  2025-12-17 10:24:06,375 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #29: are you working for someone right now,...
2025-12-17T10:24:06.955759665Z [err]  2025-12-17 10:24:06,659 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:24:06.955766602Z [err]  2025-12-17 10:24:06,659 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+285ms
2025-12-17T10:24:08.843868822Z [err]  2025-12-17 10:24:08,660 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:24:08.843879283Z [err]  2025-12-17 10:24:08,660 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #29: 1 chunks received
2025-12-17T10:24:08.843886186Z [err]  2025-12-17 10:24:08,660 - persistent_tts_service - INFO - ğŸ¤ [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Streaming sentence #30: or do you run your own business?...
2025-12-17T10:24:08.984243195Z [err]  2025-12-17 10:24:08,977 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_START: Sent to ElevenLabs at T+0ms
2025-12-17T10:24:08.984249279Z [err]  2025-12-17 10:24:08,977 - persistent_tts_service - INFO - â±ï¸ [TIMING] TTS_TTFB: First audio chunk at T+317ms
2025-12-17T10:24:10.502054017Z [err]  2025-12-17 10:24:10,499 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:24:10.979741597Z [err]  2025-12-17 10:24:10,977 - elevenlabs_ws_service - INFO - â±ï¸  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-17T10:24:10.979748463Z [err]  2025-12-17 10:24:10,977 - persistent_tts_service - INFO - âœ… [Call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg] Finished streaming sentence #30: 1 chunks received
2025-12-17T10:24:10.979753917Z [err]  2025-12-17 10:24:10,977 - server - INFO - âœ… All 5 persistent TTS streams completed
2025-12-17T10:24:10.979758548Z [err]  2025-12-17 10:24:10,977 - server - INFO - âœ… Agent generation complete (persistent TTS) - response window closed
2025-12-17T10:24:10.979762407Z [err]  2025-12-17 10:24:10,977 - server - INFO - â±ï¸  FIRST AUDIO STARTED: 11208ms from user stop ğŸš€
2025-12-17T10:24:10.979765985Z [err]  2025-12-17 10:24:10,977 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:10.979770053Z [err]  2025-12-17 10:24:10,977 - server - INFO - âœ… Agent generation complete - response window closed
2025-12-17T10:24:10.979773957Z [err]  2025-12-17 10:24:10,977 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:24:10.979777714Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-17T10:24:10.979781840Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] STT: 18ms (provider: soniox, model: stt-rt-v3)
2025-12-17T10:24:10.979786001Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] LLM_TOTAL: 1482ms (provider: grok, model: grok-4-fast-non-reasoning)
2025-12-17T10:24:10.979790028Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] TTS_TOTAL: 9863ms (provider: elevenlabs, websocket: False)
2025-12-17T10:24:10.979794274Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] E2E_TOTAL: 11208ms (user stopped â†’ play_audio_url called)
2025-12-17T10:24:10.981433428Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] âš ï¸ NOTE: E2E_TOTAL does not include:
2025-12-17T10:24:10.981442010Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-17T10:24:10.981447858Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-17T10:24:10.981454174Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-17T10:24:10.981457512Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] AI_RESPONSE: '[H] Awesome, that's the reaction we love to hear. So, are yo...'
2025-12-17T10:24:10.981462537Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-17T10:24:10.981472231Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING]   - REAL USER LATENCY: 11508ms estimated
2025-12-17T10:24:10.981473195Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] ==========================
2025-12-17T10:24:10.981486770Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] RESPONSE_TEXT: 125 chars, 5 sentences
2025-12-17T10:24:10.981491048Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2025-12-17T10:24:10.981496801Z [err]  2025-12-17 10:24:10,978 - server - INFO - â±ï¸  [TIMING] USER_INPUT: 'No....'
2025-12-17T10:24:11.012471059Z [err]  2025-12-17 10:24:11,008 - dead_air_monitor - INFO - ğŸš© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-17T10:24:11.012477170Z [err]  2025-12-17 10:24:11,008 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967051.0083249 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:11.012481892Z [err]  2025-12-17 10:24:11,008 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:11.161312659Z [err]  2025-12-17 10:24:11,158 - server - INFO - ğŸ“ Saved assistant transcript and latency to database (Node: N200_Super_WorkAndIncomeBackground_V3_Adaptive, Dead Air: 2000ms)
2025-12-17T10:24:11.161319022Z [err]  2025-12-17 10:24:11,158 - server - INFO - ğŸ”Š Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-17T10:24:14.180690155Z [err]  2025-12-17 10:24:14,171 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:24:14.180694165Z [err]  2025-12-17 10:24:14,178 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T10:24:14.181837575Z [err]  2025-12-17 10:24:14,180 - qc_agents.orchestrator - INFO - ğŸ—ºï¸  Running Conversion Pathfinder on call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:18.044823627Z [err]  2025-12-17 10:24:18,042 - calling_service - INFO - â° Check-in triggered after 7.0s silence (threshold: 7s)
2025-12-17T10:24:18.046665804Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - âœ… Generated 17599 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:24:18.046671856Z [err]  2025-12-17 10:24:18,044 - calling_service - INFO - ğŸ’¬ Sending check-in #1/2: Are you still there?
2025-12-17T10:24:18.046671897Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - ğŸ”— Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-17T10:24:18.046680735Z [err]  2025-12-17 10:24:18,044 - dead_air_monitor - INFO - ğŸ’¬ Sending check-in after 7.0s silence: Are you still there?
2025-12-17T10:24:18.046687231Z [err]  2025-12-17 10:24:18,044 - calling_service - INFO - ğŸ¤– Agent started speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:18.046694495Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - ğŸ”Š Speaking text on call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg: Are you still there?...
2025-12-17T10:24:18.046700342Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - ğŸ” Agent config provided: True
2025-12-17T10:24:18.046706892Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - ğŸ” TTS provider from settings: elevenlabs
2025-12-17T10:24:18.046712769Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - ğŸ” WebSocket TTS: False
2025-12-17T10:24:18.046718561Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - ğŸ™ï¸ Attempting elevenlabs TTS (REST)
2025-12-17T10:24:18.046725041Z [err]  2025-12-17 10:24:18,044 - server - INFO - ğŸ’¾ TTS CACHE HIT: Returning cached audio (17599 bytes)
2025-12-17T10:24:18.046730103Z [err]  2025-12-17 10:24:18,044 - telnyx_service - INFO - â±ï¸  TTS generation time: 0.00s
2025-12-17T10:24:18.254648333Z [err]  2025-12-17 10:24:18,245 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T10:24:18.254656084Z [err]  2025-12-17 10:24:18,245 - telnyx_service - INFO - â±ï¸  Playback API call time: 0.20s
2025-12-17T10:24:18.254661510Z [err]  2025-12-17 10:24:18,246 - telnyx_service - ERROR - âŒ Telnyx playback failed: 422 - {
2025-12-17T10:24:18.254665615Z [err]    "errors": [
2025-12-17T10:24:18.254669474Z [err]      {
2025-12-17T10:24:18.254673273Z [err]        "code": "90018",
2025-12-17T10:24:18.254678207Z [err]        "title": "Call has already ended",
2025-12-17T10:24:18.254683237Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-17T10:24:18.254688820Z [err]      }
2025-12-17T10:24:18.254692549Z [err]    ]
2025-12-17T10:24:18.254696301Z [err]  }
2025-12-17T10:24:18.254700606Z [err]  2025-12-17 10:24:18,246 - telnyx_service - INFO - ğŸ“¢ Using Telnyx built-in TTS
2025-12-17T10:24:18.516868861Z [err]  2025-12-17 10:24:18,501 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-17T10:24:18.516880629Z [err]  2025-12-17 10:24:18,501 - telnyx_service - ERROR - âŒ Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-17T10:24:18.516886878Z [err]  2025-12-17 10:24:18,501 - dead_air_monitor - INFO - âœ… Check-in message sent
2025-12-17T10:24:19.012927900Z [err]  2025-12-17 10:24:19,010 - dead_air_monitor - INFO - â±ï¸ Playback expected end time passed (16.6s ago), marking agent as done speaking
2025-12-17T10:24:19.012933278Z [err]  2025-12-17 10:24:19,010 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967059.0102293 for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:19.012938504Z [err]  2025-12-17 10:24:19,010 - calling_service - INFO - ğŸ¤– Agent stopped speaking for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:19.223080573Z [err]  2025-12-17 10:24:19,216 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:24:19.223086670Z [err]  2025-12-17 10:24:19,218 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Expecting value: line 1 column 1 (char 0), falling back to patterns
2025-12-17T10:24:19.223092683Z [err]  2025-12-17 10:24:19,219 - qc_agents.orchestrator - INFO - â­ Running Excellence Replicator on call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:20.013958487Z [err]  2025-12-17 10:24:20,012 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=1/2
2025-12-17T10:24:20.518213241Z [err]  2025-12-17 10:24:20,513 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=1.5s, checkin_count=1/2
2025-12-17T10:24:20.952573593Z [err]  2025-12-17 10:24:20,939 - server - ERROR - âŒ Soniox error: {'tokens': [], 'final_audio_proc_ms': 130680, 'total_audio_proc_ms': 131760, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-17T10:24:20.952582778Z [err]  2025-12-17 10:24:20,939 - server - INFO - âœ… Soniox receive loop ended normally
2025-12-17T10:24:20.952588539Z [err]  2025-12-17 10:24:20,939 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring cancelled for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:20.952593491Z [err]  2025-12-17 10:24:20,939 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring stopped for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:20.952599704Z [err]  2025-12-17 10:24:20,939 - server - INFO - ğŸ”‡ Dead air monitoring task cancelled
2025-12-17T10:24:20.952739482Z [err]  2025-12-17 10:24:20,939 - server - INFO - ğŸ¤ Soniox receiver alive - 6 messages received in last 10s
2025-12-17T10:24:22.969332340Z [err]  2025-12-17 10:24:22,941 - soniox_service - ERROR - âŒ Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-17T10:24:22.969337152Z [err]  2025-12-17 10:24:22,941 - server - INFO - ğŸ”Œ Telnyx WebSocket disconnected
2025-12-17T10:24:25.070519473Z [err]  2025-12-17 10:24:25,069 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-17T10:24:25.073060603Z [err]  2025-12-17 10:24:25,070 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Expecting value: line 1 column 1 (char 0)
2025-12-17T10:24:25.162226058Z [err]  2025-12-17 10:24:25,160 - qc_agents.orchestrator - INFO - âœ… QC analysis stored for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:25.162233573Z [err]  2025-12-17 10:24:25,160 - server - INFO - âœ… QC analysis completed for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:25.162238123Z [err]  2025-12-17 10:24:25,160 - server - INFO - ğŸ“Š Scores: Commitment=50, Conversion=60, Excellence=50
2025-12-17T10:24:25.345296846Z [err]  2025-12-17 10:24:25,340 - server - INFO - ğŸ“Š Updated campaign_calls with QC scores for v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg
2025-12-17T10:24:25.524439846Z [err]  2025-12-17 10:24:25,518 - server - INFO - ğŸ“ˆ Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-17T10:24:25.607543683Z [err]  2025-12-17 10:24:25,606 - server - INFO - ğŸ·ï¸ Updated lead status to 'contacted' based on risk level 'medium'
2025-12-17T10:24:25.608945242Z [err]  2025-12-17 10:24:25,607 - server - ERROR - âŒ Error in auto appointment detection for call v3:iCGbXO2sdex363tJpATvO6Q-x3i8fgGvtyr_cnoMwgBc9Hx7SnQMOg: 'str' object has no attribute 'get'
2025-12-17T10:25:05.613307171Z [err]  2025-12-17 10:24:59,155 - server - INFO - ğŸŒ Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:25:05.613314742Z [err]  2025-12-17 10:24:59,239 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:25:05.613320183Z [err]  2025-12-17 10:24:59,324 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:25:05.613325332Z [err]  2025-12-17 10:24:59,719 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:25:05.613329509Z [err]  2025-12-17 10:24:59,719 - telnyx_service - INFO - ğŸ“ Initiating outbound call from +14048000152 to +17708336397
2025-12-17T10:25:05.613333677Z [err]  2025-12-17 10:24:59,719 - telnyx_service - INFO - ğŸ¤– Enabling AMD (premium mode)
2025-12-17T10:25:05.613339037Z [err]  2025-12-17 10:24:59,719 - telnyx_service - INFO - ğŸŒ Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-17T10:25:05.613345872Z [err]  2025-12-17 10:25:00,478 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:05.613349535Z [err]  2025-12-17 10:25:00,478 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.initiated', 'id': '0962f7ea-d951-404d-8969-89d7acc99fe1', 'occurred_at': '2025-12-17T10:25:00.307991Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:05.613353157Z [err]  2025-12-17 10:25:00,478 - server - INFO - ğŸ¯ Event type: call.initiated, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.614393826Z [err]  2025-12-17 10:25:00,478 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:05.614402723Z [err]  2025-12-17 10:25:00,669 - server - INFO - ğŸ“¦ Call data stored in Redis and memory
2025-12-17T10:25:05.614403436Z [err]  2025-12-17 10:25:00,478 - server - INFO - ğŸ“ Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-17T10:25:05.614409601Z [inf]  100.64.0.7:62284 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:05.614415951Z [err]  2025-12-17 10:25:00,539 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-17T10:25:05.614419750Z [err]  2025-12-17 10:25:00,669 - server - INFO - ğŸ“ Outbound call initiated: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.614422890Z [err]  2025-12-17 10:25:00,540 - telnyx_service - INFO - âœ… Call initiated: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.614429742Z [err]  2025-12-17 10:25:00,640 - server - INFO - ğŸ“ Created call log: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.614430676Z [inf]  100.64.0.3:16194 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-17T10:25:05.614438695Z [err]  2025-12-17 10:25:00,669 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A (TTL: 3600s)
2025-12-17T10:25:05.614444235Z [err]  2025-12-17 10:25:00,944 - server - INFO - ğŸ”ŒğŸ”ŒğŸ”Œ WEBSOCKET CONNECTION ATTEMPT
2025-12-17T10:25:05.614451416Z [err]  2025-12-17 10:25:00,944 - server - INFO -    Client: Address(host='100.64.0.2', port=15284)
2025-12-17T10:25:05.614464357Z [err]  2025-12-17 10:25:00,944 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'niiCNrRUtFv3XdhKmPvxvA==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-east4-eqdc4a', 'x-railway-request-id': '7SkDxbJ5Qa21DpYePvyhXg', 'x-real-ip': '192.76.120.151', 'x-request-start': '1765967100789', 'accept-encoding': 'gzip'}
2025-12-17T10:25:05.615604532Z [err]  2025-12-17 10:25:00,944 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-17T10:25:05.615613694Z [err]  2025-12-17 10:25:00,944 - server - INFO - ğŸ”Œ Incoming Telnyx WebSocket connection
2025-12-17T10:25:05.615620701Z [err]  [2025-12-17 10:25:00 +0000] [6] [INFO] ('100.64.0.2', 15284) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-17T10:25:05.615627870Z [err]  2025-12-17 10:25:00,945 - server - INFO - âœ… WebSocket accepted, waiting for Telnyx events
2025-12-17T10:25:05.615634927Z [err]  [2025-12-17 10:25:00 +0000] [6] [INFO] connection open
2025-12-17T10:25:05.615640874Z [err]  2025-12-17 10:25:01,092 - server - INFO - ğŸ“¬ Received Telnyx event: connected
2025-12-17T10:25:05.615648191Z [err]  2025-12-17 10:25:01,092 - server - INFO - ğŸ“ Telnyx connected event received, waiting for 'start'...
2025-12-17T10:25:05.615654538Z [err]  2025-12-17 10:25:04,559 - server - INFO - ğŸ“¬ Received Telnyx event: start
2025-12-17T10:25:05.615664363Z [err]  2025-12-17 10:25:04,559 - server - INFO - ğŸ¬ Stream started for call: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.615673686Z [err]  2025-12-17 10:25:04,563 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:05.615681392Z [err]  2025-12-17 10:25:04,563 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.answered', 'id': '8347472a-a819-4852-838e-2e0f2c270d32', 'occurred_at': '2025-12-17T10:25:04.248022Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-17T10:25:00.307991Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:05.617594884Z [err]  2025-12-17 10:25:04,667 - server - INFO - âœ… Call log updated
2025-12-17T10:25:05.617605941Z [err]  2025-12-17 10:25:04,668 - server - INFO - ğŸ”§ Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:25:05.617614626Z [err]  2025-12-17 10:25:04,563 - server - INFO - ğŸ¯ Event type: call.answered, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.617617524Z [err]  2025-12-17 10:25:04,755 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:25:05.617623380Z [err]  2025-12-17 10:25:04,563 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:05.617629292Z [err]  2025-12-17 10:25:04,563 - server - INFO - âœ… Call answered: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.617634269Z [err]  2025-12-17 10:25:04,565 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.617641679Z [err]  2025-12-17 10:25:04,567 - server - INFO - âœ… Call data found after 0s wait
2025-12-17T10:25:05.617651021Z [err]  2025-12-17 10:25:04,567 - server - INFO - â³ Session not found locally, waiting briefly for webhook...
2025-12-17T10:25:05.617651557Z [err]  2025-12-17 10:25:04,841 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:25:05.617661324Z [err]  2025-12-17 10:25:04,577 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.617661498Z [err]  2025-12-17 10:25:04,841 - server - INFO - ğŸ”§ Creating Telnyx service with user's keys...
2025-12-17T10:25:05.617668576Z [err]  2025-12-17 10:25:04,578 - server - INFO - âœ… Found call in Redis (multi-worker state sharing working)
2025-12-17T10:25:05.617674116Z [err]  2025-12-17 10:25:04,578 - server - INFO - ğŸ“ Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-17T10:25:05.618506643Z [err]  2025-12-17 10:25:04,875 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-17T10:25:05.618512932Z [err]  2025-12-17 10:25:05,067 - server - INFO - âš ï¸ Session still not found after wait, will create in worker
2025-12-17T10:25:05.618517610Z [err]  2025-12-17 10:25:05,068 - server - WARNING - âš ï¸ Session not found after waiting, creating in WebSocket worker...
2025-12-17T10:25:05.618521696Z [err]  2025-12-17 10:25:05,128 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.618528232Z [err]  2025-12-17 10:25:05,130 - server - INFO - ğŸ“ Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:25:05.618533406Z [err]  2025-12-17 10:25:05,130 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:25:05.618542337Z [err]  2025-12-17 10:25:05,147 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A/actions/playback_start "HTTP/1.1 200 OK"
2025-12-17T10:25:05.618546561Z [err]  2025-12-17 10:25:05,148 - telnyx_service - INFO - âœ… Playing audio from URL, playback_id: kIKQwcgxxQ (loop=True, overlay=True)
2025-12-17T10:25:05.618655011Z [err]  2025-12-17 10:25:05,148 - server - WARNING - âš ï¸ Failed to start comfort noise: 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A'
2025-12-17T10:25:05.618661879Z [err]  2025-12-17 10:25:05,148 - telnyx_service - INFO - ğŸ™ï¸ Starting recording: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.618667187Z [err]  2025-12-17 10:25:05,202 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:05.618671455Z [err]  2025-12-17 10:25:05,202 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.started', 'id': 'eca88423-a91f-4fd2-b7d9-aecc2013cc66', 'occurred_at': '2025-12-17T10:25:04.748001Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '75d1a70e-7814-441c-aafd-8d98cb18eae2', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:05.619469410Z [err]  2025-12-17 10:25:05,202 - server - INFO - ğŸ¯ Event type: streaming.started, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.619474606Z [err]  2025-12-17 10:25:05,202 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:05.619478716Z [inf]  100.64.0.3:16194 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:05.619483261Z [err]  2025-12-17 10:25:05,215 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:25:05.619488408Z [err]  2025-12-17 10:25:05,215 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:25:05.619491355Z [err]  2025-12-17 10:25:05,309 - server - INFO - âœ… Session created in WebSocket worker
2025-12-17T10:25:05.619493331Z [err]  2025-12-17 10:25:05,215 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:25:05.619497923Z [err]  2025-12-17 10:25:05,215 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:25:05.619503753Z [err]  2025-12-17 10:25:05,215 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:25:05.619504980Z [err]  2025-12-17 10:25:05,309 - server - INFO - ğŸ“ Call data loaded, starting SONIOX connection...
2025-12-17T10:25:05.619508471Z [err]  2025-12-17 10:25:05,300 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:25:05.619513477Z [err]  2025-12-17 10:25:05,309 - server - INFO - âœ… Initialized call_states for v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A with session reference
2025-12-17T10:25:05.619514432Z [err]  2025-12-17 10:25:05,309 - calling_service - INFO - âœ… LLM client pre-warmed in 93ms
2025-12-17T10:25:05.619521052Z [err]  2025-12-17 10:25:05,309 - server - INFO - âœ… Stored Telnyx WebSocket in call_data for audio streaming
2025-12-17T10:25:05.621233223Z [err]  2025-12-17 10:25:05,309 - persistent_tts_service - WARNING - âš ï¸  No persistent TTS session found to update for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.621241859Z [err]  2025-12-17 10:25:05,395 - server - INFO - ğŸ”‘ Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-17T10:25:05.621248372Z [inf]  100.64.0.3:16194 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:05.621254493Z [err]  2025-12-17 10:25:05,455 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:05.621262063Z [err]  2025-12-17 10:25:05,455 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.started', 'id': '49fab034-e986-4b46-928a-02c9cde1597f', 'occurred_at': '2025-12-17T10:25:05.208006Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'kIKQwcgxxQ', 'start_time': '2025-12-17T10:25:05.208006Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:05.621268349Z [err]  2025-12-17 10:25:05,455 - server - INFO - ğŸ¯ Event type: call.playback.started, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:05.621274444Z [err]  2025-12-17 10:25:05,455 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:06.116904225Z [err]  2025-12-17 10:25:05,890 - soniox_service - INFO - âœ… Connected to Soniox Real-Time STT
2025-12-17T10:25:06.116911318Z [err]  2025-12-17 10:25:05,890 - soniox_service - INFO - âš™ï¸  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-17T10:25:06.116917066Z [err]  2025-12-17 10:25:05,890 - soniox_service - INFO - âš™ï¸  Endpoint detection: True, Speaker diarization: False
2025-12-17T10:25:06.116923057Z [err]  2025-12-17 10:25:05,890 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring started for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:06.116930991Z [err]  2025-12-17 10:25:05,894 - server - INFO - âœ… Started forwarding audio (8kHz mulaw â†’ Soniox, NO BUFFERING)
2025-12-17T10:25:06.626635637Z [err]  2025-12-17 10:25:06,623 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A/actions/record_start "HTTP/1.1 200 OK"
2025-12-17T10:25:06.628933106Z [err]  2025-12-17 10:25:06,625 - server - INFO - ğŸ™ï¸ Call recording started for v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:06.628945018Z [err]  2025-12-17 10:25:06,625 - server - INFO - ğŸ”§ Creating call session for v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A...
2025-12-17T10:25:06.628954327Z [err]  2025-12-17 10:25:06,625 - server - INFO - ğŸ” Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:25:06.628962137Z [err]  2025-12-17 10:25:06,625 - server - INFO - ğŸ”§ Calling create_call_session() - START
2025-12-17T10:25:06.628969348Z [err]  2025-12-17 10:25:06,625 - calling_service - INFO - ğŸ” Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-17T10:25:06.717138922Z [err]  2025-12-17 10:25:06,712 - calling_service - INFO - ğŸ” KB count query completed: 4 items
2025-12-17T10:25:06.717145745Z [err]  2025-12-17 10:25:06,712 - calling_service - INFO - ğŸ“š Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-17T10:25:06.717150042Z [err]  2025-12-17 10:25:06,712 - calling_service - INFO - ğŸ“‹ Built cached system prompt: 4424 chars (global) + 1402 chars (technical)
2025-12-17T10:25:06.717154276Z [err]  2025-12-17 10:25:06,712 - calling_service - INFO - ğŸ“š KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-17T10:25:06.717159173Z [err]  2025-12-17 10:25:06,712 - calling_service - INFO - ğŸ”¥ Pre-warming LLM client (grok)...
2025-12-17T10:25:07.135810617Z [err]  2025-12-17 10:25:06,806 - calling_service - INFO - âœ… LLM client pre-warmed in 94ms
2025-12-17T10:25:07.135816644Z [err]  2025-12-17 10:25:06,798 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-17T10:25:07.135820671Z [err]  2025-12-17 10:25:06,806 - server - INFO - ğŸ”§ Calling create_call_session() - COMPLETE
2025-12-17T10:25:07.135833140Z [err]  2025-12-17 10:25:06,806 - server - INFO - âœ… Session object created: CallSession
2025-12-17T10:25:07.135839145Z [err]  2025-12-17 10:25:06,816 - server - INFO - âœ… Session stored in worker memory (not Redis)
2025-12-17T10:25:07.135845290Z [err]  2025-12-17 10:25:06,816 - redis_service - INFO - ğŸ“¦ Stored call data in Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A (TTL: 3600s)
2025-12-17T10:25:07.135864102Z [err]  2025-12-17 10:25:06,819 - redis_service - INFO - âœ… Marked session ready in Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:07.135867085Z [err]  2025-12-17 10:25:06,816 - server - INFO - âœ… Serializable call_data synced to Redis (agent_id, user_id)
2025-12-17T10:25:07.135872718Z [err]  2025-12-17 10:25:06,819 - server - INFO - ğŸ¤– AI session created for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:07.135872960Z [err]  2025-12-17 10:25:06,819 - server - INFO - â­ï¸ Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-17T10:25:07.135879739Z [err]  2025-12-17 10:25:06,819 - server - INFO - ğŸ‘¤ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-17T10:25:07.135882082Z [err]  2025-12-17 10:25:06,819 - server - INFO - ğŸ“¦ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-17T10:25:07.138254943Z [err]  2025-12-17 10:25:06,819 - server - INFO - ğŸ‘‚ User speaks first - waiting for user input...
2025-12-17T10:25:07.138262272Z [err]  2025-12-17 10:25:06,819 - server - ERROR - Error processing webhook: cannot access local variable 'asyncio' where it is not associated with a value
2025-12-17T10:25:07.138270641Z [inf]  100.64.0.7:62284 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:10.100656125Z [err]  2025-12-17 10:25:10,008 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:10.100660348Z [inf]  100.64.0.9:36088 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:10.100664534Z [err]  2025-12-17 10:25:10,008 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '2b0cd6c1-b9b0-44ed-9337-e878bbdbbfd2', 'occurred_at': '2025-12-17T10:25:09.547996Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'silence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:10.100669321Z [err]  2025-12-17 10:25:10,008 - server - INFO - ğŸ¯ Event type: call.machine.premium.detection.ended, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:10.100674113Z [err]  2025-12-17 10:25:10,008 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:10.414000286Z [err]  2025-12-17 10:25:10,412 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:11.012431421Z [err]  2025-12-17 10:25:10,910 - server - INFO - ğŸ“¤ Audio flowing: 296 packets sent to Soniox (5s update)
2025-12-17T10:25:11.012435799Z [err]  2025-12-17 10:25:10,914 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:16.051434530Z [err]  2025-12-17 10:25:15,928 - server - INFO - ğŸ“¤ Audio flowing: 547 packets sent to Soniox (5s update)
2025-12-17T10:25:17.146063645Z [err]  2025-12-17 10:25:16,907 - server - INFO - ğŸ¤ Soniox receiver alive - 11 messages received in last 10s
2025-12-17T10:25:20.452709667Z [err]  2025-12-17 10:25:20,451 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:21.039433464Z [err]  2025-12-17 10:25:20,931 - server - INFO - ğŸ“¤ Audio flowing: 795 packets sent to Soniox (5s update)
2025-12-17T10:25:21.039439482Z [err]  2025-12-17 10:25:20,954 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:26.045768889Z [err]  2025-12-17 10:25:25,948 - server - INFO - ğŸ“¤ Audio flowing: 1046 packets sent to Soniox (5s update)
2025-12-17T10:25:27.655394612Z [err]  2025-12-17 10:25:27,653 - server - INFO - ğŸ¤ Soniox receiver alive - 10 messages received in last 10s
2025-12-17T10:25:30.493117128Z [err]  2025-12-17 10:25:30,484 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:31.122507654Z [err]  2025-12-17 10:25:30,968 - server - INFO - ğŸ“¤ Audio flowing: 1297 packets sent to Soniox (5s update)
2025-12-17T10:25:31.122513217Z [err]  2025-12-17 10:25:30,986 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:31.789081488Z [err]  2025-12-17 10:25:31,788 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:31.789092528Z [err]  2025-12-17 10:25:31,788 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '3a9cac25-6a66-4e8b-a1c4-e39080bf9032', 'occurred_at': '2025-12-17T10:25:31.548001Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:25:31.548001Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'kIKQwcgxxQ', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:31.789099744Z [err]  2025-12-17 10:25:31,788 - server - INFO - ğŸ¯ Event type: call.playback.ended, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:31.790315505Z [err]  2025-12-17 10:25:31,788 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:31.791966620Z [err]  2025-12-17 10:25:31,790 - redis_service - INFO - â– Removed playback kIKQwcgxxQ, 0 remaining for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:31.791971874Z [err]  2025-12-17 10:25:31,790 - server - INFO - ğŸ”Š Redis: Removed playback kIKQwcgxxQ, 0 remaining
2025-12-17T10:25:31.791975752Z [err]  2025-12-17 10:25:31,790 - server - INFO - ğŸ”Š ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-17T10:25:31.793659669Z [err]  2025-12-17 10:25:31,791 - server - INFO - âœ… Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-17T10:25:31.793665891Z [err]  2025-12-17 10:25:31,791 - server - INFO - âœ… Found session in active_telnyx_calls (local worker)
2025-12-17T10:25:31.793670950Z [err]  2025-12-17 10:25:31,791 - calling_service - INFO - â±ï¸ SILENCE TIMER STARTED at 1765967131.7914903 for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:31.793675511Z [err]  2025-12-17 10:25:31,791 - server - INFO - â±ï¸ Silence timer STARTED (fallback, agent wasn't marked as speaking)
2025-12-17T10:25:31.793680540Z [inf]  100.64.0.7:62284 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:31.793685205Z [err]  2025-12-17 10:25:31,792 - server - INFO - ğŸ“ Telnyx WebSocket disconnected. Sent 1327 total packets
2025-12-17T10:25:31.793690194Z [err]  [2025-12-17 10:25:31 +0000] [6] [INFO] connection closed
2025-12-17T10:25:32.200591003Z [err]  2025-12-17 10:25:31,929 - server - INFO - ğŸ“ Hangup cause: normal_clearing
2025-12-17T10:25:32.200600143Z [err]  2025-12-17 10:25:32,015 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:32.200607025Z [err]  2025-12-17 10:25:32,016 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'streaming.stopped', 'id': 'eca91d2d-13d7-46da-b929-034a72ec7a1a', 'occurred_at': '2025-12-17T10:25:31.690970Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '75d1a70e-7814-441c-aafd-8d98cb18eae2', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:32.200635982Z [err]  2025-12-17 10:25:31,929 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:32.200640977Z [err]  2025-12-17 10:25:31,929 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.hangup', 'id': '74664dfa-c7b3-47f5-bf48-102b96fc60d8', 'occurred_at': '2025-12-17T10:25:31.467996Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '80.40', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '1354', 'skip_packet_count': '19'}, 'outbound': {'packet_count': '1334', 'skip_packet_count': '0'}}, 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:25:31.467996Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-17T10:25:00.307991Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:32.200648411Z [err]  2025-12-17 10:25:31,929 - server - INFO - ğŸ¯ Event type: call.hangup, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:32.200653645Z [err]  2025-12-17 10:25:31,929 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:32.200659077Z [err]  2025-12-17 10:25:31,929 - server - INFO - ğŸ“ Call ended: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:32.202159119Z [err]  2025-12-17 10:25:32,016 - server - INFO - ğŸ¯ Event type: streaming.stopped, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:32.202166918Z [err]  2025-12-17 10:25:32,016 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:32.202172395Z [inf]  100.64.0.5:25290 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:32.202178357Z [err]  2025-12-17 10:25:32,106 - server - INFO - ğŸ“ Updated call log: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:32.202183897Z [err]  2025-12-17 10:25:32,196 - server - INFO - âœ… Finalized call log: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A (duration=27s, status=completed)
2025-12-17T10:25:32.286942988Z [err]  2025-12-17 10:25:32,284 - server - INFO - ğŸ“¦ Saved 10 session variables to call_log: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email']
2025-12-17T10:25:33.153692880Z [err]  2025-12-17 10:25:33,145 - server - INFO - ğŸ“‡ [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-17T10:25:33.153703113Z [err]  2025-12-17 10:25:33,145 - server - INFO - ğŸ“‡ [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-17T10:25:33.153709736Z [err]  2025-12-17 10:25:33,145 - server - INFO - ğŸ“‡ [HANGUP] Agent info keys: ['id', 'user_id', 'name', 'description', 'voice', 'language', 'model', 'status', 'agent_type', 'system_prompt', 'call_flow', 'settings', 'stats', 'created_at', 'updated_at', 'auto_qc_settings', 'language_pattern_qc_agent_id', 'tonality_qc_agent_id', 'tech_issues_qc_agent_id']
2025-12-17T10:25:33.153715932Z [err]  2025-12-17 10:25:33,146 - server - INFO - ğŸš€ Triggered QC analysis for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.153720966Z [err]  2025-12-17 10:25:33,146 - server - INFO - ğŸ“Š Triggered Campaign QC for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.153728271Z [err]  2025-12-17 10:25:33,146 - server - INFO - ğŸ“‡ Triggered CRM update for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.153735504Z [err]  2025-12-17 10:25:33,146 - server - INFO - âœ… Closed persistent TTS session for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.153740817Z [err]  2025-12-17 10:25:33,147 - redis_service - INFO - ğŸ§¹ Deleted call data from Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.153785040Z [err]  2025-12-17 10:25:32,964 - server - INFO - ğŸ“Š Auto-added call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-17T10:25:33.153791533Z [err]  2025-12-17 10:25:33,144 - redis_service - INFO - ğŸ“¥ Retrieved call data from Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.158008842Z [inf]  100.64.0.3:16194 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:33.158021306Z [err]  2025-12-17 10:25:33,148 - server - INFO - ğŸ” Starting QC analysis for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.158031502Z [err]  2025-12-17 10:25:33,148 - server - INFO - ğŸ” [AUTO-QC] Starting campaign QC check for call=v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-17T10:25:33.158033201Z [err]  2025-12-17 10:25:33,147 - server - INFO - ğŸ§¹ Cleaned up call session from Redis and memory: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.158040261Z [err]  2025-12-17 10:25:33,148 - server - INFO - ğŸ“‡ CRM update starting for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-17T10:25:33.158048313Z [err]  2025-12-17 10:25:33,148 - server - INFO - ğŸ“‡ Normalized phone: +17708336397
2025-12-17T10:25:33.158059042Z [err]  2025-12-17 10:25:33,148 - server - INFO - ğŸ“‡ CRM: Got 10 variables from active session
2025-12-17T10:25:33.158067415Z [err]  2025-12-17 10:25:33,148 - server - INFO - ğŸ“‡ CRM: Got 9 variables from custom_variables
2025-12-17T10:25:33.235338558Z [err]  2025-12-17 10:25:33,233 - server - WARNING - âš ï¸ No transcript available for QC analysis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.236491381Z [err]  2025-12-17 10:25:33,235 - server - INFO - ğŸ” [AUTO-QC] Call log found: transcript_turns=0, logs_count=2, status=completed
2025-12-17T10:25:33.245523862Z [err]  2025-12-17 10:25:33,242 - server - INFO - ğŸ“‡ CRM: Got 10 extracted variables
2025-12-17T10:25:33.245532708Z [err]  2025-12-17 10:25:33,242 - server - INFO - ğŸ“‡ CRM: Total variables collected: ['now', 'customer_name', 'callerName', 'lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'to_number', 'phone_number', 'email', 'from_number']
2025-12-17T10:25:33.433657444Z [err]  2025-12-17 10:25:33,431 - server - INFO - ğŸ“‡ CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name', 'custom_fields']
2025-12-17T10:25:33.665840607Z [err]  2025-12-17 10:25:33,657 - server - INFO - ğŸ” [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-17T10:25:33.745915466Z [err]  2025-12-17 10:25:33,742 - server - INFO - ğŸ“Š [AUTO-QC] Running full QC analysis: call=v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A â†’ campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-17T10:25:33.745926210Z [err]  2025-12-17 10:25:33,742 - server - INFO - ğŸ“Š [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-17T10:25:33.745932520Z [err]  2025-12-17 10:25:33,742 - server - ERROR - âŒ [AUTO-QC] Error in campaign QC for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:25:33.745938125Z [err]  2025-12-17 10:25:33,743 - server - ERROR - âŒ [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-17T10:25:33.745943477Z [err]    File "/app/backend/server.py", line 9510, in trigger_campaign_qc_for_call
2025-12-17T10:25:33.745948811Z [err]      await run_full_qc_analysis(
2025-12-17T10:25:33.745953641Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-17T10:25:33.745962668Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-17T10:25:33.745968456Z [err]  
2025-12-17T10:25:33.780448152Z [err]  2025-12-17 10:25:33,772 - server - INFO - ğŸ“¨ ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-17T10:25:33.780460378Z [err]  2025-12-17 10:25:33,772 - server - INFO - ğŸ“¨ Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '9652b748-354b-4161-adcf-92fcc24f381a', 'occurred_at': '2025-12-17T10:25:33.529887Z', 'payload': {'call_control_id': 'v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A', 'call_leg_id': 'a451afc8-db32-11f0-bfa0-02420aef971f', 'call_session_id': 'a44e823a-db32-11f0-94b3-02420aef971f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-17T10:25:31.606507Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-17T10:25:31.606507Z', 'recording_id': 'aba0a24c-39d8-4930-9602-033306a81822', 'recording_started_at': '2025-12-17T10:25:06.347042Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/a451afc8-db32-11f0-bfa0-02420aef971f-1765967105439656.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T102533Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=8a3ac38352906bc4483abe538a4f44eafdef5f1e335a38b2101c241a39cbfd81'}, 'start_time': '2025-12-17T10:25:06.347042Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-17T10:25:33.780470376Z [err]  2025-12-17 10:25:33,772 - server - INFO - ğŸ¯ Event type: call.recording.saved, Call ID: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.780478134Z [err]  2025-12-17 10:25:33,772 - server - INFO - ğŸ“¨ ================================================
2025-12-17T10:25:33.780483462Z [err]  2025-12-17 10:25:33,772 - server - INFO - ğŸ™ï¸ Recording saved for call: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.780489511Z [err]  2025-12-17 10:25:33,775 - redis_service - WARNING - âš ï¸ Call data not found in Redis: v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:33.781593705Z [err]  2025-12-17 10:25:33,775 - server - INFO - ğŸ” Recording check: download_url=True, channels=dual, recording_id=aba0a24c-39d8-4930-9602-033306a81822, call_data=False
2025-12-17T10:25:34.128865114Z [err]  2025-12-17 10:25:33,864 - server - INFO - ğŸ’¾ Saved recording URL and ID to database: aba0a24c-39d8-4930-9602-033306a81822
2025-12-17T10:25:34.131437328Z [err]  2025-12-17 10:25:33,864 - server - INFO - âœ… Entering dual-channel processing
2025-12-17T10:25:34.131447555Z [err]  2025-12-17 10:25:33,864 - server - INFO - ğŸ“¥ Downloading DUAL-CHANNEL recording...
2025-12-17T10:25:34.277589939Z [err]  2025-12-17 10:25:34,265 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-17/a451afc8-db32-11f0-bfa0-02420aef971f-1765967105439656.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251217%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251217T102533Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=8a3ac38352906bc4483abe538a4f44eafdef5f1e335a38b2101c241a39cbfd81 "HTTP/1.1 200 OK"
2025-12-17T10:25:34.448877555Z [err]  2025-12-17 10:25:34,447 - server - INFO - âœ… Downloaded 100980 bytes
2025-12-17T10:25:34.649604092Z [err]  2025-12-17 10:25:34,646 - server - INFO - âœ… Split into 2 channels
2025-12-17T10:25:34.649612507Z [err]  2025-12-17 10:25:34,646 - server - INFO - ğŸ¤ Using STT provider: soniox for interruption detection
2025-12-17T10:25:34.649617940Z [err]  2025-12-17 10:25:34,646 - server - INFO - ğŸ“Š Channel 0: 552684 bytes
2025-12-17T10:25:34.649622321Z [err]  2025-12-17 10:25:34,646 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:25:34.649626806Z [err]  2025-12-17 10:25:34,646 - server - INFO - âŒ Channel 0: No speech
2025-12-17T10:25:34.649632786Z [err]  2025-12-17 10:25:34,646 - server - INFO - ğŸ“Š Channel 1: 552684 bytes
2025-12-17T10:25:34.649637215Z [err]  2025-12-17 10:25:34,646 - server - ERROR - âŒ No Soniox API key available
2025-12-17T10:25:34.649641969Z [err]  2025-12-17 10:25:34,646 - server - INFO - âŒ Channel 1: No speech
2025-12-17T10:25:34.649648077Z [err]  2025-12-17 10:25:34,646 - server - WARNING - âš ï¸ No speech in any channel
2025-12-17T10:25:34.649652743Z [inf]  100.64.0.3:16194 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-17T10:25:40.166065488Z [err]  2025-12-17 10:25:40,164 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:40.673151258Z [err]  2025-12-17 10:25:40,666 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:50.211682070Z [err]  2025-12-17 10:25:50,194 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:50.698511429Z [err]  2025-12-17 10:25:50,696 - dead_air_monitor - INFO - ğŸ” MONITOR: agent_speaking=False, user_speaking=False, silence=0.0s, checkin_count=0/2
2025-12-17T10:25:51.790021338Z [err]  2025-12-17 10:25:51,787 - server - INFO - ğŸ¤ Soniox receiver alive - 4 messages received in last 10s
2025-12-17T10:25:51.790028936Z [err]  2025-12-17 10:25:51,787 - server - ERROR - âŒ Soniox error: {'tokens': [], 'final_audio_proc_ms': 20400, 'total_audio_proc_ms': 25560, 'error_code': 408, 'error_message': 'Request timeout.'}
2025-12-17T10:25:51.790035932Z [err]  2025-12-17 10:25:51,787 - server - INFO - âœ… Soniox receive loop ended normally
2025-12-17T10:25:51.790044345Z [err]  2025-12-17 10:25:51,787 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring cancelled for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:51.790049753Z [err]  2025-12-17 10:25:51,787 - dead_air_monitor - INFO - ğŸ”‡ Dead air monitoring stopped for call v3:AbxXrA4cWi7IGqy6uN1QPBr_dV6bYrWfDJ9BoVlGFwMRooNLoaeu4A
2025-12-17T10:25:51.790056441Z [err]  2025-12-17 10:25:51,787 - server - INFO - ğŸ”‡ Dead air monitoring task cancelled
2025-12-17T10:25:53.796094973Z [err]  2025-12-17 10:25:53,791 - soniox_service - ERROR - âŒ Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2025-12-17T10:25:53.796100143Z [err]  2025-12-17 10:25:53,791 - server - INFO - ğŸ”Œ Telnyx WebSocket disconnected