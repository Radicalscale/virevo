2026-01-10T22:35:50.000000000Z [inf]  Starting Container
2026-01-10T22:35:51.190187641Z [inf]  üîç Python path: /app/backend
2026-01-10T22:35:51.190202788Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2026-01-10T22:35:51.190203338Z [inf]  =========================================
2026-01-10T22:35:51.190216931Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2026-01-10T22:35:51.190222376Z [err]  [2026-01-10 22:35:50 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2026-01-10T22:35:51.190227376Z [inf]  =========================================
2026-01-10T22:35:51.190228722Z [err]  [2026-01-10 22:35:50 +0000] [4] [INFO] Booting worker with pid: 4
2026-01-10T22:35:51.190237340Z [inf]  üìç Working directory: /app/backend
2026-01-10T22:35:51.190239344Z [err]  [2026-01-10 22:35:50 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2026-01-10T22:35:51.190242305Z [err]  [2026-01-10 22:35:50 +0000] [5] [INFO] Booting worker with pid: 5
2026-01-10T22:35:51.190252711Z [inf]  =========================================
2026-01-10T22:35:51.190254071Z [err]  [2026-01-10 22:35:50 +0000] [3] [INFO] Booting worker with pid: 3
2026-01-10T22:35:51.190255976Z [err]  [2026-01-10 22:35:50 +0000] [6] [INFO] Booting worker with pid: 6
2026-01-10T22:35:51.190267278Z [err]  [2026-01-10 22:35:50 +0000] [1] [INFO] Starting gunicorn 22.0.0
2026-01-10T22:36:11.263065874Z [err]  2026-01-10 22:36:03,041 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T22:36:11.263066885Z [err]  2026-01-10 22:36:02,895 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T22:36:11.263080954Z [err]  2026-01-10 22:36:02,906 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T22:36:11.263081684Z [err]  2026-01-10 22:36:02,895 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T22:36:11.263087428Z [err]  2026-01-10 22:36:02,978 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T22:36:11.263096746Z [err]  2026-01-10 22:36:02,978 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T22:36:11.263100892Z [err]  2026-01-10 22:36:02,910 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T22:36:11.263108168Z [err]  2026-01-10 22:36:02,985 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T22:36:11.263109108Z [err]  2026-01-10 22:36:02,964 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T22:36:11.263113209Z [err]  2026-01-10 22:36:02,900 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2026-01-10T22:36:11.263117737Z [err]  2026-01-10 22:36:02,964 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T22:36:11.263117812Z [err]  2026-01-10 22:36:03,027 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T22:36:11.263125693Z [err]  2026-01-10 22:36:02,900 - server - INFO - üî• Pre-warming connection libraries...
2026-01-10T22:36:11.263127623Z [err]  2026-01-10 22:36:02,977 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2026-01-10T22:36:11.264183570Z [err]  2026-01-10 22:36:03,152 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T22:36:11.264185866Z [err]  2026-01-10 22:36:03,233 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T22:36:11.264190741Z [err]  2026-01-10 22:36:03,205 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T22:36:11.264194039Z [err]  2026-01-10 22:36:03,092 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T22:36:11.264195077Z [err]  2026-01-10 22:36:03,185 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T22:36:11.264201729Z [err]  2026-01-10 22:36:03,237 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T22:36:11.264205708Z [err]  2026-01-10 22:36:03,206 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T22:36:11.264206240Z [err]  2026-01-10 22:36:03,093 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2026-01-10T22:36:11.264207448Z [err]  2026-01-10 22:36:03,189 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T22:36:11.264215751Z [err]  2026-01-10 22:36:03,205 - server - INFO - ‚úÖ QC agent router loaded
2026-01-10T22:36:11.264216116Z [err]  2026-01-10 22:36:03,146 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T22:36:11.264224271Z [err]  2026-01-10 22:36:03,151 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T22:36:11.264229137Z [err]  2026-01-10 22:36:03,208 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T22:36:11.264235562Z [err]  2026-01-10 22:36:03,152 - server - INFO - ‚úÖ QC enhanced router loaded
2026-01-10T22:36:11.264238453Z [err]  2026-01-10 22:36:03,209 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T22:36:11.264245403Z [err]  2026-01-10 22:36:03,211 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T22:36:11.264255126Z [err]  2026-01-10 22:36:03,232 - server - INFO - ‚úÖ QC learning router loaded
2026-01-10T22:36:11.265013617Z [err]  2026-01-10 22:36:03,378 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T22:36:11.265022213Z [err]  2026-01-10 22:36:03,380 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T22:36:11.265026091Z [err]  2026-01-10 22:36:03,237 - server - INFO - ‚úÖ Voice library router loaded
2026-01-10T22:36:11.265032400Z [err]  2026-01-10 22:36:03,309 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T22:36:11.265038034Z [err]  2026-01-10 22:36:03,319 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T22:36:11.265043777Z [err]  2026-01-10 22:36:03,322 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T22:36:11.265049351Z [err]  2026-01-10 22:36:03,324 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T22:36:11.265054708Z [err]  2026-01-10 22:36:03,341 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T22:36:11.265060004Z [err]  2026-01-10 22:36:03,349 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T22:36:11.265065120Z [err]  2026-01-10 22:36:03,352 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T22:36:11.265070391Z [err]  2026-01-10 22:36:03,352 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T22:36:11.265075663Z [err]  2026-01-10 22:36:03,355 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T22:36:11.265080980Z [err]  2026-01-10 22:36:03,356 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T22:36:11.265086338Z [err]  [2026-01-10 22:36:03 +0000] [4] [INFO] Started server process [4]
2026-01-10T22:36:11.265091704Z [err]  [2026-01-10 22:36:03 +0000] [4] [INFO] Waiting for application startup.
2026-01-10T22:36:11.265097399Z [err]  [2026-01-10 22:36:03 +0000] [6] [INFO] Started server process [6]
2026-01-10T22:36:11.265102656Z [err]  [2026-01-10 22:36:03 +0000] [6] [INFO] Waiting for application startup.
2026-01-10T22:36:11.266384450Z [err]  2026-01-10 22:36:09,596 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T22:36:11.266389507Z [err]  2026-01-10 22:36:03,443 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T22:36:11.266390069Z [err]  2026-01-10 22:36:03,417 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T22:36:11.266396492Z [err]  2026-01-10 22:36:03,417 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T22:36:11.266399399Z [err]  [2026-01-10 22:36:03 +0000] [3] [INFO] Started server process [3]
2026-01-10T22:36:11.266401915Z [err]  2026-01-10 22:36:03,423 - server - INFO - ‚úÖ Director Studio router loaded
2026-01-10T22:36:11.266407924Z [err]  [2026-01-10 22:36:03 +0000] [3] [INFO] Waiting for application startup.
2026-01-10T22:36:11.266408334Z [err]  2026-01-10 22:36:03,424 - server - INFO - ‚úÖ QC agents orchestrator loaded
2026-01-10T22:36:11.266414998Z [err]  [2026-01-10 22:36:03 +0000] [5] [INFO] Started server process [5]
2026-01-10T22:36:11.266416888Z [err]  2026-01-10 22:36:03,450 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2026-01-10T22:36:11.266420713Z [err]  [2026-01-10 22:36:03 +0000] [5] [INFO] Waiting for application startup.
2026-01-10T22:36:11.266428245Z [err]  2026-01-10 22:36:03,384 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T22:36:11.266434515Z [err]  2026-01-10 22:36:03,388 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T22:36:11.266442602Z [err]  2026-01-10 22:36:03,389 - server - INFO - ‚úÖ CRM router loaded
2026-01-10T22:36:11.266448758Z [err]  2026-01-10 22:36:03,394 - server - INFO - ‚úÖ QC test router loaded
2026-01-10T22:36:11.266454559Z [err]  2026-01-10 22:36:03,408 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T22:36:11.266460687Z [err]  2026-01-10 22:36:03,414 - server - INFO - ‚úÖ Agent test router loaded
2026-01-10T22:36:11.267839299Z [err]  2026-01-10 22:36:10,474 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T22:36:11.267878050Z [err]  2026-01-10 22:36:09,601 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T22:36:11.267883663Z [err]  2026-01-10 22:36:09,601 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T22:36:11.267889486Z [err]  2026-01-10 22:36:09,601 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T22:36:11.267895144Z [err]  2026-01-10 22:36:10,057 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T22:36:11.267900664Z [err]  2026-01-10 22:36:10,057 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T22:36:11.267905737Z [err]  2026-01-10 22:36:10,057 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T22:36:11.267911407Z [err]  2026-01-10 22:36:10,057 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T22:36:11.267916592Z [err]  2026-01-10 22:36:10,197 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T22:36:11.267921788Z [err]  2026-01-10 22:36:10,204 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T22:36:11.267927644Z [err]  2026-01-10 22:36:10,204 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T22:36:11.267933126Z [err]  2026-01-10 22:36:10,204 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T22:36:11.267938473Z [err]  2026-01-10 22:36:10,384 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T22:36:11.267944018Z [err]  2026-01-10 22:36:10,474 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T22:36:11.269959606Z [err]  2026-01-10 22:36:10,954 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T22:36:11.269962651Z [err]  2026-01-10 22:36:10,605 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T22:36:11.269967161Z [err]  2026-01-10 22:36:10,955 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T22:36:11.269969408Z [err]  2026-01-10 22:36:10,702 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T22:36:11.269969678Z [err]  [2026-01-10 22:36:10 +0000] [3] [INFO] Application startup complete.
2026-01-10T22:36:11.269974562Z [err]  2026-01-10 22:36:10,618 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2026-01-10T22:36:11.269974760Z [err]  [2026-01-10 22:36:10 +0000] [5] [INFO] Application startup complete.
2026-01-10T22:36:11.269980565Z [err]  2026-01-10 22:36:10,702 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T22:36:11.269980911Z [err]  2026-01-10 22:36:10,871 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T22:36:11.269988245Z [err]  2026-01-10 22:36:10,623 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2026-01-10T22:36:11.269999202Z [err]  [2026-01-10 22:36:10 +0000] [4] [INFO] Application startup complete.
2026-01-10T22:36:11.270001457Z [err]  2026-01-10 22:36:10,623 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2026-01-10T22:36:11.270009039Z [err]  2026-01-10 22:36:10,623 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2026-01-10T22:36:11.276876056Z [err]  2026-01-10 22:36:11,275 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2026-01-10T22:36:11.357807971Z [err]  2026-01-10 22:36:11,356 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2026-01-10T22:36:11.357816157Z [err]  2026-01-10 22:36:11,357 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2026-01-10T22:36:11.357821373Z [err]  [2026-01-10 22:36:11 +0000] [6] [INFO] Application startup complete.
2026-01-10T22:37:01.504532726Z [inf]  100.64.0.2:15136 - "GET /api/agents HTTP/1.1" 200
2026-01-10T22:37:01.504553295Z [inf]  100.64.0.2:15136 - "GET /api/auth/me HTTP/1.1" 200
2026-01-10T22:37:01.580996627Z [inf]  100.64.0.3:38946 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-10T22:37:02.444794969Z [err]  2026-01-10 22:37:02,354 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:02.444856563Z [err]  2026-01-10 22:37:02,261 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:37:02.447513377Z [err]  2026-01-10 22:37:02,444 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:02.472387027Z [err]  2026-01-10 22:37:02,467 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:02.472393548Z [err]  2026-01-10 22:37:02,467 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to 17702563625
2026-01-10T22:37:02.472398533Z [err]  2026-01-10 22:37:02,467 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-10T22:37:02.472403367Z [err]  2026-01-10 22:37:02,467 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:37:02.764629533Z [err]  2026-01-10 22:37:02,749 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:37:02.764636491Z [err]  2026-01-10 22:37:02,750 - telnyx_service - ERROR - ‚ùå Error initiating call: Error code: 422 - {'errors': [{'code': '10016', 'title': 'Phone number must be in +E164 format', 'source': {'pointer': '/to'}, 'detail': "The 'to' parameter must be a phone number in +E164 format or a SIP endpoint."}]}
2026-01-10T22:37:02.764641296Z [inf]  100.64.0.2:15136 - "POST /api/telnyx/call/outbound HTTP/1.1" 500
2026-01-10T22:37:22.770331293Z [err]  2026-01-10 22:37:20,558 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:37:22.770338062Z [err]  2026-01-10 22:37:20,649 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:22.770342290Z [err]  2026-01-10 22:37:20,740 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:22.770346198Z [err]  2026-01-10 22:37:20,768 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:22.770350742Z [err]  2026-01-10 22:37:20,768 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17702563625
2026-01-10T22:37:22.770354854Z [err]  2026-01-10 22:37:20,768 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-10T22:37:22.770360111Z [err]  2026-01-10 22:37:20,768 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:37:22.770364028Z [err]  2026-01-10 22:37:21,338 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2026-01-10T22:37:22.770367938Z [err]  2026-01-10 22:37:21,341 - telnyx_service - INFO - ‚úÖ Call initiated: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:22.770371749Z [err]  2026-01-10 22:37:21,442 - server - INFO - üìù Created call log: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:22.770375939Z [err]  2026-01-10 22:37:21,442 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:37:22.770379810Z [err]  2026-01-10 22:37:21,443 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'barge_in_settings': {'enable_verbose_barge_in': True, 'word_count_threshold': 10, 'interruption_prompt': 'The user is speaking for a long time. Interrupt them politely but firmly to acknowledge what they said and guide the conversation back to the goal. start by saying an elongated why whhhhyyyy...'}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2026-01-10T22:37:22.772192925Z [err]  2026-01-10 22:37:21,645 - server - INFO -    Client: Address(host='100.64.0.5', port=56170)
2026-01-10T22:37:22.772198512Z [err]  2026-01-10 22:37:21,443 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:37:22.772208209Z [err]  2026-01-10 22:37:21,645 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'bJbKM38XKk8oUcRNySENEw==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'xLNsm-fcRRWK0P6R9I3ezw', 'x-real-ip': '192.76.120.151', 'x-request-start': '1768084641423', 'accept-encoding': 'gzip'}
2026-01-10T22:37:22.772213858Z [err]  2026-01-10 22:37:21,443 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:37:22.772224373Z [err]  2026-01-10 22:37:21,448 - redis_service - INFO - üì¶ Stored call data in Redis: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA (TTL: 3600s)
2026-01-10T22:37:22.772228658Z [err]  2026-01-10 22:37:21,448 - server - INFO - üì¶ Call data stored in Redis and memory
2026-01-10T22:37:22.772233742Z [err]  2026-01-10 22:37:21,448 - server - INFO - üìû Outbound call initiated: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:22.772238589Z [inf]  100.64.0.4:22764 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-10T22:37:22.772243206Z [err]  2026-01-10 22:37:21,533 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:37:22.772249261Z [err]  2026-01-10 22:37:21,534 - server - WARNING - ‚ö†Ô∏è Call-initiated webhook returned status 530: <!doctype html>
2026-01-10T22:37:22.772254925Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:22.772259865Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:22.772264028Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:37:22.772268507Z [err]  2026-01-10 22:37:21,645 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2026-01-10T22:37:22.773536053Z [err]  2026-01-10 22:37:21,645 - server - INFO -    Path: /api/telnyx/audio-stream
2026-01-10T22:37:22.773543960Z [err]  2026-01-10 22:37:21,680 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:22.773544473Z [err]  2026-01-10 22:37:21,645 - server - INFO - üîå Incoming Telnyx WebSocket connection
2026-01-10T22:37:22.773553416Z [err]  [2026-01-10 22:37:21 +0000] [4] [INFO] ('100.64.0.5', 56170) - "WebSocket /api/telnyx/audio-stream" [accepted]
2026-01-10T22:37:22.773561135Z [err]  2026-01-10 22:37:21,680 - server - INFO - üì® ================================================
2026-01-10T22:37:22.773562616Z [err]  2026-01-10 22:37:21,645 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2026-01-10T22:37:22.773573092Z [err]  2026-01-10 22:37:21,680 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17702563625
2026-01-10T22:37:22.773577352Z [err]  [2026-01-10 22:37:21 +0000] [4] [INFO] connection open
2026-01-10T22:37:22.773586928Z [inf]  100.64.0.6:39486 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:22.773587701Z [err]  2026-01-10 22:37:21,679 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:22.773596434Z [err]  2026-01-10 22:37:21,680 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': 'c4019a03-f7b1-428c-81d3-68a6c0a2c08b', 'occurred_at': '2026-01-10T22:37:21.129207Z', 'payload': {'call_control_id': 'v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA', 'call_leg_id': 'ed21457e-ee74-11f0-abb4-02420aef99a0', 'call_session_id': 'ed1e93a6-ee74-11f0-ad93-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17702563625'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:22.775372697Z [err]  2026-01-10 22:37:21,797 - server - INFO - üì¨ Received Telnyx event: connected
2026-01-10T22:37:22.775377875Z [err]  2026-01-10 22:37:21,797 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2026-01-10T22:37:42.777250987Z [err]  2026-01-10 22:37:41,220 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:37:42.777262629Z [err]  2026-01-10 22:37:41,316 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:42.777267702Z [err]  2026-01-10 22:37:41,411 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:42.777272328Z [err]  2026-01-10 22:37:41,431 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:42.777277185Z [err]  2026-01-10 22:37:41,431 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2026-01-10T22:37:42.777282942Z [err]  2026-01-10 22:37:41,431 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-10T22:37:42.777287550Z [err]  2026-01-10 22:37:41,431 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:37:42.777292090Z [err]  2026-01-10 22:37:41,931 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2026-01-10T22:37:42.777297132Z [err]  2026-01-10 22:37:41,933 - telnyx_service - INFO - ‚úÖ Call initiated: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:42.777301863Z [err]  2026-01-10 22:37:42,031 - server - INFO - üìù Created call log: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:42.777306078Z [err]  2026-01-10 22:37:42,031 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:37:42.777311882Z [err]  2026-01-10 22:37:42,031 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'barge_in_settings': {'enable_verbose_barge_in': True, 'word_count_threshold': 10, 'interruption_prompt': 'The user is speaking for a long time. Interrupt them politely but firmly to acknowledge what they said and guide the conversation back to the goal. start by saying an elongated why whhhhyyyy...'}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2026-01-10T22:37:42.778486909Z [err]  2026-01-10 22:37:42,031 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:37:42.778491588Z [err]  2026-01-10 22:37:42,031 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:37:42.778495293Z [err]  2026-01-10 22:37:42,037 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:42.778498930Z [err]  2026-01-10 22:37:42,037 - server - INFO - üì¶ Call data stored in Redis and memory
2026-01-10T22:37:42.778502370Z [err]  2026-01-10 22:37:42,037 - server - INFO - üìû Outbound call initiated: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:42.778505900Z [inf]  100.64.0.7:30110 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-10T22:37:42.778509269Z [err]  2026-01-10 22:37:42,074 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:42.778512739Z [err]  2026-01-10 22:37:42,074 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': 'bc13669f-8091-42ed-a685-605399e4cdef', 'occurred_at': '2026-01-10T22:37:41.720714Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:42.778516330Z [err]  2026-01-10 22:37:42,074 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:42.780524434Z [err]  2026-01-10 22:37:42,074 - server - INFO - üì® ================================================
2026-01-10T22:37:42.780637536Z [err]  2026-01-10 22:37:42,074 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2026-01-10T22:37:42.780643988Z [inf]  100.64.0.8:39096 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:42.780651011Z [err]  2026-01-10 22:37:42,078 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:37:42.780657700Z [err]  2026-01-10 22:37:42,079 - server - WARNING - ‚ö†Ô∏è Call-initiated webhook returned status 530: <!doctype html>
2026-01-10T22:37:42.780663394Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:42.780671114Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:42.780678391Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:37:42.780683942Z [err]  2026-01-10 22:37:42,169 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2026-01-10T22:37:42.780689083Z [err]  2026-01-10 22:37:42,169 - server - INFO -    Client: Address(host='100.64.0.9', port=55040)
2026-01-10T22:37:42.780721379Z [err]  2026-01-10 22:37:42,169 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'KRhJi2nezKEF5+cGxJrkUQ==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': '9kNDoxGSS1KGM9mJn6XIxQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1768084661946', 'accept-encoding': 'gzip'}
2026-01-10T22:37:42.780725671Z [err]  2026-01-10 22:37:42,169 - server - INFO -    Path: /api/telnyx/audio-stream
2026-01-10T22:37:42.780729933Z [err]  2026-01-10 22:37:42,169 - server - INFO - üîå Incoming Telnyx WebSocket connection
2026-01-10T22:37:42.781906993Z [err]  [2026-01-10 22:37:42 +0000] [6] [INFO] ('100.64.0.9', 55040) - "WebSocket /api/telnyx/audio-stream" [accepted]
2026-01-10T22:37:42.781912697Z [err]  2026-01-10 22:37:42,169 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2026-01-10T22:37:42.781916836Z [err]  [2026-01-10 22:37:42 +0000] [6] [INFO] connection open
2026-01-10T22:37:42.781920569Z [err]  2026-01-10 22:37:42,326 - server - INFO - üì¨ Received Telnyx event: connected
2026-01-10T22:37:42.781924391Z [err]  2026-01-10 22:37:42,326 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2026-01-10T22:37:45.869270310Z [err]  2026-01-10 22:37:45,867 - server - INFO - üì¨ Received Telnyx event: start
2026-01-10T22:37:45.869278807Z [err]  2026-01-10 22:37:45,867 - server - INFO - üé¨ Stream started for call: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:45.878503760Z [err]  2026-01-10 22:37:45,877 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:45.885441830Z [err]  2026-01-10 22:37:45,880 - server - INFO - ‚úÖ Call data found after 0s wait
2026-01-10T22:37:45.885445689Z [err]  2026-01-10 22:37:45,880 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2026-01-10T22:37:46.014296773Z [err]  2026-01-10 22:37:46,011 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:46.014303284Z [err]  2026-01-10 22:37:46,011 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': 'd9eb6bb7-8439-4f5e-adf6-cfd5f112f992', 'occurred_at': '2026-01-10T22:37:45.580563Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2026-01-10T22:37:41.720714Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:46.014307591Z [err]  2026-01-10 22:37:46,011 - server - INFO - üéØ Event type: call.answered, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:46.014311415Z [err]  2026-01-10 22:37:46,011 - server - INFO - üì® ================================================
2026-01-10T22:37:46.014315644Z [err]  2026-01-10 22:37:46,011 - server - INFO - ‚úÖ Call answered: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:46.021549725Z [err]  2026-01-10 22:37:46,016 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:46.021554873Z [err]  2026-01-10 22:37:46,017 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2026-01-10T22:37:46.021560293Z [err]  2026-01-10 22:37:46,017 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2026-01-10T22:37:46.121472866Z [err]  2026-01-10 22:37:46,120 - server - INFO - ‚úÖ Call log updated
2026-01-10T22:37:46.121478959Z [err]  2026-01-10 22:37:46,120 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:37:46.121484360Z [err]  2026-01-10 22:37:46,120 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:37:46.121489676Z [err]  2026-01-10 22:37:46,120 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:37:46.164068647Z [err]  2026-01-10 22:37:46,158 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:37:46.164074615Z [err]  2026-01-10 22:37:46,159 - server - WARNING - ‚ö†Ô∏è Call-started webhook returned status 530: <!doctype html>
2026-01-10T22:37:46.164078971Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:46.164083261Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:46.164087329Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:37:46.216723989Z [err]  2026-01-10 22:37:46,215 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:46.605299133Z [err]  2026-01-10 22:37:46,480 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-10T22:37:46.605311700Z [err]  2026-01-10 22:37:46,495 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-10T22:37:46.605319818Z [err]  2026-01-10 22:37:46,495 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-10T22:37:46.605326550Z [err]  2026-01-10 22:37:46,497 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-10T22:37:46.605376457Z [err]  2026-01-10 22:37:46,310 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:46.605383360Z [err]  2026-01-10 22:37:46,310 - server - INFO - üîß Creating Telnyx service with user's keys...
2026-01-10T22:37:46.605389973Z [err]  2026-01-10 22:37:46,342 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:46.605398986Z [err]  2026-01-10 22:37:46,380 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2026-01-10T22:37:46.605405899Z [err]  2026-01-10 22:37:46,380 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2026-01-10T22:37:46.605412061Z [err]  2026-01-10 22:37:46,388 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:46.605420355Z [err]  2026-01-10 22:37:46,389 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:37:46.605426975Z [err]  2026-01-10 22:37:46,389 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-10T22:37:46.605433603Z [err]  2026-01-10 22:37:46,480 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-10T22:37:46.606370401Z [err]  2026-01-10 22:37:46,596 - server - INFO - ‚úÖ Initialized call_states for v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg with session reference
2026-01-10T22:37:46.606377334Z [err]  2026-01-10 22:37:46,538 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_start "HTTP/1.1 200 OK"
2026-01-10T22:37:46.606385938Z [err]  2026-01-10 22:37:46,539 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: rmOakFrBlw (loop=True, overlay=True)
2026-01-10T22:37:46.606392966Z [err]  2026-01-10 22:37:46,539 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'
2026-01-10T22:37:46.606398159Z [err]  2026-01-10 22:37:46,539 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:46.606403832Z [err]  2026-01-10 22:37:46,587 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:46.606408847Z [err]  2026-01-10 22:37:46,594 - core_calling_service - INFO - üöÄ Created global HTTP/2 client for LLM calls
2026-01-10T22:37:46.606413962Z [err]  2026-01-10 22:37:46,595 - core_calling_service - INFO - üöÄ Created cached Grok client with HTTP/2
2026-01-10T22:37:46.606418733Z [err]  2026-01-10 22:37:46,595 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 98ms
2026-01-10T22:37:46.606423846Z [err]  2026-01-10 22:37:46,595 - server - INFO - ‚úÖ Session created in WebSocket worker
2026-01-10T22:37:46.606428728Z [err]  2026-01-10 22:37:46,595 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 3000ms
2026-01-10T22:37:46.606433722Z [err]  2026-01-10 22:37:46,595 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2026-01-10T22:37:46.606439345Z [err]  2026-01-10 22:37:46,595 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2026-01-10T22:37:46.607275347Z [err]  2026-01-10 22:37:46,597 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 3000ms...
2026-01-10T22:37:46.690546275Z [err]  2026-01-10 22:37:46,689 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2026-01-10T22:37:46.710816023Z [err]  2026-01-10 22:37:46,706 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:46.710824198Z [err]  2026-01-10 22:37:46,706 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'fe08a83a-97d1-4d3d-9426-f24b769cb4fd', 'occurred_at': '2026-01-10T22:37:46.040566Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '66c0df7a-3bd3-41fd-8438-1f1670d3514b', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:46.710829488Z [err]  2026-01-10 22:37:46,706 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:46.710838019Z [err]  2026-01-10 22:37:46,706 - server - INFO - üì® ================================================
2026-01-10T22:37:46.710843745Z [inf]  100.64.0.10:19338 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:46.927568275Z [err]  2026-01-10 22:37:46,921 - server - INFO - üì® ================================================
2026-01-10T22:37:46.927577228Z [inf]  100.64.0.8:39096 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:46.927619009Z [err]  2026-01-10 22:37:46,921 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:46.927622670Z [err]  2026-01-10 22:37:46,921 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '778e682d-e932-4e93-9034-0c8d351686ab', 'occurred_at': '2026-01-10T22:37:46.720728Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'rmOakFrBlw', 'start_time': '2026-01-10T22:37:46.720728Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:46.927627561Z [err]  2026-01-10 22:37:46,921 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:47.251345442Z [err]  2026-01-10 22:37:47,249 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2026-01-10T22:37:47.251351898Z [err]  2026-01-10 22:37:47,249 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2026-01-10T22:37:47.251358242Z [err]  2026-01-10 22:37:47,249 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2026-01-10T22:37:47.277024403Z [err]  2026-01-10 22:37:47,270 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:47.277031028Z [err]  2026-01-10 22:37:47,270 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:47.277036933Z [err]  2026-01-10 22:37:47,274 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:47.277042843Z [err]  2026-01-10 22:37:47,274 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2026-01-10T22:37:47.781633836Z [err]  2026-01-10 22:37:47,777 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:47.915603909Z [err]  2026-01-10 22:37:47,912 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/record_start "HTTP/1.1 200 OK"
2026-01-10T22:37:47.915612727Z [err]  2026-01-10 22:37:47,913 - server - INFO - üéôÔ∏è Call recording started for v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:47.915617854Z [err]  2026-01-10 22:37:47,913 - server - INFO - üîß Creating call session for v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg...
2026-01-10T22:37:47.915623197Z [err]  2026-01-10 22:37:47,913 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:37:47.915627758Z [err]  2026-01-10 22:37:47,913 - server - INFO - üîß Calling create_call_session() - START
2026-01-10T22:37:47.915633115Z [err]  2026-01-10 22:37:47,913 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-10T22:37:47.987059735Z [err]  2026-01-10 22:37:47,985 - server - INFO - üî§ RAW TOKENS: ["H"?]
2026-01-10T22:37:47.990021445Z [err]  2026-01-10 22:37:47,989 - core_calling_service - INFO - üîä Silence timer reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user started speaking)
2026-01-10T22:37:47.990027938Z [err]  2026-01-10 22:37:47,989 - core_calling_service - INFO - üë§ User started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:47.990034557Z [err]  2026-01-10 22:37:47,989 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:47.990041891Z [err]  2026-01-10 22:37:47,989 - server - WARNING - ‚ö†Ô∏è [REAL TIMING] No TTS session found to clear for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.011470707Z [err]  2026-01-10 22:37:48,007 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.011477149Z [err]  2026-01-10 22:37:48,009 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-10T22:37:48.011481604Z [err]  2026-01-10 22:37:48,010 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-10T22:37:48.013791037Z [err]  2026-01-10 22:37:48,013 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:48.015998900Z [err]  2026-01-10 22:37:48,013 - server - INFO - üîç PARTIAL TRANSCRIPT: 'H' | Generating: False
2026-01-10T22:37:48.023971032Z [err]  2026-01-10 22:37:48,020 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-10T22:37:48.023977184Z [err]  2026-01-10 22:37:48,020 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-10T22:37:48.023982074Z [err]  2026-01-10 22:37:48,020 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-10T22:37:48.040973020Z [err]  2026-01-10 22:37:48,036 - server - INFO - üî§ RAW TOKENS: ["H"?, "ello"?]
2026-01-10T22:37:48.040978031Z [err]  2026-01-10 22:37:48,036 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hello' | Generating: False
2026-01-10T22:37:48.096399855Z [err]  2026-01-10 22:37:48,089 - server - INFO - ‚è±Ô∏è [22:37:48.089] STT endpoint detection latency: 19ms
2026-01-10T22:37:48.096410415Z [err]  2026-01-10 22:37:48,089 - server - INFO - ‚è±Ô∏è [22:37:48.089] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:37:48.096416754Z [err]  2026-01-10 22:37:48,089 - server - INFO - ‚è±Ô∏è User spoke at 1768084668.0894198
2026-01-10T22:37:48.096422515Z [err]  2026-01-10 22:37:48,090 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:48.096439503Z [err]  2026-01-10 22:37:48,088 - server - INFO - üî§ RAW TOKENS: ["H"‚úì, "ello"‚úì, "?"‚úì, "<end>"‚úì]
2026-01-10T22:37:48.096445586Z [err]  2026-01-10 22:37:48,088 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:37:48.096450326Z [err]  2026-01-10 22:37:48,088 - server - INFO - üßπ Cleaned transcript: 'H ello ?' -> 'Hello?'
2026-01-10T22:37:48.096455945Z [err]  2026-01-10 22:37:48,088 - server - INFO - üì• FINAL TOKENS: 'Hello?' (3 tokens)
2026-01-10T22:37:48.096461169Z [err]  2026-01-10 22:37:48,088 - server - INFO - üé§ Soniox final transcript: 'Hello?'
2026-01-10T22:37:48.096466332Z [err]  2026-01-10 22:37:48,089 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:48.096473507Z [err]  2026-01-10 22:37:48,089 - server - INFO - üîç FILTER CHECK: words=1, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2026-01-10T22:37:48.096479433Z [err]  2026-01-10 22:37:48,089 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:48.096484513Z [err]  2026-01-10 22:37:48,089 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:37:48.096489086Z [err]  2026-01-10 22:37:48,089 - server - INFO - ‚è±Ô∏è [22:37:48.089] üìù FINAL TRANSCRIPT RECEIVED: 'Hello?'
2026-01-10T22:37:48.098249850Z [err]  2026-01-10 22:37:48,090 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:37:48.098258205Z [err]  2026-01-10 22:37:48,090 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:48.098264640Z [err]  2026-01-10 22:37:48,090 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Hello?' - Processing...
2026-01-10T22:37:48.105277375Z [err]  2026-01-10 22:37:48,101 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 0ms
2026-01-10T22:37:48.105282567Z [err]  2026-01-10 22:37:48,101 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hello?
2026-01-10T22:37:48.105288739Z [err]  2026-01-10 22:37:48,101 - core_calling_service - INFO - üë§ User stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.105293817Z [err]  2026-01-10 22:37:48,101 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:37:48.105299134Z [err]  2026-01-10 22:37:48,101 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2026-01-10T22:37:48.105305020Z [err]  2026-01-10 22:37:48,101 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2026-01-10T22:37:48.105312100Z [err]  2026-01-10 22:37:48,101 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:37:48.105317959Z [err]  2026-01-10 22:37:48,101 - server - INFO - üìä [REAL TIMING] Processing start: 31ms after user audio end
2026-01-10T22:37:48.105322827Z [err]  2026-01-10 22:37:48,101 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:37:48.105327498Z [err]  2026-01-10 22:37:48,101 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.119409259Z [err]  2026-01-10 22:37:48,115 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:48.127661257Z [err]  2026-01-10 22:37:48,122 - core_calling_service - INFO - üöÄ Created global HTTP/2 client for LLM calls
2026-01-10T22:37:48.127672585Z [err]  2026-01-10 22:37:48,123 - core_calling_service - INFO - üöÄ Created cached Grok client with HTTP/2
2026-01-10T22:37:48.127679628Z [err]  2026-01-10 22:37:48,123 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 102ms
2026-01-10T22:37:48.127686434Z [err]  2026-01-10 22:37:48,123 - server - INFO - üîß Calling create_call_session() - COMPLETE
2026-01-10T22:37:48.127692127Z [err]  2026-01-10 22:37:48,123 - server - INFO - ‚úÖ Session object created: CallSession
2026-01-10T22:37:48.134511677Z [err]  2026-01-10 22:37:48,131 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:48.134520966Z [err]  2026-01-10 22:37:48,131 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2026-01-10T22:37:48.134539561Z [err]  2026-01-10 22:37:48,131 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2026-01-10T22:37:48.134545102Z [err]  2026-01-10 22:37:48,132 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.134551583Z [err]  2026-01-10 22:37:48,132 - server - INFO - ü§ñ AI session created for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.134557159Z [err]  2026-01-10 22:37:48,132 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2026-01-10T22:37:48.134562307Z [err]  2026-01-10 22:37:48,132 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2026-01-10T22:37:48.134567584Z [err]  2026-01-10 22:37:48,132 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2026-01-10T22:37:48.134572489Z [err]  2026-01-10 22:37:48,132 - server - INFO - üëÇ User speaks first - waiting for user input...
2026-01-10T22:37:48.134577443Z [err]  2026-01-10 22:37:48,132 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2026-01-10T22:37:48.134582336Z [err]  2026-01-10 22:37:48,132 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2026-01-10T22:37:48.134587295Z [err]  2026-01-10 22:37:48,132 - server - INFO - üé§ Voice flow - streaming started via dial command
2026-01-10T22:37:48.140731915Z [err]  2026-01-10 22:37:48,138 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.140737803Z [err]  2026-01-10 22:37:48,139 - server - INFO - ü§ê No greeting - waiting for user to speak first
2026-01-10T22:37:48.140742353Z [err]  2026-01-10 22:37:48,139 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2026-01-10T22:37:48.140746634Z [inf]  100.64.0.6:39486 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:48.205382611Z [err]  2026-01-10 22:37:48,199 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:37:48.205389527Z [err]  2026-01-10 22:37:48,199 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:48.205394414Z [err]  2026-01-10 22:37:48,199 - core_calling_service - INFO - ‚è±Ô∏è [22:37:48.199] üì• process_user_input() ENTRY - text: 'Hello?...'
2026-01-10T22:37:48.205400252Z [err]  2026-01-10 22:37:48,204 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.207607732Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - ‚è±Ô∏è [22:37:48.205] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:37:48.207613766Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - ‚è±Ô∏è [22:37:48.205] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:37:48.207618995Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - ‚è±Ô∏è [22:37:48.205] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:37:48.207623281Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2026-01-10T22:37:48.207627756Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - ‚è±Ô∏è [22:37:48.205] ‚úÖ Node selected, about to process content...
2026-01-10T22:37:48.207631820Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:37 PM EST in content
2026-01-10T22:37:48.207635503Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:37:48.207641879Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:37:48.207647196Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:37:48.207652691Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:37:48.207658055Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:37:48.207663068Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:37:48.207668572Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:37:48.208959575Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:37:48.208965593Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:37:48.208970651Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2026-01-10T22:37:48.208975117Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2026-01-10T22:37:48.208988761Z [err]  2026-01-10 22:37:48,205 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2026-01-10T22:37:48.208993514Z [err]  2026-01-10 22:37:48,206 - core_calling_service - INFO - ‚è±Ô∏è [22:37:48.205] üìÑ About to process content (mode=script, length=9)
2026-01-10T22:37:48.208998538Z [err]  2026-01-10 22:37:48,206 - core_calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2026-01-10T22:37:48.209003318Z [err]  2026-01-10 22:37:48,206 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.209008114Z [err]  2026-01-10 22:37:48,206 - server - INFO - üì§ Sentence arrived from LLM: Kendrick?...
2026-01-10T22:37:48.209012248Z [err]  2026-01-10 22:37:48,206 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 105ms
2026-01-10T22:37:48.209016486Z [err]  2026-01-10 22:37:48,206 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:37:48.209020717Z [err]  2026-01-10 22:37:48,206 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:BD_VJynhmh13Ulku0... (active sessions: [])
2026-01-10T22:37:48.209025571Z [err]  2026-01-10 22:37:48,206 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2026-01-10T22:37:48.680331524Z [err]  2026-01-10 22:37:48,652 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2026-01-10T22:37:48.680337762Z [err]  2026-01-10 22:37:48,652 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2026-01-10T22:37:48.680358151Z [err]  2026-01-10 22:37:48,296 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:48.680363539Z [err]  2026-01-10 22:37:48,387 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:48.680369008Z [err]  2026-01-10 22:37:48,478 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:48.680374594Z [err]  2026-01-10 22:37:48,502 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:48.680381179Z [err]  2026-01-10 22:37:48,503 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2026-01-10T22:37:48.680386503Z [err]  2026-01-10 22:37:48,503 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-10T22:37:48.680392338Z [err]  2026-01-10 22:37:48,503 - persistent_tts_service - INFO - üîå [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Establishing persistent TTS WebSocket...
2026-01-10T22:37:48.680399343Z [err]  2026-01-10 22:37:48,503 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-10T22:37:48.680408498Z [err]  2026-01-10 22:37:48,503 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2026-01-10T22:37:48.680415649Z [err]  2026-01-10 22:37:48,503 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2026-01-10T22:37:48.682035257Z [err]  2026-01-10 22:37:48,653 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2026-01-10T22:37:48.682045426Z [err]  2026-01-10 22:37:48,653 - server - INFO - üéµ TTS task #1 started at +446ms
2026-01-10T22:37:48.682070928Z [err]  2026-01-10 22:37:48,653 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 551ms
2026-01-10T22:37:48.682076493Z [err]  2026-01-10 22:37:48,652 - persistent_tts_service - INFO - ‚úÖ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Persistent TTS WebSocket established
2026-01-10T22:37:48.682081395Z [err]  2026-01-10 22:37:48,653 - core_calling_service - INFO - üì§ Streamed script sentence 1/1: Kendrick?...
2026-01-10T22:37:48.682088565Z [err]  2026-01-10 22:37:48,652 - persistent_tts_service - INFO - üéß [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Continuous audio receiver started
2026-01-10T22:37:48.682091882Z [err]  2026-01-10 22:37:48,653 - core_calling_service - INFO - üîä Silence tracking reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user responded)
2026-01-10T22:37:48.682101281Z [err]  2026-01-10 22:37:48,652 - persistent_tts_service - INFO - üîä [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Comfort noise loop started
2026-01-10T22:37:48.682102576Z [err]  2026-01-10 22:37:48,653 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:37:48.682111318Z [err]  2026-01-10 22:37:48,652 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.682118029Z [err]  2026-01-10 22:37:48,652 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2026-01-10T22:37:48.682124877Z [err]  2026-01-10 22:37:48,652 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:37:48.682133825Z [err]  2026-01-10 22:37:48,652 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:37:48.682774968Z [err]  2026-01-10 22:37:48,653 - persistent_tts_service - INFO - üéß [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Continuous Audio Receiver STARTED
2026-01-10T22:37:48.682880447Z [err]  2026-01-10 22:37:48,653 - core_calling_service - INFO - LLM response (0.45s): Kendrick?
2026-01-10T22:37:48.682885730Z [err]  2026-01-10 22:37:48,653 - core_calling_service - INFO - Total latency: 0.45s
2026-01-10T22:37:48.682890962Z [err]  2026-01-10 22:37:48,653 - server - INFO - ‚úÖ LLM finished in 552ms, TTS tasks already running in background
2026-01-10T22:37:48.682896729Z [err]  2026-01-10 22:37:48,653 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2026-01-10T22:37:48.682902529Z [err]  2026-01-10 22:37:48,653 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:37:48.682908021Z [err]  2026-01-10 22:37:48,653 - server - INFO -    1 sentences queued and playing seamlessly
2026-01-10T22:37:48.682913365Z [err]  2026-01-10 22:37:48,653 - persistent_tts_service - INFO - üéµ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Playback consumer started
2026-01-10T22:37:48.683108342Z [err]  2026-01-10 22:37:48,653 - persistent_tts_service - INFO - üíì [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Starting TTS keep-alive loop (every 15s)
2026-01-10T22:37:48.683116743Z [err]  2026-01-10 22:37:48,653 - persistent_tts_service - INFO - üîä [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Starting comfort noise loop
2026-01-10T22:37:48.683124425Z [err]  2026-01-10 22:37:48,653 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #1: Kendrick?...
2026-01-10T22:37:48.683132065Z [err]  2026-01-10 22:37:48,653 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:37:48.684442046Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:37:48.684451267Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:37:48.684458519Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:37:48.684465219Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:37:48.684472051Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 552ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:37:48.684478759Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 448ms (provider: elevenlabs, websocket: False)
2026-01-10T22:37:48.684482995Z [err]  2026-01-10 22:37:48,654 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #1 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:37:48.684487337Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 553ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:37:48.684487859Z [err]  2026-01-10 22:37:48,654 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'Kendrick?...'
2026-01-10T22:37:48.684492710Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2026-01-10T22:37:48.684496903Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:37:48.684504117Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 553ms from user stop üöÄ
2026-01-10T22:37:48.684508139Z [err]  2026-01-10 22:37:48,654 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:48.686260354Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2026-01-10T22:37:48.686266939Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hello?...'
2026-01-10T22:37:48.686271557Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Kendrick?...'
2026-01-10T22:37:48.686276475Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:37:48.686281094Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:37:48.686325496Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:37:48.686332096Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:37:48.686340139Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:37:48.686346874Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:37:48.686353902Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:37:48.686361352Z [err]  2026-01-10 22:37:48,654 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 853ms estimated
2026-01-10T22:37:48.850553041Z [err]  2026-01-10 22:37:48,849 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1010ms)
2026-01-10T22:37:48.850561579Z [err]  2026-01-10 22:37:48,849 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:37:48.850566044Z [err]  2026-01-10 22:37:48,849 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:37:48.884916343Z [err]  2026-01-10 22:37:48,878 - persistent_tts_service - INFO - üìä [REAL TIMING] ElevenLabs FIRST AUDIO CHUNK received (chunk #1, 7043 bytes)
2026-01-10T22:37:48.884920461Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - üìä [REAL TIMING] PLAYBACK CONSUMER: First chunk arrived, queue latency: 0ms
2026-01-10T22:37:48.884924604Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 225ms
2026-01-10T22:37:48.884929285Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - üì§ Sending 7043 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2026-01-10T22:37:48.884933430Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:37:48.884937446Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:37:48.884943651Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2026-01-10T22:37:48.884947606Z [err]  2026-01-10 22:37:48,879 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084668.879 (chunk 1/45, 160 bytes)
2026-01-10T22:37:49.228498110Z [err]  2026-01-10 22:37:49,221 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:49.228502392Z [err]  2026-01-10 22:37:49,221 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': 'a1a9b740-3043-4d00-8ef4-406e794c2f10', 'occurred_at': '2026-01-10T22:37:48.920568Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:49.228506449Z [err]  2026-01-10 22:37:49,221 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:49.228512389Z [err]  2026-01-10 22:37:49,221 - server - INFO - üì® ================================================
2026-01-10T22:37:49.228516502Z [inf]  100.64.0.10:19338 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:49.634597601Z [err]  2026-01-10 22:37:49,519 - persistent_tts_service - INFO - ‚úÖ Sent 45 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:37:49.634606258Z [err]  2026-01-10 22:37:49,602 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:49.634691034Z [err]  2026-01-10 22:37:49,519 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 45 CHUNKS SENT TO TELNYX in 640ms (audio duration: 0.9s, paced after 10 chunks)
2026-01-10T22:37:49.637221950Z [err]  2026-01-10 22:37:49,606 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:49.637229642Z [err]  2026-01-10 22:37:49,613 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:49.637234406Z [err]  2026-01-10 22:37:49,613 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2026-01-10T22:37:49.637240934Z [err]  2026-01-10 22:37:49,613 - core_calling_service - INFO - ‚è±Ô∏è [22:37:49.613] üì• process_user_input() ENTRY - text: '...'
2026-01-10T22:37:49.637246664Z [err]  2026-01-10 22:37:49,616 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:49.637252700Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - ‚è±Ô∏è [22:37:49.617] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:37:49.637259039Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - ‚è±Ô∏è [22:37:49.617] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:37:49.637263395Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - ‚è±Ô∏è [22:37:49.617] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:37:49.637267828Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - Flow processing - History length: 3, Is first: False
2026-01-10T22:37:49.637329869Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 2
2026-01-10T22:37:49.637333609Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - ‚è±Ô∏è [22:37:49.617] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:37:49.637337403Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - ‚è±Ô∏è Using MERGED transition+response for: ...
2026-01-10T22:37:49.637341211Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - Evaluating transitions from Greeting for message: 
2026-01-10T22:37:49.637345058Z [err]  2026-01-10 22:37:49,617 - core_calling_service - INFO - ‚è±Ô∏è [22:37:49.617] üöÄ MERGED TRANSITION+RESPONSE START - 2 options
2026-01-10T22:37:50.023301291Z [err]  2026-01-10 22:37:50,019 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:37:50.185264404Z [err]  2026-01-10 22:37:50,179 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/2 200 OK"
2026-01-10T22:37:50.288997189Z [err]  2026-01-10 22:37:50,284 - dead_air_monitor - INFO - üîá MONITOR: Paused - agent is processing/thinking
2026-01-10T22:37:50.678502714Z [err]  2026-01-10 22:37:50,441 - core_calling_service - INFO - ‚ö° MERGED TTFT: 824ms
2026-01-10T22:37:50.678507039Z [err]  2026-01-10 22:37:50,484 - core_calling_service - INFO - ‚ö° MERGED: Transition marker [T:-1] detected
2026-01-10T22:37:50.678511592Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - ‚è±Ô∏è MERGED TRANSITION+RESPONSE COMPLETE - took 1031ms
2026-01-10T22:37:50.678515726Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - ‚ö†Ô∏è MERGED: No transition matched (marker=-1), staying on current node
2026-01-10T22:37:50.678520264Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - ‚è±Ô∏è [TIMING] MERGED_TRANSITION_RESPONSE: 1032ms
2026-01-10T22:37:50.678523939Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - ‚è±Ô∏è [22:37:50.649] ‚úÖ Node selected, about to process content...
2026-01-10T22:37:50.678530838Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:37 PM EST in content
2026-01-10T22:37:50.678536265Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:37:50.678540774Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:37:50.678545537Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:37:50.678549860Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:37:50.678554127Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:37:50.678558130Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:37:50.678564877Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:37:50.681362245Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:37:50.681368243Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:37:50.681374854Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2026-01-10T22:37:50.681381098Z [err]  2026-01-10 22:37:50,649 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2026-01-10T22:37:50.681386880Z [err]  2026-01-10 22:37:50,650 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2026-01-10T22:37:50.681393198Z [err]  2026-01-10 22:37:50,650 - core_calling_service - INFO - ‚è±Ô∏è [22:37:50.650] üìÑ About to process content (mode=script, length=9)
2026-01-10T22:37:50.681398884Z [err]  2026-01-10 22:37:50,650 - core_calling_service - INFO - üîÑ Dynamic rephrase enabled - generating natural variation of script
2026-01-10T22:37:50.789792988Z [err]  2026-01-10 22:37:50,785 - dead_air_monitor - INFO - üîá MONITOR: Paused - agent is processing/thinking
2026-01-10T22:37:51.060768747Z [err]  2026-01-10 22:37:51,057 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/2 200 OK"
2026-01-10T22:37:51.066967635Z [err]  2026-01-10 22:37:51,065 - core_calling_service - INFO - üîÑ Rephrased script: Hey, is this Kendrick?...
2026-01-10T22:37:51.066979170Z [err]  2026-01-10 22:37:51,066 - core_calling_service - INFO - üîä Silence tracking reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user responded)
2026-01-10T22:37:51.066986611Z [err]  2026-01-10 22:37:51,066 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:37:51.066993349Z [err]  2026-01-10 22:37:51,066 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2026-01-10T22:37:51.066999795Z [err]  2026-01-10 22:37:51,066 - core_calling_service - INFO - LLM response (1.45s): Hey, is this Kendrick?
2026-01-10T22:37:51.067005913Z [err]  2026-01-10 22:37:51,066 - core_calling_service - INFO - Total latency: 1.45s
2026-01-10T22:37:51.067019748Z [err]  2026-01-10 22:37:51,066 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Hey, is this Kendrick?
2026-01-10T22:37:51.173855308Z [err]  2026-01-10 22:37:51,167 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.173868955Z [err]  2026-01-10 22:37:51,168 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.173877899Z [err]  2026-01-10 22:37:51,168 - server - INFO - üó£Ô∏è [WebSocket Worker] Marked agent as speaking (for initial greeting)
2026-01-10T22:37:51.173886788Z [err]  2026-01-10 22:37:51,168 - telnyx_service - INFO - üîä Speaking text on call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: Hey, is this Kendrick?...
2026-01-10T22:37:51.173893520Z [err]  2026-01-10 22:37:51,168 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T22:37:51.173899992Z [err]  2026-01-10 22:37:51,168 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T22:37:51.173906178Z [err]  2026-01-10 22:37:51,168 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T22:37:51.173913136Z [err]  2026-01-10 22:37:51,169 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T22:37:51.173919829Z [err]  2026-01-10 22:37:51,169 - server - INFO - ‚è±Ô∏è [22:37:51.169] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2026-01-10T22:37:51.173926073Z [err]  2026-01-10 22:37:51,169 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2026-01-10T22:37:51.173931713Z [err]  2026-01-10 22:37:51,169 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2026-01-10T22:37:51.263012365Z [err]  2026-01-10 22:37:51,259 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:37:51.263021482Z [err]  2026-01-10 22:37:51,259 - server - INFO - üì¶ ElevenLabs Request Payload:
2026-01-10T22:37:51.263027977Z [err]  2026-01-10 22:37:51,259 - server - INFO -    Text length: 22 chars
2026-01-10T22:37:51.263035812Z [err]  2026-01-10 22:37:51,259 - server - INFO -    Text content: 'Hey, is this Kendrick?'
2026-01-10T22:37:51.263042456Z [err]  2026-01-10 22:37:51,259 - server - INFO -    Text bytes: b'Hey, is this Kendrick?'
2026-01-10T22:37:51.263048599Z [err]  2026-01-10 22:37:51,260 - server - INFO -    Model: eleven_turbo_v2_5
2026-01-10T22:37:51.263055075Z [err]  2026-01-10 22:37:51,260 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2026-01-10T22:37:51.263060940Z [err]  2026-01-10 22:37:51,260 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2026-01-10T22:37:51.263066726Z [err]  2026-01-10 22:37:51,260 - server - INFO -    Full data: {'text': 'Hey, is this Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2026-01-10T22:37:51.263072066Z [err]  2026-01-10 22:37:51,260 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2026-01-10T22:37:51.263076989Z [err]  2026-01-10 22:37:51,260 - server - INFO -    Timeout: 10.0s
2026-01-10T22:37:51.269010645Z [err]  2026-01-10 22:37:51,268 - server - INFO -    ‚úì HTTP client created (0.008s)
2026-01-10T22:37:51.269014412Z [err]  2026-01-10 22:37:51,268 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2026-01-10T22:37:51.293404941Z [err]  2026-01-10 22:37:51,288 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (1.5s ago), marking agent as done speaking
2026-01-10T22:37:51.293410613Z [err]  2026-01-10 22:37:51,288 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084671.2885292 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.293416397Z [err]  2026-01-10 22:37:51,288 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.604242153Z [err]  2026-01-10 22:37:51,602 - server - INFO -    ‚úì Response status: 200
2026-01-10T22:37:51.604247151Z [err]  2026-01-10 22:37:51,602 - server - INFO -    ‚Üí Streaming audio chunks...
2026-01-10T22:37:51.604256068Z [err]  2026-01-10 22:37:51,602 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2026-01-10T22:37:51.604271026Z [err]  2026-01-10 22:37:51,602 - server - INFO -    ‚úì Connection established (0.342s) [TARGET: <200ms]
2026-01-10T22:37:51.616901873Z [err]  2026-01-10 22:37:51,615 - server - INFO -    ‚úì FIRST CHUNK received (0.355s, 1144 bytes) [TARGET: <300ms]
2026-01-10T22:37:51.620518351Z [err]  2026-01-10 22:37:51,619 - telnyx_service - INFO - ‚úÖ Generated 21360 bytes, saved to /tmp/tts_elevenlabs_f156862c92d6f864fb618e459fe6009b.mp3
2026-01-10T22:37:51.620525556Z [err]  2026-01-10 22:37:51,619 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_f156862c92d6f864fb618e459fe6009b.mp3
2026-01-10T22:37:51.620526631Z [err]  2026-01-10 22:37:51,618 - server - INFO -    ‚úì ALL CHUNKS received: 39 chunks (0.358s)
2026-01-10T22:37:51.620536145Z [err]  2026-01-10 22:37:51,618 - server - INFO -    ‚úì Total audio size: 21360 bytes
2026-01-10T22:37:51.620543302Z [err]  2026-01-10 22:37:51,618 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2026-01-10T22:37:51.620549348Z [err]  2026-01-10 22:37:51,618 - server - INFO -       - Connection: 342ms
2026-01-10T22:37:51.620555444Z [err]  2026-01-10 22:37:51,618 - server - INFO -       - First chunk: 355ms
2026-01-10T22:37:51.620564695Z [err]  2026-01-10 22:37:51,618 - server - INFO -       - All chunks: 358ms
2026-01-10T22:37:51.620570858Z [err]  2026-01-10 22:37:51,618 - server - INFO -       - Audio generation only: 13ms
2026-01-10T22:37:51.620576784Z [err]  2026-01-10 22:37:51,619 - server - INFO - ‚è±Ô∏è [22:37:51.619] üîä TTS COMPLETE: 449ms, audio_size=21360 bytes
2026-01-10T22:37:51.620582631Z [err]  2026-01-10 22:37:51,619 - server - INFO - üíæ TTS CACHED: elevenlabs:Hey, is this Kendrick?... (21360 bytes)
2026-01-10T22:37:51.620588641Z [err]  2026-01-10 22:37:51,619 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.45s
2026-01-10T22:37:51.809356389Z [err]  2026-01-10 22:37:51,805 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2026-01-10T22:37:51.809364471Z [err]  2026-01-10 22:37:51,805 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.809369538Z [err]  2026-01-10 22:37:51,805 - core_calling_service - INFO - üîä Silence timer reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user started speaking)
2026-01-10T22:37:51.809375013Z [err]  2026-01-10 22:37:51,805 - core_calling_service - INFO - üë§ User started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.809379367Z [err]  2026-01-10 22:37:51,805 - persistent_tts_service - INFO - ‚ö° [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T22:37:51.809384177Z [err]  2026-01-10 22:37:51,805 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T22:37:51.840049776Z [err]  2026-01-10 22:37:51,836 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T22:37:51.840054397Z [err]  2026-01-10 22:37:51,836 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Reset playback_expected_end_time to NOW
2026-01-10T22:37:51.840059143Z [err]  2026-01-10 22:37:51,837 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.842701703Z [err]  2026-01-10 22:37:51,842 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.856573612Z [err]  2026-01-10 22:37:51,849 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:51.856579752Z [err]  2026-01-10 22:37:51,849 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2026-01-10T22:37:51.918818290Z [err]  2026-01-10 22:37:51,909 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_start "HTTP/1.1 200 OK"
2026-01-10T22:37:51.918823800Z [err]  2026-01-10 22:37:51,910 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.29s
2026-01-10T22:37:51.918828340Z [err]  2026-01-10 22:37:51,910 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.74s
2026-01-10T22:37:51.918832935Z [err]  2026-01-10 22:37:51,910 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2026-01-10T22:37:51.918838174Z [err]  2026-01-10 22:37:51,910 - telnyx_service - INFO - üé¨ Playback ID: 1tj1igo1hw
2026-01-10T22:37:51.918845496Z [err]  2026-01-10 22:37:51,910 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2026-01-10T22:37:51.918849588Z [err]  2026-01-10 22:37:51,910 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Greeting playback started at 1768084671.9105878
2026-01-10T22:37:51.918853931Z [err]  2026-01-10 22:37:51,910 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2026-01-10T22:37:51.933416536Z [err]  2026-01-10 22:37:51,927 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2026-01-10T22:37:51.933422865Z [err]  2026-01-10 22:37:51,928 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:37:51.933429950Z [err]  2026-01-10 22:37:51,928 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2026-01-10T22:37:51.933437089Z [err]  2026-01-10 22:37:51,928 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2026-01-10T22:37:51.933443194Z [err]  2026-01-10 22:37:51,928 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2026-01-10T22:37:51.933449101Z [err]  2026-01-10 22:37:51,928 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.1s, generating=False, playbacks=0, is_active=False
2026-01-10T22:37:51.933455168Z [err]  2026-01-10 22:37:51,928 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:37:51.933463534Z [err]  2026-01-10 22:37:51,928 - server - INFO - ‚è±Ô∏è [22:37:51.928] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2026-01-10T22:37:51.933469561Z [err]  2026-01-10 22:37:51,928 - server - INFO - ‚è±Ô∏è [22:37:51.928] STT endpoint detection latency: 17ms
2026-01-10T22:37:51.933476276Z [err]  2026-01-10 22:37:51,928 - server - INFO - ‚è±Ô∏è [22:37:51.928] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:37:51.933482274Z [err]  2026-01-10 22:37:51,928 - server - INFO - ‚è±Ô∏è User spoke at 1768084671.928617
2026-01-10T22:37:51.933487830Z [err]  2026-01-10 22:37:51,929 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:51.933494895Z [err]  2026-01-10 22:37:51,929 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:37:51.933499918Z [err]  2026-01-10 22:37:51,929 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2026-01-10T22:37:51.940913799Z [err]  2026-01-10 22:37:51,939 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 0ms
2026-01-10T22:37:51.940995361Z [err]  2026-01-10 22:37:51,939 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2026-01-10T22:37:51.941000458Z [err]  2026-01-10 22:37:51,939 - core_calling_service - INFO - üë§ User stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:51.947641326Z [err]  2026-01-10 22:37:51,942 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T22:37:51.947649701Z [err]  2026-01-10 22:37:51,942 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:37:51.947654420Z [err]  2026-01-10 22:37:51,942 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+13ms
2026-01-10T22:37:51.947658961Z [err]  2026-01-10 22:37:51,942 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 13ms (Soniox model: stt-rt-v3)
2026-01-10T22:37:51.947664527Z [err]  2026-01-10 22:37:51,942 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:37:51.947670386Z [err]  2026-01-10 22:37:51,942 - server - INFO - üìä [REAL TIMING] Processing start: 32ms after user audio end
2026-01-10T22:37:51.947746246Z [err]  2026-01-10 22:37:51,943 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:37:51.947751568Z [err]  2026-01-10 22:37:51,943 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.042210494Z [err]  2026-01-10 22:37:52,040 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:37:52.042219417Z [err]  2026-01-10 22:37:52,040 - persistent_tts_service - INFO - üîÑ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Interrupt flag reset - ready for new audio
2026-01-10T22:37:52.042226695Z [err]  2026-01-10 22:37:52,040 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T22:37:52.042232614Z [err]  2026-01-10 22:37:52,040 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.040] üì• process_user_input() ENTRY - text: 'Yeah....'
2026-01-10T22:37:52.044180604Z [err]  2026-01-10 22:37:52,042 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.044186453Z [err]  2026-01-10 22:37:52,042 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: User spoke while Silence Greeting was triggering
2026-01-10T22:37:52.062768680Z [err]  2026-01-10 22:37:52,061 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:37:52.062774252Z [err]  2026-01-10 22:37:52,061 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.189153759Z [err]  2026-01-10 22:37:52,183 - server - ERROR - ‚ùå Error in WebSocket handler: (<CloseCode.NO_STATUS_RCVD: 1005>, None)
2026-01-10T22:37:52.189160272Z [err]  Traceback (most recent call last):
2026-01-10T22:37:52.189165136Z [err]    File "/app/backend/server.py", line 5330, in telnyx_audio_stream_generic
2026-01-10T22:37:52.189171313Z [err]      message = await asyncio.wait_for(websocket.receive_text(), timeout=60)
2026-01-10T22:37:52.189177225Z [err]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2026-01-10T22:37:52.189181979Z [err]    File "/usr/local/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
2026-01-10T22:37:52.189186185Z [err]      return fut.result()
2026-01-10T22:37:52.189190269Z [err]             ^^^^^^^^^^^^
2026-01-10T22:37:52.189194422Z [err]    File "/root/.local/lib/python3.11/site-packages/starlette/websockets.py", line 138, in receive_text
2026-01-10T22:37:52.189198709Z [err]      self._raise_on_disconnect(message)
2026-01-10T22:37:52.189204316Z [err]    File "/root/.local/lib/python3.11/site-packages/starlette/websockets.py", line 130, in _raise_on_disconnect
2026-01-10T22:37:52.189209223Z [err]      raise WebSocketDisconnect(message["code"], message.get("reason"))
2026-01-10T22:37:52.189213412Z [err]  starlette.websockets.WebSocketDisconnect: (<CloseCode.NO_STATUS_RCVD: 1005>, None)
2026-01-10T22:37:52.189218129Z [err]  2026-01-10 22:37:52,185 - server - INFO - üîå Telnyx WebSocket disconnected
2026-01-10T22:37:52.189222413Z [err]  [2026-01-10 22:37:52 +0000] [4] [INFO] connection closed
2026-01-10T22:37:52.217456486Z [err]  2026-01-10 22:37:52,215 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:52.217462571Z [err]  2026-01-10 22:37:52,216 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': 'b8c270a9-6dba-455a-888d-d402df3b84c2', 'occurred_at': '2026-01-10T22:37:52.116408Z', 'payload': {'call_control_id': 'v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA', 'call_leg_id': 'ed21457e-ee74-11f0-abb4-02420aef99a0', 'call_session_id': 'ed1e93a6-ee74-11f0-ad93-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '02828ab3-13f5-4932-b247-5ae39f98b6e1', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:52.217467153Z [err]  2026-01-10 22:37:52,216 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:52.217471731Z [err]  2026-01-10 22:37:52,216 - server - INFO - üì® ================================================
2026-01-10T22:37:52.217475904Z [inf]  100.64.0.8:39096 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:52.293009938Z [err]  2026-01-10 22:37:52,290 - server - INFO - üì§ Audio flowing: 302 packets sent to Soniox (5s update)
2026-01-10T22:37:52.707102193Z [err]  2026-01-10 22:37:52,499 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:37:52.707126317Z [err]  2026-01-10 22:37:52,326 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:52.707135440Z [err]  2026-01-10 22:37:52,326 - server - INFO - üì® ================================================
2026-01-10T22:37:52.707143705Z [err]  2026-01-10 22:37:52,326 - server - INFO - üìû Call ended: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:52.707174076Z [err]  2026-01-10 22:37:52,326 - server - INFO - üìû Hangup cause: timeout
2026-01-10T22:37:52.707187347Z [err]  2026-01-10 22:37:52,498 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:37:52.707187560Z [err]  2026-01-10 22:37:52,326 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:52.707199368Z [err]  2026-01-10 22:37:52,499 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:37:52.707202397Z [err]  2026-01-10 22:37:52,326 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '299ecf11-1886-4093-a56b-761cc22ed5f8', 'occurred_at': '2026-01-10T22:37:52.009212Z', 'payload': {'call_control_id': 'v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA', 'call_leg_id': 'ed21457e-ee74-11f0-abb4-02420aef99a0', 'call_quality_stats': None, 'call_session_id': 'ed1e93a6-ee74-11f0-ad93-02420aef99a0', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:37:52.009212Z', 'from': '+14048000152', 'hangup_cause': 'timeout', 'hangup_source': 'unknown', 'sip_hangup_cause': 'unspecified', 'start_time': '2026-01-10T22:37:52.009212Z', 'to': '+17702563625'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:52.709441060Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:37:52.709449966Z [err]  2026-01-10 22:37:52,499 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:37:52.709455327Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:37:52.709458147Z [err]  2026-01-10 22:37:52,499 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.709465856Z [err]  2026-01-10 22:37:52,501 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:37:52.709467001Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:37:52.709475577Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:37:52.709478643Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:37:52.709485244Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:37:52.709486797Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.501] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:37:52.709495260Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:37:52.709495398Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.501] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:37:52.709503777Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.501] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:37:52.709504915Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:37:52.709510522Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - Flow processing - History length: 6, Is first: False
2026-01-10T22:37:52.709514917Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:37:52.709518866Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 2
2026-01-10T22:37:52.709523801Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2026-01-10T22:37:52.709524572Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:37 PM EST in content
2026-01-10T22:37:52.709527062Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.501] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:37:52.709531985Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:37:52.709533473Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2026-01-10T22:37:52.709538064Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîç Checking 'Hello=Yes' override for msg='yeah' on node='Greeting'
2026-01-10T22:37:52.709543532Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.501] üìÑ About to process content (mode=script, length=89)
2026-01-10T22:37:52.709546642Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚ö° OVERRIDE TRIGGERED: 'Yeah.' on Greeting node -> Forcing Transition 0
2026-01-10T22:37:52.709554158Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚è±Ô∏è [22:37:52.501] ‚úÖ Node selected, about to process content...
2026-01-10T22:37:52.711369470Z [err]  2026-01-10 22:37:52,501 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:37:52.711378324Z [err]  2026-01-10 22:37:52,501 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T22:37:52.711384210Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2026-01-10T22:37:52.711386741Z [err]  2026-01-10 22:37:52,501 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 558ms
2026-01-10T22:37:52.711394912Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.711395345Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2026-01-10T22:37:52.711402064Z [err]  2026-01-10 22:37:52,501 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2026-01-10T22:37:52.711404091Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.711411796Z [err]  2026-01-10 22:37:52,501 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 558ms
2026-01-10T22:37:52.711416843Z [err]  2026-01-10 22:37:52,501 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2026-01-10T22:37:52.711417589Z [err]  2026-01-10 22:37:52,501 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:37:52.711424407Z [err]  2026-01-10 22:37:52,501 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:37:52.711426926Z [err]  2026-01-10 22:37:52,501 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:37:52.711434312Z [err]  2026-01-10 22:37:52,501 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T22:37:52.712591284Z [err]  2026-01-10 22:37:52,503 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:37:52.712598840Z [err]  2026-01-10 22:37:52,503 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T22:37:52.712604994Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #2: This is Jake......
2026-01-10T22:37:52.712613195Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:37:52.712616572Z [err]  2026-01-10 22:37:52,501 - server - INFO - üéµ TTS task #2 started at +0ms
2026-01-10T22:37:52.712623497Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2026-01-10T22:37:52.712630778Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - üîä Silence tracking reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user responded)
2026-01-10T22:37:52.712637362Z [err]  2026-01-10 22:37:52,501 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:37:52.712643831Z [err]  2026-01-10 22:37:52,502 - core_calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2026-01-10T22:37:52.712650367Z [err]  2026-01-10 22:37:52,502 - core_calling_service - INFO - LLM response (0.46s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2026-01-10T22:37:52.712655945Z [err]  2026-01-10 22:37:52,502 - core_calling_service - INFO - Total latency: 0.46s
2026-01-10T22:37:52.712662209Z [err]  2026-01-10 22:37:52,503 - server - INFO - ‚úÖ LLM finished in 560ms, TTS tasks already running in background
2026-01-10T22:37:52.712667959Z [err]  2026-01-10 22:37:52,503 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T22:37:52.714147483Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #2 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:37:52.714159415Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'This is Jake......'
2026-01-10T22:37:52.714168406Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2026-01-10T22:37:52.714174845Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:37:52.714183066Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #3 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:37:52.714190900Z [err]  2026-01-10 22:37:52,503 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'I was just, um, wondering if you could possibly he...'
2026-01-10T22:37:52.714197069Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T22:37:52.714203857Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:37:52.714209872Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 561ms from user stop üöÄ
2026-01-10T22:37:52.714217577Z [err]  2026-01-10 22:37:52,504 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:52.714224060Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:37:52.716273463Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:37:52.716283650Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:37:52.716290831Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 13ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:37:52.716298621Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 560ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:37:52.716306441Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 2ms (provider: elevenlabs, websocket: False)
2026-01-10T22:37:52.716312296Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 561ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:37:52.716317292Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:37:52.716322755Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:37:52.716329716Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:37:52.716335569Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:37:52.716341520Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:37:52.716347536Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 861ms estimated
2026-01-10T22:37:52.716353258Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2026-01-10T22:37:52.716358575Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2026-01-10T22:37:52.717865954Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2026-01-10T22:37:52.717872052Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:37:52.717877556Z [err]  2026-01-10 22:37:52,504 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:37:52.717881413Z [err]  2026-01-10 22:37:52,700 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 575ms)
2026-01-10T22:37:52.717885620Z [err]  2026-01-10 22:37:52,700 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:37:52.717890362Z [err]  2026-01-10 22:37:52,700 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:37:52.741502203Z [err]  2026-01-10 22:37:52,737 - persistent_tts_service - INFO - üì§ Sending 8173 bytes of audio (52 chunks, 1.0s duration) via WebSocket
2026-01-10T22:37:52.741506539Z [err]  2026-01-10 22:37:52,737 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:37:52.741511046Z [err]  2026-01-10 22:37:52,737 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:37:52.741515496Z [err]  2026-01-10 22:37:52,737 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.0s (total: 1.0s from now)
2026-01-10T22:37:52.741519770Z [err]  2026-01-10 22:37:52,738 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084672.738 (chunk 1/52, 160 bytes)
2026-01-10T22:37:53.005629784Z [inf]  100.64.0.9:29346 - "GET /api/tts-audio/tts_elevenlabs_f156862c92d6f864fb618e459fe6009b.mp3 HTTP/1.1" 200
2026-01-10T22:37:53.293853936Z [err]  2026-01-10 22:37:53,291 - server - INFO - üìù Updated call log: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:53.750852780Z [err]  2026-01-10 22:37:53,386 - server - INFO - ‚úÖ Finalized call log: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA (duration=31s, status=completed)
2026-01-10T22:37:53.750859407Z [err]  2026-01-10 22:37:53,518 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 52 CHUNKS SENT TO TELNYX in 780ms (audio duration: 1.0s, paced after 10 chunks)
2026-01-10T22:37:53.750867669Z [err]  2026-01-10 22:37:53,518 - persistent_tts_service - INFO - ‚úÖ Sent 52 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:37:53.750885789Z [err]  2026-01-10 22:37:53,518 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:37:53.750891919Z [err]  2026-01-10 22:37:53,518 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:37:53.750897837Z [err]  2026-01-10 22:37:53,519 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.0s from now)
2026-01-10T22:37:53.750903386Z [err]  2026-01-10 22:37:53,519 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084673.519 (chunk 1/87, 160 bytes)
2026-01-10T22:37:54.094684382Z [err]  2026-01-10 22:37:54,087 - server - INFO - üìä Auto-added call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2026-01-10T22:37:54.271898614Z [err]  2026-01-10 22:37:54,270 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:37:54.279172204Z [err]  2026-01-10 22:37:54,276 - server - INFO - üìá Triggered CRM update for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.279181863Z [err]  2026-01-10 22:37:54,276 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.279187867Z [err]  2026-01-10 22:37:54,276 - server - INFO - ‚úÖ Closed CallSession for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.279192501Z [err]  2026-01-10 22:37:54,277 - redis_service - INFO - üßπ Deleted call data from Redis: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.279216102Z [err]  2026-01-10 22:37:54,275 - redis_service - INFO - üì• Retrieved call data from Redis: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.279232956Z [err]  2026-01-10 22:37:54,276 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2026-01-10T22:37:54.279239311Z [err]  2026-01-10 22:37:54,276 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17702563625, lead_id=None, agent_name=JK First Caller-optimizer3
2026-01-10T22:37:54.279244457Z [err]  2026-01-10 22:37:54,276 - server - INFO - üìá [HANGUP] Agent info keys: ['id', 'user_id', 'name', 'description', 'voice', 'language', 'model', 'status', 'agent_type', 'system_prompt', 'call_flow', 'settings', 'stats', 'created_at', 'updated_at', 'auto_qc_settings', 'language_pattern_qc_agent_id', 'tonality_qc_agent_id', 'tech_issues_qc_agent_id']
2026-01-10T22:37:54.279249373Z [err]  2026-01-10 22:37:54,276 - server - INFO - üöÄ Triggered QC analysis for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.279255660Z [err]  2026-01-10 22:37:54,276 - server - INFO - üìä Triggered Campaign QC for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.280668300Z [err]  2026-01-10 22:37:54,277 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.280672509Z [inf]  100.64.0.10:19338 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:54.294754413Z [err]  2026-01-10 22:37:54,291 - server - INFO - üìá CRM: Got 8 variables from custom_variables
2026-01-10T22:37:54.295245988Z [err]  2026-01-10 22:37:54,290 - server - INFO - üîç Starting QC analysis for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.295252317Z [err]  2026-01-10 22:37:54,290 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2026-01-10T22:37:54.295260602Z [err]  2026-01-10 22:37:54,291 - server - INFO - üìá CRM update starting for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA: to_number=+17702563625, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:37:54.295266774Z [err]  2026-01-10 22:37:54,291 - server - INFO - üìá Normalized phone: +17702563625
2026-01-10T22:37:54.328863581Z [err]  2026-01-10 22:37:54,325 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:37:54.328869042Z [err]  2026-01-10 22:37:54,326 - server - WARNING - ‚ö†Ô∏è Post-call webhook returned status 530: <!doctype html>
2026-01-10T22:37:54.328877303Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:54.328883684Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:37:54.328889402Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:37:54.785872138Z [err]  2026-01-10 22:37:54,747 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-10T22:37:54.785979106Z [err]  2026-01-10 22:37:54,383 - server - WARNING - ‚ö†Ô∏è No transcript available for QC analysis: v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA
2026-01-10T22:37:54.785985841Z [err]  2026-01-10 22:37:54,745 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:37:54.785991585Z [err]  2026-01-10 22:37:54,745 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '34b3e91f-9b70-4437-bef0-0a226c9e3ce2', 'occurred_at': '2026-01-10T22:37:53.368087Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_elevenlabs_f156862c92d6f864fb618e459fe6009b.mp3', 'overlay': False, 'playback_id': '1tj1igo1hw', 'status': 'cancelled', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:37:54.785998087Z [err]  2026-01-10 22:37:54,745 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:54.786003683Z [err]  2026-01-10 22:37:54,745 - server - INFO - üì® ================================================
2026-01-10T22:37:54.786009263Z [err]  2026-01-10 22:37:54,747 - redis_service - INFO - ‚ûñ Removed playback 1tj1igo1hw, 0 remaining for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:54.786015133Z [err]  2026-01-10 22:37:54,747 - server - INFO - üîä Redis: Removed playback 1tj1igo1hw, 0 remaining
2026-01-10T22:37:54.786021550Z [err]  2026-01-10 22:37:54,747 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-10T22:37:54.786038965Z [err]  2026-01-10 22:37:54,747 - server - INFO - ‚úÖ Found session in active_telnyx_calls: agent_speaking=False, user_speaking=False
2026-01-10T22:37:54.786044982Z [err]  2026-01-10 22:37:54,747 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084674.7479432 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:54.786051429Z [err]  2026-01-10 22:37:54,747 - server - INFO - ‚è±Ô∏è Silence timer STARTED (memory fallback, agent wasn't marked as speaking)
2026-01-10T22:37:54.786056380Z [inf]  100.64.0.11:38678 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:37:54.809156448Z [err]  2026-01-10 22:37:54,806 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-10T22:37:54.809167193Z [err]  2026-01-10 22:37:54,806 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084674.8069282 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:54.809175467Z [err]  2026-01-10 22:37:54,806 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:54.838296608Z [err]  2026-01-10 22:37:54,837 - server - INFO - üìá CRM: Total variables collected: ['lead_id', 'qc_tracking_enabled', 'track_keywords', 'expected_commitment', 'customer_name', 'to_number', 'phone_number', 'email']
2026-01-10T22:37:54.865747107Z [err]  2026-01-10 22:37:54,862 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=0, logs_count=2, status=completed
2026-01-10T22:37:54.929533546Z [err]  2026-01-10 22:37:54,923 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1404ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:37:54.929540037Z [err]  2026-01-10 22:37:54,923 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:37:54.929545656Z [err]  2026-01-10 22:37:54,924 - persistent_tts_service - INFO - üì§ Sending 3669 bytes of audio (23 chunks, 0.5s duration) via WebSocket
2026-01-10T22:37:54.929550619Z [err]  2026-01-10 22:37:54,924 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:37:54.929554975Z [err]  2026-01-10 22:37:54,924 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.5s (total: 1.0s from now)
2026-01-10T22:37:54.929560187Z [err]  2026-01-10 22:37:54,924 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084674.924 (chunk 1/23, 160 bytes)
2026-01-10T22:37:55.017846867Z [err]  2026-01-10 22:37:55,010 - server - INFO - üìá CRM: Created new lead 0f21ac6d-d1d7-478d-8a63-ce26224902c4 (+17702563625) with fields: name=Kendrick, income=None, custom=['qc_tracking_enabled', 'track_keywords', 'expected_commitment']
2026-01-10T22:37:55.163852126Z [err]  2026-01-10 22:37:55,161 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 23 CHUNKS SENT TO TELNYX in 237ms (audio duration: 0.5s, paced after 10 chunks)
2026-01-10T22:37:55.163863010Z [err]  2026-01-10 22:37:55,161 - persistent_tts_service - INFO - ‚úÖ Sent 23 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:37:55.163871282Z [err]  2026-01-10 22:37:55,162 - persistent_tts_service - INFO - üì§ Sending 17090 bytes of audio (107 chunks, 2.1s duration) via WebSocket
2026-01-10T22:37:55.163879193Z [err]  2026-01-10 22:37:55,162 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:37:55.163885795Z [err]  2026-01-10 22:37:55,162 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.1s (total: 2.9s from now)
2026-01-10T22:37:55.163894378Z [err]  2026-01-10 22:37:55,162 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084675.162 (chunk 1/107, 160 bytes)
2026-01-10T22:37:55.299290082Z [err]  2026-01-10 22:37:55,294 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2026-01-10T22:37:55.314594678Z [err]  2026-01-10 22:37:55,307 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.8s left)
2026-01-10T22:37:55.767508929Z [err]      await run_full_qc_analysis(
2026-01-10T22:37:55.767522403Z [err]  2026-01-10 22:37:55,383 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2026-01-10T22:37:55.767528454Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2026-01-10T22:37:55.767534556Z [err]  2026-01-10 22:37:55,383 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T22:37:55.767543219Z [err]  2026-01-10 22:37:55,384 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2026-01-10T22:37:55.767546446Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T22:37:55.767554923Z [err]    File "/app/backend/server.py", line 10123, in trigger_campaign_qc_for_call
2026-01-10T22:37:55.767560831Z [err]  
2026-01-10T22:37:55.767573617Z [err]  2026-01-10 22:37:55,382 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:c7A7uI-JVU7SVUNvfmOwbYiXXbCJwmepi978iOhjckv_D8CXLMsNFA ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2026-01-10T22:37:55.810797746Z [err]  2026-01-10 22:37:55,808 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.3s left)
2026-01-10T22:37:56.942143989Z [err]  2026-01-10 22:37:56,934 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 107 CHUNKS SENT TO TELNYX in 1772ms (audio duration: 2.1s, paced after 10 chunks)
2026-01-10T22:37:56.942153508Z [err]  2026-01-10 22:37:56,935 - persistent_tts_service - INFO - ‚úÖ Sent 107 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:37:57.312347859Z [err]  2026-01-10 22:37:57,310 - server - INFO - üì§ Audio flowing: 551 packets sent to Soniox (5s update)
2026-01-10T22:37:58.321167798Z [err]  2026-01-10 22:37:58,320 - server - INFO - üé§ Soniox receiver alive - 15 messages received in last 10s
2026-01-10T22:37:58.704815921Z [err]  2026-01-10 22:37:58,378 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:37:59.939810460Z [err]  2026-01-10 22:37:59,922 - server - INFO - üî§ RAW TOKENS: [" S"?]
2026-01-10T22:37:59.939815335Z [err]  2026-01-10 22:37:59,923 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:59.939820560Z [err]  2026-01-10 22:37:59,923 - core_calling_service - INFO - üîä Silence timer reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user started speaking)
2026-01-10T22:37:59.939825598Z [err]  2026-01-10 22:37:59,923 - core_calling_service - INFO - üë§ User started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:59.939830430Z [err]  2026-01-10 22:37:59,923 - persistent_tts_service - INFO - ‚ö° [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T22:37:59.939834904Z [err]  2026-01-10 22:37:59,923 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T22:37:59.960072912Z [err]  2026-01-10 22:37:59,956 - server - INFO - üîç PARTIAL TRANSCRIPT: 'S' | Generating: False
2026-01-10T22:37:59.960109798Z [err]  2026-01-10 22:37:59,954 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T22:37:59.960115285Z [err]  2026-01-10 22:37:59,954 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Reset playback_expected_end_time to NOW
2026-01-10T22:37:59.960121577Z [err]  2026-01-10 22:37:59,954 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:59.960129391Z [err]  2026-01-10 22:37:59,955 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:37:59.960136248Z [err]  2026-01-10 22:37:59,956 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:38:00.074208761Z [err]  2026-01-10 22:38:00,071 - server - INFO - üî§ RAW TOKENS: [" S"?, "ure"?]
2026-01-10T22:38:00.074215838Z [err]  2026-01-10 22:38:00,071 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Sure' | Generating: False
2026-01-10T22:38:00.126342653Z [err]  2026-01-10 22:38:00,125 - server - INFO - üî§ RAW TOKENS: [" S"‚úì, "ure"‚úì, "."‚úì, "<end>"‚úì]
2026-01-10T22:38:00.126351909Z [err]  2026-01-10 22:38:00,125 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:38:00.126358162Z [err]  2026-01-10 22:38:00,125 - server - INFO - üßπ Cleaned transcript: ' S ure .' -> 'Sure.'
2026-01-10T22:38:00.126378782Z [err]  2026-01-10 22:38:00,125 - server - INFO - üì• FINAL TOKENS: 'Sure.' (3 tokens)
2026-01-10T22:38:00.126384039Z [err]  2026-01-10 22:38:00,125 - server - INFO - üé§ Soniox final transcript: 'Sure.'
2026-01-10T22:38:00.126390255Z [err]  2026-01-10 22:38:00,125 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.2s, generating=False, playbacks=0, is_active=False
2026-01-10T22:38:00.126396671Z [err]  2026-01-10 22:38:00,125 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:38:00.126403371Z [err]  2026-01-10 22:38:00,125 - server - INFO - ‚è±Ô∏è [22:38:00.125] üìù FINAL TRANSCRIPT RECEIVED: 'Sure.'
2026-01-10T22:38:00.126410054Z [err]  2026-01-10 22:38:00,125 - server - INFO - ‚è±Ô∏è [22:38:00.125] STT endpoint detection latency: 16ms
2026-01-10T22:38:00.126416538Z [err]  2026-01-10 22:38:00,125 - server - INFO - ‚è±Ô∏è [22:38:00.125] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:38:00.126423884Z [err]  2026-01-10 22:38:00,125 - server - INFO - ‚è±Ô∏è User spoke at 1768084680.125648
2026-01-10T22:38:00.128000997Z [err]  2026-01-10 22:38:00,126 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:38:00.128007258Z [err]  2026-01-10 22:38:00,126 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:38:00.128011366Z [err]  2026-01-10 22:38:00,126 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Sure.' - Processing...
2026-01-10T22:38:00.138371835Z [err]  2026-01-10 22:38:00,137 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:38:00.138379583Z [err]  2026-01-10 22:38:00,137 - server - INFO - üìä [REAL TIMING] Processing start: 27ms after user audio end
2026-01-10T22:38:00.138388555Z [err]  2026-01-10 22:38:00,137 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:38:00.138393809Z [err]  2026-01-10 22:38:00,137 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.138411419Z [err]  2026-01-10 22:38:00,136 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: -5ms
2026-01-10T22:38:00.138417573Z [err]  2026-01-10 22:38:00,136 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Sure.
2026-01-10T22:38:00.138423866Z [err]  2026-01-10 22:38:00,136 - core_calling_service - INFO - üë§ User stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.138428898Z [err]  2026-01-10 22:38:00,136 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T22:38:00.138433690Z [err]  2026-01-10 22:38:00,136 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:38:00.138438989Z [err]  2026-01-10 22:38:00,137 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+4ms
2026-01-10T22:38:00.138443299Z [err]  2026-01-10 22:38:00,137 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 4ms (Soniox model: stt-rt-v3)
2026-01-10T22:38:00.236851587Z [err]  2026-01-10 22:38:00,235 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:38:00.236859933Z [err]  2026-01-10 22:38:00,235 - persistent_tts_service - INFO - üîÑ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Interrupt flag reset - ready for new audio
2026-01-10T22:38:00.236868589Z [err]  2026-01-10 22:38:00,235 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T22:38:00.236874643Z [err]  2026-01-10 22:38:00,235 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.235] üì• process_user_input() ENTRY - text: 'Sure....'
2026-01-10T22:38:00.238922968Z [err]  2026-01-10 22:38:00,236 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.238927222Z [err]  2026-01-10 22:38:00,236 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: User spoke while Silence Greeting was triggering
2026-01-10T22:38:00.263326154Z [err]  2026-01-10 22:38:00,261 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:00.263330753Z [err]  2026-01-10 22:38:00,261 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.318395098Z [err]  2026-01-10 22:38:00,317 - dead_air_monitor - INFO - üîá MONITOR: Paused - agent is processing/thinking
2026-01-10T22:38:00.715921266Z [err]  2026-01-10 22:38:00,633 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:38:00.715926360Z [err]  2026-01-10 22:38:00,634 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:38:00.715931340Z [err]  2026-01-10 22:38:00,634 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:38:00.715936500Z [err]  2026-01-10 22:38:00,634 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:38:00.715941876Z [err]  2026-01-10 22:38:00,635 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.715947736Z [err]  2026-01-10 22:38:00,636 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:38:00.715952533Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:38:00.715958443Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.636] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:38:00.715964454Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.636] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:38:00.715970559Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.636] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:38:00.715974991Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - Flow processing - History length: 8, Is first: False
2026-01-10T22:38:00.715980531Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 1763159750250
2026-01-10T22:38:00.715987672Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.636] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:38:00.716220643Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üé§ AUTO-TRANSITION AFTER RESPONSE - user spoke, transitioning to: 1763161849799
2026-01-10T22:38:00.716226878Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚úÖ Auto-transitioned (after response) to: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic
2026-01-10T22:38:00.716235859Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.636] ‚úÖ Node selected, about to process content...
2026-01-10T22:38:00.716243735Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:38 PM EST in content
2026-01-10T22:38:00.716248616Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:38:00.716253734Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:38:00.716259481Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:38:00.716265106Z [err]  2026-01-10 22:38:00,636 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:38:00.716272611Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:38:00.716277878Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:38:00.716282661Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:38:00.716287344Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:38:00.716292511Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:38:00.717627064Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 260 chars) - will return text instantly
2026-01-10T22:38:00.717631173Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - Using flow node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic (type: conversation, mode: script)
2026-01-10T22:38:00.717636155Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - ‚è±Ô∏è [22:38:00.637] üìÑ About to process content (mode=script, length=260)
2026-01-10T22:38:00.717641551Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2026-01-10T22:38:00.717647319Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.717652773Z [err]  2026-01-10 22:38:00,637 - server - INFO - üì§ Sentence arrived from LLM: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T22:38:00.717658266Z [err]  2026-01-10 22:38:00,637 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 500ms
2026-01-10T22:38:00.717664056Z [err]  2026-01-10 22:38:00,637 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:38:00.717669718Z [err]  2026-01-10 22:38:00,637 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:38:00.717675295Z [err]  2026-01-10 22:38:00,637 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:38:00.717680904Z [err]  2026-01-10 22:38:00,637 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T22:38:00.717686372Z [err]  2026-01-10 22:38:00,637 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 500ms
2026-01-10T22:38:00.717690751Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üì§ Streamed script sentence 1/2: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T22:38:00.720137787Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.720141418Z [err]  2026-01-10 22:38:00,637 - server - INFO - üì§ Sentence arrived from LLM: I know this call is out of the blue, but do you ha...
2026-01-10T22:38:00.720145497Z [err]  2026-01-10 22:38:00,637 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:38:00.720148942Z [err]  2026-01-10 22:38:00,637 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T22:38:00.720152633Z [err]  2026-01-10 22:38:00,637 - server - INFO - üéµ TTS task #2 started at +0ms
2026-01-10T22:38:00.720156550Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üì§ Streamed script sentence 2/2: I know this call is out of the blue, but do you ha...
2026-01-10T22:38:00.720161985Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üîä Silence tracking reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user responded)
2026-01-10T22:38:00.720167074Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:38:00.720172345Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - üíæ Storing node ID 1763161849799 in conversation history
2026-01-10T22:38:00.720177583Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - LLM response (0.40s): Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stacking income without stacking hours. I know this call is out of the blue, but do you have just 25 seconds for me to explain why I'm reaching out today specifically?
2026-01-10T22:38:00.720182270Z [err]  2026-01-10 22:38:00,637 - core_calling_service - INFO - Total latency: 0.40s
2026-01-10T22:38:00.720187716Z [err]  2026-01-10 22:38:00,638 - server - INFO - ‚úÖ LLM finished in 501ms, TTS tasks already running in background
2026-01-10T22:38:00.723811909Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #4 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:00.723813557Z [err]  2026-01-10 22:38:00,639 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T22:38:00.723818442Z [err]  2026-01-10 22:38:00,639 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:38:00.723823387Z [err]  2026-01-10 22:38:00,639 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T22:38:00.723824888Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'Well, uh, I don't know if you could yet, but, I'm ...'
2026-01-10T22:38:00.723830723Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #4: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T22:38:00.723834116Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #5: I know this call is out of the blue, but do you ha...
2026-01-10T22:38:00.723836598Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:00.723843351Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:00.723850479Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #5 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:00.723858689Z [err]  2026-01-10 22:38:00,639 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'I know this call is out of the blue, but do you ha...'
2026-01-10T22:38:00.725705909Z [err]  2026-01-10 22:38:00,639 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T22:38:00.725716042Z [err]  2026-01-10 22:38:00,639 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:38:00.725717322Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:38:00.725730533Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 4ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:38:00.725735522Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 501ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:38:00.725741997Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:38:00.725748487Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:38:00.725757176Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 2ms (provider: elevenlabs, websocket: False)
2026-01-10T22:38:00.725764592Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 503ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:38:00.725770963Z [err]  2026-01-10 22:38:00,639 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 502ms from user stop üöÄ
2026-01-10T22:38:00.725772958Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:38:00.725779452Z [err]  2026-01-10 22:38:00,639 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.725783077Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:00.728210093Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Well, uh, I don't know if you could yet, but, I'm calling be...'
2026-01-10T22:38:00.728219715Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:38:00.728226216Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:38:00.728230383Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:38:00.728236726Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 803ms estimated
2026-01-10T22:38:00.728242014Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 260 chars, 2 sentences
2026-01-10T22:38:00.728247599Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Sure....'
2026-01-10T22:38:00.728253204Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:38:00.728260335Z [err]  2026-01-10 22:38:00,640 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:00.820807143Z [err]  2026-01-10 22:38:00,819 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.9s ago), marking agent as done speaking
2026-01-10T22:38:00.820817340Z [err]  2026-01-10 22:38:00,819 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084680.819662 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.820824044Z [err]  2026-01-10 22:38:00,819 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:00.820830693Z [err]  2026-01-10 22:38:00,819 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - waiting for first audio (precise state)
2026-01-10T22:38:00.837520693Z [err]  2026-01-10 22:38:00,835 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 507ms)
2026-01-10T22:38:00.837527551Z [err]  2026-01-10 22:38:00,835 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:38:00.837533715Z [err]  2026-01-10 22:38:00,835 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:38:00.943135027Z [err]  2026-01-10 22:38:00,940 - persistent_tts_service - INFO - üì§ Sending 13746 bytes of audio (86 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:00.943144388Z [err]  2026-01-10 22:38:00,940 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:00.943150790Z [err]  2026-01-10 22:38:00,940 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:00.943169336Z [err]  2026-01-10 22:38:00,940 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2026-01-10T22:38:00.943175795Z [err]  2026-01-10 22:38:00,940 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084680.940 (chunk 1/86, 160 bytes)
2026-01-10T22:38:02.312115844Z [err]  2026-01-10 22:38:02,310 - server - INFO - üì§ Audio flowing: 801 packets sent to Soniox (5s update)
2026-01-10T22:38:02.343710903Z [err]  2026-01-10 22:38:02,339 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 86 CHUNKS SENT TO TELNYX in 1399ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:02.343718708Z [err]  2026-01-10 22:38:02,339 - persistent_tts_service - INFO - ‚úÖ Sent 86 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:02.343725334Z [err]  2026-01-10 22:38:02,339 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:02.343731993Z [err]  2026-01-10 22:38:02,339 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:02.343738881Z [err]  2026-01-10 22:38:02,339 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.0s from now)
2026-01-10T22:38:02.343745322Z [err]  2026-01-10 22:38:02,340 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084682.340 (chunk 1/87, 160 bytes)
2026-01-10T22:38:03.746142669Z [err]  2026-01-10 22:38:03,739 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1399ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:03.746148852Z [err]  2026-01-10 22:38:03,740 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:03.746155746Z [err]  2026-01-10 22:38:03,740 - persistent_tts_service - INFO - üì§ Sending 6270 bytes of audio (40 chunks, 0.8s duration) via WebSocket
2026-01-10T22:38:03.746160917Z [err]  2026-01-10 22:38:03,740 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:03.746170024Z [err]  2026-01-10 22:38:03,740 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.8s (total: 1.4s from now)
2026-01-10T22:38:03.746176629Z [err]  2026-01-10 22:38:03,740 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084683.740 (chunk 1/40, 160 bytes)
2026-01-10T22:38:04.234479455Z [err]  2026-01-10 22:38:04,229 - server - INFO - üî§ RAW TOKENS: [" Ok"?]
2026-01-10T22:38:04.234487150Z [err]  2026-01-10 22:38:04,230 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.234492614Z [err]  2026-01-10 22:38:04,230 - core_calling_service - INFO - üîä Silence timer reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user started speaking)
2026-01-10T22:38:04.234497323Z [err]  2026-01-10 22:38:04,230 - core_calling_service - INFO - üë§ User started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.234503678Z [err]  2026-01-10 22:38:04,230 - persistent_tts_service - INFO - ‚ö° [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR_AUDIO called - pending_sentences=0, audio_queue=7
2026-01-10T22:38:04.234508046Z [err]  2026-01-10 22:38:04,230 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T22:38:04.250024221Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/23 due to interruption
2026-01-10T22:38:04.250036247Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 38/40 due to interruption
2026-01-10T22:38:04.250042500Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.250048439Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:04.250053193Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.250057835Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.6s from now)
2026-01-10T22:38:04.250063056Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/87 due to interruption
2026-01-10T22:38:04.250069241Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.250073735Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 3669 bytes of audio (23 chunks, 0.5s duration) via WebSocket
2026-01-10T22:38:04.250078879Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.250083509Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.5s (total: 3.1s from now)
2026-01-10T22:38:04.252100928Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/103 due to interruption
2026-01-10T22:38:04.252111548Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.252133250Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.252134133Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 10031 bytes of audio (63 chunks, 1.3s duration) via WebSocket
2026-01-10T22:38:04.252138605Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 16347 bytes of audio (103 chunks, 2.0s duration) via WebSocket
2026-01-10T22:38:04.252143505Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.252144361Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.252150557Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.0s (total: 5.1s from now)
2026-01-10T22:38:04.252152416Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.3s (total: 6.4s from now)
2026-01-10T22:38:04.252158978Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/63 due to interruption
2026-01-10T22:38:04.252165623Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.253911114Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:04.253918524Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.253925451Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 8.1s from now)
2026-01-10T22:38:04.253931435Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/87 due to interruption
2026-01-10T22:38:04.253937532Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.253943087Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 2554 bytes of audio (16 chunks, 0.3s duration) via WebSocket
2026-01-10T22:38:04.253948616Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.253954799Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.3s (total: 8.4s from now)
2026-01-10T22:38:04.253960266Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/16 due to interruption
2026-01-10T22:38:04.253966218Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.253971540Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üì§ Sending 25263 bytes of audio (158 chunks, 3.2s duration) via WebSocket
2026-01-10T22:38:04.255803918Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:04.255810827Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +3.2s (total: 11.6s from now)
2026-01-10T22:38:04.255815859Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Audio sending STOPPED at chunk 0/158 due to interruption
2026-01-10T22:38:04.255820791Z [err]  2026-01-10 22:38:04,248 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT STOPPED SPEAKING (interrupted, is_speaking=False)
2026-01-10T22:38:04.265447161Z [err]  2026-01-10 22:38:04,262 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:38:04.265455610Z [err]  2026-01-10 22:38:04,261 - persistent_tts_service - INFO - üõë [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T22:38:04.265459976Z [err]  2026-01-10 22:38:04,262 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ok' | Generating: False
2026-01-10T22:38:04.265460899Z [err]  2026-01-10 22:38:04,261 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Reset playback_expected_end_time to NOW
2026-01-10T22:38:04.265466651Z [err]  2026-01-10 22:38:04,261 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.265471511Z [err]  2026-01-10 22:38:04,262 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.349084172Z [err]  2026-01-10 22:38:04,347 - server - INFO - üî§ RAW TOKENS: [" Ok"?]
2026-01-10T22:38:04.349093716Z [err]  2026-01-10 22:38:04,347 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ok' | Generating: False
2026-01-10T22:38:04.680219823Z [err]  2026-01-10 22:38:04,477 - server - INFO - ‚è±Ô∏è User spoke at 1768084684.477312
2026-01-10T22:38:04.680224132Z [err]  2026-01-10 22:38:04,476 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:38:04.680229748Z [err]  2026-01-10 22:38:04,478 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:38:04.680234315Z [err]  2026-01-10 22:38:04,477 - server - INFO - üßπ Cleaned transcript: ' Ok ay.' -> 'Okay.'
2026-01-10T22:38:04.680236791Z [err]  2026-01-10 22:38:04,478 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:38:04.680241029Z [err]  2026-01-10 22:38:04,477 - server - INFO - üì• FINAL TOKENS: 'Okay.' (2 tokens)
2026-01-10T22:38:04.680243312Z [err]  2026-01-10 22:38:04,477 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:38:04.680243811Z [err]  2026-01-10 22:38:04,478 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Okay.' - Processing...
2026-01-10T22:38:04.680250061Z [err]  2026-01-10 22:38:04,477 - server - INFO - üé§ Soniox final transcript: 'Okay.'
2026-01-10T22:38:04.680250099Z [err]  2026-01-10 22:38:04,477 - server - INFO - ‚è±Ô∏è [22:38:04.477] üìù FINAL TRANSCRIPT RECEIVED: 'Okay.'
2026-01-10T22:38:04.680255760Z [err]  2026-01-10 22:38:04,477 - server - INFO - ‚è±Ô∏è [22:38:04.477] STT endpoint detection latency: 7ms
2026-01-10T22:38:04.680255885Z [err]  2026-01-10 22:38:04,477 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.2s, generating=False, playbacks=0, is_active=False
2026-01-10T22:38:04.680261369Z [err]  2026-01-10 22:38:04,477 - server - INFO - ‚è±Ô∏è [22:38:04.477] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:38:04.680270369Z [err]  2026-01-10 22:38:04,476 - server - INFO - üî§ RAW TOKENS: [" Ok"‚úì, "ay."‚úì, "<end>"‚úì]
2026-01-10T22:38:04.681354467Z [err]  2026-01-10 22:38:04,488 - server - INFO - üìä [REAL TIMING] Processing start: 19ms after user audio end
2026-01-10T22:38:04.681360659Z [err]  2026-01-10 22:38:04,488 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:38:04.681365719Z [err]  2026-01-10 22:38:04,488 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.681370834Z [err]  2026-01-10 22:38:04,586 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:38:04.681372123Z [err]  2026-01-10 22:38:04,488 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 8ms
2026-01-10T22:38:04.681377686Z [err]  2026-01-10 22:38:04,586 - persistent_tts_service - INFO - üîÑ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Interrupt flag reset - ready for new audio
2026-01-10T22:38:04.681377867Z [err]  2026-01-10 22:38:04,488 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Okay.
2026-01-10T22:38:04.681384003Z [err]  2026-01-10 22:38:04,586 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T22:38:04.681384793Z [err]  2026-01-10 22:38:04,488 - core_calling_service - INFO - üë§ User stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.681390018Z [err]  2026-01-10 22:38:04,488 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T22:38:04.681394640Z [err]  2026-01-10 22:38:04,488 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:38:04.681398876Z [err]  2026-01-10 22:38:04,488 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+19ms
2026-01-10T22:38:04.681402985Z [err]  2026-01-10 22:38:04,488 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 19ms (Soniox model: stt-rt-v3)
2026-01-10T22:38:04.681407041Z [err]  2026-01-10 22:38:04,488 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:38:04.682837398Z [err]  2026-01-10 22:38:04,586 - core_calling_service - INFO - ‚è±Ô∏è [22:38:04.586] üì• process_user_input() ENTRY - text: 'Okay....'
2026-01-10T22:38:04.682841730Z [err]  2026-01-10 22:38:04,587 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:04.682846114Z [err]  2026-01-10 22:38:04,587 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: User spoke while Silence Greeting was triggering
2026-01-10T22:38:04.682850570Z [err]  2026-01-10 22:38:04,609 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:04.682854819Z [err]  2026-01-10 22:38:04,609 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:05.045165192Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - Flow processing - History length: 10, Is first: False
2026-01-10T22:38:05.045174916Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 1763161849799
2026-01-10T22:38:05.045181103Z [err]  2026-01-10 22:38:05,038 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:38:05.045181621Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - ‚è±Ô∏è [22:38:05.040] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:38:05.045188238Z [err]  2026-01-10 22:38:05,038 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:38:05.045192961Z [err]  2026-01-10 22:38:05,039 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:38:05.045197409Z [err]  2026-01-10 22:38:05,039 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:38:05.045201319Z [err]  2026-01-10 22:38:05,040 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:05.045205472Z [err]  2026-01-10 22:38:05,040 - redis_service - INFO - üì¶ Stored call data in Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (TTL: 3600s)
2026-01-10T22:38:05.045212136Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:38:05.045216317Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - ‚è±Ô∏è [22:38:05.040] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:38:05.045220161Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - ‚è±Ô∏è [22:38:05.040] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:38:05.045223947Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - ‚è±Ô∏è [22:38:05.040] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:38:05.047029523Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - ‚è±Ô∏è Using MERGED transition+response for: Okay....
2026-01-10T22:38:05.047035780Z [err]  2026-01-10 22:38:05,040 - core_calling_service - INFO - Evaluating transitions from Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic for message: Okay.
2026-01-10T22:38:05.047041571Z [err]  2026-01-10 22:38:05,041 - core_calling_service - INFO - ‚è±Ô∏è [22:38:05.041] üöÄ MERGED TRANSITION+RESPONSE START - 4 options
2026-01-10T22:38:05.331728340Z [err]  2026-01-10 22:38:05,328 - dead_air_monitor - INFO - üîá MONITOR: Paused - agent is processing/thinking
2026-01-10T22:38:05.728465319Z [err]  2026-01-10 22:38:05,640 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/2 200 OK"
2026-01-10T22:38:05.835397160Z [err]  2026-01-10 22:38:05,829 - dead_air_monitor - INFO - üîá MONITOR: Paused - agent is processing/thinking
2026-01-10T22:38:06.016416330Z [err]  2026-01-10 22:38:06,015 - core_calling_service - INFO - ‚ö° MERGED TTFT: 974ms
2026-01-10T22:38:06.069380956Z [err]  2026-01-10 22:38:06,065 - core_calling_service - INFO - ‚ö° MERGED: Transition marker [T:0] detected
2026-01-10T22:38:06.187358836Z [err]  2026-01-10 22:38:06,183 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.187363205Z [err]  2026-01-10 22:38:06,183 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.187367199Z [err]  2026-01-10 22:38:06,183 - server - INFO - üì§ Sentence arrived from LLM: [N] Okay, in a nutshell, we set up passive income ...
2026-01-10T22:38:06.187370918Z [err]  2026-01-10 22:38:06,183 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 1694ms
2026-01-10T22:38:06.187375240Z [err]  2026-01-10 22:38:06,183 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:38:06.187379223Z [err]  2026-01-10 22:38:06,183 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:38:06.187383611Z [err]  2026-01-10 22:38:06,183 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:38:06.187388571Z [err]  2026-01-10 22:38:06,183 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T22:38:06.187394111Z [err]  2026-01-10 22:38:06,183 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1695ms
2026-01-10T22:38:06.187398369Z [err]  2026-01-10 22:38:06,183 - core_calling_service - INFO - üì§ Streamed: [N] Okay, in a nutshell, we set up passive income ...
2026-01-10T22:38:06.187402375Z [err]  2026-01-10 22:38:06,184 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #6: [N] Okay, in a nutshell, we set up passive income ...
2026-01-10T22:38:06.187406890Z [err]  2026-01-10 22:38:06,184 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:06.189182470Z [err]  2026-01-10 22:38:06,184 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #6 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:06.189190967Z [err]  2026-01-10 22:38:06,184 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: '[N] Okay, in a nutshell, we set up passive income ...'
2026-01-10T22:38:06.232822258Z [err]  2026-01-10 22:38:06,230 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.232828276Z [err]  2026-01-10 22:38:06,231 - persistent_tts_service - INFO - üé§ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Streaming sentence #7: What questions come to mind as soon as you hear so...
2026-01-10T22:38:06.232833715Z [err]  2026-01-10 22:38:06,230 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.232839006Z [err]  2026-01-10 22:38:06,231 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:06.232841626Z [err]  2026-01-10 22:38:06,230 - server - INFO - üì§ Sentence arrived from LLM: What questions come to mind as soon as you hear so...
2026-01-10T22:38:06.232846944Z [err]  2026-01-10 22:38:06,231 - persistent_tts_service - INFO - üöÄ [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] Sent sentence #7 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:06.232850883Z [err]  2026-01-10 22:38:06,230 - server - INFO - üîç Persistent TTS lookup: call_id=v3:BD_VJynhmh13Ulku0..., session=FOUND
2026-01-10T22:38:06.232854937Z [err]  2026-01-10 22:38:06,231 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'What questions come to mind as soon as you hear so...'
2026-01-10T22:38:06.232867683Z [err]  2026-01-10 22:38:06,230 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T22:38:06.232874163Z [err]  2026-01-10 22:38:06,230 - server - INFO - üéµ TTS task #2 started at +47ms
2026-01-10T22:38:06.232879509Z [err]  2026-01-10 22:38:06,231 - core_calling_service - INFO - üì§ Streamed: What questions come to mind as soon as you hear so...
2026-01-10T22:38:06.234397259Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T22:38:06.234416309Z [err]  2026-01-10 22:38:06,231 - core_calling_service - INFO - ‚è±Ô∏è MERGED TRANSITION+RESPONSE COMPLETE - took 1190ms
2026-01-10T22:38:06.234424024Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - ‚úÖ MERGED: Transitioning to N_IntroduceModel_And_AskQuestions_V3_Adaptive
2026-01-10T22:38:06.234429564Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - ‚è±Ô∏è [TIMING] MERGED_TRANSITION_RESPONSE: 1191ms
2026-01-10T22:38:06.234447887Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - üîä Silence tracking reset for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (user responded)
2026-01-10T22:38:06.234454855Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:38:06.234460562Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - üíæ Storing node ID 1763163400676 in conversation history
2026-01-10T22:38:06.234467793Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - LLM response (1.65s): [N] Okay, in a nutshell, we set up passive income websites, and we let them produce income for you. What questions come to mind as soon as you hear something like that?
2026-01-10T22:38:06.234473984Z [err]  2026-01-10 22:38:06,232 - core_calling_service - INFO - Total latency: 1.65s
2026-01-10T22:38:06.234479398Z [err]  2026-01-10 22:38:06,232 - server - INFO - ‚úÖ LLM finished in 1744ms, TTS tasks already running in background
2026-01-10T22:38:06.234484951Z [err]  2026-01-10 22:38:06,233 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T22:38:06.234490950Z [err]  2026-01-10 22:38:06,233 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:38:06.234496292Z [err]  2026-01-10 22:38:06,233 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T22:38:06.236553489Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:38:06.236558905Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 1744ms from user stop üöÄ
2026-01-10T22:38:06.236564281Z [err]  2026-01-10 22:38:06,233 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.236568410Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:38:06.236573229Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:06.236577214Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:38:06.236581659Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 19ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:38:06.236586447Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 1744ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:38:06.236591155Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 50ms (provider: elevenlabs, websocket: False)
2026-01-10T22:38:06.236598767Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 1744ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:38:06.236603025Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:38:06.236607354Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:38:06.236611625Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:38:06.238688960Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:38:06.238694725Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:38:06.238700609Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2044ms estimated
2026-01-10T22:38:06.238706404Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 168 chars, 2 sentences
2026-01-10T22:38:06.238713309Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Okay....'
2026-01-10T22:38:06.238718837Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '[N] Okay, in a nutshell, we set up passive income websites, ...'
2026-01-10T22:38:06.238724795Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:38:06.238731808Z [err]  2026-01-10 22:38:06,233 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:06.337013246Z [err]  2026-01-10 22:38:06,330 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (2.1s ago), marking agent as done speaking
2026-01-10T22:38:06.337018903Z [err]  2026-01-10 22:38:06,330 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084686.3308496 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.337024780Z [err]  2026-01-10 22:38:06,330 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:06.673848297Z [err]  2026-01-10 22:38:06,485 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084686.486 (chunk 1/87, 160 bytes)
2026-01-10T22:38:06.673868387Z [err]  2026-01-10 22:38:06,485 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:06.673881697Z [err]  2026-01-10 22:38:06,485 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:06.673889936Z [err]  2026-01-10 22:38:06,485 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:06.673897229Z [err]  2026-01-10 22:38:06,485 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2026-01-10T22:38:06.673907703Z [err]  2026-01-10 22:38:06,428 - server - INFO - üìù Saved assistant transcript and latency to database (Node: N_IntroduceModel_And_AskQuestions_V3_Adaptive, Dead Air: 1813ms)
2026-01-10T22:38:06.673916379Z [err]  2026-01-10 22:38:06,429 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:38:06.673928096Z [err]  2026-01-10 22:38:06,429 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:38:07.336052261Z [err]  2026-01-10 22:38:07,333 - server - INFO - üì§ Audio flowing: 1052 packets sent to Soniox (5s update)
2026-01-10T22:38:07.903990877Z [err]  2026-01-10 22:38:07,894 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1408ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:07.903996863Z [err]  2026-01-10 22:38:07,894 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:07.904001163Z [err]  2026-01-10 22:38:07,894 - persistent_tts_service - INFO - üì§ Sending 2554 bytes of audio (16 chunks, 0.3s duration) via WebSocket
2026-01-10T22:38:07.904005752Z [err]  2026-01-10 22:38:07,894 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:07.904009894Z [err]  2026-01-10 22:38:07,894 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.3s (total: 0.6s from now)
2026-01-10T22:38:07.904014037Z [err]  2026-01-10 22:38:07,894 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084687.895 (chunk 1/16, 160 bytes)
2026-01-10T22:38:08.007557058Z [err]  2026-01-10 22:38:08,004 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:08.007566711Z [err]  2026-01-10 22:38:08,004 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.2s from now)
2026-01-10T22:38:08.007573338Z [err]  2026-01-10 22:38:08,005 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084688.005 (chunk 1/87, 160 bytes)
2026-01-10T22:38:08.007610956Z [err]  2026-01-10 22:38:08,004 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 16 CHUNKS SENT TO TELNYX in 110ms (audio duration: 0.3s, paced after 10 chunks)
2026-01-10T22:38:08.007615341Z [err]  2026-01-10 22:38:08,004 - persistent_tts_service - INFO - ‚úÖ Sent 16 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:08.007619555Z [err]  2026-01-10 22:38:08,004 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:08.788769937Z [err]  2026-01-10 22:38:08,785 - server - INFO - üé§ Soniox receiver alive - 14 messages received in last 10s
2026-01-10T22:38:09.701020309Z [err]  2026-01-10 22:38:09,420 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084689.420 (chunk 1/30, 160 bytes)
2026-01-10T22:38:09.701089713Z [err]  2026-01-10 22:38:09,419 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1414ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:09.701093764Z [err]  2026-01-10 22:38:09,419 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:09.701100528Z [err]  2026-01-10 22:38:09,420 - persistent_tts_service - INFO - üì§ Sending 4783 bytes of audio (30 chunks, 0.6s duration) via WebSocket
2026-01-10T22:38:09.701105020Z [err]  2026-01-10 22:38:09,420 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:09.701109379Z [err]  2026-01-10 22:38:09,420 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.6s (total: 1.4s from now)
2026-01-10T22:38:09.759057208Z [err]  2026-01-10 22:38:09,747 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 1163 total packets
2026-01-10T22:38:09.759062390Z [err]  [2026-01-10 22:38:09 +0000] [6] [INFO] connection closed
2026-01-10T22:38:09.759066908Z [err]  2026-01-10 22:38:09,752 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:09.759070892Z [err]  2026-01-10 22:38:09,753 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '0cf939c4-a9a9-47b8-baf4-4890bf3d0ec5', 'occurred_at': '2026-01-10T22:38:09.673878Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '66c0df7a-3bd3-41fd-8438-1f1670d3514b', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:09.759074614Z [err]  2026-01-10 22:38:09,753 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:09.759078423Z [err]  2026-01-10 22:38:09,753 - server - INFO - üì® ================================================
2026-01-10T22:38:09.759082076Z [inf]  100.64.0.6:39486 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:09.765325516Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:38:09.765325756Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 4.8s from now)
2026-01-10T22:38:09.765332282Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - üì§ Sending 15604 bytes of audio (98 chunks, 2.0s duration) via WebSocket
2026-01-10T22:38:09.765336820Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:38:09.765340669Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:09.765346178Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - üì§ Sending 2554 bytes of audio (16 chunks, 0.3s duration) via WebSocket
2026-01-10T22:38:09.765346279Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.0s (total: 3.0s from now)
2026-01-10T22:38:09.765352748Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:38:09.765357353Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:09.765363727Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:09.767501400Z [err]  2026-01-10 22:38:09,764 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:38:09.767524137Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:09.767529873Z [err]  2026-01-10 22:38:09,763 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.3s (total: 5.1s from now)
2026-01-10T22:38:09.767535866Z [err]  2026-01-10 22:38:09,764 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:38:09.767543932Z [err]  2026-01-10 22:38:09,764 - persistent_tts_service - INFO - üì§ Sending 14489 bytes of audio (91 chunks, 1.8s duration) via WebSocket
2026-01-10T22:38:09.767551173Z [err]  2026-01-10 22:38:09,764 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:09.767556681Z [err]  2026-01-10 22:38:09,764 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.8s (total: 6.9s from now)
2026-01-10T22:38:09.849804794Z [err]  2026-01-10 22:38:09,847 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:09.849809295Z [err]  2026-01-10 22:38:09,848 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '9c51c886-936e-43d8-8f92-786ec47a58cb', 'occurred_at': '2026-01-10T22:38:09.520574Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:38:09.520574Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'rmOakFrBlw', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:09.849813269Z [err]  2026-01-10 22:38:09,848 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:09.849817450Z [err]  2026-01-10 22:38:09,848 - server - INFO - üì® ================================================
2026-01-10T22:38:09.849823596Z [err]  2026-01-10 22:38:09,849 - redis_service - INFO - ‚ûñ Removed playback rmOakFrBlw, 0 remaining for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:09.849827975Z [err]  2026-01-10 22:38:09,849 - server - INFO - üîä Redis: Removed playback rmOakFrBlw, 0 remaining
2026-01-10T22:38:09.849832469Z [err]  2026-01-10 22:38:09,849 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-10T22:38:09.851499742Z [err]  2026-01-10 22:38:09,849 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-10T22:38:09.851505308Z [err]  2026-01-10 22:38:09,849 - server - WARNING - ‚ö†Ô∏è Could not find session to start silence timer for v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:09.851509366Z [inf]  100.64.0.10:19338 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:10.036796108Z [err]  2026-01-10 22:38:10,032 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:10.036801800Z [err]  2026-01-10 22:38:10,032 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '26ae3343-9f71-4f58-b6df-a451f53ce0e1', 'occurred_at': '2026-01-10T22:38:09.500560Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '100.00', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '1199', 'skip_packet_count': '17'}, 'outbound': {'packet_count': '1168', 'skip_packet_count': '0'}}, 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:38:09.500560Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2026-01-10T22:37:41.720714Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:10.036807424Z [err]  2026-01-10 22:38:10,032 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:10.036815436Z [err]  2026-01-10 22:38:10,032 - server - INFO - üì® ================================================
2026-01-10T22:38:10.036821637Z [err]  2026-01-10 22:38:10,032 - server - INFO - üìû Call ended: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:10.036826873Z [err]  2026-01-10 22:38:10,033 - server - INFO - üìû Hangup cause: normal_clearing
2026-01-10T22:38:10.342480877Z [err]  2026-01-10 22:38:10,338 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (6.3s left)
2026-01-10T22:38:10.841547048Z [err]  2026-01-10 22:38:10,840 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (5.8s left)
2026-01-10T22:38:11.063067887Z [err]  2026-01-10 22:38:11,062 - server - INFO - üìù Updated call log: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:11.077079777Z [err]  2026-01-10 22:38:11,073 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:11.077103546Z [err]  2026-01-10 22:38:11,073 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'fe5ba404-1709-4c82-b9a9-f43d4f1db1c3', 'occurred_at': '2026-01-10T22:38:10.938364Z', 'payload': {'call_control_id': 'v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg', 'call_leg_id': 'f968d0ae-ee74-11f0-aa0a-02420aef951f', 'call_session_id': 'f9665db0-ee74-11f0-b0ec-02420aef951f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:38:09.588790Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2026-01-10T22:38:09.588790Z', 'recording_id': '550cfa36-1b26-4210-9458-7552260a56be', 'recording_started_at': '2026-01-10T22:37:47.733896Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-10/f968d0ae-ee74-11f0-aa0a-02420aef951f-1768084666818759.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T223810Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=e69ad96c6da10d5f0d2d237129029cbf001215eadd2bb7fefd748ae701c888f5'}, 'start_time': '2026-01-10T22:37:47.733896Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:11.077108498Z [err]  2026-01-10 22:38:11,073 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:11.077113225Z [err]  2026-01-10 22:38:11,073 - server - INFO - üì® ================================================
2026-01-10T22:38:11.077117541Z [err]  2026-01-10 22:38:11,073 - server - INFO - üéôÔ∏è Recording saved for call: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:11.077121455Z [err]  2026-01-10 22:38:11,074 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:11.078799894Z [err]  2026-01-10 22:38:11,074 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=550cfa36-1b26-4210-9458-7552260a56be, call_data=True
2026-01-10T22:38:11.170026773Z [err]  2026-01-10 22:38:11,166 - server - INFO - ‚úÖ Finalized call log: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg (duration=24s, status=completed)
2026-01-10T22:38:11.179094797Z [err]  2026-01-10 22:38:11,175 - server - INFO - üíæ Saved recording URL and ID to database: 550cfa36-1b26-4210-9458-7552260a56be
2026-01-10T22:38:11.179101094Z [err]  2026-01-10 22:38:11,176 - server - INFO - ‚úÖ Entering dual-channel processing
2026-01-10T22:38:11.179107080Z [err]  2026-01-10 22:38:11,176 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2026-01-10T22:38:11.747515848Z [err]  2026-01-10 22:38:11,499 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-10/f968d0ae-ee74-11f0-aa0a-02420aef951f-1768084666818759.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T223810Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=e69ad96c6da10d5f0d2d237129029cbf001215eadd2bb7fefd748ae701c888f5 "HTTP/1.1 200 OK"
2026-01-10T22:38:11.747521273Z [err]  2026-01-10 22:38:11,672 - server - INFO - ‚úÖ Downloaded 87605 bytes
2026-01-10T22:38:11.847853771Z [err]  2026-01-10 22:38:11,843 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:38:11.870394086Z [err]  2026-01-10 22:38:11,865 - server - INFO - ‚úÖ Split into 2 channels
2026-01-10T22:38:11.870407224Z [err]  2026-01-10 22:38:11,865 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2026-01-10T22:38:11.870415388Z [err]  2026-01-10 22:38:11,865 - server - INFO - üìä Channel 0: 478764 bytes
2026-01-10T22:38:11.870424401Z [err]  2026-01-10 22:38:11,865 - server - ERROR - ‚ùå No Soniox API key available
2026-01-10T22:38:11.870431037Z [err]  2026-01-10 22:38:11,865 - server - INFO - ‚ùå Channel 0: No speech
2026-01-10T22:38:11.870444637Z [err]  2026-01-10 22:38:11,865 - server - INFO - üìä Channel 1: 478764 bytes
2026-01-10T22:38:11.870451991Z [err]  2026-01-10 22:38:11,865 - server - ERROR - ‚ùå No Soniox API key available
2026-01-10T22:38:11.870458600Z [err]  2026-01-10 22:38:11,865 - server - INFO - ‚ùå Channel 1: No speech
2026-01-10T22:38:11.870466032Z [err]  2026-01-10 22:38:11,865 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2026-01-10T22:38:11.870474263Z [inf]  100.64.0.6:39486 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:11.939101606Z [err]  2026-01-10 22:38:11,934 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:11.948291526Z [err]  2026-01-10 22:38:11,947 - server - INFO - üìä Auto-added call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2026-01-10T22:38:12.026663733Z [err]  2026-01-10 22:38:12,024 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:12.149719365Z [err]  2026-01-10 22:38:12,149 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:38:12.157632060Z [err]  2026-01-10 22:38:12,151 - redis_service - INFO - üì• Retrieved call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.157638679Z [err]  2026-01-10 22:38:12,151 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2026-01-10T22:38:12.157645852Z [err]  2026-01-10 22:38:12,151 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2026-01-10T22:38:12.193536066Z [err]  2026-01-10 22:38:12,190 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:38:12.193541684Z [err]  2026-01-10 22:38:12,191 - server - WARNING - ‚ö†Ô∏è Post-call webhook returned status 530: <!doctype html>
2026-01-10T22:38:12.193546219Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:38:12.193550145Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:38:12.193553850Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:38:12.256736747Z [err]  2026-01-10 22:38:12,254 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2026-01-10T22:38:12.279598339Z [err]  2026-01-10 22:38:12,278 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:12.279602867Z [err]  2026-01-10 22:38:12,278 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2026-01-10T22:38:12.279607121Z [err]  2026-01-10 22:38:12,278 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2026-01-10T22:38:12.279612361Z [err]  2026-01-10 22:38:12,278 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2026-01-10T22:38:12.357013397Z [err]  2026-01-10 22:38:12,353 - server - INFO - üîç Starting QC analysis for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357015932Z [err]  2026-01-10 22:38:12,351 - server - INFO - üìá Triggered CRM update for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357025360Z [err]  2026-01-10 22:38:12,352 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357032501Z [err]  2026-01-10 22:38:12,352 - server - INFO - ‚úÖ Closed CallSession for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357035147Z [err]  2026-01-10 22:38:12,351 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2026-01-10T22:38:12.357038732Z [err]  2026-01-10 22:38:12,353 - redis_service - INFO - üßπ Deleted call data from Redis: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357043848Z [err]  2026-01-10 22:38:12,351 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2026-01-10T22:38:12.357044819Z [err]  2026-01-10 22:38:12,353 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357051713Z [inf]  100.64.0.5:46370 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:12.357052819Z [err]  2026-01-10 22:38:12,351 - server - INFO - üìá [HANGUP] Agent info keys: None
2026-01-10T22:38:12.357059103Z [err]  2026-01-10 22:38:12,351 - server - INFO - üöÄ Triggered QC analysis for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.357064858Z [err]  2026-01-10 22:38:12,351 - server - INFO - üìä Triggered Campaign QC for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.358060949Z [err]  2026-01-10 22:38:12,353 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2026-01-10T22:38:12.358069133Z [err]  2026-01-10 22:38:12,354 - server - INFO - üìá CRM update starting for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:38:12.358076680Z [err]  2026-01-10 22:38:12,355 - server - INFO - üìá Normalized phone: +17708336397
2026-01-10T22:38:12.755495464Z [err]  2026-01-10 22:38:12,662 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2026-01-10T22:38:12.755506391Z [err]  2026-01-10 22:38:12,724 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:12.755513637Z [err]  2026-01-10 22:38:12,724 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '1bcedf62-0128-48f1-ab37-db16e654920d', 'occurred_at': '2026-01-10T22:38:12.587884Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:12.755519637Z [err]  2026-01-10 22:38:12,724 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:12.755527017Z [err]  2026-01-10 22:38:12,724 - server - INFO - üì® ================================================
2026-01-10T22:38:12.755528380Z [err]  2026-01-10 22:38:12,461 - server - INFO - üìù Converted transcript from 9 messages to 656 characters
2026-01-10T22:38:12.755535269Z [err]  2026-01-10 22:38:12,565 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:12.755536936Z [err]  2026-01-10 22:38:12,724 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2026-01-10T22:38:12.755543955Z [inf]  100.64.0.6:39486 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:12.765347327Z [err]  2026-01-10 22:38:12,759 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2026-01-10T22:38:12.765354750Z [err]  2026-01-10 22:38:12,759 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:38:12.765361191Z [err]  2026-01-10 22:38:12,759 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:12.787126648Z [err]  2026-01-10 22:38:12,786 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2026-01-10T22:38:12.789154480Z [err]  2026-01-10 22:38:12,787 - telnyx_service - INFO - ‚úÖ Call initiated: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:12.882702928Z [err]  2026-01-10 22:38:12,879 - server - INFO - üìù Created call log: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:12.882708465Z [err]  2026-01-10 22:38:12,879 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:38:12.882714052Z [err]  2026-01-10 22:38:12,879 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'barge_in_settings': {'enable_verbose_barge_in': True, 'word_count_threshold': 10, 'interruption_prompt': 'The user is speaking for a long time. Interrupt them politely but firmly to acknowledge what they said and guide the conversation back to the goal. start by saying an elongated why whhhhyyyy...'}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2026-01-10T22:38:12.887078300Z [err]  2026-01-10 22:38:12,879 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:38:12.887082961Z [err]  2026-01-10 22:38:12,880 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:38:12.897930658Z [err]  2026-01-10 22:38:12,889 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:12.897935227Z [err]  2026-01-10 22:38:12,889 - server - INFO - üì¶ Call data stored in Redis and memory
2026-01-10T22:38:12.897939937Z [err]  2026-01-10 22:38:12,889 - server - INFO - üìû Outbound call initiated: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:12.897944219Z [inf]  100.64.0.2:15136 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2026-01-10T22:38:12.913077216Z [err]  2026-01-10 22:38:12,911 - server - INFO - üìá CRM: Total variables collected: []
2026-01-10T22:38:12.926007173Z [err]  2026-01-10 22:38:12,919 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:38:12.926012411Z [err]  2026-01-10 22:38:12,920 - server - WARNING - ‚ö†Ô∏è Call-initiated webhook returned status 530: <!doctype html>
2026-01-10T22:38:12.926018270Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:38:12.926024496Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:38:12.926030866Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:38:12.980287608Z [err]  2026-01-10 22:38:12,973 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=9, logs_count=10, status=completed
2026-01-10T22:38:13.054946515Z [err]  2026-01-10 22:38:13,053 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2026-01-10T22:38:13.054953407Z [err]  2026-01-10 22:38:13,053 - server - INFO -    Client: Address(host='100.64.0.10', port=55058)
2026-01-10T22:38:13.054961478Z [err]  2026-01-10 22:38:13,053 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': 'CcFsBwzxi5Wxp+ek887oaA==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': '01Bfl5CoSfqAiPug2prcFg', 'x-real-ip': '192.76.120.151', 'x-request-start': '1768084692834', 'accept-encoding': 'gzip'}
2026-01-10T22:38:13.054971672Z [err]  2026-01-10 22:38:13,053 - server - INFO -    Path: /api/telnyx/audio-stream
2026-01-10T22:38:13.055001724Z [err]  2026-01-10 22:38:13,053 - server - INFO - üîå Incoming Telnyx WebSocket connection
2026-01-10T22:38:13.055009215Z [err]  [2026-01-10 22:38:13 +0000] [6] [INFO] ('100.64.0.10', 55058) - "WebSocket /api/telnyx/audio-stream" [accepted]
2026-01-10T22:38:13.055015838Z [err]  2026-01-10 22:38:13,054 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2026-01-10T22:38:13.057078406Z [err]  [2026-01-10 22:38:13 +0000] [6] [INFO] connection open
2026-01-10T22:38:13.103212176Z [err]  2026-01-10 22:38:13,089 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2026-01-10T22:38:13.206971554Z [err]  2026-01-10 22:38:13,204 - server - INFO - üì¨ Received Telnyx event: connected
2026-01-10T22:38:13.206980054Z [err]  2026-01-10 22:38:13,205 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2026-01-10T22:38:13.364151574Z [err]  2026-01-10 22:38:13,359 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2026-01-10T22:38:13.686640457Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:38:13.686649937Z [err]  2026-01-10 22:38:13,632 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:38:13.686664631Z [err]  2026-01-10 22:38:13,457 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2026-01-10T22:38:13.686670524Z [err]  2026-01-10 22:38:13,457 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T22:38:13.686673129Z [err]  2026-01-10 22:38:13,457 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2026-01-10T22:38:13.686677019Z [err]  2026-01-10 22:38:13,459 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2026-01-10T22:38:13.686682314Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2026-01-10T22:38:13.686682559Z [err]    File "/app/backend/server.py", line 10123, in trigger_campaign_qc_for_call
2026-01-10T22:38:13.686687507Z [err]      await run_full_qc_analysis(
2026-01-10T22:38:13.686694496Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T22:38:13.686703766Z [err]  
2026-01-10T22:38:13.686711311Z [err]  2026-01-10 22:38:13,632 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T22:38:13.686718848Z [err]  2026-01-10 22:38:13,632 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:38:13.687207385Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-10T22:38:13.687211767Z [err]  2026-01-10 22:38:13,634 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:14.168762015Z [err]  2026-01-10 22:38:14,162 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T22:38:14.168796216Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-10T22:38:14.168801636Z [err]  2026-01-10 22:38:14,164 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:14.168818832Z [err]  2026-01-10 22:38:14,163 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:38:14.168823624Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:38:14.168828564Z [err]  2026-01-10 22:38:14,163 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:38:14.692762519Z [err]  2026-01-10 22:38:14,530 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T22:38:14.692766453Z [err]  2026-01-10 22:38:14,530 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:38:14.692770065Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:38:14.692774575Z [err]  2026-01-10 22:38:14,530 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:38:14.692778264Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:38:14.692781868Z [err]  2026-01-10 22:38:14,630 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:14.692785477Z [err]  2026-01-10 22:38:14,630 - server - INFO - ‚úÖ QC analysis completed for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:14.692789319Z [err]  2026-01-10 22:38:14,630 - server - INFO - üìä Scores: Commitment=50, Conversion=60, Excellence=50
2026-01-10T22:38:14.844024589Z [err]  2026-01-10 22:38:14,834 - server - INFO - üìä Updated campaign_calls with QC scores for v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:15.033248455Z [err]  2026-01-10 22:38:15,030 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2026-01-10T22:38:15.129864790Z [err]  2026-01-10 22:38:15,127 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2026-01-10T22:38:15.129871328Z [err]  2026-01-10 22:38:15,128 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: 'str' object has no attribute 'get'
2026-01-10T22:38:15.300958088Z [err]  2026-01-10 22:38:15,299 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.4s left)
2026-01-10T22:38:15.674962055Z [err]  2026-01-10 22:38:15,555 - server - INFO - üì® ================================================
2026-01-10T22:38:15.674973321Z [err]  2026-01-10 22:38:15,555 - server - INFO - ‚úÖ Call answered: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:15.674976738Z [err]  2026-01-10 22:38:15,455 - server - INFO - ‚úÖ Call data found after 0s wait
2026-01-10T22:38:15.674988200Z [err]  2026-01-10 22:38:15,455 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2026-01-10T22:38:15.674998605Z [err]  2026-01-10 22:38:15,555 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:15.675006016Z [err]  2026-01-10 22:38:15,555 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': '4d3e2f85-6deb-4c51-8d93-9f3cf385adce', 'occurred_at': '2026-01-10T22:38:15.147885Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2026-01-10T22:38:12.587884Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:15.675012427Z [err]  2026-01-10 22:38:15,450 - server - INFO - üì¨ Received Telnyx event: start
2026-01-10T22:38:15.675014214Z [err]  2026-01-10 22:38:15,555 - server - INFO - üéØ Event type: call.answered, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:15.675018244Z [err]  2026-01-10 22:38:15,450 - server - INFO - üé¨ Stream started for call: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:15.675032628Z [err]  2026-01-10 22:38:15,454 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:15.675973505Z [err]  2026-01-10 22:38:15,559 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:15.675977847Z [err]  2026-01-10 22:38:15,562 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2026-01-10T22:38:15.675981786Z [err]  2026-01-10 22:38:15,562 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2026-01-10T22:38:15.675985464Z [err]  2026-01-10 22:38:15,660 - server - INFO - ‚úÖ Call log updated
2026-01-10T22:38:15.675989357Z [err]  2026-01-10 22:38:15,660 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2026-01-10T22:38:15.675992944Z [err]  2026-01-10 22:38:15,660 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:38:15.675997543Z [err]  2026-01-10 22:38:15,660 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:38:15.698406361Z [err]  2026-01-10 22:38:15,694 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:38:15.698410246Z [err]  2026-01-10 22:38:15,695 - server - WARNING - ‚ö†Ô∏è Call-started webhook returned status 530: <!doctype html>
2026-01-10T22:38:15.698414472Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:38:15.698419108Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:38:15.698422830Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:38:15.755345428Z [err]  2026-01-10 22:38:15,751 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:15.802684843Z [err]  2026-01-10 22:38:15,800 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (0.9s left)
2026-01-10T22:38:15.846213104Z [err]  2026-01-10 22:38:15,841 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:15.846219208Z [err]  2026-01-10 22:38:15,841 - server - INFO - üîß Creating Telnyx service with user's keys...
2026-01-10T22:38:15.862494258Z [err]  2026-01-10 22:38:15,861 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:15.963553755Z [err]  2026-01-10 22:38:15,956 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2026-01-10T22:38:15.963560001Z [err]  2026-01-10 22:38:15,956 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2026-01-10T22:38:15.963565873Z [err]  2026-01-10 22:38:15,959 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:15.963572164Z [err]  2026-01-10 22:38:15,960 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:38:15.963578020Z [err]  2026-01-10 22:38:15,961 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-10T22:38:16.068337558Z [err]  2026-01-10 22:38:16,053 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-10T22:38:16.068346866Z [err]  2026-01-10 22:38:16,053 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-10T22:38:16.068353127Z [err]  2026-01-10 22:38:16,061 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_start "HTTP/1.1 200 OK"
2026-01-10T22:38:16.068357995Z [err]  2026-01-10 22:38:16,061 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: k_y3oxosgA (loop=True, overlay=True)
2026-01-10T22:38:16.068363475Z [err]  2026-01-10 22:38:16,062 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag'
2026-01-10T22:38:16.068368901Z [err]  2026-01-10 22:38:16,062 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:16.068419200Z [err]  2026-01-10 22:38:16,053 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-10T22:38:16.068425069Z [err]  2026-01-10 22:38:16,053 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-10T22:38:16.068432389Z [err]  2026-01-10 22:38:16,053 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-10T22:38:16.096341762Z [err]  2026-01-10 22:38:16,091 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:16.096350518Z [err]  2026-01-10 22:38:16,092 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': 'f382cf8a-df15-4d53-832d-e24428d429d4', 'occurred_at': '2026-01-10T22:38:15.687884Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '2721f905-d159-4952-ae27-9b716111e437', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:16.096357508Z [err]  2026-01-10 22:38:16,092 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:16.096363239Z [err]  2026-01-10 22:38:16,092 - server - INFO - üì® ================================================
2026-01-10T22:38:16.096368727Z [inf]  100.64.0.12:56314 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:16.378187837Z [err]  2026-01-10 22:38:16,370 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:16.378197291Z [err]  2026-01-10 22:38:16,371 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'f7aa9d34-98a1-44fe-ae57-4b88d2ae7b5c', 'occurred_at': '2026-01-10T22:38:16.167889Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'k_y3oxosgA', 'start_time': '2026-01-10T22:38:16.167889Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:16.378204189Z [err]  2026-01-10 22:38:16,371 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:16.378210674Z [err]  2026-01-10 22:38:16,371 - server - INFO - üì® ================================================
2026-01-10T22:38:16.378216760Z [inf]  100.64.0.10:19338 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:17.734368756Z [err]  2026-01-10 22:38:17,576 - server - INFO - ‚úÖ Initialized call_states for v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag with session reference
2026-01-10T22:38:17.734390579Z [err]  2026-01-10 22:38:17,570 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/record_start "HTTP/1.1 200 OK"
2026-01-10T22:38:17.734397108Z [err]  2026-01-10 22:38:17,571 - server - INFO - üéôÔ∏è Call recording started for v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:17.734402605Z [err]  2026-01-10 22:38:17,571 - server - INFO - üîß Creating call session for v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag...
2026-01-10T22:38:17.734407497Z [err]  2026-01-10 22:38:17,571 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:38:17.734411726Z [err]  2026-01-10 22:38:17,571 - server - INFO - üîß Calling create_call_session() - START
2026-01-10T22:38:17.734416123Z [err]  2026-01-10 22:38:17,571 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2026-01-10T22:38:17.734421739Z [err]  2026-01-10 22:38:17,573 - core_calling_service - INFO - ‚è∞ Check-in triggered after 11.2s silence (threshold: 7s)
2026-01-10T22:38:17.734426702Z [err]  2026-01-10 22:38:17,574 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-10T22:38:17.734430703Z [err]  2026-01-10 22:38:17,574 - dead_air_monitor - INFO - üí¨ Sending check-in after 11.2s silence: Are you still there?
2026-01-10T22:38:17.734435042Z [err]  2026-01-10 22:38:17,574 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:17.734438906Z [err]  2026-01-10 22:38:17,574 - telnyx_service - INFO - üîä Speaking text on call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: Are you still there?...
2026-01-10T22:38:17.734443041Z [err]  2026-01-10 22:38:17,574 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T22:38:17.734509334Z [err]  2026-01-10 22:38:17,574 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T22:38:17.734516525Z [err]  2026-01-10 22:38:17,574 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T22:38:17.734520868Z [err]  2026-01-10 22:38:17,574 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T22:38:17.734530693Z [err]  2026-01-10 22:38:17,574 - server - INFO - ‚è±Ô∏è [22:38:17.574] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2026-01-10T22:38:17.734535499Z [err]  2026-01-10 22:38:17,574 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2026-01-10T22:38:17.734540940Z [err]  2026-01-10 22:38:17,574 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2026-01-10T22:38:17.734545410Z [err]  2026-01-10 22:38:17,575 - persistent_tts_service - INFO - üîá [Call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:38:17.734549953Z [err]  2026-01-10 22:38:17,575 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:17.734554334Z [err]  2026-01-10 22:38:17,575 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 1521ms
2026-01-10T22:38:17.734559278Z [err]  2026-01-10 22:38:17,575 - server - INFO - ‚úÖ Session created in WebSocket worker
2026-01-10T22:38:17.734564631Z [err]  2026-01-10 22:38:17,575 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 3000ms
2026-01-10T22:38:17.734573615Z [err]  2026-01-10 22:38:17,575 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2026-01-10T22:38:17.734578924Z [err]  2026-01-10 22:38:17,576 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2026-01-10T22:38:17.736004171Z [err]  2026-01-10 22:38:17,662 - core_calling_service - INFO - üîç KB count query completed: 4 items
2026-01-10T22:38:17.736008567Z [err]  2026-01-10 22:38:17,663 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2026-01-10T22:38:17.736011661Z [err]  2026-01-10 22:38:17,662 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2026-01-10T22:38:17.736019416Z [err]  2026-01-10 22:38:17,576 - server - INFO - ‚úÖ Stored Telnyx WebSocket in call_data for audio streaming
2026-01-10T22:38:17.736026100Z [err]  2026-01-10 22:38:17,576 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found to update for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:17.736033463Z [err]  2026-01-10 22:38:17,663 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2026-01-10T22:38:17.736033728Z [err]  2026-01-10 22:38:17,576 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 3000ms...
2026-01-10T22:38:17.736044196Z [err]  2026-01-10 22:38:17,663 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2026-01-10T22:38:17.766471407Z [err]  2026-01-10 22:38:17,765 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:17.766478767Z [err]  2026-01-10 22:38:17,765 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 102ms
2026-01-10T22:38:17.766483356Z [err]  2026-01-10 22:38:17,765 - server - INFO - üîß Calling create_call_session() - COMPLETE
2026-01-10T22:38:17.766488229Z [err]  2026-01-10 22:38:17,765 - server - INFO - ‚úÖ Session object created: CallSession
2026-01-10T22:38:17.770723232Z [err]  2026-01-10 22:38:17,770 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:17.770727577Z [err]  2026-01-10 22:38:17,770 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2026-01-10T22:38:17.772753373Z [err]  2026-01-10 22:38:17,770 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2026-01-10T22:38:17.772763519Z [err]  2026-01-10 22:38:17,771 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:17.772770955Z [err]  2026-01-10 22:38:17,771 - server - INFO - ü§ñ AI session created for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:17.772777096Z [err]  2026-01-10 22:38:17,771 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2026-01-10T22:38:17.772783240Z [err]  2026-01-10 22:38:17,771 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2026-01-10T22:38:17.772791476Z [err]  2026-01-10 22:38:17,771 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2026-01-10T22:38:17.772798546Z [err]  2026-01-10 22:38:17,771 - server - INFO - üëÇ User speaks first - waiting for user input...
2026-01-10T22:38:17.772803807Z [err]  2026-01-10 22:38:17,771 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2026-01-10T22:38:17.772808429Z [err]  2026-01-10 22:38:17,771 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2026-01-10T22:38:17.772813408Z [err]  2026-01-10 22:38:17,771 - server - INFO - üé§ Voice flow - streaming started via dial command
2026-01-10T22:38:17.775935788Z [err]  2026-01-10 22:38:17,775 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:17.777974272Z [err]  2026-01-10 22:38:17,776 - server - INFO - ü§ê No greeting - waiting for user to speak first
2026-01-10T22:38:17.777981903Z [err]  2026-01-10 22:38:17,776 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2026-01-10T22:38:17.777988205Z [inf]  100.64.0.8:39096 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:18.133288303Z [err]  2026-01-10 22:38:18,127 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:18.133293391Z [err]  2026-01-10 22:38:18,127 - server - INFO - üì¶ ElevenLabs Request Payload:
2026-01-10T22:38:18.133299727Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Text length: 20 chars
2026-01-10T22:38:18.133303875Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Text content: 'Are you still there?'
2026-01-10T22:38:18.133307909Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Text bytes: b'Are you still there?'
2026-01-10T22:38:18.133311758Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Model: eleven_turbo_v2_5
2026-01-10T22:38:18.133315710Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2026-01-10T22:38:18.133320074Z [err]  2026-01-10 22:38:18,127 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2026-01-10T22:38:18.133324907Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2026-01-10T22:38:18.133329585Z [err]  2026-01-10 22:38:18,127 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2026-01-10T22:38:18.133334932Z [err]  2026-01-10 22:38:18,127 - server - INFO -    Timeout: 10.0s
2026-01-10T22:38:18.136997004Z [err]  2026-01-10 22:38:18,135 - server - INFO -    ‚úì HTTP client created (0.007s)
2026-01-10T22:38:18.137003167Z [err]  2026-01-10 22:38:18,135 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2026-01-10T22:38:18.144555287Z [err]  2026-01-10 22:38:18,144 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2026-01-10T22:38:18.706863337Z [err]  2026-01-10 22:38:18,470 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17599 bytes)
2026-01-10T22:38:18.706869987Z [err]  2026-01-10 22:38:18,451 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2026-01-10T22:38:18.706871519Z [err]  2026-01-10 22:38:18,452 - server - INFO -    ‚úì Response status: 200
2026-01-10T22:38:18.706875057Z [err]  2026-01-10 22:38:18,470 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.90s
2026-01-10T22:38:18.706875394Z [err]  2026-01-10 22:38:18,469 - server - INFO -       - First chunk: 340ms
2026-01-10T22:38:18.706878201Z [err]  2026-01-10 22:38:18,452 - server - INFO -    ‚úì Connection established (0.324s) [TARGET: <200ms]
2026-01-10T22:38:18.706881438Z [err]  2026-01-10 22:38:18,452 - server - INFO -    ‚Üí Streaming audio chunks...
2026-01-10T22:38:18.706882986Z [err]  2026-01-10 22:38:18,470 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:38:18.706885145Z [err]  2026-01-10 22:38:18,469 - server - INFO -       - All chunks: 342ms
2026-01-10T22:38:18.706888679Z [err]  2026-01-10 22:38:18,467 - server - INFO -    ‚úì FIRST CHUNK received (0.340s, 1001 bytes) [TARGET: <300ms]
2026-01-10T22:38:18.706890548Z [err]  2026-01-10 22:38:18,469 - server - INFO -       - Audio generation only: 15ms
2026-01-10T22:38:18.706894891Z [err]  2026-01-10 22:38:18,469 - server - INFO -    ‚úì ALL CHUNKS received: 24 chunks (0.342s)
2026-01-10T22:38:18.706896964Z [err]  2026-01-10 22:38:18,470 - server - INFO - ‚è±Ô∏è [22:38:18.470] üîä TTS COMPLETE: 895ms, audio_size=17599 bytes
2026-01-10T22:38:18.706909850Z [err]  2026-01-10 22:38:18,469 - server - INFO -    ‚úì Total audio size: 17599 bytes
2026-01-10T22:38:18.706920423Z [err]  2026-01-10 22:38:18,469 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2026-01-10T22:38:18.706925667Z [err]  2026-01-10 22:38:18,469 - server - INFO -       - Connection: 324ms
2026-01-10T22:38:18.707543752Z [err]  2026-01-10 22:38:18,470 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:38:18.707547807Z [err]  2026-01-10 22:38:18,616 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2026-01-10T22:38:18.707551659Z [err]  2026-01-10 22:38:18,616 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2026-01-10T22:38:18.707555404Z [err]  2026-01-10 22:38:18,616 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2026-01-10T22:38:18.707561220Z [err]  2026-01-10 22:38:18,616 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:18.707565630Z [err]  2026-01-10 22:38:18,617 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:18.707569630Z [err]  2026-01-10 22:38:18,617 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2026-01-10T22:38:18.707573882Z [err]  2026-01-10 22:38:18,682 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:38:18.707577976Z [err]  2026-01-10 22:38:18,683 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.21s
2026-01-10T22:38:18.707581985Z [err]  2026-01-10 22:38:18,683 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2026-01-10T22:38:18.707586403Z [err]    "errors": [
2026-01-10T22:38:18.707591241Z [err]      {
2026-01-10T22:38:18.707595054Z [err]        "code": "90018",
2026-01-10T22:38:18.707599523Z [err]        "title": "Call has already ended",
2026-01-10T22:38:18.707604292Z [err]        "detail": "This call is no longer active and can't receive commands."
2026-01-10T22:38:18.708581805Z [err]      }
2026-01-10T22:38:18.708585810Z [err]    ]
2026-01-10T22:38:18.708590332Z [err]  }
2026-01-10T22:38:18.708594558Z [err]  2026-01-10 22:38:18,683 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2026-01-10T22:38:18.954237650Z [err]  2026-01-10 22:38:18,948 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:38:18.954245123Z [err]  2026-01-10 22:38:18,948 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2026-01-10T22:38:18.954249487Z [err]  2026-01-10 22:38:18,948 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T22:38:19.119927772Z [err]  2026-01-10 22:38:19,118 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.356781259Z [err]  2026-01-10 22:38:19,340 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:19.356787596Z [err]  2026-01-10 22:38:19,340 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '60ecbcc7-ff26-4bc3-a0db-6d9964ee25ac', 'occurred_at': '2026-01-10T22:38:18.807887Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:19.356795805Z [err]  2026-01-10 22:38:19,340 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.356801833Z [err]  2026-01-10 22:38:19,340 - server - INFO - üì® ================================================
2026-01-10T22:38:19.356807901Z [inf]  100.64.0.13:52226 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:19.698278097Z [err]  2026-01-10 22:38:19,637 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:19.698292605Z [err]  2026-01-10 22:38:19,620 - core_calling_service - INFO - üîä Silence timer reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user started speaking)
2026-01-10T22:38:19.698298651Z [err]  2026-01-10 22:38:19,620 - core_calling_service - INFO - üë§ User started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.698303179Z [err]  2026-01-10 22:38:19,449 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-10T22:38:19.698304438Z [err]  2026-01-10 22:38:19,620 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.698309592Z [err]  2026-01-10 22:38:19,620 - server - WARNING - ‚ö†Ô∏è [REAL TIMING] No TTS session found to clear for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.698311861Z [err]  2026-01-10 22:38:19,449 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084699.4493587 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:19.698315951Z [err]  2026-01-10 22:38:19,624 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.698318554Z [err]  2026-01-10 22:38:19,449 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:19.698323282Z [err]  2026-01-10 22:38:19,620 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.698330318Z [err]  2026-01-10 22:38:19,620 - server - INFO - üî§ RAW TOKENS: ["Hell"?]
2026-01-10T22:38:19.713335144Z [err]  2026-01-10 22:38:19,637 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hell' | Generating: False
2026-01-10T22:38:19.713341496Z [err]  2026-01-10 22:38:19,665 - server - INFO - üî§ RAW TOKENS: ["Hell"‚úì, "o."‚úì, "<end>"‚úì]
2026-01-10T22:38:19.713347561Z [err]  2026-01-10 22:38:19,665 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:38:19.713352210Z [err]  2026-01-10 22:38:19,665 - server - INFO - üì• FINAL TOKENS: 'Hell o.' (2 tokens)
2026-01-10T22:38:19.713358148Z [err]  2026-01-10 22:38:19,665 - server - INFO - üé§ Soniox final transcript: 'Hell o.'
2026-01-10T22:38:19.713362903Z [err]  2026-01-10 22:38:19,665 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.713367104Z [err]  2026-01-10 22:38:19,665 - server - INFO - üîç FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2026-01-10T22:38:19.713371340Z [err]  2026-01-10 22:38:19,665 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.713376135Z [err]  2026-01-10 22:38:19,665 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:38:19.713381623Z [err]  2026-01-10 22:38:19,665 - server - INFO - ‚è±Ô∏è [22:38:19.665] üìù FINAL TRANSCRIPT RECEIVED: 'Hell o.'
2026-01-10T22:38:19.713386247Z [err]  2026-01-10 22:38:19,665 - server - INFO - ‚è±Ô∏è [22:38:19.665] STT endpoint detection latency: 12ms
2026-01-10T22:38:19.713390713Z [err]  2026-01-10 22:38:19,665 - server - INFO - ‚è±Ô∏è [22:38:19.665] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:38:19.713394757Z [err]  2026-01-10 22:38:19,666 - server - INFO - ‚è±Ô∏è User spoke at 1768084699.6659951
2026-01-10T22:38:19.713461536Z [err]  2026-01-10 22:38:19,667 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:19.713465572Z [err]  2026-01-10 22:38:19,668 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:38:19.713470197Z [err]  2026-01-10 22:38:19,668 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.713474458Z [err]  2026-01-10 22:38:19,668 - server - INFO - ‚úÖ Agent SILENT - User said 2 word(s): 'Hell o.' - Processing...
2026-01-10T22:38:19.713478796Z [err]  2026-01-10 22:38:19,678 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: -6ms
2026-01-10T22:38:19.713483031Z [err]  2026-01-10 22:38:19,678 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hell o.
2026-01-10T22:38:19.713487037Z [err]  2026-01-10 22:38:19,678 - core_calling_service - INFO - üë§ User stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.713491359Z [err]  2026-01-10 22:38:19,678 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:38:19.713495246Z [err]  2026-01-10 22:38:19,678 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+4ms
2026-01-10T22:38:19.713499924Z [err]  2026-01-10 22:38:19,678 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 4ms (Soniox model: stt-rt-v3)
2026-01-10T22:38:19.713504522Z [err]  2026-01-10 22:38:19,678 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:38:19.713508926Z [err]  2026-01-10 22:38:19,678 - server - INFO - üìä [REAL TIMING] Processing start: 25ms after user audio end
2026-01-10T22:38:19.713513226Z [err]  2026-01-10 22:38:19,678 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:38:19.713544989Z [err]  2026-01-10 22:38:19,678 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.776599604Z [err]  2026-01-10 22:38:19,774 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:38:19.776608256Z [err]  2026-01-10 22:38:19,774 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:19.776615619Z [err]  2026-01-10 22:38:19,774 - core_calling_service - INFO - ‚è±Ô∏è [22:38:19.774] üì• process_user_input() ENTRY - text: 'Hell o....'
2026-01-10T22:38:19.776621726Z [err]  2026-01-10 22:38:19,775 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:19.776627382Z [err]  2026-01-10 22:38:19,775 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: User spoke while Silence Greeting was triggering
2026-01-10T22:38:19.805165586Z [err]  2026-01-10 22:38:19,798 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:19.805174776Z [err]  2026-01-10 22:38:19,798 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:20.128315784Z [err]  2026-01-10 22:38:20,122 - dead_air_monitor - INFO - üîá MONITOR: Paused - agent is processing/thinking
2026-01-10T22:38:20.142972831Z [err]  2026-01-10 22:38:20,142 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:38:20.143859143Z [err]  2026-01-10 22:38:20,142 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:38:20.143865988Z [err]  2026-01-10 22:38:20,143 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:38:20.143871813Z [err]  2026-01-10 22:38:20,143 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:38:20.145443679Z [err]  2026-01-10 22:38:20,143 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:20.145454292Z [err]  2026-01-10 22:38:20,144 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:20.145459268Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:38:20.145463602Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - ‚è±Ô∏è [22:38:20.144] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:38:20.145468416Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - ‚è±Ô∏è [22:38:20.144] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:38:20.145473399Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - ‚è±Ô∏è [22:38:20.144] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:38:20.145477883Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2026-01-10T22:38:20.145483796Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - ‚è±Ô∏è [22:38:20.144] ‚úÖ Node selected, about to process content...
2026-01-10T22:38:20.145489479Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:38 PM EST in content
2026-01-10T22:38:20.145494548Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:38:20.145498800Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:38:20.145502943Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:38:20.145507222Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:38:20.147330644Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:38:20.147337106Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:38:20.147342845Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:38:20.147348400Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:38:20.147353643Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:38:20.147358088Z [err]  2026-01-10 22:38:20,144 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2026-01-10T22:38:20.147365304Z [err]  2026-01-10 22:38:20,145 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2026-01-10T22:38:20.147369676Z [err]  2026-01-10 22:38:20,145 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2026-01-10T22:38:20.147375257Z [err]  2026-01-10 22:38:20,145 - core_calling_service - INFO - ‚è±Ô∏è [22:38:20.145] üìÑ About to process content (mode=script, length=9)
2026-01-10T22:38:20.147381414Z [err]  2026-01-10 22:38:20,145 - core_calling_service - INFO - üì§ Streaming script as 1 sentence(s)
2026-01-10T22:38:20.147386162Z [err]  2026-01-10 22:38:20,145 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:20.147391346Z [err]  2026-01-10 22:38:20,145 - server - INFO - üì§ Sentence arrived from LLM: Kendrick?...
2026-01-10T22:38:20.147396551Z [err]  2026-01-10 22:38:20,145 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 466ms
2026-01-10T22:38:20.148374652Z [err]  2026-01-10 22:38:20,145 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:38:20.148378497Z [err]  2026-01-10 22:38:20,145 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:WEX1rb28OL4rUMpOW... (active sessions: ['v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg'])
2026-01-10T22:38:20.148382209Z [err]  2026-01-10 22:38:20,145 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2026-01-10T22:38:20.239871008Z [err]  2026-01-10 22:38:20,234 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:20.323504849Z [err]  2026-01-10 22:38:20,322 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:20.736537810Z [err]  2026-01-10 22:38:20,410 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:38:20.736541805Z [err]  2026-01-10 22:38:20,431 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:20.736546227Z [err]  2026-01-10 22:38:20,431 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2026-01-10T22:38:20.736550454Z [err]  2026-01-10 22:38:20,431 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-10T22:38:20.736554835Z [err]  2026-01-10 22:38:20,431 - persistent_tts_service - INFO - üîå [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Establishing persistent TTS WebSocket...
2026-01-10T22:38:20.736559253Z [err]  2026-01-10 22:38:20,431 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2026-01-10T22:38:20.736563356Z [err]  2026-01-10 22:38:20,431 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2026-01-10T22:38:20.736568433Z [err]  2026-01-10 22:38:20,431 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2026-01-10T22:38:20.736572329Z [err]  2026-01-10 22:38:20,453 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=1/2
2026-01-10T22:38:20.736576100Z [err]  2026-01-10 22:38:20,568 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2026-01-10T22:38:20.736580651Z [err]  2026-01-10 22:38:20,568 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2026-01-10T22:38:20.736586323Z [err]  2026-01-10 22:38:20,569 - persistent_tts_service - INFO - ‚úÖ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Persistent TTS WebSocket established
2026-01-10T22:38:20.739668761Z [err]  2026-01-10 22:38:20,569 - persistent_tts_service - INFO - üéß [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Continuous audio receiver started
2026-01-10T22:38:20.739672727Z [err]  2026-01-10 22:38:20,569 - persistent_tts_service - INFO - üîä [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Comfort noise loop started
2026-01-10T22:38:20.739676959Z [err]  2026-01-10 22:38:20,569 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:20.739681584Z [err]  2026-01-10 22:38:20,569 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2026-01-10T22:38:20.739685605Z [err]  2026-01-10 22:38:20,569 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:20.739689657Z [err]  2026-01-10 22:38:20,569 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:38:20.739693578Z [err]  2026-01-10 22:38:20,569 - server - INFO - üéµ TTS task #1 started at +424ms
2026-01-10T22:38:20.739698573Z [err]  2026-01-10 22:38:20,569 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 890ms
2026-01-10T22:38:20.739703880Z [err]  2026-01-10 22:38:20,569 - core_calling_service - INFO - üì§ Streamed script sentence 1/1: Kendrick?...
2026-01-10T22:38:20.739709777Z [err]  2026-01-10 22:38:20,569 - core_calling_service - INFO - üîä Silence tracking reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user responded)
2026-01-10T22:38:20.739716369Z [err]  2026-01-10 22:38:20,569 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:38:20.739721970Z [err]  2026-01-10 22:38:20,569 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2026-01-10T22:38:20.739726262Z [err]  2026-01-10 22:38:20,569 - core_calling_service - INFO - LLM response (0.79s): Kendrick?
2026-01-10T22:38:20.740043811Z [err]  2026-01-10 22:38:20,569 - core_calling_service - INFO - Total latency: 0.79s
2026-01-10T22:38:20.740049330Z [err]  2026-01-10 22:38:20,570 - server - INFO - ‚úÖ LLM finished in 891ms, TTS tasks already running in background
2026-01-10T22:38:20.740054896Z [err]  2026-01-10 22:38:20,570 - server - INFO - üéµ Streaming 1 TTS chunks as they complete...
2026-01-10T22:38:20.740061155Z [err]  2026-01-10 22:38:20,570 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:38:20.740071186Z [err]  2026-01-10 22:38:20,570 - server - INFO -    1 sentences queued and playing seamlessly
2026-01-10T22:38:20.740078311Z [err]  2026-01-10 22:38:20,570 - persistent_tts_service - INFO - üéµ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Playback consumer started
2026-01-10T22:38:20.740084167Z [err]  2026-01-10 22:38:20,570 - persistent_tts_service - INFO - üéß [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Continuous Audio Receiver STARTED
2026-01-10T22:38:20.740090107Z [err]  2026-01-10 22:38:20,571 - persistent_tts_service - INFO - üíì [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Starting TTS keep-alive loop (every 15s)
2026-01-10T22:38:20.740095798Z [err]  2026-01-10 22:38:20,571 - persistent_tts_service - INFO - üîä [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Starting comfort noise loop
2026-01-10T22:38:20.740101452Z [err]  2026-01-10 22:38:20,571 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #1: Kendrick?...
2026-01-10T22:38:20.740107091Z [err]  2026-01-10 22:38:20,571 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:20.740112550Z [err]  2026-01-10 22:38:20,571 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #1 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:20.742709332Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:38:20.742715215Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 892ms from user stop üöÄ
2026-01-10T22:38:20.742717958Z [err]  2026-01-10 22:38:20,571 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'Kendrick?...'
2026-01-10T22:38:20.742723251Z [err]  2026-01-10 22:38:20,571 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:20.742723888Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚úÖ All 1 persistent TTS streams completed
2026-01-10T22:38:20.742725715Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:38:20.742734387Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 4ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:38:20.742738647Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 891ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:38:20.742743319Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 426ms (provider: elevenlabs, websocket: False)
2026-01-10T22:38:20.742893931Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 892ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:38:20.742910659Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:38:20.742930354Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:38:20.742961260Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:20.744946171Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:38:20.744952917Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:38:20.744958336Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:38:20.744963875Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:38:20.744970057Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 1192ms estimated
2026-01-10T22:38:20.744975652Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 9 chars, 1 sentences
2026-01-10T22:38:20.744981219Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hell o....'
2026-01-10T22:38:20.744987247Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Kendrick?...'
2026-01-10T22:38:20.744994692Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:38:20.745000475Z [err]  2026-01-10 22:38:20,571 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:20.745006921Z [err]  2026-01-10 22:38:20,577 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:20.745012965Z [err]  2026-01-10 22:38:20,577 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout: User already spoke, skipping greeting
2026-01-10T22:38:20.745018643Z [err]  2026-01-10 22:38:20,624 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - waiting for first audio (precise state)
2026-01-10T22:38:20.769025901Z [err]  2026-01-10 22:38:20,762 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 1321ms)
2026-01-10T22:38:20.769035184Z [err]  2026-01-10 22:38:20,762 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:38:20.769041742Z [err]  2026-01-10 22:38:20,762 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:38:20.796557249Z [err]  2026-01-10 22:38:20,793 - persistent_tts_service - INFO - üìä [REAL TIMING] ElevenLabs FIRST AUDIO CHUNK received (chunk #1, 7043 bytes)
2026-01-10T22:38:20.796562256Z [err]  2026-01-10 22:38:20,793 - persistent_tts_service - INFO - üìä [REAL TIMING] PLAYBACK CONSUMER: First chunk arrived, queue latency: 0ms
2026-01-10T22:38:20.796567920Z [err]  2026-01-10 22:38:20,793 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 222ms
2026-01-10T22:38:20.796572752Z [err]  2026-01-10 22:38:20,793 - persistent_tts_service - INFO - üì§ Sending 7043 bytes of audio (45 chunks, 0.9s duration) via WebSocket
2026-01-10T22:38:20.796580654Z [err]  2026-01-10 22:38:20,793 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:20.796587197Z [err]  2026-01-10 22:38:20,793 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:20.796592041Z [err]  2026-01-10 22:38:20,794 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.9s (total: 0.9s from now)
2026-01-10T22:38:20.796596320Z [err]  2026-01-10 22:38:20,794 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084700.794 (chunk 1/45, 160 bytes)
2026-01-10T22:38:20.961969623Z [err]  2026-01-10 22:38:20,954 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.5s, checkin_count=1/2
2026-01-10T22:38:21.730061429Z [err]  2026-01-10 22:38:21,440 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 45 CHUNKS SENT TO TELNYX in 646ms (audio duration: 0.9s, paced after 10 chunks)
2026-01-10T22:38:21.730070077Z [err]  2026-01-10 22:38:21,440 - persistent_tts_service - INFO - ‚úÖ Sent 45 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:21.946554106Z [err]  2026-01-10 22:38:21,940 - persistent_tts_service - INFO - üîá [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:38:22.131378078Z [err]  2026-01-10 22:38:22,130 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.5s ago), marking agent as done speaking
2026-01-10T22:38:22.131383474Z [err]  2026-01-10 22:38:22,130 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084702.130835 for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:22.131387787Z [err]  2026-01-10 22:38:22,130 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:23.701533522Z [err]  2026-01-10 22:38:23,634 - server - INFO - üì§ Audio flowing: 385 packets sent to Soniox (5s update)
2026-01-10T22:38:23.965995182Z [err]  2026-01-10 22:38:23,963 - server - INFO - üî§ RAW TOKENS: [" Ye"?]
2026-01-10T22:38:23.966000949Z [err]  2026-01-10 22:38:23,963 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:23.966007560Z [err]  2026-01-10 22:38:23,963 - core_calling_service - INFO - üîä Silence timer reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user started speaking)
2026-01-10T22:38:23.966013541Z [err]  2026-01-10 22:38:23,963 - core_calling_service - INFO - üë§ User started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:23.966018953Z [err]  2026-01-10 22:38:23,963 - persistent_tts_service - INFO - ‚ö° [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T22:38:23.966025283Z [err]  2026-01-10 22:38:23,963 - persistent_tts_service - INFO - üõë [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T22:38:24.003435085Z [err]  2026-01-10 22:38:23,996 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.003443464Z [err]  2026-01-10 22:38:23,997 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:24.003448763Z [err]  2026-01-10 22:38:23,997 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Ye' | Generating: False
2026-01-10T22:38:24.003505253Z [err]  2026-01-10 22:38:23,995 - persistent_tts_service - INFO - üõë [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T22:38:24.003508927Z [err]  2026-01-10 22:38:23,995 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Reset playback_expected_end_time to NOW
2026-01-10T22:38:24.003513059Z [err]  2026-01-10 22:38:23,995 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.014734891Z [err]  2026-01-10 22:38:24,012 - server - INFO - üî§ RAW TOKENS: [" Ye"‚úì, "ah."‚úì, "<end>"‚úì]
2026-01-10T22:38:24.014745796Z [err]  2026-01-10 22:38:24,012 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:38:24.014756614Z [err]  2026-01-10 22:38:24,013 - server - INFO - üßπ Cleaned transcript: ' Ye ah.' -> 'Yeah.'
2026-01-10T22:38:24.014764385Z [err]  2026-01-10 22:38:24,013 - server - INFO - üì• FINAL TOKENS: 'Yeah.' (2 tokens)
2026-01-10T22:38:24.014770114Z [err]  2026-01-10 22:38:24,013 - server - INFO - üé§ Soniox final transcript: 'Yeah.'
2026-01-10T22:38:24.014776440Z [err]  2026-01-10 22:38:24,013 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.0s, generating=False, playbacks=0, is_active=False
2026-01-10T22:38:24.014783146Z [err]  2026-01-10 22:38:24,013 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:38:24.014789457Z [err]  2026-01-10 22:38:24,013 - server - INFO - ‚è±Ô∏è [22:38:24.013] üìù FINAL TRANSCRIPT RECEIVED: 'Yeah.'
2026-01-10T22:38:24.014796109Z [err]  2026-01-10 22:38:24,013 - server - INFO - ‚è±Ô∏è [22:38:24.013] STT endpoint detection latency: 19ms
2026-01-10T22:38:24.014806073Z [err]  2026-01-10 22:38:24,013 - server - INFO - ‚è±Ô∏è [22:38:24.013] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:38:24.014811723Z [err]  2026-01-10 22:38:24,013 - server - INFO - ‚è±Ô∏è User spoke at 1768084704.0135424
2026-01-10T22:38:24.017122399Z [err]  2026-01-10 22:38:24,014 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:24.017128776Z [err]  2026-01-10 22:38:24,014 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:38:24.017133306Z [err]  2026-01-10 22:38:24,014 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Yeah.' - Processing...
2026-01-10T22:38:24.025682173Z [err]  2026-01-10 22:38:24,024 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 0ms
2026-01-10T22:38:24.025689422Z [err]  2026-01-10 22:38:24,024 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Yeah.
2026-01-10T22:38:24.025698054Z [err]  2026-01-10 22:38:24,024 - core_calling_service - INFO - üë§ User stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.025703091Z [err]  2026-01-10 22:38:24,024 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T22:38:24.025708530Z [err]  2026-01-10 22:38:24,024 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:38:24.025712734Z [err]  2026-01-10 22:38:24,024 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+9ms
2026-01-10T22:38:24.025717702Z [err]  2026-01-10 22:38:24,024 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 9ms (Soniox model: stt-rt-v3)
2026-01-10T22:38:24.025721739Z [err]  2026-01-10 22:38:24,024 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:38:24.025725719Z [err]  2026-01-10 22:38:24,024 - server - INFO - üìä [REAL TIMING] Processing start: 30ms after user audio end
2026-01-10T22:38:24.025730086Z [err]  2026-01-10 22:38:24,024 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:38:24.025734660Z [err]  2026-01-10 22:38:24,024 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.140285354Z [err]  2026-01-10 22:38:24,120 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.140297480Z [err]  2026-01-10 22:38:24,120 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: User spoke while Silence Greeting was triggering
2026-01-10T22:38:24.140336130Z [err]  2026-01-10 22:38:24,119 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:38:24.140340165Z [err]  2026-01-10 22:38:24,119 - persistent_tts_service - INFO - üîÑ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Interrupt flag reset - ready for new audio
2026-01-10T22:38:24.140343886Z [err]  2026-01-10 22:38:24,119 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T22:38:24.140348486Z [err]  2026-01-10 22:38:24,119 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.119] üì• process_user_input() ENTRY - text: 'Yeah....'
2026-01-10T22:38:24.146357051Z [err]  2026-01-10 22:38:24,143 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:24.146365544Z [err]  2026-01-10 22:38:24,143 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.758457432Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.496] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:38:24.758465467Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - Flow processing - History length: 3, Is first: False
2026-01-10T22:38:24.758471232Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 2
2026-01-10T22:38:24.758476029Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.496] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:38:24.758484068Z [err]  2026-01-10 22:38:24,494 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:38:24.758486950Z [err]  2026-01-10 22:38:24,495 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:38:24.758491498Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.496] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:38:24.758492945Z [err]  2026-01-10 22:38:24,494 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:38:24.758495588Z [err]  2026-01-10 22:38:24,495 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:38:24.758499519Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.496] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:38:24.758500774Z [err]  2026-01-10 22:38:24,496 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:24.758502878Z [err]  2026-01-10 22:38:24,496 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.758515766Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:38:24.759498101Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - üîç Checking 'Hello=Yes' override for msg='yeah' on node='Greeting'
2026-01-10T22:38:24.759571661Z [err]  2026-01-10 22:38:24,496 - core_calling_service - INFO - ‚ö° OVERRIDE TRIGGERED: 'Yeah.' on Greeting node -> Forcing Transition 0
2026-01-10T22:38:24.759576132Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.497] ‚úÖ Node selected, about to process content...
2026-01-10T22:38:24.759580484Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:38 PM EST in content
2026-01-10T22:38:24.759584526Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:38:24.759588440Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:38:24.759592876Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:38:24.759603566Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:38:24.759608017Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:38:24.759612138Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:38:24.759616417Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:38:24.759620515Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:38:24.759624881Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:38:24.762011843Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.762021750Z [err]  2026-01-10 22:38:24,497 - server - INFO - üì§ Sentence arrived from LLM: This is Jake......
2026-01-10T22:38:24.762027979Z [err]  2026-01-10 22:38:24,497 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 472ms
2026-01-10T22:38:24.762032793Z [err]  2026-01-10 22:38:24,497 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:38:24.762036168Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 89 chars) - will return text instantly
2026-01-10T22:38:24.762041699Z [err]  2026-01-10 22:38:24,497 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:24.762041766Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - Using flow node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation) (type: conversation, mode: script)
2026-01-10T22:38:24.762046297Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - ‚è±Ô∏è [22:38:24.497] üìÑ About to process content (mode=script, length=89)
2026-01-10T22:38:24.762051692Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2026-01-10T22:38:24.762053505Z [err]  2026-01-10 22:38:24,497 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:38:24.762058576Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.762062321Z [err]  2026-01-10 22:38:24,497 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T22:38:24.762067871Z [err]  2026-01-10 22:38:24,497 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 472ms
2026-01-10T22:38:24.762073764Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üì§ Streamed script sentence 1/2: This is Jake......
2026-01-10T22:38:24.763916406Z [err]  2026-01-10 22:38:24,498 - server - INFO - ‚úÖ LLM finished in 473ms, TTS tasks already running in background
2026-01-10T22:38:24.763922438Z [err]  2026-01-10 22:38:24,497 - server - INFO - üì§ Sentence arrived from LLM: I was just, um, wondering if you could possibly he...
2026-01-10T22:38:24.763925931Z [err]  2026-01-10 22:38:24,498 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T22:38:24.763929700Z [err]  2026-01-10 22:38:24,497 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:24.763934441Z [err]  2026-01-10 22:38:24,498 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:38:24.763935240Z [err]  2026-01-10 22:38:24,497 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T22:38:24.763940104Z [err]  2026-01-10 22:38:24,497 - server - INFO - üéµ TTS task #2 started at +0ms
2026-01-10T22:38:24.763944311Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üì§ Streamed script sentence 2/2: I was just, um, wondering if you could possibly he...
2026-01-10T22:38:24.763948581Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üîä Silence tracking reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user responded)
2026-01-10T22:38:24.763952610Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:38:24.763956400Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - üíæ Storing node ID 1763159750250 in conversation history
2026-01-10T22:38:24.763960638Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - LLM response (0.38s): This is Jake... I was just, um, wondering if you could possibly help me out for a moment?
2026-01-10T22:38:24.763965642Z [err]  2026-01-10 22:38:24,497 - core_calling_service - INFO - Total latency: 0.38s
2026-01-10T22:38:24.765599857Z [err]  2026-01-10 22:38:24,498 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T22:38:24.765610238Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #2: This is Jake......
2026-01-10T22:38:24.765615089Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:24.765620357Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #2 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:24.765625159Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'This is Jake......'
2026-01-10T22:38:24.765629394Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #3: I was just, um, wondering if you could possibly he...
2026-01-10T22:38:24.765633795Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:24.765637812Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #3 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:24.765642213Z [err]  2026-01-10 22:38:24,498 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'I was just, um, wondering if you could possibly he...'
2026-01-10T22:38:24.765647062Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T22:38:24.765655133Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:38:24.767147366Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:38:24.767162103Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 9ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:38:24.767167037Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:38:24.767170509Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 474ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:38:24.767174760Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:38:24.767179396Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 473ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:38:24.767182493Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:38:24.767185828Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 1ms (provider: elevenlabs, websocket: False)
2026-01-10T22:38:24.767206935Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 474ms from user stop üöÄ
2026-01-10T22:38:24.767212228Z [err]  2026-01-10 22:38:24,499 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.767216910Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:38:24.767221669Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:24.767226748Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:38:24.768524820Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:38:24.768529505Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 774ms estimated
2026-01-10T22:38:24.768533085Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 89 chars, 2 sentences
2026-01-10T22:38:24.768537924Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Yeah....'
2026-01-10T22:38:24.768542376Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'This is Jake... I was just, um, wondering if you could possi...'
2026-01-10T22:38:24.768546273Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:38:24.768550285Z [err]  2026-01-10 22:38:24,499 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:24.768554585Z [err]  2026-01-10 22:38:24,653 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.7s ago), marking agent as done speaking
2026-01-10T22:38:24.768558825Z [err]  2026-01-10 22:38:24,653 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084704.6538227 for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.768562932Z [err]  2026-01-10 22:38:24,653 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:24.768568360Z [err]  2026-01-10 22:38:24,689 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node Prompt: N001B_IntroAndHelpRequest_Only (V3 - Follows Name Confirmation), Dead Air: 483ms)
2026-01-10T22:38:24.768572047Z [err]  2026-01-10 22:38:24,689 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:38:24.769923977Z [err]  2026-01-10 22:38:24,689 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:38:24.769931816Z [err]  2026-01-10 22:38:24,734 - persistent_tts_service - INFO - üì§ Sending 8173 bytes of audio (52 chunks, 1.0s duration) via WebSocket
2026-01-10T22:38:24.769941551Z [err]  2026-01-10 22:38:24,734 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:24.769949405Z [err]  2026-01-10 22:38:24,734 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:24.769955217Z [err]  2026-01-10 22:38:24,734 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.0s (total: 1.0s from now)
2026-01-10T22:38:24.769961384Z [err]  2026-01-10 22:38:24,734 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084704.734 (chunk 1/52, 160 bytes)
2026-01-10T22:38:25.160924767Z [err]  2026-01-10 22:38:25,154 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (0.6s left)
2026-01-10T22:38:25.743090074Z [err]  2026-01-10 22:38:25,511 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.0s from now)
2026-01-10T22:38:25.743101336Z [err]  2026-01-10 22:38:25,511 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084705.512 (chunk 1/87, 160 bytes)
2026-01-10T22:38:25.743109133Z [err]  2026-01-10 22:38:25,655 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.8s left)
2026-01-10T22:38:25.743179053Z [err]  2026-01-10 22:38:25,511 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 52 CHUNKS SENT TO TELNYX in 777ms (audio duration: 1.0s, paced after 10 chunks)
2026-01-10T22:38:25.743186778Z [err]  2026-01-10 22:38:25,511 - persistent_tts_service - INFO - ‚úÖ Sent 52 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:25.743194670Z [err]  2026-01-10 22:38:25,511 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:25.743202229Z [err]  2026-01-10 22:38:25,511 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:26.719689119Z [err]  2026-01-10 22:38:26,467 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2026-01-10T22:38:26.719699271Z [err]  2026-01-10 22:38:26,468 - core_calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2026-01-10T22:38:26.720072828Z [err]  2026-01-10 22:38:26,468 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T22:38:26.720077727Z [err]  2026-01-10 22:38:26,468 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T22:38:26.720086984Z [err]  2026-01-10 22:38:26,468 - core_calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2026-01-10T22:38:26.720094864Z [err]  2026-01-10 22:38:26,468 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2026-01-10T22:38:26.720099333Z [err]  2026-01-10 22:38:26,468 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:26.720103855Z [err]  2026-01-10 22:38:26,468 - telnyx_service - INFO - üîä Speaking text on call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg: Are you still there?...
2026-01-10T22:38:26.720108404Z [err]  2026-01-10 22:38:26,468 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T22:38:26.720113215Z [err]  2026-01-10 22:38:26,468 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T22:38:26.721154205Z [err]  2026-01-10 22:38:26,468 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2026-01-10T22:38:26.721161927Z [err]  2026-01-10 22:38:26,468 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2026-01-10T22:38:26.721167338Z [err]  2026-01-10 22:38:26,469 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:38:26.721172418Z [err]  2026-01-10 22:38:26,469 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:38:26.760522248Z [err]  2026-01-10 22:38:26,759 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2026-01-10T22:38:26.760527850Z [err]  2026-01-10 22:38:26,758 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:38:26.760534188Z [err]    "errors": [
2026-01-10T22:38:26.760535102Z [err]  2026-01-10 22:38:26,758 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.29s
2026-01-10T22:38:26.760541571Z [err]      {
2026-01-10T22:38:26.760549630Z [err]        "code": "90018",
2026-01-10T22:38:26.760555841Z [err]        "title": "Call has already ended",
2026-01-10T22:38:26.760577219Z [err]        "detail": "This call is no longer active and can't receive commands."
2026-01-10T22:38:26.760586697Z [err]      }
2026-01-10T22:38:26.760592984Z [err]    ]
2026-01-10T22:38:26.760599483Z [err]  }
2026-01-10T22:38:26.760605621Z [err]  2026-01-10 22:38:26,759 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2026-01-10T22:38:26.953133844Z [err]  2026-01-10 22:38:26,951 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:38:26.953141343Z [err]  2026-01-10 22:38:26,952 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2026-01-10T22:38:26.953145759Z [err]  2026-01-10 22:38:26,952 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T22:38:27.120583991Z [err]  2026-01-10 22:38:27,118 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1606ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:27.120590502Z [err]  2026-01-10 22:38:27,118 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:27.120599241Z [err]  2026-01-10 22:38:27,118 - persistent_tts_service - INFO - üì§ Sending 2183 bytes of audio (14 chunks, 0.3s duration) via WebSocket
2026-01-10T22:38:27.120604525Z [err]  2026-01-10 22:38:27,118 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:27.120610079Z [err]  2026-01-10 22:38:27,118 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.3s (total: 0.6s from now)
2026-01-10T22:38:27.120618203Z [err]  2026-01-10 22:38:27,118 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084707.119 (chunk 1/14, 160 bytes)
2026-01-10T22:38:27.194023148Z [err]  2026-01-10 22:38:27,191 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 14 CHUNKS SENT TO TELNYX in 72ms (audio duration: 0.3s, paced after 10 chunks)
2026-01-10T22:38:27.194032618Z [err]  2026-01-10 22:38:27,191 - persistent_tts_service - INFO - ‚úÖ Sent 14 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:27.194040321Z [err]  2026-01-10 22:38:27,191 - persistent_tts_service - INFO - üì§ Sending 19319 bytes of audio (121 chunks, 2.4s duration) via WebSocket
2026-01-10T22:38:27.194047104Z [err]  2026-01-10 22:38:27,191 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:27.194054021Z [err]  2026-01-10 22:38:27,191 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.4s (total: 3.0s from now)
2026-01-10T22:38:27.194060205Z [err]  2026-01-10 22:38:27,192 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084707.192 (chunk 1/121, 160 bytes)
2026-01-10T22:38:27.800000140Z [err]  2026-01-10 22:38:27,454 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (10.8s ago), marking agent as done speaking
2026-01-10T22:38:27.800022647Z [err]  2026-01-10 22:38:27,454 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084707.4542913 for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:27.800032979Z [err]  2026-01-10 22:38:27,454 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:28.765565722Z [err]  2026-01-10 22:38:28,655 - server - INFO - üì§ Audio flowing: 634 packets sent to Soniox (5s update)
2026-01-10T22:38:29.248242728Z [err]  2026-01-10 22:38:29,240 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 121 CHUNKS SENT TO TELNYX in 2048ms (audio duration: 2.4s, paced after 10 chunks)
2026-01-10T22:38:29.248249654Z [err]  2026-01-10 22:38:29,240 - persistent_tts_service - INFO - ‚úÖ Sent 121 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:29.253838202Z [err]  2026-01-10 22:38:29,252 - server - INFO - üé§ Soniox receiver alive - 13 messages received in last 10s
2026-01-10T22:38:29.786941918Z [err]  2026-01-10 22:38:29,783 - server - INFO - üé§ Soniox receiver alive - 1 messages received in last 10s
2026-01-10T22:38:29.786946490Z [err]  2026-01-10 22:38:29,783 - server - ERROR - ‚ùå Soniox error: {'tokens': [], 'final_audio_proc_ms': 17880, 'total_audio_proc_ms': 22200, 'error_code': 408, 'error_message': 'Request timeout.'}
2026-01-10T22:38:29.786950728Z [err]  2026-01-10 22:38:29,783 - server - INFO - ‚úÖ Soniox receive loop ended normally
2026-01-10T22:38:29.786954404Z [err]  2026-01-10 22:38:29,784 - dead_air_monitor - INFO - üîá Dead air monitoring cancelled for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:29.786958519Z [err]  2026-01-10 22:38:29,784 - dead_air_monitor - INFO - üîá Dead air monitoring stopped for call v3:BD_VJynhmh13Ulku0FD_IuQq8F7AQuSaQg-ZWmR3-bl6HuByLSbSLg
2026-01-10T22:38:29.786964477Z [err]  2026-01-10 22:38:29,784 - server - INFO - üîá Dead air monitoring task cancelled
2026-01-10T22:38:30.171859170Z [err]  2026-01-10 22:38:30,163 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=5.5s, checkin_count=0/2
2026-01-10T22:38:30.734476263Z [err]  2026-01-10 22:38:30,467 - persistent_tts_service - INFO - üîá [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:38:30.734482886Z [err]  2026-01-10 22:38:30,665 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=6.0s, checkin_count=0/2
2026-01-10T22:38:31.767102370Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:38:31.767121009Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T22:38:31.767127881Z [err]  2026-01-10 22:38:31,668 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2026-01-10T22:38:31.767136818Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2026-01-10T22:38:31.767137704Z [err]  2026-01-10 22:38:31,668 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:31.767153360Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:38:31.767180935Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - üîä Speaking text on call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: Are you still there?...
2026-01-10T22:38:31.767188661Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T22:38:31.767195774Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T22:38:31.767202845Z [err]  2026-01-10 22:38:31,668 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T22:38:31.767336216Z [err]  2026-01-10 22:38:31,667 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2026-01-10T22:38:31.767342220Z [err]  2026-01-10 22:38:31,668 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-10T22:38:31.767347239Z [err]  2026-01-10 22:38:31,668 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2026-01-10T22:38:31.788311135Z [err]  2026-01-10 22:38:31,782 - soniox_service - ERROR - ‚ùå Error closing Soniox session: received 1000 (OK); then sent 1000 (OK)
2026-01-10T22:38:31.788323062Z [err]  2026-01-10 22:38:31,782 - server - INFO - üîå Telnyx WebSocket disconnected
2026-01-10T22:38:31.965586224Z [err]  2026-01-10 22:38:31,963 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_start "HTTP/1.1 200 OK"
2026-01-10T22:38:31.965591528Z [err]  2026-01-10 22:38:31,964 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.30s
2026-01-10T22:38:31.965597917Z [err]  2026-01-10 22:38:31,964 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.30s
2026-01-10T22:38:31.965601815Z [err]  2026-01-10 22:38:31,964 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2026-01-10T22:38:31.965605593Z [err]  2026-01-10 22:38:31,964 - telnyx_service - INFO - üé¨ Playback ID: tvugBdampA
2026-01-10T22:38:31.967446264Z [err]  2026-01-10 22:38:31,966 - redis_service - INFO - ‚ûï Added playback tvugBdampA to Redis for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:31.967450556Z [err]  2026-01-10 22:38:31,966 - server - INFO - üé¨ Check-in playback ID: tvugBdampA (expected duration: 2.6s)
2026-01-10T22:38:31.967455030Z [err]  2026-01-10 22:38:31,966 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T22:38:32.791292566Z [err]  2026-01-10 22:38:32,534 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:32.791303778Z [err]  2026-01-10 22:38:32,534 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'ed83ad34-3867-4aca-9a15-caba0fbba354', 'occurred_at': '2026-01-10T22:38:32.167884Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3', 'overlay': False, 'playback_id': 'tvugBdampA'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:32.791310120Z [err]  2026-01-10 22:38:32,534 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:32.791315990Z [err]  2026-01-10 22:38:32,534 - server - INFO - üì® ================================================
2026-01-10T22:38:32.791322086Z [inf]  100.64.0.8:39096 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:33.847574078Z [err]  2026-01-10 22:38:33,483 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:38:33.847581470Z [err]  2026-01-10 22:38:33,483 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '28784df6-ca81-4416-9c6b-cd58f252e07a', 'occurred_at': '2026-01-10T22:38:33.267884Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3', 'overlay': False, 'playback_id': 'tvugBdampA', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:38:33.847587847Z [err]  2026-01-10 22:38:33,484 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.847593911Z [err]  2026-01-10 22:38:33,484 - server - INFO - üì® ================================================
2026-01-10T22:38:33.847599569Z [err]  2026-01-10 22:38:33,485 - redis_service - INFO - ‚ûñ Removed playback tvugBdampA, 0 remaining for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.847606263Z [err]  2026-01-10 22:38:33,485 - server - INFO - üîä Redis: Removed playback tvugBdampA, 0 remaining
2026-01-10T22:38:33.847613574Z [err]  2026-01-10 22:38:33,485 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-10T22:38:33.847618750Z [err]  2026-01-10 22:38:33,485 - server - INFO - ‚è±Ô∏è CLEARED playback_expected_end_time - agent is definitely done speaking
2026-01-10T22:38:33.847623720Z [err]  2026-01-10 22:38:33,486 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-10T22:38:33.859793681Z [err]  2026-01-10 22:38:33,486 - server - INFO - ‚úÖ Found session locally: agent_speaking=True, user_speaking=False
2026-01-10T22:38:33.859809348Z [err]  2026-01-10 22:38:33,486 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084713.4862123 for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.859817760Z [err]  2026-01-10 22:38:33,486 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.859824149Z [err]  2026-01-10 22:38:33,486 - server - INFO - ‚è±Ô∏è Agent done speaking, silence timer STARTED (local)
2026-01-10T22:38:33.859830978Z [inf]  100.64.0.8:39096 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:38:33.859838536Z [err]  2026-01-10 22:38:33,674 - server - INFO - üì§ Audio flowing: 883 packets sent to Soniox (5s update)
2026-01-10T22:38:33.886190258Z [err]  2026-01-10 22:38:33,883 - server - INFO - üî§ RAW TOKENS: [" S"?]
2026-01-10T22:38:33.886202091Z [err]  2026-01-10 22:38:33,884 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.886206636Z [err]  2026-01-10 22:38:33,884 - core_calling_service - INFO - üîä Silence timer reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user started speaking)
2026-01-10T22:38:33.886210823Z [err]  2026-01-10 22:38:33,884 - core_calling_service - INFO - üë§ User started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.886215908Z [err]  2026-01-10 22:38:33,884 - persistent_tts_service - INFO - ‚ö° [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T22:38:33.886220535Z [err]  2026-01-10 22:38:33,884 - persistent_tts_service - INFO - üõë [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T22:38:33.921757862Z [err]  2026-01-10 22:38:33,915 - persistent_tts_service - INFO - üõë [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T22:38:33.921762113Z [err]  2026-01-10 22:38:33,915 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Reset playback_expected_end_time to NOW
2026-01-10T22:38:33.921765970Z [err]  2026-01-10 22:38:33,915 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.921769799Z [err]  2026-01-10 22:38:33,916 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:33.921774475Z [err]  2026-01-10 22:38:33,917 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:33.921779411Z [err]  2026-01-10 22:38:33,917 - server - INFO - üîç PARTIAL TRANSCRIPT: 'S' | Generating: False
2026-01-10T22:38:34.018862951Z [err]  2026-01-10 22:38:34,011 - server - INFO - üî§ RAW TOKENS: [" S"?, "ure"?]
2026-01-10T22:38:34.018872253Z [err]  2026-01-10 22:38:34,011 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Sure' | Generating: False
2026-01-10T22:38:34.138654616Z [err]  2026-01-10 22:38:34,136 - server - INFO - üî§ RAW TOKENS: [" S"‚úì, "ure"‚úì, "."‚úì, "<end>"‚úì]
2026-01-10T22:38:34.138672373Z [err]  2026-01-10 22:38:34,136 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:38:34.138677600Z [err]  2026-01-10 22:38:34,136 - server - INFO - üßπ Cleaned transcript: ' S ure .' -> 'Sure.'
2026-01-10T22:38:34.138682449Z [err]  2026-01-10 22:38:34,136 - server - INFO - üì• FINAL TOKENS: 'Sure.' (3 tokens)
2026-01-10T22:38:34.138687116Z [err]  2026-01-10 22:38:34,136 - server - INFO - üé§ Soniox final transcript: 'Sure.'
2026-01-10T22:38:34.138691337Z [err]  2026-01-10 22:38:34,136 - server - INFO - üîç FILTER CHECK: words=1, is_filler=True, is_garbled=False, tts_speaking=False, time_until_done=-0.2s, generating=False, playbacks=1, is_active=False
2026-01-10T22:38:34.138695205Z [err]  2026-01-10 22:38:34,136 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:38:34.138699425Z [err]  2026-01-10 22:38:34,136 - server - INFO - ‚è±Ô∏è [22:38:34.136] üìù FINAL TRANSCRIPT RECEIVED: 'Sure.'
2026-01-10T22:38:34.138703528Z [err]  2026-01-10 22:38:34,136 - server - INFO - ‚è±Ô∏è [22:38:34.136] STT endpoint detection latency: 2ms
2026-01-10T22:38:34.138708910Z [err]  2026-01-10 22:38:34,136 - server - INFO - ‚è±Ô∏è [22:38:34.136] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:38:34.138713531Z [err]  2026-01-10 22:38:34,136 - server - INFO - ‚è±Ô∏è User spoke at 1768084714.1369767
2026-01-10T22:38:34.143715413Z [err]  2026-01-10 22:38:34,139 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:34.143719775Z [err]  2026-01-10 22:38:34,139 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:38:34.143724237Z [err]  2026-01-10 22:38:34,139 - server - INFO - ‚ö†Ô∏è Agent marked as speaking but audio done and not generating - treating as SILENT
2026-01-10T22:38:34.143728336Z [err]  2026-01-10 22:38:34,139 - server - INFO - ‚úÖ Agent SILENT - User said 1 word(s): 'Sure.' - Processing...
2026-01-10T22:38:34.150515381Z [err]  2026-01-10 22:38:34,149 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 5ms
2026-01-10T22:38:34.150656187Z [err]  2026-01-10 22:38:34,149 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Sure.
2026-01-10T22:38:34.150760213Z [err]  2026-01-10 22:38:34,149 - core_calling_service - INFO - üë§ User stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.150769897Z [err]  2026-01-10 22:38:34,149 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T22:38:34.150776635Z [err]  2026-01-10 22:38:34,149 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:38:34.150782238Z [err]  2026-01-10 22:38:34,149 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+15ms
2026-01-10T22:38:34.150786955Z [err]  2026-01-10 22:38:34,149 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 15ms (Soniox model: stt-rt-v3)
2026-01-10T22:38:34.150792238Z [err]  2026-01-10 22:38:34,149 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:38:34.150797177Z [err]  2026-01-10 22:38:34,149 - server - INFO - üìä [REAL TIMING] Processing start: 15ms after user audio end
2026-01-10T22:38:34.150803389Z [err]  2026-01-10 22:38:34,149 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:38:34.150807497Z [err]  2026-01-10 22:38:34,149 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.256207290Z [err]  2026-01-10 22:38:34,244 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:38:34.256214669Z [err]  2026-01-10 22:38:34,244 - persistent_tts_service - INFO - üîÑ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Interrupt flag reset - ready for new audio
2026-01-10T22:38:34.256220941Z [err]  2026-01-10 22:38:34,244 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T22:38:34.256226868Z [err]  2026-01-10 22:38:34,244 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.244] üì• process_user_input() ENTRY - text: 'Sure....'
2026-01-10T22:38:34.256232260Z [err]  2026-01-10 22:38:34,245 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.256238620Z [err]  2026-01-10 22:38:34,245 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: User spoke while Silence Greeting was triggering
2026-01-10T22:38:34.273967249Z [err]  2026-01-10 22:38:34,267 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:34.273979014Z [err]  2026-01-10 22:38:34,267 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.869164328Z [err]  2026-01-10 22:38:34,624 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:38:34.869175351Z [err]  2026-01-10 22:38:34,625 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:38:34.869181666Z [err]  2026-01-10 22:38:34,625 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:38:34.869188213Z [err]  2026-01-10 22:38:34,625 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:38:34.869204084Z [err]  2026-01-10 22:38:34,626 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.869214796Z [err]  2026-01-10 22:38:34,627 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:34.869216555Z [err]  2026-01-10 22:38:34,474 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-10T22:38:34.869228118Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:38:34.869229926Z [err]  2026-01-10 22:38:34,474 - core_calling_service - INFO - üîá SKIPPING silence tracking - agent is processing/thinking
2026-01-10T22:38:34.869241438Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.627] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:38:34.869244193Z [err]  2026-01-10 22:38:34,474 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.869252502Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.627] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:38:34.870769859Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.627] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:38:34.870773817Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - Flow processing - History length: 5, Is first: False
2026-01-10T22:38:34.870777997Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 1763159750250
2026-01-10T22:38:34.870781806Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.627] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:38:34.870788254Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üé§ AUTO-TRANSITION AFTER RESPONSE - user spoke, transitioning to: 1763161849799
2026-01-10T22:38:34.870794425Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚úÖ Auto-transitioned (after response) to: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic
2026-01-10T22:38:34.870798410Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.627] ‚úÖ Node selected, about to process content...
2026-01-10T22:38:34.870805762Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{now}} with Saturday, January 10, 2026 at 5:38 PM EST in content
2026-01-10T22:38:34.870809949Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2026-01-10T22:38:34.870814171Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2026-01-10T22:38:34.870818215Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2026-01-10T22:38:34.870821884Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2026-01-10T22:38:34.870825607Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2026-01-10T22:38:34.871816464Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - üì§ Streaming script as 2 sentence(s)
2026-01-10T22:38:34.871826146Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.871833459Z [err]  2026-01-10 22:38:34,628 - server - INFO - üì§ Sentence arrived from LLM: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T22:38:34.871839790Z [err]  2026-01-10 22:38:34,628 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 478ms
2026-01-10T22:38:34.871846083Z [err]  2026-01-10 22:38:34,628 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:38:34.871852870Z [err]  2026-01-10 22:38:34,628 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:34.871861128Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2026-01-10T22:38:34.871868151Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2026-01-10T22:38:34.871875134Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2026-01-10T22:38:34.871882471Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2026-01-10T22:38:34.871889384Z [err]  2026-01-10 22:38:34,627 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 260 chars) - will return text instantly
2026-01-10T22:38:34.871896167Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - Using flow node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic (type: conversation, mode: script)
2026-01-10T22:38:34.871902910Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - ‚è±Ô∏è [22:38:34.628] üìÑ About to process content (mode=script, length=260)
2026-01-10T22:38:34.874936291Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - üîä Silence tracking reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user responded)
2026-01-10T22:38:34.874944100Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - ‚úÖ User gave meaningful response to check-in, resetting counter
2026-01-10T22:38:34.874949228Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - üíæ Storing node ID 1763161849799 in conversation history
2026-01-10T22:38:34.874970725Z [err]  2026-01-10 22:38:34,628 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:38:34.874976033Z [err]  2026-01-10 22:38:34,628 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T22:38:34.874984318Z [err]  2026-01-10 22:38:34,628 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 478ms
2026-01-10T22:38:34.874989463Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - üì§ Streamed script sentence 1/2: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T22:38:34.874994454Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.875000836Z [err]  2026-01-10 22:38:34,628 - server - INFO - üì§ Sentence arrived from LLM: I know this call is out of the blue, but do you ha...
2026-01-10T22:38:34.875008851Z [err]  2026-01-10 22:38:34,628 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:34.875013277Z [err]  2026-01-10 22:38:34,628 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T22:38:34.875017610Z [err]  2026-01-10 22:38:34,628 - server - INFO - üéµ TTS task #2 started at +0ms
2026-01-10T22:38:34.875024720Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - üì§ Streamed script sentence 2/2: I know this call is out of the blue, but do you ha...
2026-01-10T22:38:34.877711223Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - LLM response (0.38s): Well, uh, I don't know if you could yet, but, I'm calling because you filled out an ad about stacking income without stacking hours. I know this call is out of the blue, but do you have just 25 seconds for me to explain why I'm reaching out today specifically?
2026-01-10T22:38:34.877716733Z [err]  2026-01-10 22:38:34,628 - core_calling_service - INFO - Total latency: 0.38s
2026-01-10T22:38:34.877723061Z [err]  2026-01-10 22:38:34,630 - server - INFO - ‚úÖ LLM finished in 480ms, TTS tasks already running in background
2026-01-10T22:38:34.877728929Z [err]  2026-01-10 22:38:34,630 - server - INFO - üéµ Streaming 2 TTS chunks as they complete...
2026-01-10T22:38:34.877734438Z [err]  2026-01-10 22:38:34,630 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:38:34.877739784Z [err]  2026-01-10 22:38:34,630 - server - INFO -    2 sentences queued and playing seamlessly
2026-01-10T22:38:34.877746016Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #4: Well, uh, I don't know if you could yet, but, I'm ...
2026-01-10T22:38:34.877752212Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:34.877759331Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #4 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:34.877765266Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'Well, uh, I don't know if you could yet, but, I'm ...'
2026-01-10T22:38:34.877773989Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #5: I know this call is out of the blue, but do you ha...
2026-01-10T22:38:34.879639816Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:34.879645941Z [err]  2026-01-10 22:38:34,631 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #5 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:34.879652642Z [err]  2026-01-10 22:38:34,632 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'I know this call is out of the blue, but do you ha...'
2026-01-10T22:38:34.879658464Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚úÖ All 2 persistent TTS streams completed
2026-01-10T22:38:34.879663930Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:38:34.879669450Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 482ms from user stop üöÄ
2026-01-10T22:38:34.879674343Z [err]  2026-01-10 22:38:34,632 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:34.879679519Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:38:34.879684682Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:34.879689743Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:38:34.879695326Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 15ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:38:34.879700809Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 480ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:38:34.881959637Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 782ms estimated
2026-01-10T22:38:34.881960324Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 4ms (provider: elevenlabs, websocket: False)
2026-01-10T22:38:34.881969137Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 482ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:38:34.881973222Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 260 chars, 2 sentences
2026-01-10T22:38:34.881978557Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:38:34.881983924Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Sure....'
2026-01-10T22:38:34.881987455Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:38:34.881993452Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'Well, uh, I don't know if you could yet, but, I'm calling be...'
2026-01-10T22:38:34.881996734Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:38:34.882002778Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:38:34.882006597Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:38:34.882014350Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:34.882019195Z [err]  2026-01-10 22:38:34,632 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:38:34.882036489Z [err]  2026-01-10 22:38:34,824 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 499ms)
2026-01-10T22:38:34.884201032Z [err]  2026-01-10 22:38:34,824 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:38:34.884207391Z [err]  2026-01-10 22:38:34,824 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:38:34.918960556Z [err]  2026-01-10 22:38:34,914 - persistent_tts_service - INFO - üì§ Sending 13374 bytes of audio (84 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:34.918964806Z [err]  2026-01-10 22:38:34,915 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:34.918968638Z [err]  2026-01-10 22:38:34,915 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:34.918974048Z [err]  2026-01-10 22:38:34,915 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 1.7s from now)
2026-01-10T22:38:34.918978715Z [err]  2026-01-10 22:38:34,915 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084714.915 (chunk 1/84, 160 bytes)
2026-01-10T22:38:35.796091572Z [err]  2026-01-10 22:38:35,482 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.1s left)
2026-01-10T22:38:35.985329891Z [err]  2026-01-10 22:38:35,984 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (0.6s left)
2026-01-10T22:38:36.302902087Z [err]  2026-01-10 22:38:36,292 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 84 CHUNKS SENT TO TELNYX in 1377ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:36.302912292Z [err]  2026-01-10 22:38:36,292 - persistent_tts_service - INFO - ‚úÖ Sent 84 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:36.302919225Z [err]  2026-01-10 22:38:36,292 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:36.302927043Z [err]  2026-01-10 22:38:36,292 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:36.302933869Z [err]  2026-01-10 22:38:36,292 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.0s from now)
2026-01-10T22:38:36.302939911Z [err]  2026-01-10 22:38:36,292 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084716.293 (chunk 1/87, 160 bytes)
2026-01-10T22:38:37.813996398Z [err]  2026-01-10 22:38:37,722 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1429ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:37.814000707Z [err]  2026-01-10 22:38:37,722 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:37.814004229Z [err]  2026-01-10 22:38:37,722 - persistent_tts_service - INFO - üì§ Sending 3669 bytes of audio (23 chunks, 0.5s duration) via WebSocket
2026-01-10T22:38:37.814007894Z [err]  2026-01-10 22:38:37,722 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:37.814011268Z [err]  2026-01-10 22:38:37,722 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.5s (total: 1.0s from now)
2026-01-10T22:38:37.814016135Z [err]  2026-01-10 22:38:37,722 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084717.723 (chunk 1/23, 160 bytes)
2026-01-10T22:38:37.965942269Z [err]  2026-01-10 22:38:37,964 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 23 CHUNKS SENT TO TELNYX in 242ms (audio duration: 0.5s, paced after 10 chunks)
2026-01-10T22:38:37.965947939Z [err]  2026-01-10 22:38:37,964 - persistent_tts_service - INFO - ‚úÖ Sent 23 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:37.965954533Z [err]  2026-01-10 22:38:37,964 - persistent_tts_service - INFO - üì§ Sending 13792 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:37.965960459Z [err]  2026-01-10 22:38:37,964 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:37.965966354Z [err]  2026-01-10 22:38:37,964 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.5s from now)
2026-01-10T22:38:37.965974365Z [err]  2026-01-10 22:38:37,965 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084717.965 (chunk 1/87, 160 bytes)
2026-01-10T22:38:38.869806713Z [err]  2026-01-10 22:38:38,701 - server - INFO - üì§ Audio flowing: 1133 packets sent to Soniox (5s update)
2026-01-10T22:38:39.398809584Z [err]  2026-01-10 22:38:39,397 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1432ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:39.398818306Z [err]  2026-01-10 22:38:39,397 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:39.398825137Z [err]  2026-01-10 22:38:39,397 - persistent_tts_service - INFO - üì§ Sending 2183 bytes of audio (14 chunks, 0.3s duration) via WebSocket
2026-01-10T22:38:39.398833125Z [err]  2026-01-10 22:38:39,397 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:39.398838526Z [err]  2026-01-10 22:38:39,397 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.3s (total: 1.4s from now)
2026-01-10T22:38:39.398842681Z [err]  2026-01-10 22:38:39,397 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084719.397 (chunk 1/14, 160 bytes)
2026-01-10T22:38:39.789149206Z [err]  2026-01-10 22:38:39,472 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084719.473 (chunk 1/105, 160 bytes)
2026-01-10T22:38:39.789158601Z [err]  2026-01-10 22:38:39,548 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2026-01-10T22:38:39.789168383Z [err]  2026-01-10 22:38:39,472 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 14 CHUNKS SENT TO TELNYX in 75ms (audio duration: 0.3s, paced after 10 chunks)
2026-01-10T22:38:39.789178226Z [err]  2026-01-10 22:38:39,472 - persistent_tts_service - INFO - ‚úÖ Sent 14 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:39.789186532Z [err]  2026-01-10 22:38:39,472 - persistent_tts_service - INFO - üì§ Sending 16718 bytes of audio (105 chunks, 2.1s duration) via WebSocket
2026-01-10T22:38:39.789192345Z [err]  2026-01-10 22:38:39,472 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:39.789197515Z [err]  2026-01-10 22:38:39,472 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.1s (total: 3.4s from now)
2026-01-10T22:38:40.880888992Z [err]  2026-01-10 22:38:40,495 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.4s left)
2026-01-10T22:38:40.997881967Z [err]  2026-01-10 22:38:40,996 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.9s left)
2026-01-10T22:38:41.251762301Z [err]  2026-01-10 22:38:41,244 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 105 CHUNKS SENT TO TELNYX in 1771ms (audio duration: 2.1s, paced after 10 chunks)
2026-01-10T22:38:41.251768838Z [err]  2026-01-10 22:38:41,244 - persistent_tts_service - INFO - ‚úÖ Sent 105 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:41.251774675Z [err]  2026-01-10 22:38:41,244 - persistent_tts_service - INFO - üì§ Sending 9660 bytes of audio (61 chunks, 1.2s duration) via WebSocket
2026-01-10T22:38:41.251780818Z [err]  2026-01-10 22:38:41,244 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:41.251786950Z [err]  2026-01-10 22:38:41,244 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.2s (total: 2.8s from now)
2026-01-10T22:38:41.251793294Z [err]  2026-01-10 22:38:41,244 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084721.245 (chunk 1/61, 160 bytes)
2026-01-10T22:38:42.202506985Z [err]  2026-01-10 22:38:42,197 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 61 CHUNKS SENT TO TELNYX in 952ms (audio duration: 1.2s, paced after 10 chunks)
2026-01-10T22:38:42.202511813Z [err]  2026-01-10 22:38:42,197 - persistent_tts_service - INFO - ‚úÖ Sent 61 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:42.202516926Z [err]  2026-01-10 22:38:42,197 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:42.202522208Z [err]  2026-01-10 22:38:42,197 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:42.202526487Z [err]  2026-01-10 22:38:42,197 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 3.6s from now)
2026-01-10T22:38:42.202531632Z [err]  2026-01-10 22:38:42,197 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084722.198 (chunk 1/87, 160 bytes)
2026-01-10T22:38:43.771566399Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - ‚úÖ Sent 3 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:43.771572833Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1438ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:43.771573591Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üì§ Sending 27864 bytes of audio (175 chunks, 3.5s duration) via WebSocket
2026-01-10T22:38:43.771580433Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:43.771583441Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:43.771586588Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +3.5s (total: 5.7s from now)
2026-01-10T22:38:43.771590215Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üì§ Sending 325 bytes of audio (3 chunks, 0.0s duration) via WebSocket
2026-01-10T22:38:43.771598165Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:43.771606837Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.0s (total: 2.2s from now)
2026-01-10T22:38:43.771612317Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084723.636 (chunk 1/3, 160 bytes)
2026-01-10T22:38:43.771619036Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 3 CHUNKS SENT TO TELNYX in 0ms (audio duration: 0.0s, paced after 10 chunks)
2026-01-10T22:38:43.773539262Z [err]  2026-01-10 22:38:43,636 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084723.636 (chunk 1/175, 160 bytes)
2026-01-10T22:38:43.773543062Z [err]  2026-01-10 22:38:43,715 - server - INFO - üì§ Audio flowing: 1384 packets sent to Soniox (5s update)
2026-01-10T22:38:45.025159234Z [err]  2026-01-10 22:38:45,015 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (4.3s left)
2026-01-10T22:38:45.810035703Z [err]  2026-01-10 22:38:45,517 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.8s left)
2026-01-10T22:38:46.859967362Z [err]  2026-01-10 22:38:46,700 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 175 CHUNKS SENT TO TELNYX in 3064ms (audio duration: 3.5s, paced after 10 chunks)
2026-01-10T22:38:46.859977241Z [err]  2026-01-10 22:38:46,700 - persistent_tts_service - INFO - ‚úÖ Sent 175 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:48.916183173Z [err]  2026-01-10 22:38:48,716 - server - INFO - üì§ Audio flowing: 1634 packets sent to Soniox (5s update)
2026-01-10T22:38:49.797980982Z [err]  2026-01-10 22:38:49,536 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084729.5367815 for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:49.797994276Z [err]  2026-01-10 22:38:49,536 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:49.798000892Z [err]  2026-01-10 22:38:49,611 - persistent_tts_service - INFO - üîá [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:38:49.798141466Z [err]  2026-01-10 22:38:49,536 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (0.2s ago), marking agent as done speaking
2026-01-10T22:38:50.042579688Z [err]  2026-01-10 22:38:50,037 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=0/2
2026-01-10T22:38:50.388840570Z [err]  2026-01-10 22:38:50,381 - server - INFO - üé§ Soniox receiver alive - 10 messages received in last 10s
2026-01-10T22:38:50.913491927Z [err]  2026-01-10 22:38:50,539 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=0/2
2026-01-10T22:38:51.204651888Z [err]  2026-01-10 22:38:51,201 - server - INFO - üî§ RAW TOKENS: [" O"?]
2026-01-10T22:38:51.204659622Z [err]  2026-01-10 22:38:51,202 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER RESET (user started speaking) for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:51.204663954Z [err]  2026-01-10 22:38:51,202 - core_calling_service - INFO - üîä Silence timer reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user started speaking)
2026-01-10T22:38:51.204667780Z [err]  2026-01-10 22:38:51,202 - core_calling_service - INFO - üë§ User started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:51.204671627Z [err]  2026-01-10 22:38:51,202 - persistent_tts_service - INFO - ‚ö° [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR_AUDIO called - pending_sentences=0, audio_queue=0
2026-01-10T22:38:51.204675626Z [err]  2026-01-10 22:38:51,202 - persistent_tts_service - INFO - üõë [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] INTERRUPT - Floor Released (is_holding_floor=False)
2026-01-10T22:38:51.238487465Z [err]  2026-01-10 22:38:51,234 - persistent_tts_service - INFO - üõë [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent clear event to Telnyx WebSocket (3x)
2026-01-10T22:38:51.238498552Z [err]  2026-01-10 22:38:51,234 - persistent_tts_service - INFO - ‚è±Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Reset playback_expected_end_time to NOW
2026-01-10T22:38:51.238505382Z [err]  2026-01-10 22:38:51,234 - server - INFO - üìä [REAL TIMING] AUDIO QUEUE CLEARED (user started speaking) for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:51.238511450Z [err]  2026-01-10 22:38:51,234 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:51.238517422Z [err]  2026-01-10 22:38:51,235 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:51.238523441Z [err]  2026-01-10 22:38:51,235 - server - INFO - üîç PARTIAL TRANSCRIPT: 'O' | Generating: False
2026-01-10T22:38:51.342831148Z [err]  2026-01-10 22:38:51,337 - server - INFO - üî§ RAW TOKENS: [" O"?, "h,"?]
2026-01-10T22:38:51.342852579Z [err]  2026-01-10 22:38:51,337 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Oh,' | Generating: False
2026-01-10T22:38:51.465275580Z [err]  2026-01-10 22:38:51,458 - server - INFO - üî§ RAW TOKENS: [" O"?, "h,"?, " l"?]
2026-01-10T22:38:51.465284742Z [err]  2026-01-10 22:38:51,458 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Oh, l' | Generating: False
2026-01-10T22:38:51.870134525Z [err]  2026-01-10 22:38:51,580 - server - INFO - üî§ RAW TOKENS: [" O"?, "h,"?, " l"?, "ike"?]
2026-01-10T22:38:51.870139462Z [err]  2026-01-10 22:38:51,581 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Oh, like' | Generating: False
2026-01-10T22:38:51.870144637Z [err]  2026-01-10 22:38:51,713 - server - INFO - üî§ RAW TOKENS: [" O"?, "h,"?, " l"?, "ike"?, " C"?]
2026-01-10T22:38:51.870149953Z [err]  2026-01-10 22:38:51,713 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Oh, like C' | Generating: False
2026-01-10T22:38:51.870155100Z [err]  2026-01-10 22:38:51,841 - server - INFO - üî§ RAW TOKENS: [" O"?, "h,"?, " l"?, "ike"?, " C"?, "M"?]
2026-01-10T22:38:51.870160214Z [err]  2026-01-10 22:38:51,842 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Oh, like CM' | Generating: False
2026-01-10T22:38:52.041619619Z [err]  2026-01-10 22:38:52,039 - server - INFO - üî§ RAW TOKENS: [" O"‚úì, "h,"‚úì, " l"‚úì, "ike"‚úì, " C"‚úì, "M"‚úì, "s."‚úì, "<end>"‚úì]
2026-01-10T22:38:52.041632244Z [err]  2026-01-10 22:38:52,040 - server - INFO - üéØ Endpoint detected: <end> token received
2026-01-10T22:38:52.041640433Z [err]  2026-01-10 22:38:52,040 - server - INFO - üßπ Cleaned transcript: ' O h,  l ike  C M s.' -> 'Oh, like CMs.'
2026-01-10T22:38:52.041646530Z [err]  2026-01-10 22:38:52,040 - server - INFO - üì• FINAL TOKENS: 'Oh, like CMs.' (7 tokens)
2026-01-10T22:38:52.041654619Z [err]  2026-01-10 22:38:52,040 - server - INFO - üé§ Soniox final transcript: 'Oh, like CMs.'
2026-01-10T22:38:52.041660875Z [err]  2026-01-10 22:38:52,040 - server - INFO - üîç FILTER CHECK: words=3, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=-0.8s, generating=False, playbacks=0, is_active=False
2026-01-10T22:38:52.041667064Z [err]  2026-01-10 22:38:52,040 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2026-01-10T22:38:52.041673932Z [err]  2026-01-10 22:38:52,040 - server - INFO - ‚è±Ô∏è [22:38:52.040] üìù FINAL TRANSCRIPT RECEIVED: 'Oh, like CMs.'
2026-01-10T22:38:52.041680237Z [err]  2026-01-10 22:38:52,040 - server - INFO - ‚è±Ô∏è [22:38:52.040] STT endpoint detection latency: 6ms
2026-01-10T22:38:52.041686473Z [err]  2026-01-10 22:38:52,040 - server - INFO - ‚è±Ô∏è [22:38:52.040] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2026-01-10T22:38:52.041692764Z [err]  2026-01-10 22:38:52,040 - server - INFO - ‚è±Ô∏è User spoke at 1768084732.040688
2026-01-10T22:38:52.043064150Z [err]  2026-01-10 22:38:52,041 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:52.043072308Z [err]  2026-01-10 22:38:52,041 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2026-01-10T22:38:52.043078525Z [err]  2026-01-10 22:38:52,041 - server - INFO - ‚úÖ Agent SILENT - User said 3 word(s): 'Oh, like CMs.' - Processing...
2026-01-10T22:38:52.054858597Z [err]  2026-01-10 22:38:52,052 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 18ms (Soniox model: stt-rt-v3)
2026-01-10T22:38:52.054863395Z [err]  2026-01-10 22:38:52,051 - server - INFO - üìä [REAL TIMING] STT: User audio end ‚Üí Transcript received: 7ms
2026-01-10T22:38:52.054866972Z [err]  2026-01-10 22:38:52,052 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2026-01-10T22:38:52.054869003Z [err]  2026-01-10 22:38:52,051 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Oh, like CMs.
2026-01-10T22:38:52.054874400Z [err]  2026-01-10 22:38:52,051 - core_calling_service - INFO - üë§ User stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:52.054875492Z [err]  2026-01-10 22:38:52,052 - server - INFO - üìä [REAL TIMING] Processing start: 18ms after user audio end
2026-01-10T22:38:52.054880789Z [err]  2026-01-10 22:38:52,052 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2026-01-10T22:38:52.054884787Z [err]  2026-01-10 22:38:52,052 - server - INFO - ‚úÖ User starting new turn - resetting agent speaking flag
2026-01-10T22:38:52.054887097Z [err]  2026-01-10 22:38:52,052 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:52.054891531Z [err]  2026-01-10 22:38:52,052 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2026-01-10T22:38:52.054895823Z [err]  2026-01-10 22:38:52,052 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+18ms
2026-01-10T22:38:52.153029044Z [err]  2026-01-10 22:38:52,148 - server - INFO - üìù Saved user transcript to database
2026-01-10T22:38:52.153035463Z [err]  2026-01-10 22:38:52,148 - persistent_tts_service - INFO - üîÑ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Interrupt flag reset - ready for new audio
2026-01-10T22:38:52.153045879Z [err]  2026-01-10 22:38:52,148 - server - INFO - üîÑ Reset TTS interrupt flag before new response
2026-01-10T22:38:52.153052662Z [err]  2026-01-10 22:38:52,148 - core_calling_service - INFO - ‚è±Ô∏è [22:38:52.148] üì• process_user_input() ENTRY - text: 'Oh, like CMs....'
2026-01-10T22:38:52.153058497Z [err]  2026-01-10 22:38:52,149 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:52.153064511Z [err]  2026-01-10 22:38:52,149 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: User spoke while Silence Greeting was triggering
2026-01-10T22:38:52.179228171Z [err]  2026-01-10 22:38:52,170 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2026-01-10T22:38:52.179239346Z [err]  2026-01-10 22:38:52,170 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:52.857853073Z [err]  2026-01-10 22:38:52,620 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2026-01-10T22:38:52.857861416Z [err]  2026-01-10 22:38:52,620 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2026-01-10T22:38:52.857866111Z [err]  2026-01-10 22:38:52,620 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2026-01-10T22:38:52.857894683Z [err]  2026-01-10 22:38:52,621 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:52.857901285Z [err]  2026-01-10 22:38:52,621 - redis_service - INFO - üì¶ Stored call data in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (TTL: 3600s)
2026-01-10T22:38:52.857909924Z [err]  2026-01-10 22:38:52,621 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2026-01-10T22:38:52.857916839Z [err]  2026-01-10 22:38:52,621 - core_calling_service - INFO - ‚è±Ô∏è [22:38:52.621] ‚è© About to call _process_call_flow_streaming()
2026-01-10T22:38:52.857922803Z [err]  2026-01-10 22:38:52,621 - core_calling_service - INFO - ‚è±Ô∏è [22:38:52.621] üîÄ Agent type: call_flow, calling flow processor...
2026-01-10T22:38:52.857929722Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - ‚è±Ô∏è [22:38:52.622] üîÄ _process_call_flow_streaming() ENTRY
2026-01-10T22:38:52.857936838Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - Flow processing - History length: 7, Is first: False
2026-01-10T22:38:52.857942159Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 1763161849799
2026-01-10T22:38:52.857947713Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - ‚è±Ô∏è [22:38:52.622] üöÄ Checking special cases before merged transition+response...
2026-01-10T22:38:52.858099045Z [err]  2026-01-10 22:38:52,619 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_stop "HTTP/1.1 200 OK"
2026-01-10T22:38:52.860461280Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - ‚è±Ô∏è Using MERGED transition+response for: Oh, like CMs....
2026-01-10T22:38:52.860467021Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - Evaluating transitions from Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic for message: Oh, like CMs.
2026-01-10T22:38:52.860472610Z [err]  2026-01-10 22:38:52,622 - core_calling_service - INFO - ‚è±Ô∏è [22:38:52.622] üöÄ MERGED TRANSITION+RESPONSE START - 4 options
2026-01-10T22:38:53.097267323Z [err]  2026-01-10 22:38:53,087 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/2 200 OK"
2026-01-10T22:38:53.926533173Z [err]  2026-01-10 22:38:53,539 - core_calling_service - INFO - ‚ö° MERGED: Transition marker [T:-1] detected
2026-01-10T22:38:53.926544987Z [err]  2026-01-10 22:38:53,540 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:53.926553326Z [err]  2026-01-10 22:38:53,540 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:53.926558106Z [err]  2026-01-10 22:38:53,540 - core_calling_service - INFO - üì§ Streamed: CMs?...
2026-01-10T22:38:53.926561221Z [err]  2026-01-10 22:38:53,540 - server - INFO - üì§ Sentence arrived from LLM: CMs?...
2026-01-10T22:38:53.926570765Z [err]  2026-01-10 22:38:53,540 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 1487ms
2026-01-10T22:38:53.926574885Z [err]  2026-01-10 22:38:53,540 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #6: CMs?...
2026-01-10T22:38:53.926578955Z [err]  2026-01-10 22:38:53,540 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2026-01-10T22:38:53.926583881Z [err]  2026-01-10 22:38:53,540 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:53.926584087Z [err]  2026-01-10 22:38:53,540 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:53.926591086Z [err]  2026-01-10 22:38:53,540 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2026-01-10T22:38:53.926598963Z [err]  2026-01-10 22:38:53,540 - server - INFO - üéµ TTS task #1 started at +0ms
2026-01-10T22:38:53.926605387Z [err]  2026-01-10 22:38:53,538 - core_calling_service - INFO - ‚ö° MERGED TTFT: 916ms
2026-01-10T22:38:53.926606693Z [err]  2026-01-10 22:38:53,540 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 1487ms
2026-01-10T22:38:53.930040741Z [err]  2026-01-10 22:38:53,540 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #6 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:53.930045165Z [err]  2026-01-10 22:38:53,540 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'CMs?...'
2026-01-10T22:38:53.930048939Z [err]  2026-01-10 22:38:53,734 - server - INFO - üì§ Audio flowing: 1885 packets sent to Soniox (5s update)
2026-01-10T22:38:53.930053257Z [err]  2026-01-10 22:38:53,800 - persistent_tts_service - INFO - üì§ Sending 6687 bytes of audio (42 chunks, 0.8s duration) via WebSocket
2026-01-10T22:38:53.930057552Z [err]  2026-01-10 22:38:53,800 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:53.930062292Z [err]  2026-01-10 22:38:53,800 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:53.930066258Z [err]  2026-01-10 22:38:53,800 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.8s (total: 0.8s from now)
2026-01-10T22:38:53.930070234Z [err]  2026-01-10 22:38:53,801 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084733.801 (chunk 1/42, 160 bytes)
2026-01-10T22:38:54.209719476Z [err]  2026-01-10 22:38:54,204 - core_calling_service - INFO - üì§ Streamed: You mean like call centers or something else?...
2026-01-10T22:38:54.209728251Z [err]  2026-01-10 22:38:54,205 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #7: You mean like call centers or something else?...
2026-01-10T22:38:54.209734645Z [err]  2026-01-10 22:38:54,205 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:54.209739387Z [err]  2026-01-10 22:38:54,205 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #7 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:54.209743867Z [err]  2026-01-10 22:38:54,205 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'You mean like call centers or something else?...'
2026-01-10T22:38:54.209767819Z [err]  2026-01-10 22:38:54,204 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.209772185Z [err]  2026-01-10 22:38:54,204 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.209776791Z [err]  2026-01-10 22:38:54,204 - server - INFO - üì§ Sentence arrived from LLM: You mean like call centers or something else?...
2026-01-10T22:38:54.209781702Z [err]  2026-01-10 22:38:54,204 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:54.209786028Z [err]  2026-01-10 22:38:54,204 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2026-01-10T22:38:54.209790892Z [err]  2026-01-10 22:38:54,204 - server - INFO - üéµ TTS task #2 started at +664ms
2026-01-10T22:38:54.319408915Z [err]  2026-01-10 22:38:54,317 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #8: In a nutshell, we set up passive income websites t...
2026-01-10T22:38:54.319418679Z [err]  2026-01-10 22:38:54,317 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:54.319419616Z [err]  2026-01-10 22:38:54,317 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.319425544Z [err]  2026-01-10 22:38:54,318 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #8 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:54.319429171Z [err]  2026-01-10 22:38:54,317 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.319431142Z [err]  2026-01-10 22:38:54,318 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'In a nutshell, we set up passive income websites t...'
2026-01-10T22:38:54.319436148Z [err]  2026-01-10 22:38:54,317 - server - INFO - üì§ Sentence arrived from LLM: In a nutshell, we set up passive income websites t...
2026-01-10T22:38:54.319443059Z [err]  2026-01-10 22:38:54,317 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:54.319449362Z [err]  2026-01-10 22:38:54,317 - server - INFO - üöÄ Streaming sentence #3 via persistent WebSocket
2026-01-10T22:38:54.319455130Z [err]  2026-01-10 22:38:54,317 - server - INFO - üéµ TTS task #3 started at +777ms
2026-01-10T22:38:54.319460106Z [err]  2026-01-10 22:38:54,317 - core_calling_service - INFO - üì§ Streamed: In a nutshell, we set up passive income websites t...
2026-01-10T22:38:54.320863115Z [err]  2026-01-10 22:38:54,319 - persistent_tts_service - INFO - üìä [REAL TIMING] TEXT SENT TO ELEVENLABS: 'What questions come to mind right away?...'
2026-01-10T22:38:54.320907872Z [err]  2026-01-10 22:38:54,319 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.320914269Z [err]  2026-01-10 22:38:54,319 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.320920103Z [err]  2026-01-10 22:38:54,319 - server - INFO - üì§ Sentence arrived from LLM: What questions come to mind right away?...
2026-01-10T22:38:54.320925823Z [err]  2026-01-10 22:38:54,319 - server - INFO - üîç Persistent TTS lookup: call_id=v3:WEX1rb28OL4rUMpOW..., session=FOUND
2026-01-10T22:38:54.320931612Z [err]  2026-01-10 22:38:54,319 - server - INFO - üöÄ Streaming sentence #4 via persistent WebSocket
2026-01-10T22:38:54.320938799Z [err]  2026-01-10 22:38:54,319 - server - INFO - üéµ TTS task #4 started at +779ms
2026-01-10T22:38:54.320946763Z [err]  2026-01-10 22:38:54,319 - core_calling_service - INFO - üì§ Streamed: What questions come to mind right away?...
2026-01-10T22:38:54.320952871Z [err]  2026-01-10 22:38:54,319 - persistent_tts_service - INFO - üé§ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Streaming sentence #9: What questions come to mind right away?...
2026-01-10T22:38:54.320959163Z [err]  2026-01-10 22:38:54,319 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] ACTIVATE WAIT STATE: is_waiting_for_first_audio_of_response=True
2026-01-10T22:38:54.320964543Z [err]  2026-01-10 22:38:54,319 - persistent_tts_service - INFO - üöÄ [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] Sent sentence #9 to ElevenLabs in 0ms (non-blocking)
2026-01-10T22:38:54.322885408Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - ‚è±Ô∏è MERGED TRANSITION+RESPONSE COMPLETE - took 1698ms
2026-01-10T22:38:54.322890947Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - ‚ö†Ô∏è MERGED: No transition matched (marker=-1), staying on current node
2026-01-10T22:38:54.322896508Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - ‚è±Ô∏è [TIMING] MERGED_TRANSITION_RESPONSE: 1698ms
2026-01-10T22:38:54.322902991Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - üîä Silence tracking reset for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (user responded)
2026-01-10T22:38:54.322908922Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2026-01-10T22:38:54.322914669Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - üíæ Storing node ID 1763161849799 in conversation history
2026-01-10T22:38:54.322919954Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - LLM response (2.17s): CMs? You mean like call centers or something else? In a nutshell, we set up passive income websites that generate leads for local businesses and produce income for you. What questions come to mind right away?
2026-01-10T22:38:54.322925181Z [err]  2026-01-10 22:38:54,320 - core_calling_service - INFO - Total latency: 2.17s
2026-01-10T22:38:54.322930747Z [err]  2026-01-10 22:38:54,321 - server - INFO - ‚úÖ LLM finished in 2268ms, TTS tasks already running in background
2026-01-10T22:38:54.322936580Z [err]  2026-01-10 22:38:54,321 - server - INFO - üéµ Streaming 4 TTS chunks as they complete...
2026-01-10T22:38:54.322943210Z [err]  2026-01-10 22:38:54,321 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2026-01-10T22:38:54.322948869Z [err]  2026-01-10 22:38:54,321 - server - INFO -    4 sentences queued and playing seamlessly
2026-01-10T22:38:54.322954379Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚úÖ All 4 persistent TTS streams completed
2026-01-10T22:38:54.324571290Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2026-01-10T22:38:54.324579145Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 18ms (provider: soniox, model: stt-rt-v3)
2026-01-10T22:38:54.324582703Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2026-01-10T22:38:54.324588368Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 2268ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2026-01-10T22:38:54.324590898Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 2269ms from user stop üöÄ
2026-01-10T22:38:54.324597595Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 782ms (provider: elevenlabs, websocket: False)
2026-01-10T22:38:54.324598776Z [err]  2026-01-10 22:38:54,322 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:38:54.324605259Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 2269ms (user stopped ‚Üí play_audio_url called)
2026-01-10T22:38:54.324606744Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚úÖ Agent generation complete - response window closed
2026-01-10T22:38:54.324613450Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2026-01-10T22:38:54.324615130Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:54.324621103Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2026-01-10T22:38:54.324623029Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2026-01-10T22:38:54.326063263Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2026-01-10T22:38:54.326073640Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2026-01-10T22:38:54.326081186Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2569ms estimated
2026-01-10T22:38:54.326087635Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 208 chars, 4 sentences
2026-01-10T22:38:54.326096194Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Oh, like CMs....'
2026-01-10T22:38:54.326103034Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: 'CMs? You mean like call centers or something else? In a nuts...'
2026-01-10T22:38:54.326110053Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2026-01-10T22:38:54.326116716Z [err]  2026-01-10 22:38:54,322 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2026-01-10T22:38:54.390909450Z [err]  2026-01-10 22:38:54,385 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 42 CHUNKS SENT TO TELNYX in 584ms (audio duration: 0.8s, paced after 10 chunks)
2026-01-10T22:38:54.390916412Z [err]  2026-01-10 22:38:54,385 - persistent_tts_service - INFO - ‚úÖ Sent 42 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:54.863968603Z [err]  2026-01-10 22:38:54,492 - persistent_tts_service - INFO - üì§ Sending 18204 bytes of audio (114 chunks, 2.3s duration) via WebSocket
2026-01-10T22:38:54.863978623Z [err]  2026-01-10 22:38:54,492 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:54.863979948Z [err]  2026-01-10 22:38:54,492 - persistent_tts_service - INFO - üõ°Ô∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] CLEAR WAIT STATE: Audio flow started (is_waiting_for_first_audio_of_response=False)
2026-01-10T22:38:54.863986410Z [err]  2026-01-10 22:38:54,492 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.3s (total: 2.4s from now)
2026-01-10T22:38:54.863991199Z [err]  2026-01-10 22:38:54,492 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084734.493 (chunk 1/114, 160 bytes)
2026-01-10T22:38:54.863995711Z [err]  2026-01-10 22:38:54,513 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Node ID: N_Opener_StackingIncomeHook_V3_CreativeTactic, Dead Air: 2786ms)
2026-01-10T22:38:54.864000254Z [err]  2026-01-10 22:38:54,513 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2026-01-10T22:38:54.864005240Z [err]  2026-01-10 22:38:54,513 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2026-01-10T22:38:55.059139711Z [err]  2026-01-10 22:38:55,058 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.9s left)
2026-01-10T22:38:55.840594657Z [err]  2026-01-10 22:38:55,558 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (1.4s left)
2026-01-10T22:38:56.435940291Z [err]  2026-01-10 22:38:56,433 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 114 CHUNKS SENT TO TELNYX in 1941ms (audio duration: 2.3s, paced after 10 chunks)
2026-01-10T22:38:56.435944286Z [err]  2026-01-10 22:38:56,433 - persistent_tts_service - INFO - ‚úÖ Sent 114 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:56.435948526Z [err]  2026-01-10 22:38:56,434 - persistent_tts_service - INFO - üì§ Sending 11889 bytes of audio (75 chunks, 1.5s duration) via WebSocket
2026-01-10T22:38:56.435953007Z [err]  2026-01-10 22:38:56,434 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:56.435956995Z [err]  2026-01-10 22:38:56,434 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.5s (total: 2.0s from now)
2026-01-10T22:38:56.435961085Z [err]  2026-01-10 22:38:56,434 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084736.434 (chunk 1/75, 160 bytes)
2026-01-10T22:38:57.902875382Z [err]  2026-01-10 22:38:57,644 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 75 CHUNKS SENT TO TELNYX in 1210ms (audio duration: 1.5s, paced after 10 chunks)
2026-01-10T22:38:57.902883996Z [err]  2026-01-10 22:38:57,644 - persistent_tts_service - INFO - ‚úÖ Sent 75 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:57.902890679Z [err]  2026-01-10 22:38:57,645 - persistent_tts_service - INFO - üì§ Sending 13793 bytes of audio (87 chunks, 1.7s duration) via WebSocket
2026-01-10T22:38:57.902897256Z [err]  2026-01-10 22:38:57,645 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:57.902905083Z [err]  2026-01-10 22:38:57,645 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.7s (total: 2.5s from now)
2026-01-10T22:38:57.902919269Z [err]  2026-01-10 22:38:57,645 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084737.645 (chunk 1/87, 160 bytes)
2026-01-10T22:38:58.834145529Z [err]  2026-01-10 22:38:58,753 - server - INFO - üì§ Audio flowing: 2134 packets sent to Soniox (5s update)
2026-01-10T22:38:59.075965618Z [err]  2026-01-10 22:38:59,073 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 87 CHUNKS SENT TO TELNYX in 1428ms (audio duration: 1.7s, paced after 10 chunks)
2026-01-10T22:38:59.075970171Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - ‚úÖ Sent 87 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:59.075974902Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üì§ Sending 696 bytes of audio (5 chunks, 0.1s duration) via WebSocket
2026-01-10T22:38:59.075979628Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:59.075984196Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.1s (total: 1.1s from now)
2026-01-10T22:38:59.075988692Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084739.074 (chunk 1/5, 160 bytes)
2026-01-10T22:38:59.075996312Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üìä [REAL TIMING] ALL 5 CHUNKS SENT TO TELNYX in 0ms (audio duration: 0.1s, paced after 10 chunks)
2026-01-10T22:38:59.076001439Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - ‚úÖ Sent 5 audio chunks via WebSocket (paced sending enabled)
2026-01-10T22:38:59.076006420Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üì§ Sending 23777 bytes of audio (149 chunks, 3.0s duration) via WebSocket
2026-01-10T22:38:59.076010823Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:38:59.076015170Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +3.0s (total: 4.1s from now)
2026-01-10T22:38:59.078795271Z [err]  2026-01-10 22:38:59,074 - persistent_tts_service - INFO - üìä [REAL TIMING] FIRST AUDIO CHUNK SENT TO TELNYX at 1768084739.075 (chunk 1/149, 160 bytes)
2026-01-10T22:39:00.084267557Z [err]  2026-01-10 22:39:00,078 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (3.1s left)
2026-01-10T22:39:00.848600309Z [err]  2026-01-10 22:39:00,580 - dead_air_monitor - INFO - üîá MONITOR: Skipping silence check - audio playing (2.6s left)
2026-01-10T22:39:00.848607135Z [err]  2026-01-10 22:39:00,668 - server - INFO - üé§ Soniox receiver alive - 15 messages received in last 10s
2026-01-10T22:39:01.055601593Z [err]  2026-01-10 22:39:01,048 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 2239 total packets
2026-01-10T22:39:01.055606850Z [err]  [2026-01-10 22:39:01 +0000] [6] [INFO] connection closed
2026-01-10T22:39:01.058489129Z [err]  2026-01-10 22:39:01,055 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:39:01.058499287Z [err]  2026-01-10 22:39:01,055 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': 'b17b7883-7150-4b3d-ae46-4875051ca34b', 'occurred_at': '2026-01-10T22:39:00.747886Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '7.84', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '2271', 'skip_packet_count': '22'}, 'outbound': {'packet_count': '2247', 'skip_packet_count': '0'}}, 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:39:00.747886Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2026-01-10T22:38:12.587884Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:39:01.058505975Z [err]  2026-01-10 22:39:01,055 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.058512280Z [err]  2026-01-10 22:39:01,055 - server - INFO - üì® ================================================
2026-01-10T22:39:01.058518188Z [err]  2026-01-10 22:39:01,055 - server - INFO - üìû Call ended: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.058524452Z [err]  2026-01-10 22:39:01,055 - server - INFO - üìû Hangup cause: normal_clearing
2026-01-10T22:39:01.058530383Z [err]  2026-01-10 22:39:01,057 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:39:01.060808192Z [err]  2026-01-10 22:39:01,057 - persistent_tts_service - INFO - üì§ Sending 16347 bytes of audio (103 chunks, 2.0s duration) via WebSocket
2026-01-10T22:39:01.060815954Z [err]  2026-01-10 22:39:01,058 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] AGENT IS NOW SPEAKING (is_speaking=True)
2026-01-10T22:39:01.060822058Z [err]  2026-01-10 22:39:01,058 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +2.0s (total: 4.2s from now)
2026-01-10T22:39:01.060828274Z [err]  2026-01-10 22:39:01,058 - persistent_tts_service - ERROR - ‚ùå Error sending audio via WebSocket: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2026-01-10T22:39:01.109436003Z [err]  2026-01-10 22:39:01,107 - server - INFO - üîä Redis: Removed playback k_y3oxosgA, 0 remaining
2026-01-10T22:39:01.109445739Z [err]  2026-01-10 22:39:01,107 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2026-01-10T22:39:01.109451698Z [err]  2026-01-10 22:39:01,108 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2026-01-10T22:39:01.109456936Z [err]  2026-01-10 22:39:01,108 - server - WARNING - ‚ö†Ô∏è Could not find session to start silence timer for v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.109511430Z [err]  2026-01-10 22:39:01,105 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:39:01.109515149Z [err]  2026-01-10 22:39:01,105 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': '48f9a0a8-e98c-444c-80d9-a1010e7fbdb7', 'occurred_at': '2026-01-10T22:39:00.787887Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:39:00.787887Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'k_y3oxosgA', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:39:01.109519045Z [err]  2026-01-10 22:39:01,105 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.109523074Z [err]  2026-01-10 22:39:01,105 - server - INFO - üì® ================================================
2026-01-10T22:39:01.109527101Z [err]  2026-01-10 22:39:01,107 - redis_service - INFO - ‚ûñ Removed playback k_y3oxosgA, 0 remaining for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.111458783Z [inf]  100.64.0.11:38678 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:39:01.202255556Z [err]  2026-01-10 22:39:01,196 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:39:01.202260123Z [err]  2026-01-10 22:39:01,196 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '6e6964e0-2162-49ef-8193-15f56375fb91', 'occurred_at': '2026-01-10T22:39:01.030814Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '2721f905-d159-4952-ae27-9b716111e437', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:39:01.202265213Z [err]  2026-01-10 22:39:01,196 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.202269259Z [err]  2026-01-10 22:39:01,196 - server - INFO - üì® ================================================
2026-01-10T22:39:01.202273489Z [inf]  100.64.0.5:46370 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:39:01.243394074Z [err]  2026-01-10 22:39:01,237 - server - INFO - üìù Updated call log: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.336905058Z [err]  2026-01-10 22:39:01,330 - server - INFO - ‚úÖ Finalized call log: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag (duration=45s, status=completed)
2026-01-10T22:39:01.824443520Z [err]  2026-01-10 22:39:01,583 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2026-01-10T22:39:01.824451021Z [err]  2026-01-10 22:39:01,583 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084741.5836916 for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.824457321Z [err]  2026-01-10 22:39:01,583 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:01.934496664Z [err]  2026-01-10 22:39:01,932 - server - INFO - üìä Auto-added call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2026-01-10T22:39:02.117768704Z [err]  2026-01-10 22:39:02,113 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2026-01-10T22:39:02.117776321Z [err]  2026-01-10 22:39:02,114 - redis_service - INFO - üì• Retrieved call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.117781721Z [err]  2026-01-10 22:39:02,114 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=No
2026-01-10T22:39:02.117786395Z [err]  2026-01-10 22:39:02,115 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2026-01-10T22:39:02.158997447Z [err]  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:39:02.159009251Z [err]  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
2026-01-10T22:39:02.159017782Z [err]  <!--[if IE 8]>    <html class="no-
2026-01-10T22:39:02.159021126Z [err]  2026-01-10 22:39:02,154 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 530 <none>"
2026-01-10T22:39:02.159026211Z [err]  2026-01-10 22:39:02,155 - server - WARNING - ‚ö†Ô∏è Post-call webhook returned status 530: <!doctype html>
2026-01-10T22:39:02.209004640Z [err]  2026-01-10 22:39:02,205 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2026-01-10T22:39:02.298434136Z [err]  2026-01-10 22:39:02,290 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2026-01-10T22:39:02.298446733Z [err]  2026-01-10 22:39:02,290 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2026-01-10T22:39:02.298453350Z [err]  2026-01-10 22:39:02,291 - server - INFO - üìá [HANGUP] Agent info keys: None
2026-01-10T22:39:02.298459831Z [err]  2026-01-10 22:39:02,291 - server - INFO - üöÄ Triggered QC analysis for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298465645Z [err]  2026-01-10 22:39:02,291 - server - INFO - üìä Triggered Campaign QC for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298473823Z [err]  2026-01-10 22:39:02,291 - server - INFO - üìá Triggered CRM update for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298479907Z [err]  2026-01-10 22:39:02,291 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298485928Z [err]  2026-01-10 22:39:02,291 - server - INFO - ‚úÖ Closed CallSession for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298491659Z [err]  2026-01-10 22:39:02,292 - redis_service - INFO - üßπ Deleted call data from Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298498163Z [err]  2026-01-10 22:39:02,292 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.298502968Z [inf]  100.64.0.10:19338 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:39:02.298507336Z [err]  2026-01-10 22:39:02,293 - server - INFO - üîç Starting QC analysis for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.299964359Z [err]  2026-01-10 22:39:02,293 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2026-01-10T22:39:02.299970641Z [err]  2026-01-10 22:39:02,293 - server - INFO - üìá CRM update starting for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:39:02.299974853Z [err]  2026-01-10 22:39:02,293 - server - INFO - üìá Normalized phone: +17708336397
2026-01-10T22:39:02.384021715Z [err]  2026-01-10 22:39:02,383 - server - INFO - üìù Converted transcript from 8 messages to 671 characters
2026-01-10T22:39:02.387830569Z [err]  2026-01-10 22:39:02,385 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=8, logs_count=10, status=completed
2026-01-10T22:39:02.387835833Z [err]  2026-01-10 22:39:02,385 - server - INFO - üìá CRM: Total variables collected: []
2026-01-10T22:39:02.487843746Z [err]  2026-01-10 22:39:02,473 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2026-01-10T22:39:02.934812619Z [err]  2026-01-10 22:39:02,559 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2026-01-10T22:39:02.934817847Z [err]  2026-01-10 22:39:02,560 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2026-01-10T22:39:02.934823166Z [err]  2026-01-10 22:39:02,644 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2026-01-10T22:39:02.934826459Z [err]  2026-01-10 22:39:02,892 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2026-01-10T22:39:02.934831391Z [err]  2026-01-10 22:39:02,644 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2026-01-10T22:39:02.934831483Z [err]    File "/app/backend/server.py", line 10123, in trigger_campaign_qc_for_call
2026-01-10T22:39:02.934837195Z [err]      await run_full_qc_analysis(
2026-01-10T22:39:02.934840331Z [err]  2026-01-10 22:39:02,644 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.934844696Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2026-01-10T22:39:02.934847745Z [err]  2026-01-10 22:39:02,726 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2026-01-10T22:39:02.934851266Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T22:39:02.934855175Z [err]  2026-01-10 22:39:02,726 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': '3116ab2d-3d7c-481f-bed3-e046bc48faec', 'occurred_at': '2026-01-10T22:39:02.534067Z', 'payload': {'call_control_id': 'v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag', 'call_leg_id': '0bcd8eb0-ee75-11f0-b0e2-02420aef981f', 'call_session_id': '0bcb0aaa-ee75-11f0-9afb-02420aef981f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2026-01-10T22:39:00.852296Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2026-01-10T22:39:00.852296Z', 'recording_id': '176fad1c-1c7f-4d6a-9c33-df3c4c64a7db', 'recording_started_at': '2026-01-10T22:38:17.321359Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-10/0bcd8eb0-ee75-11f0-b0e2-02420aef981f-1768084696406401.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T223902Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=2061ca392ebb0567ce52124d6440ad71f633ccad52220495120df0a12becf19c'}, 'start_time': '2026-01-10T22:38:17.321359Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2026-01-10T22:39:02.934858354Z [err]  
2026-01-10T22:39:02.934966649Z [err]  2026-01-10 22:39:02,726 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.934972493Z [err]  2026-01-10 22:39:02,726 - server - INFO - üì® ================================================
2026-01-10T22:39:02.934984854Z [err]  2026-01-10 22:39:02,726 - server - INFO - üéôÔ∏è Recording saved for call: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.934990443Z [err]  2026-01-10 22:39:02,727 - redis_service - WARNING - ‚ö†Ô∏è Call data not found in Redis: v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:02.934996498Z [err]  2026-01-10 22:39:02,728 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=176fad1c-1c7f-4d6a-9c33-df3c4c64a7db, call_data=False
2026-01-10T22:39:02.935002228Z [err]  2026-01-10 22:39:02,806 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2026-01-10T22:39:02.935007949Z [err]  2026-01-10 22:39:02,832 - server - INFO - üíæ Saved recording URL and ID to database: 176fad1c-1c7f-4d6a-9c33-df3c4c64a7db
2026-01-10T22:39:02.935013877Z [err]  2026-01-10 22:39:02,832 - server - INFO - ‚úÖ Entering dual-channel processing
2026-01-10T22:39:02.935019973Z [err]  2026-01-10 22:39:02,832 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2026-01-10T22:39:02.935025699Z [err]  2026-01-10 22:39:02,892 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2026-01-10T22:39:02.935031871Z [err]  2026-01-10 22:39:02,892 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2026-01-10T22:39:02.935038877Z [err]  2026-01-10 22:39:02,892 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2026-01-10T22:39:03.014014670Z [err]  2026-01-10 22:39:03,011 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T22:39:03.014021055Z [err]  2026-01-10 22:39:03,012 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:39:03.014025662Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:39:03.014029697Z [err]  2026-01-10 22:39:03,012 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:39:03.014033936Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-10T22:39:03.016253566Z [err]  2026-01-10 22:39:03,013 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:03.136998259Z [err]  2026-01-10 22:39:03,134 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2026-01-10/0bcd8eb0-ee75-11f0-b0e2-02420aef981f-1768084696406401.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T223902Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=2061ca392ebb0567ce52124d6440ad71f633ccad52220495120df0a12becf19c "HTTP/1.1 200 OK"
2026-01-10T22:39:03.307666481Z [err]  2026-01-10 22:39:03,306 - server - INFO - ‚úÖ Downloaded 174332 bytes
2026-01-10T22:39:03.509898542Z [err]  2026-01-10 22:39:03,506 - server - INFO - ‚úÖ Split into 2 channels
2026-01-10T22:39:03.509907970Z [err]  2026-01-10 22:39:03,506 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2026-01-10T22:39:03.509913793Z [err]  2026-01-10 22:39:03,506 - server - INFO - üìä Channel 0: 956604 bytes
2026-01-10T22:39:03.509920642Z [err]  2026-01-10 22:39:03,506 - server - ERROR - ‚ùå No Soniox API key available
2026-01-10T22:39:03.509926990Z [err]  2026-01-10 22:39:03,506 - server - INFO - ‚ùå Channel 0: No speech
2026-01-10T22:39:03.509933511Z [err]  2026-01-10 22:39:03,506 - server - INFO - üìä Channel 1: 956604 bytes
2026-01-10T22:39:03.509939862Z [err]  2026-01-10 22:39:03,506 - server - ERROR - ‚ùå No Soniox API key available
2026-01-10T22:39:03.509945044Z [err]  2026-01-10 22:39:03,506 - server - INFO - ‚ùå Channel 1: No speech
2026-01-10T22:39:03.509950286Z [err]  2026-01-10 22:39:03,506 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2026-01-10T22:39:03.509955830Z [inf]  100.64.0.5:46370 - "POST /api/telnyx/webhook HTTP/1.1" 200
2026-01-10T22:39:03.895985831Z [err]  2026-01-10 22:39:03,825 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T22:39:03.895989692Z [err]  2026-01-10 22:39:03,827 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:39:03.895994213Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:39:03.895997818Z [err]  2026-01-10 22:39:03,827 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:39:03.896001536Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2026-01-10T22:39:03.896005437Z [err]  2026-01-10 22:39:03,827 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:04.882777343Z [err]  2026-01-10 22:39:04,751 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:39:04.882786657Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:39:04.882793849Z [err]  2026-01-10 22:39:04,839 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:04.882796785Z [err]  2026-01-10 22:39:04,749 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2026-01-10T22:39:04.882800438Z [err]  2026-01-10 22:39:04,839 - server - INFO - ‚úÖ QC analysis completed for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:04.882805771Z [err]  2026-01-10 22:39:04,751 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2026-01-10T22:39:04.882806755Z [err]  2026-01-10 22:39:04,839 - server - INFO - üìä Scores: Commitment=50, Conversion=60, Excellence=50
2026-01-10T22:39:04.882813097Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2026-01-10T22:39:05.030934677Z [err]  2026-01-10 22:39:05,020 - server - INFO - üìä Updated campaign_calls with QC scores for v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:05.192714586Z [err]  2026-01-10 22:39:05,191 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2026-01-10T22:39:05.282013977Z [err]  2026-01-10 22:39:05,277 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2026-01-10T22:39:05.282020700Z [err]  2026-01-10 22:39:05,277 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: 'str' object has no attribute 'get'
2026-01-10T22:39:05.393968591Z [err]  2026-01-10 22:39:05,390 - persistent_tts_service - INFO - üîá [Call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag] FLOOR RELEASED (is_holding_floor=False)
2026-01-10T22:39:08.959752143Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - üîä Speaking text on call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: Are you still there?...
2026-01-10T22:39:08.959757759Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T22:39:08.959763275Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T22:39:08.959769527Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T22:39:08.959792884Z [err]  2026-01-10 22:39:08,597 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2026-01-10T22:39:08.959803331Z [err]  2026-01-10 22:39:08,599 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2026-01-10T22:39:08.959809957Z [err]  2026-01-10 22:39:08,599 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2026-01-10T22:39:08.959816221Z [err]  2026-01-10 22:39:08,599 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:08.959827088Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:39:08.959832415Z [err]  2026-01-10 22:39:08,862 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:39:08.959847761Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T22:39:08.959853207Z [err]  2026-01-10 22:39:08,599 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2026-01-10T22:39:08.959859744Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2026-01-10T22:39:08.959864842Z [err]  2026-01-10 22:39:08,599 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:39:08.964939842Z [err]  2026-01-10 22:39:08,863 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.26s
2026-01-10T22:39:08.964947924Z [err]  2026-01-10 22:39:08,863 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2026-01-10T22:39:08.964955843Z [err]    "errors": [
2026-01-10T22:39:08.964961090Z [err]      {
2026-01-10T22:39:08.964966490Z [err]        "code": "90018",
2026-01-10T22:39:08.964973517Z [err]        "title": "Call has already ended",
2026-01-10T22:39:08.964979343Z [err]        "detail": "This call is no longer active and can't receive commands."
2026-01-10T22:39:08.964985907Z [err]      }
2026-01-10T22:39:08.964991644Z [err]    ]
2026-01-10T22:39:08.964998669Z [err]  }
2026-01-10T22:39:08.965005150Z [err]  2026-01-10 22:39:08,863 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2026-01-10T22:39:09.131499102Z [err]  2026-01-10 22:39:09,121 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:39:09.131508492Z [err]  2026-01-10 22:39:09,121 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2026-01-10T22:39:09.131514956Z [err]  2026-01-10 22:39:09,121 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2026-01-10T22:39:09.928199102Z [err]  2026-01-10 22:39:09,623 - dead_air_monitor - INFO - ‚è±Ô∏è Playback expected end time passed (4.4s ago), marking agent as done speaking
2026-01-10T22:39:09.928256549Z [err]  2026-01-10 22:39:09,623 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1768084749.6234486 for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:09.928264984Z [err]  2026-01-10 22:39:09,623 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:10.127147032Z [err]  2026-01-10 22:39:10,124 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=0.5s, checkin_count=1/2
2026-01-10T22:39:10.895709502Z [err]  2026-01-10 22:39:10,624 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=1.0s, checkin_count=1/2
2026-01-10T22:39:16.890202658Z [err]  2026-01-10 22:39:16,639 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.0s silence (threshold: 7s)
2026-01-10T22:39:16.890215993Z [err]  2026-01-10 22:39:16,639 - server - INFO - üíæ TTS CACHE HIT: Returning cached audio (17599 bytes)
2026-01-10T22:39:16.890223656Z [err]  2026-01-10 22:39:16,639 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2026-01-10T22:39:16.890225046Z [err]  2026-01-10 22:39:16,639 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.00s
2026-01-10T22:39:16.890231847Z [err]  2026-01-10 22:39:16,639 - telnyx_service - INFO - üîç WebSocket TTS: False
2026-01-10T22:39:16.890236022Z [err]  2026-01-10 22:39:16,640 - telnyx_service - INFO - ‚úÖ Generated 17599 bytes, saved to /tmp/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:39:16.890240541Z [err]  2026-01-10 22:39:16,639 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2026-01-10T22:39:16.890240804Z [err]  2026-01-10 22:39:16,639 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag
2026-01-10T22:39:16.890245658Z [err]  2026-01-10 22:39:16,640 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_elevenlabs_01b2ec34551c0c3ab527c8199487051c.mp3
2026-01-10T22:39:16.890249652Z [err]  2026-01-10 22:39:16,639 - core_calling_service - INFO - üí¨ Sending FINAL check-in #2/2: Are you still there?
2026-01-10T22:39:16.890253956Z [err]  2026-01-10 22:39:16,639 - telnyx_service - INFO - üîä Speaking text on call v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag: Are you still there?...
2026-01-10T22:39:16.890257853Z [err]  2026-01-10 22:39:16,639 - core_calling_service - INFO - ‚ö†Ô∏è Will end call if no response after next silence timeout
2026-01-10T22:39:16.890264358Z [err]  2026-01-10 22:39:16,639 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.0s silence: Are you still there?
2026-01-10T22:39:16.890265959Z [err]  2026-01-10 22:39:16,639 - telnyx_service - INFO - üîç Agent config provided: True
2026-01-10T22:39:16.929046799Z [err]  2026-01-10 22:39:16,920 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:39:16.929062320Z [err]  2026-01-10 22:39:16,921 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.28s
2026-01-10T22:39:16.929068776Z [err]  2026-01-10 22:39:16,921 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2026-01-10T22:39:16.929074625Z [err]    "errors": [
2026-01-10T22:39:16.929079585Z [err]      {
2026-01-10T22:39:16.929084884Z [err]        "code": "90018",
2026-01-10T22:39:16.929091672Z [err]        "title": "Call has already ended",
2026-01-10T22:39:16.929102033Z [err]        "detail": "This call is no longer active and can't receive commands."
2026-01-10T22:39:16.929108416Z [err]      }
2026-01-10T22:39:16.929113242Z [err]    ]
2026-01-10T22:39:16.929118412Z [err]  }
2026-01-10T22:39:16.929123495Z [err]  2026-01-10 22:39:16,921 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2026-01-10T22:39:17.187899500Z [err]  2026-01-10 22:39:17,173 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:WEX1rb28OL4rUMpOW5iS4bPLcXl0t-oUOVzNg7_MYX6kd3FXyf7Bag/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2026-01-10T22:39:17.187904467Z [err]  2026-01-10 22:39:17,173 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2026-01-10T22:39:17.187909382Z [err]  2026-01-10 22:39:17,173 - dead_air_monitor - INFO - ‚úÖ Check-in message sent