2025-12-29T06:28:37.000000000Z [inf]  Starting Container
2025-12-29T06:28:37.131027522Z [inf]  =========================================
2025-12-29T06:28:37.131035467Z [inf]  üöÄ START.SH SCRIPT IS EXECUTING
2025-12-29T06:28:37.131042076Z [inf]  =========================================
2025-12-29T06:28:37.131048965Z [inf]  üìç Working directory: /app/backend
2025-12-29T06:28:37.131055928Z [inf]  üîç Python path: /app/backend
2025-12-29T06:28:37.131062403Z [inf]  üåê Starting Gunicorn on 0.0.0.0:8080...
2025-12-29T06:28:37.131069600Z [inf]  =========================================
2025-12-29T06:28:37.779969586Z [err]  [2025-12-29 06:28:37 +0000] [1] [INFO] Starting gunicorn 22.0.0
2025-12-29T06:28:37.779974927Z [err]  [2025-12-29 06:28:37 +0000] [1] [INFO] Listening at: http://0.0.0.0:8080 (1)
2025-12-29T06:28:37.779979181Z [err]  [2025-12-29 06:28:37 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-29T06:28:37.779983187Z [err]  [2025-12-29 06:28:37 +0000] [3] [INFO] Booting worker with pid: 3
2025-12-29T06:28:37.848794158Z [err]  [2025-12-29 06:28:37 +0000] [4] [INFO] Booting worker with pid: 4
2025-12-29T06:28:37.993241137Z [err]  [2025-12-29 06:28:37 +0000] [5] [INFO] Booting worker with pid: 5
2025-12-29T06:28:38.144751719Z [err]  [2025-12-29 06:28:37 +0000] [6] [INFO] Booting worker with pid: 6
2025-12-29T06:28:58.119274830Z [err]  2025-12-29 06:28:51,500 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-29T06:28:58.119277439Z [err]  2025-12-29 06:28:51,735 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-29T06:28:58.119286084Z [err]  2025-12-29 06:28:51,500 - server - INFO - üî• Pre-warming connection libraries...
2025-12-29T06:28:58.119290031Z [err]  2025-12-29 06:28:51,750 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-29T06:28:58.119296862Z [err]  2025-12-29 06:28:51,522 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-29T06:28:58.119307775Z [err]  2025-12-29 06:28:51,522 - server - INFO - üî• Pre-warming connection libraries...
2025-12-29T06:28:58.119314327Z [err]  2025-12-29 06:28:51,527 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-29T06:28:58.119320692Z [err]  2025-12-29 06:28:51,544 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-29T06:28:58.119328539Z [err]  2025-12-29 06:28:51,594 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-29T06:28:58.119335195Z [err]  2025-12-29 06:28:51,594 - server - INFO - üî• Pre-warming connection libraries...
2025-12-29T06:28:58.119342247Z [err]  2025-12-29 06:28:51,617 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-29T06:28:58.119350142Z [err]  2025-12-29 06:28:51,645 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-29T06:28:58.119356978Z [err]  2025-12-29 06:28:51,667 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-29T06:28:58.119363661Z [err]  2025-12-29 06:28:51,720 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-29T06:28:58.119948884Z [err]  2025-12-29 06:28:51,768 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-29T06:28:58.119964683Z [err]  2025-12-29 06:28:51,773 - server - INFO - ‚úÖ QC agent router loaded
2025-12-29T06:28:58.119973578Z [err]  2025-12-29 06:28:51,783 - server - INFO - ‚úÖ QC agent router loaded
2025-12-29T06:28:58.119981565Z [err]  2025-12-29 06:28:51,797 - server - INFO - ‚úÖ QC learning router loaded
2025-12-29T06:28:58.119989038Z [err]  2025-12-29 06:28:51,800 - server - INFO - ‚úÖ QC learning router loaded
2025-12-29T06:28:58.119997395Z [err]  2025-12-29 06:28:51,802 - server - INFO - ‚úÖ QC agent router loaded
2025-12-29T06:28:58.120006079Z [err]  2025-12-29 06:28:51,820 - server - INFO - ‚úÖ QC learning router loaded
2025-12-29T06:28:58.120008641Z [err]  2025-12-29 06:28:51,924 - server - INFO - ‚úÖ QC test router loaded
2025-12-29T06:28:58.120017188Z [err]  2025-12-29 06:28:51,926 - server - INFO - ‚úÖ Agent test router loaded
2025-12-29T06:28:58.120017418Z [err]  2025-12-29 06:28:51,908 - server - INFO - ‚úÖ QC test router loaded
2025-12-29T06:28:58.120018026Z [err]  2025-12-29 06:28:51,897 - server - INFO - ‚úÖ CRM router loaded
2025-12-29T06:28:58.120026898Z [err]  2025-12-29 06:28:51,936 - server - INFO - ‚úÖ Agent test router loaded
2025-12-29T06:28:58.120028292Z [err]  2025-12-29 06:28:51,901 - server - INFO - ‚ÑπÔ∏è  RAG service disabled (set ENABLE_RAG=true to enable semantic search)
2025-12-29T06:28:58.120028662Z [err]  2025-12-29 06:28:51,912 - server - INFO - ‚úÖ QC test router loaded
2025-12-29T06:28:58.120036523Z [err]  2025-12-29 06:28:51,920 - server - INFO - ‚úÖ CRM router loaded
2025-12-29T06:28:58.120038741Z [err]  2025-12-29 06:28:51,901 - server - INFO - üî• Pre-warming connection libraries...
2025-12-29T06:28:58.120042331Z [err]  2025-12-29 06:28:51,922 - server - INFO - ‚úÖ Connection libraries pre-warmed (websockets, httpx, ElevenLabs, Soniox)
2025-12-29T06:28:58.120047864Z [err]  2025-12-29 06:28:51,907 - server - INFO - ‚úÖ CRM router loaded
2025-12-29T06:28:58.121127941Z [err]  2025-12-29 06:28:51,936 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-29T06:28:58.121128520Z [err]  2025-12-29 06:28:51,975 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-29T06:28:58.121131236Z [err]  [2025-12-29 06:28:51 +0000] [4] [INFO] Started server process [4]
2025-12-29T06:28:58.121135871Z [err]  2025-12-29 06:28:51,975 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-29T06:28:58.121138322Z [err]  [2025-12-29 06:28:51 +0000] [4] [INFO] Waiting for application startup.
2025-12-29T06:28:58.121140986Z [err]  2025-12-29 06:28:51,936 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-29T06:28:58.121144020Z [err]  2025-12-29 06:28:51,976 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-29T06:28:58.121145255Z [err]  [2025-12-29 06:28:51 +0000] [5] [INFO] Started server process [5]
2025-12-29T06:28:58.121151807Z [err]  2025-12-29 06:28:52,016 - server - INFO - ‚úÖ CORS configured for origins: ['https://app.li-ai.org', 'https://li-ai.org']
2025-12-29T06:28:58.121152149Z [err]  2025-12-29 06:28:51,937 - server - INFO - ‚úÖ Agent test router loaded
2025-12-29T06:28:58.121152201Z [err]  [2025-12-29 06:28:51 +0000] [5] [INFO] Waiting for application startup.
2025-12-29T06:28:58.121160525Z [err]  2025-12-29 06:28:51,941 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-29T06:28:58.121167395Z [err]  2025-12-29 06:28:51,941 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-29T06:28:58.121174416Z [err]  2025-12-29 06:28:51,943 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-29T06:28:58.121181965Z [err]  2025-12-29 06:28:51,943 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-29T06:28:58.121188792Z [err]  [2025-12-29 06:28:51 +0000] [3] [INFO] Started server process [3]
2025-12-29T06:28:58.121195882Z [err]  [2025-12-29 06:28:51 +0000] [3] [INFO] Waiting for application startup.
2025-12-29T06:28:58.121861324Z [err]  2025-12-29 06:28:52,063 - server - INFO - ‚úÖ QC enhanced router loaded
2025-12-29T06:28:58.121869481Z [err]  2025-12-29 06:28:52,098 - server - INFO - ‚úÖ QC agent router loaded
2025-12-29T06:28:58.121874649Z [err]  2025-12-29 06:28:52,116 - server - INFO - ‚úÖ QC learning router loaded
2025-12-29T06:28:58.121879741Z [err]  2025-12-29 06:28:52,208 - server - INFO - ‚úÖ CRM router loaded
2025-12-29T06:28:58.121884220Z [err]  2025-12-29 06:28:52,211 - server - INFO - ‚úÖ QC test router loaded
2025-12-29T06:28:58.121888721Z [err]  2025-12-29 06:28:52,222 - server - INFO - ‚úÖ Agent test router loaded
2025-12-29T06:28:58.121893821Z [err]  2025-12-29 06:28:52,228 - server - INFO - ‚úÖ Director Studio router loaded
2025-12-29T06:28:58.121898445Z [err]  2025-12-29 06:28:52,228 - server - INFO - ‚úÖ QC agents orchestrator loaded
2025-12-29T06:28:58.121905046Z [err]  [2025-12-29 06:28:52 +0000] [6] [INFO] Started server process [6]
2025-12-29T06:28:58.121912517Z [err]  [2025-12-29 06:28:52 +0000] [6] [INFO] Waiting for application startup.
2025-12-29T06:28:58.121919692Z [err]  2025-12-29 06:28:52,245 - server - INFO - üéµ Pre-generating comfort noise file on startup (5 minutes for seamless loops)...
2025-12-29T06:29:00.034160536Z [err]  2025-12-29 06:29:00,028 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-29T06:29:00.034170256Z [err]  2025-12-29 06:29:00,032 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-29T06:29:00.034178537Z [err]  2025-12-29 06:29:00,032 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-29T06:29:00.034185914Z [err]  2025-12-29 06:29:00,032 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-29T06:29:00.045914144Z [err]  2025-12-29 06:29:00,043 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-29T06:29:00.045922618Z [err]  2025-12-29 06:29:00,043 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-29T06:29:00.045928325Z [err]  2025-12-29 06:29:00,043 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-29T06:29:00.045937658Z [err]  2025-12-29 06:29:00,043 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-29T06:29:00.067932209Z [err]  2025-12-29 06:29:00,065 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-29T06:29:00.073185964Z [err]  2025-12-29 06:29:00,071 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-29T06:29:00.073194788Z [err]  2025-12-29 06:29:00,071 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-29T06:29:00.073203280Z [err]  2025-12-29 06:29:00,071 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-29T06:29:00.247417514Z [err]  2025-12-29 06:29:00,245 - comfort_noise - INFO - Generated continuous comfort noise: /tmp/comfort_noise_continuous.mp3 (300s, white=-83dB, hum=-93dB)
2025-12-29T06:29:00.253118005Z [err]  2025-12-29 06:29:00,249 - server - INFO - ‚úÖ Comfort noise MP3 ready for immediate use
2025-12-29T06:29:00.253127533Z [err]  2025-12-29 06:29:00,249 - server - INFO - üéµ Pre-warming mulaw comfort noise for WebSocket streaming...
2025-12-29T06:29:00.253134676Z [err]  2025-12-29 06:29:00,249 - comfort_noise - INFO - üéµ Loading mulaw comfort noise for WebSocket mixing...
2025-12-29T06:29:00.799509074Z [err]  2025-12-29 06:29:00,769 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-29T06:29:00.872773912Z [err]  2025-12-29 06:29:00,861 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-29T06:29:00.872779978Z [err]  2025-12-29 06:29:00,861 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-29T06:29:00.872784727Z [err]  [2025-12-29 06:29:00 +0000] [3] [INFO] Application startup complete.
2025-12-29T06:29:00.872789588Z [err]  2025-12-29 06:29:00,869 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-29T06:29:01.012939593Z [err]  2025-12-29 06:29:00,953 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-29T06:29:01.012946281Z [err]  2025-12-29 06:29:00,954 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-29T06:29:01.012951132Z [err]  [2025-12-29 06:29:00 +0000] [6] [INFO] Application startup complete.
2025-12-29T06:29:01.012955068Z [err]  2025-12-29 06:29:00,963 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-29T06:29:01.012959137Z [err]  2025-12-29 06:29:00,999 - comfort_noise - INFO - ‚úÖ Generated comfort noise sample: 30s (white=-83dB, hum=-93dB)
2025-12-29T06:29:01.051875056Z [err]  2025-12-29 06:29:01,049 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-29T06:29:01.051882611Z [err]  2025-12-29 06:29:01,049 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-29T06:29:01.051889459Z [err]  [2025-12-29 06:29:01 +0000] [5] [INFO] Application startup complete.
2025-12-29T06:29:01.090970685Z [err]  2025-12-29 06:29:01,083 - comfort_noise - INFO - ‚úÖ Generated mulaw comfort noise: 240000 bytes
2025-12-29T06:29:01.090976742Z [err]  2025-12-29 06:29:01,084 - server - INFO - ‚úÖ Mulaw comfort noise ready (240000 bytes)
2025-12-29T06:29:01.090983448Z [err]  [2025-12-29 06:29:01 +0000] [4] [INFO] Application startup complete.
2025-12-29T06:32:42.723947064Z [inf]  100.64.0.2:55974 - "GET /api/auth/me HTTP/1.1" 401
2025-12-29T06:33:22.846632518Z [inf]  100.64.0.3:56844 - "POST /api/auth/logout HTTP/1.1" 200
2025-12-29T06:33:23.713494823Z [inf]  100.64.0.3:56844 - "OPTIONS /api/auth/login HTTP/1.1" 200
2025-12-29T06:33:25.281447455Z [inf]  100.64.0.4:42088 - "POST /api/auth/login HTTP/1.1" 200
2025-12-29T06:33:26.144516306Z [inf]  100.64.0.4:42088 - "GET /api/agents HTTP/1.1" 200
2025-12-29T06:33:33.875135229Z [inf]  100.64.0.5:51194 - "GET /api/agents HTTP/1.1" 200
2025-12-29T06:33:53.849795957Z [inf]  100.64.0.6:40004 - "OPTIONS /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-29T06:33:53.849799487Z [err]  2025-12-29 06:33:51,921 - server - INFO - üåê Created WebSocket stream URL: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-29T06:33:53.849803355Z [err]  2025-12-29 06:33:52,096 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:33:53.849806998Z [err]  2025-12-29 06:33:52,183 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:33:53.849810872Z [err]  2025-12-29 06:33:52,205 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-29T06:33:53.849815625Z [err]  2025-12-29 06:33:52,205 - telnyx_service - INFO - üìû Initiating outbound call from +14048000152 to +17708336397
2025-12-29T06:33:53.849819622Z [err]  2025-12-29 06:33:52,205 - telnyx_service - INFO - ü§ñ Enabling AMD (premium mode)
2025-12-29T06:33:53.849823270Z [err]  2025-12-29 06:33:52,205 - telnyx_service - INFO - üåê Adding streaming parameters: wss://api.li-ai.org/api/telnyx/audio-stream
2025-12-29T06:33:53.849826937Z [err]  2025-12-29 06:33:52,818 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls "HTTP/1.1 200 OK"
2025-12-29T06:33:53.849830642Z [err]  2025-12-29 06:33:52,820 - telnyx_service - INFO - ‚úÖ Call initiated: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:33:53.849834955Z [err]  2025-12-29 06:33:52,923 - server - INFO - üìù Created call log: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:33:53.849839095Z [err]  2025-12-29 06:33:52,923 - server - INFO - üîç DEBUG Call Initiated Webhook (UI Trigger): url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-29T06:33:53.849842771Z [err]  2025-12-29 06:33:52,923 - server - INFO - üîç DEBUG Agent Settings Webhook Context: {'temperature': 0.2, 'max_tokens': 500, 'tts_speed': 1, 'llm_provider': 'grok', 'tts_provider': 'elevenlabs', 'stt_provider': 'soniox', 'enable_comfort_noise': True, 'dead_air_settings': {'silence_timeout_normal': 7, 'silence_timeout_hold_on': 25, 'max_checkins_before_disconnect': 2, 'max_call_duration': 1500, 'checkin_message': 'Are you still there?'}, 'voicemail_detection': {'enabled': True, 'use_telnyx_amd': True, 'telnyx_amd_mode': 'premium', 'use_llm_detection': True, 'disconnect_on_detection': True}, 'deepgram_settings': {'endpointing': 500, 'vad_turnoff': 250, 'utterance_end_ms': 1000, 'interim_results': True, 'smart_format': True}, 'elevenlabs_settings': {'voice_id': 'J5iaaqzR5zn6HFG4jV3b', 'model': 'eleven_turbo_v2_5', 'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'speed': 1.1, 'use_speaker_boost': True, 'enable_normalization': True, 'enable_ssml_parsing': True}, 'hume_settings': {'voice_name': 'e7af7ed6-3381-48aa-ab97-49485007470b', 'description': 'warm and friendly', 'speed': 1}, 'sesame_settings': {'speaker_id': 0, 'output_format': 'wav'}, 'melo_settings': {'voice': 'EN-US', 'speed': 1.2, 'clone_wav': None}, 'dia_settings': {'voice': 'S1', 'speed': 1, 'response_format': 'wav'}, 'kokoro_settings': {'voice': 'af_bella', 'speed': 1, 'response_format': 'mp3'}, 'chattts_settings': {'voice': 'female_1', 'speed': 1, 'temperature': 0.3, 'response_format': 'wav'}, 'assemblyai_settings': {'sample_rate': 8000, 'word_boost': [], 'enable_extra_session_information': True, 'disable_partial_transcripts': False, 'threshold': 0, 'end_of_turn_confidence_threshold': 0.8, 'min_end_of_turn_silence_when_confident': 500, 'max_turn_silence': 2000}, 'soniox_settings': {'model': 'stt-rt-v3', 'sample_rate': 8000, 'audio_format': 'mulaw', 'num_channels': 1, 'enable_endpoint_detection': True, 'enable_speaker_diarization': False, 'language_hints': ['en'], 'context': ''}, 'post_call_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'post_call_webhook_active': True, 'call_started_webhook_url': 'https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', 'call_started_webhook_active': True}
2025-12-29T06:33:53.853386500Z [err]  2025-12-29 06:33:52,923 - server - INFO - üîç DEBUG Call Initiated Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-29T06:33:53.853394823Z [err]  2025-12-29 06:33:52,923 - server - INFO - üì§ Sending call-initiated webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-29T06:33:53.853400208Z [err]  2025-12-29 06:33:52,954 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (TTL: 3600s)
2025-12-29T06:33:53.853404856Z [err]  2025-12-29 06:33:52,954 - server - INFO - üì¶ Call data stored in Redis and memory
2025-12-29T06:33:53.853410133Z [err]  2025-12-29 06:33:52,954 - server - INFO - üìû Outbound call initiated: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:33:53.853415355Z [inf]  100.64.0.6:40004 - "POST /api/telnyx/call/outbound HTTP/1.1" 200
2025-12-29T06:33:53.853419755Z [err]  2025-12-29 06:33:53,125 - server - INFO - üîåüîåüîå WEBSOCKET CONNECTION ATTEMPT
2025-12-29T06:33:53.853424626Z [err]  2025-12-29 06:33:53,125 - server - INFO -    Client: Address(host='100.64.0.7', port=41666)
2025-12-29T06:33:53.853430075Z [err]  2025-12-29 06:33:53,125 - server - INFO -    Headers: {'host': 'api.li-ai.org', 'user-agent': 'telnyx-websocket', 'connection': 'Upgrade', 'sec-websocket-key': '6DCatbGTecuTU2xGW9TD5A==', 'sec-websocket-version': '13', 'upgrade': 'websocket', 'x-forwarded-for': '192.76.120.151', 'x-forwarded-host': 'api.li-ai.org', 'x-forwarded-proto': 'https', 'x-railway-edge': 'railway/us-west2', 'x-railway-request-id': 'PhYF0w7RQcabepUMLPU1MQ', 'x-real-ip': '192.76.120.151', 'x-request-start': '1766990032894', 'accept-encoding': 'gzip'}
2025-12-29T06:33:53.853434515Z [err]  2025-12-29 06:33:53,125 - server - INFO -    Path: /api/telnyx/audio-stream
2025-12-29T06:33:53.853438850Z [err]  2025-12-29 06:33:53,125 - server - INFO - üîå Incoming Telnyx WebSocket connection
2025-12-29T06:33:53.853443235Z [err]  [2025-12-29 06:33:53 +0000] [6] [INFO] ('100.64.0.7', 41666) - "WebSocket /api/telnyx/audio-stream" [accepted]
2025-12-29T06:33:53.853448033Z [err]  2025-12-29 06:33:53,125 - server - INFO - ‚úÖ WebSocket accepted, waiting for Telnyx events
2025-12-29T06:33:53.853451983Z [err]  [2025-12-29 06:33:53 +0000] [6] [INFO] connection open
2025-12-29T06:33:53.853458072Z [err]  2025-12-29 06:33:53,284 - server - INFO - üì¨ Received Telnyx event: connected
2025-12-29T06:33:53.853465117Z [err]  2025-12-29 06:33:53,284 - server - INFO - üìû Telnyx connected event received, waiting for 'start'...
2025-12-29T06:33:53.853472054Z [err]  2025-12-29 06:33:53,367 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:33:53.853478835Z [inf]  100.64.0.8:31114 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:33:53.853485902Z [err]  2025-12-29 06:33:53,367 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.initiated', 'id': '74781292-ff57-4c18-a85d-1558e604b664', 'occurred_at': '2025-12-29T06:33:52.699118Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'direction': 'outgoing', 'from': '+14048000152', 'state': 'bridging', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:33:53.853492925Z [err]  2025-12-29 06:33:53,367 - server - INFO - üéØ Event type: call.initiated, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:33:53.853499685Z [err]  2025-12-29 06:33:53,367 - server - INFO - üì® ================================================
2025-12-29T06:33:53.853506501Z [err]  2025-12-29 06:33:53,367 - server - INFO - üìû Call initiated - Direction: outgoing, From: +14048000152, To: +17708336397
2025-12-29T06:33:53.853510745Z [err]  2025-12-29 06:33:53,437 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-29T06:33:53.853515083Z [err]  2025-12-29 06:33:53,438 - server - INFO - ‚úÖ Call-initiated webhook sent successfully (status=200)
2025-12-29T06:34:02.339335321Z [err]  2025-12-29 06:34:02,163 - server - INFO - üì¨ Received Telnyx event: start
2025-12-29T06:34:02.339339107Z [err]  2025-12-29 06:34:02,163 - server - INFO - üé¨ Stream started for call: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.339343023Z [err]  2025-12-29 06:34:02,198 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.339346718Z [err]  2025-12-29 06:34:02,199 - server - INFO - ‚úÖ Call data found after 0s wait
2025-12-29T06:34:02.339351530Z [err]  2025-12-29 06:34:02,199 - server - INFO - ‚è≥ Session not found locally, waiting briefly for webhook...
2025-12-29T06:34:02.578249785Z [err]  2025-12-29 06:34:02,570 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:02.578257075Z [err]  2025-12-29 06:34:02,571 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.answered', 'id': '48af0ce5-7600-4c9e-b4af-c7f19898ce50', 'occurred_at': '2025-12-29T06:34:01.959110Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'codec': 'PCMU', 'connection_id': '2777245537294877821', 'from': '+14048000152', 'sampling_rate': 8000, 'start_time': '2025-12-29T06:33:52.699118Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:02.578261770Z [err]  2025-12-29 06:34:02,571 - server - INFO - üéØ Event type: call.answered, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.578267260Z [err]  2025-12-29 06:34:02,571 - server - INFO - üì® ================================================
2025-12-29T06:34:02.578272223Z [err]  2025-12-29 06:34:02,571 - server - INFO - ‚úÖ Call answered: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.617885265Z [err]  2025-12-29 06:34:02,604 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.617893949Z [err]  2025-12-29 06:34:02,604 - server - INFO - ‚úÖ Found call in Redis (multi-worker state sharing working)
2025-12-29T06:34:02.617900357Z [err]  2025-12-29 06:34:02,605 - server - INFO - üìû Phone numbers added to session: from=+14048000152, to=+17708336397
2025-12-29T06:34:02.721237395Z [err]  2025-12-29 06:34:02,700 - server - INFO - ‚ö†Ô∏è Session still not found after wait, will create in worker
2025-12-29T06:34:02.721249302Z [err]  2025-12-29 06:34:02,700 - server - WARNING - ‚ö†Ô∏è Session not found after waiting, creating in WebSocket worker...
2025-12-29T06:34:02.721257327Z [err]  2025-12-29 06:34:02,711 - server - INFO - ‚úÖ Call log updated
2025-12-29T06:34:02.721268675Z [err]  2025-12-29 06:34:02,711 - server - INFO - üîç DEBUG Webhook: url='https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b', active=True, should_fire=True
2025-12-29T06:34:02.721275581Z [err]  2025-12-29 06:34:02,711 - server - INFO - üì§ Sending call-started webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-29T06:34:02.721283532Z [err]  2025-12-29 06:34:02,711 - server - INFO - üîß Getting Telnyx API keys for user: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-29T06:34:02.721291621Z [err]  2025-12-29 06:34:02,717 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.721298205Z [err]  2025-12-29 06:34:02,718 - server - INFO - üìù Creating session with agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-29T06:34:02.721305658Z [err]  2025-12-29 06:34:02,718 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-29T06:34:02.794476879Z [err]  2025-12-29 06:34:02,776 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:02.794488600Z [err]  2025-12-29 06:34:02,776 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.started', 'id': '28e8fa46-984d-4420-9781-cae090e26d19', 'occurred_at': '2025-12-29T06:34:02.319107Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '8405acc8-87e1-43ae-830d-2799f0e9bb6b', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:02.794496427Z [err]  2025-12-29 06:34:02,776 - server - INFO - üéØ Event type: streaming.started, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:02.794504660Z [err]  2025-12-29 06:34:02,776 - server - INFO - üì® ================================================
2025-12-29T06:34:02.794513449Z [inf]  100.64.0.10:26842 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:02.805286049Z [err]  2025-12-29 06:34:02,801 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:02.820735481Z [err]  2025-12-29 06:34:02,818 - core_calling_service - INFO - üîç KB count query completed: 4 items
2025-12-29T06:34:02.820743195Z [err]  2025-12-29 06:34:02,818 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-29T06:34:02.841818541Z [err]  2025-12-29 06:34:02,832 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-29T06:34:02.841826477Z [err]  2025-12-29 06:34:02,832 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-29T06:34:02.841832072Z [err]  2025-12-29 06:34:02,833 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-29T06:34:02.916364409Z [err]  2025-12-29 06:34:02,887 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:02.916368687Z [err]  2025-12-29 06:34:02,887 - server - INFO - üîß Creating Telnyx service with user's keys...
2025-12-29T06:34:02.916375231Z [err]  2025-12-29 06:34:02,910 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-29T06:34:02.925748199Z [err]  2025-12-29 06:34:02,921 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:02.934979969Z [err]  2025-12-29 06:34:02,934 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 100ms
2025-12-29T06:34:02.934989675Z [err]  2025-12-29 06:34:02,934 - server - INFO - ‚úÖ Session created in WebSocket worker
2025-12-29T06:34:02.934997222Z [err]  2025-12-29 06:34:02,934 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Scheduling silence timeout: 2000ms
2025-12-29T06:34:02.935004733Z [err]  2025-12-29 06:34:02,934 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task scheduled!
2025-12-29T06:34:02.935011430Z [err]  2025-12-29 06:34:02,934 - server - INFO - üìû Call data loaded, starting SONIOX connection...
2025-12-29T06:34:02.939766463Z [err]  2025-12-29 06:34:02,935 - server - INFO - ‚úÖ Initialized call_states for v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ with session reference
2025-12-29T06:34:02.944426792Z [err]  2025-12-29 06:34:02,942 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout task started, waiting 2000ms...
2025-12-29T06:34:03.039888123Z [err]  2025-12-29 06:34:03,024 - server - INFO - üîë Using user's Soniox API key (first 10 chars): b999f22d7b...
2025-12-29T06:34:03.100690307Z [err]  2025-12-29 06:34:03,095 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-29T06:34:03.100697532Z [err]  2025-12-29 06:34:03,096 - server - INFO - ‚úÖ Call-started webhook sent successfully (status=200)
2025-12-29T06:34:03.174122460Z [err]  2025-12-29 06:34:03,173 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ/actions/playback_start "HTTP/1.1 200 OK"
2025-12-29T06:34:03.174883964Z [err]  2025-12-29 06:34:03,174 - telnyx_service - INFO - ‚úÖ Playing audio from URL, playback_id: w-ZBgQcpXQ (loop=True, overlay=True)
2025-12-29T06:34:03.174889304Z [err]  2025-12-29 06:34:03,174 - server - WARNING - ‚ö†Ô∏è Failed to start comfort noise: 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ'
2025-12-29T06:34:03.174893218Z [err]  2025-12-29 06:34:03,174 - telnyx_service - INFO - üéôÔ∏è Starting recording: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.460636133Z [err]  2025-12-29 06:34:03,438 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:03.460649357Z [err]  2025-12-29 06:34:03,438 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': 'cde02dd7-b939-4846-986b-d8d120722d4c', 'occurred_at': '2025-12-29T06:34:03.159114Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'w-ZBgQcpXQ', 'start_time': '2025-12-29T06:34:03.159114Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:03.460657608Z [err]  2025-12-29 06:34:03,438 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.460668874Z [err]  2025-12-29 06:34:03,438 - server - INFO - üì® ================================================
2025-12-29T06:34:03.460676159Z [inf]  100.64.0.8:60756 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:03.561838668Z [err]  2025-12-29 06:34:03,554 - soniox_service - INFO - ‚úÖ Connected to Soniox Real-Time STT
2025-12-29T06:34:03.561845702Z [err]  2025-12-29 06:34:03,554 - soniox_service - INFO - ‚öôÔ∏è  Config: model=stt-rt-v3, format=mulaw, rate=8000Hz, channels=1
2025-12-29T06:34:03.561854324Z [err]  2025-12-29 06:34:03,554 - soniox_service - INFO - ‚öôÔ∏è  Endpoint detection: True, Speaker diarization: False
2025-12-29T06:34:03.573481502Z [err]  2025-12-29 06:34:03,567 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ/actions/record_start "HTTP/1.1 200 OK"
2025-12-29T06:34:03.573493259Z [err]  2025-12-29 06:34:03,569 - server - INFO - üéôÔ∏è Call recording started for v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.573502732Z [err]  2025-12-29 06:34:03,569 - server - INFO - üîß Creating call session for v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ...
2025-12-29T06:34:03.573510058Z [err]  2025-12-29 06:34:03,569 - server - INFO - üîç Agent ID: bbeda238-e8d9-4d8c-b93b-1b7694581adb, User ID: dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-29T06:34:03.573518577Z [err]  2025-12-29 06:34:03,569 - server - INFO - üîß Calling create_call_session() - START
2025-12-29T06:34:03.573526538Z [err]  2025-12-29 06:34:03,569 - core_calling_service - INFO - üîç Checking KB for agent bbeda238-e8d9-4d8c-b93b-1b7694581adb...
2025-12-29T06:34:03.589793433Z [err]  2025-12-29 06:34:03,584 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-29T06:34:03.589799000Z [err]  2025-12-29 06:34:03,584 - dead_air_monitor - INFO - üîá Dead air monitoring started for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.591116017Z [err]  2025-12-29 06:34:03,590 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:03.591917400Z [err]  2025-12-29 06:34:03,590 - server - INFO - ‚úÖ Started forwarding audio (8kHz mulaw ‚Üí Soniox, NO BUFFERING)
2025-12-29T06:34:03.666636142Z [err]  2025-12-29 06:34:03,656 - core_calling_service - INFO - üîç KB count query completed: 4 items
2025-12-29T06:34:03.666644491Z [err]  2025-12-29 06:34:03,656 - core_calling_service - INFO - üìö Agent bbeda238-e8d9-4d8c-b93b-1b7694581adb has 4 KB items - Smart routing enabled (RAG on demand)
2025-12-29T06:34:03.678047567Z [err]  2025-12-29 06:34:03,671 - core_calling_service - INFO - üìã Built cached system prompt: 5065 chars (global) + 1402 chars (technical)
2025-12-29T06:34:03.678056262Z [err]  2025-12-29 06:34:03,671 - core_calling_service - INFO - üìö KB available - will use smart routing (simple chat: NO KB, factual: WITH KB)
2025-12-29T06:34:03.678063241Z [err]  2025-12-29 06:34:03,672 - core_calling_service - INFO - üî• Pre-warming LLM client (grok)...
2025-12-29T06:34:03.773165176Z [err]  2025-12-29 06:34:03,758 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:03.773173325Z [err]  2025-12-29 06:34:03,766 - core_calling_service - INFO - ‚úÖ LLM client pre-warmed in 94ms
2025-12-29T06:34:03.773180467Z [err]  2025-12-29 06:34:03,766 - server - INFO - üîß Calling create_call_session() - COMPLETE
2025-12-29T06:34:03.773186909Z [err]  2025-12-29 06:34:03,766 - server - INFO - ‚úÖ Session object created: CallSession
2025-12-29T06:34:03.813041270Z [err]  2025-12-29 06:34:03,795 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (TTL: 3600s)
2025-12-29T06:34:03.813048200Z [err]  2025-12-29 06:34:03,802 - server - INFO - üé§ Voice flow - streaming started via dial command
2025-12-29T06:34:03.813052969Z [err]  2025-12-29 06:34:03,795 - server - INFO - ‚úÖ Serializable call_data synced to Redis (agent_id, user_id)
2025-12-29T06:34:03.813059763Z [err]  2025-12-29 06:34:03,795 - server - INFO - ‚úÖ Session stored in worker memory (not Redis)
2025-12-29T06:34:03.813065885Z [err]  2025-12-29 06:34:03,801 - redis_service - INFO - ‚úÖ Marked session ready in Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.813070339Z [err]  2025-12-29 06:34:03,801 - server - INFO - ü§ñ AI session created for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.813074061Z [err]  2025-12-29 06:34:03,801 - server - INFO - üì¶ Custom variables injected: {'lead_id': None, 'qc_tracking_enabled': False, 'track_keywords': '', 'expected_commitment': 'not_specified', 'customer_name': 'Kendrick', 'to_number': '+17708336397', 'phone_number': '+17708336397', 'email': None, 'from_number': '+14048000152'}
2025-12-29T06:34:03.813078119Z [err]  2025-12-29 06:34:03,801 - server - INFO - ‚è≠Ô∏è Skipping persistent TTS creation in webhook - will create on-demand with telnyx_ws
2025-12-29T06:34:03.813081997Z [err]  2025-12-29 06:34:03,801 - server - INFO - üë§ Who speaks first: user, aiSpeaksAfterSilence: True, timeout: 2000ms
2025-12-29T06:34:03.813086571Z [err]  2025-12-29 06:34:03,801 - server - INFO - üëÇ User speaks first - waiting for user input...
2025-12-29T06:34:03.813091939Z [err]  2025-12-29 06:34:03,801 - server - INFO - üõ°Ô∏è Voicemail timeout protection started (15000ms)
2025-12-29T06:34:03.813098029Z [err]  2025-12-29 06:34:03,801 - server - INFO - ‚è±Ô∏è AI will speak after 2000ms of silence (scheduled in WebSocket worker)
2025-12-29T06:34:03.834471104Z [err]  2025-12-29 06:34:03,829 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:03.834479447Z [err]  2025-12-29 06:34:03,830 - server - INFO - ü§ê No greeting - waiting for user to speak first
2025-12-29T06:34:03.834486483Z [err]  2025-12-29 06:34:03,830 - server - INFO - üé§ Voice flow - WebSocket streaming already initiated
2025-12-29T06:34:03.834492875Z [inf]  100.64.0.9:42624 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:04.112201519Z [err]  2025-12-29 06:34:04,096 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:04.642119976Z [err]  2025-12-29 06:34:04,602 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:04.989093191Z [err]  2025-12-29 06:34:04,970 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:04.989097993Z [err]  2025-12-29 06:34:04,979 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.010924009Z [err]  2025-12-29 06:34:05,009 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (TTL: 3600s)
2025-12-29T06:34:05.010931774Z [err]  2025-12-29 06:34:05,009 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence timeout reached - generating greeting!
2025-12-29T06:34:05.010937398Z [err]  2025-12-29 06:34:05,009 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.009] üì• process_user_input() ENTRY - text: '...'
2025-12-29T06:34:05.023502624Z [err]  2025-12-29 06:34:05,018 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.023509076Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.019] ‚è© About to call _process_call_flow_streaming()
2025-12-29T06:34:05.023513822Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.019] üîÄ Agent type: call_flow, calling flow processor...
2025-12-29T06:34:05.023518350Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.019] üîÄ _process_call_flow_streaming() ENTRY
2025-12-29T06:34:05.023522106Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - Flow processing - History length: 1, Is first: True
2025-12-29T06:34:05.023526531Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.019] ‚úÖ Node selected, about to process content...
2025-12-29T06:34:05.023530429Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{now}} with Monday, December 29, 2025 at 1:34 AM EST in content
2025-12-29T06:34:05.023538968Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-29T06:34:05.023542998Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-29T06:34:05.023547619Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-29T06:34:05.023552080Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-29T06:34:05.023555967Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-29T06:34:05.023560306Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-29T06:34:05.024777368Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - LLM response (0.01s): Kendrick?
2025-12-29T06:34:05.024781691Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-29T06:34:05.024782435Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - Total latency: 0.01s
2025-12-29T06:34:05.024787755Z [err]  2025-12-29 06:34:05,020 - server - INFO - üí¨ [WebSocket Worker] AI speaks after silence: Kendrick?
2025-12-29T06:34:05.024790188Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-29T06:34:05.024796491Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîä Silence tracking reset for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (user responded)
2025-12-29T06:34:05.024797128Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-29T06:34:05.024802052Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-29T06:34:05.024803182Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-29T06:34:05.024807468Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-29T06:34:05.024809324Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-29T06:34:05.024814816Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-29T06:34:05.024819278Z [err]  2025-12-29 06:34:05,019 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.019] üìÑ About to process content (mode=script, length=9)
2025-12-29T06:34:05.025648891Z [err]  2025-12-29 06:34:05,020 - server - INFO - üî§ RAW TOKENS: ["Hell"?]
2025-12-29T06:34:05.025657876Z [err]  2025-12-29 06:34:05,024 - core_calling_service - INFO - üîä Silence timer reset for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (user started speaking)
2025-12-29T06:34:05.025665069Z [err]  2025-12-29 06:34:05,024 - core_calling_service - INFO - üë§ User started speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.025672919Z [err]  2025-12-29 06:34:05,024 - server - WARNING - Failed to update user_has_spoken in Redis: cannot access local variable 'redis_svc' where it is not associated with a value
2025-12-29T06:34:05.025679462Z [err]  2025-12-29 06:34:05,025 - server - INFO - üîç PARTIAL TRANSCRIPT: 'Hell' | Generating: False
2025-12-29T06:34:05.111580234Z [err]  2025-12-29 06:34:05,109 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.124646753Z [err]  2025-12-29 06:34:05,120 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.124660013Z [err]  2025-12-29 06:34:05,121 - telnyx_service - INFO - üîä Speaking text on call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ: Kendrick?...
2025-12-29T06:34:05.124666963Z [err]  2025-12-29 06:34:05,121 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-29T06:34:05.124675909Z [err]  2025-12-29 06:34:05,121 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-29T06:34:05.124681939Z [err]  2025-12-29 06:34:05,121 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-29T06:34:05.124689205Z [err]  2025-12-29 06:34:05,121 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-29T06:34:05.124695711Z [err]  2025-12-29 06:34:05,121 - server - INFO - ‚è±Ô∏è [06:34:05.121] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-29T06:34:05.124701233Z [err]  2025-12-29 06:34:05,121 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-29T06:34:05.124709457Z [err]  2025-12-29 06:34:05,121 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-29T06:34:05.402324910Z [err]  2025-12-29 06:34:05,208 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:05.402330579Z [err]  2025-12-29 06:34:05,208 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-29T06:34:05.402335762Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Text length: 9 chars
2025-12-29T06:34:05.402341493Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Text content: 'Kendrick?'
2025-12-29T06:34:05.402355692Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Text bytes: b'Kendrick?'
2025-12-29T06:34:05.402361298Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-29T06:34:05.402368778Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-29T06:34:05.402374380Z [err]  2025-12-29 06:34:05,208 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-29T06:34:05.402380391Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Full data: {'text': 'Kendrick?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-29T06:34:05.402384871Z [err]  2025-12-29 06:34:05,208 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-29T06:34:05.402390192Z [err]  2025-12-29 06:34:05,208 - server - INFO -    Timeout: 10.0s
2025-12-29T06:34:05.402394967Z [err]  2025-12-29 06:34:05,216 - server - INFO -    ‚úì HTTP client created (0.007s)
2025-12-29T06:34:05.402400298Z [err]  2025-12-29 06:34:05,216 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-29T06:34:05.402404316Z [err]  2025-12-29 06:34:05,217 - server - INFO - üî§ RAW TOKENS: ["Hell"‚úì, "o."‚úì, "<end>"‚úì]
2025-12-29T06:34:05.402408326Z [err]  2025-12-29 06:34:05,217 - server - INFO - üéØ Endpoint detected: <end> token received
2025-12-29T06:34:05.403267864Z [err]  2025-12-29 06:34:05,224 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (TTL: 3600s)
2025-12-29T06:34:05.403276045Z [err]  2025-12-29 06:34:05,224 - server - INFO - üë§ User has spoken - aiSpeaksAfterSilence timer cancelled if pending
2025-12-29T06:34:05.403283660Z [err]  2025-12-29 06:34:05,217 - server - INFO - üì• FINAL TOKENS: 'Hell o.' (2 tokens)
2025-12-29T06:34:05.403285230Z [err]  2025-12-29 06:34:05,224 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.403296342Z [err]  2025-12-29 06:34:05,217 - server - INFO - üé§ Soniox final transcript: 'Hell o.'
2025-12-29T06:34:05.403303533Z [err]  2025-12-29 06:34:05,218 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.403310973Z [err]  2025-12-29 06:34:05,218 - server - INFO - üîç FILTER CHECK: words=2, is_filler=False, is_garbled=False, tts_speaking=False, time_until_done=0.0s, generating=False, playbacks=0, is_active=False
2025-12-29T06:34:05.403320225Z [err]  2025-12-29 06:34:05,218 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.403327591Z [err]  2025-12-29 06:34:05,218 - server - INFO - üöÄ Spawned tracked background task for endpoint processing
2025-12-29T06:34:05.403335175Z [err]  2025-12-29 06:34:05,218 - server - INFO - ‚è±Ô∏è [06:34:05.218] üìù FINAL TRANSCRIPT RECEIVED: 'Hell o.'
2025-12-29T06:34:05.403342804Z [err]  2025-12-29 06:34:05,218 - server - INFO - ‚è±Ô∏è [06:34:05.218] STT endpoint detection latency: 20ms
2025-12-29T06:34:05.403350522Z [err]  2025-12-29 06:34:05,218 - server - INFO - ‚è±Ô∏è [06:34:05.218] üé§ USER STOPPED SPEAKING - Beginning processing pipeline
2025-12-29T06:34:05.403979228Z [err]  2025-12-29 06:34:05,224 - server - INFO - ‚úÖ Agent SILENT - User said 2 word(s): 'Hell o.' - Processing...
2025-12-29T06:34:05.403987832Z [err]  2025-12-29 06:34:05,235 - server - INFO - üé§ Endpoint detected by Soniox - processing transcript: Hell o.
2025-12-29T06:34:05.403994458Z [err]  2025-12-29 06:34:05,235 - core_calling_service - INFO - üë§ User stopped speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.403999660Z [err]  2025-12-29 06:34:05,235 - server - INFO - ‚è±Ô∏è [TIMING] STT_START: User last audio packet received
2025-12-29T06:34:05.404004219Z [err]  2025-12-29 06:34:05,235 - server - INFO - ‚è±Ô∏è [TIMING] STT_END: Endpoint detected at T+10ms
2025-12-29T06:34:05.404008553Z [err]  2025-12-29 06:34:05,235 - server - INFO - ‚è±Ô∏è [TIMING] STT_LATENCY: 10ms (Soniox model: stt-rt-v3)
2025-12-29T06:34:05.404012708Z [err]  2025-12-29 06:34:05,235 - server - INFO - ‚è±Ô∏è  USER STOPPED SPEAKING at T=0ms
2025-12-29T06:34:05.404016312Z [err]  2025-12-29 06:34:05,235 - server - INFO - üéôÔ∏è Agent generating response - interruption detection active
2025-12-29T06:34:05.404020326Z [err]  2025-12-29 06:34:05,235 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.404023947Z [err]  2025-12-29 06:34:05,328 - server - INFO - üìù Saved user transcript to database
2025-12-29T06:34:05.404033796Z [err]  2025-12-29 06:34:05,328 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.404038930Z [err]  2025-12-29 06:34:05,328 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.328] üì• process_user_input() ENTRY - text: 'Hell o....'
2025-12-29T06:34:05.404043366Z [err]  2025-12-29 06:34:05,334 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.404726586Z [err]  2025-12-29 06:34:05,334 - core_calling_service - WARNING - üö® BARGE-IN DETECTED for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ: User spoke while Silence Greeting was triggering
2025-12-29T06:34:05.404734322Z [err]  2025-12-29 06:34:05,358 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-29T06:34:05.404738117Z [err]  2025-12-29 06:34:05,358 - telnyx_service - INFO - üõë Stopping audio playback on call: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.559253233Z [err]  2025-12-29 06:34:05,555 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-29T06:34:05.559257852Z [err]  2025-12-29 06:34:05,555 - server - INFO -    ‚úì Connection established (0.347s) [TARGET: <200ms]
2025-12-29T06:34:05.559262770Z [err]  2025-12-29 06:34:05,555 - server - INFO -    ‚úì Response status: 200
2025-12-29T06:34:05.559267426Z [err]  2025-12-29 06:34:05,555 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-29T06:34:05.564959972Z [err]  2025-12-29 06:34:05,563 - server - INFO -    ‚úì FIRST CHUNK received (0.355s, 1012 bytes) [TARGET: <300ms]
2025-12-29T06:34:05.565893287Z [err]  2025-12-29 06:34:05,565 - server - INFO -    ‚úì ALL CHUNKS received: 59 chunks (0.356s)
2025-12-29T06:34:05.565913355Z [err]  2025-12-29 06:34:05,565 - server - INFO -    ‚úì Total audio size: 13837 bytes
2025-12-29T06:34:05.565920843Z [err]  2025-12-29 06:34:05,565 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-29T06:34:05.565930038Z [err]  2025-12-29 06:34:05,565 - server - INFO -       - Connection: 347ms
2025-12-29T06:34:05.565940156Z [err]  2025-12-29 06:34:05,565 - server - INFO -       - First chunk: 355ms
2025-12-29T06:34:05.565948347Z [err]  2025-12-29 06:34:05,565 - server - INFO -       - All chunks: 356ms
2025-12-29T06:34:05.565956340Z [err]  2025-12-29 06:34:05,565 - server - INFO -       - Audio generation only: 8ms
2025-12-29T06:34:05.566833122Z [err]  2025-12-29 06:34:05,565 - server - INFO - ‚è±Ô∏è [06:34:05.565] üîä TTS COMPLETE: 443ms, audio_size=13837 bytes
2025-12-29T06:34:05.566839100Z [err]  2025-12-29 06:34:05,565 - server - INFO - üíæ TTS CACHED: elevenlabs:Kendrick?... (13837 bytes)
2025-12-29T06:34:05.566843189Z [err]  2025-12-29 06:34:05,565 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.44s
2025-12-29T06:34:05.566847649Z [err]  2025-12-29 06:34:05,565 - telnyx_service - INFO - ‚úÖ Generated 13837 bytes, saved to /tmp/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-29T06:34:05.566851399Z [err]  2025-12-29 06:34:05,565 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3
2025-12-29T06:34:05.630853636Z [err]  2025-12-29 06:34:05,620 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.630859882Z [err]  2025-12-29 06:34:05,620 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:05.691226907Z [err]  2025-12-29 06:34:05,687 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ/actions/playback_stop "HTTP/1.1 200 OK"
2025-12-29T06:34:05.691235652Z [err]  2025-12-29 06:34:05,687 - telnyx_service - INFO - ‚úÖ Successfully stopped audio playback
2025-12-29T06:34:05.691242068Z [err]  2025-12-29 06:34:05,687 - core_calling_service - INFO - ‚úÖ BARGE-IN: Audio playback STOPPED
2025-12-29T06:34:05.691250802Z [err]  2025-12-29 06:34:05,687 - core_calling_service - INFO - ‚úÖ BARGE-IN: Preserving silence greeting in history to maintain context
2025-12-29T06:34:05.696384643Z [err]  2025-12-29 06:34:05,693 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.701495090Z [err]  2025-12-29 06:34:05,698 - redis_service - INFO - üì¶ Stored call data in Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (TTL: 3600s)
2025-12-29T06:34:05.701495630Z [err]  2025-12-29 06:34:05,699 - core_calling_service - WARNING - ‚ö†Ô∏è Auto-transition after response target not found: None, falling back to normal evaluation
2025-12-29T06:34:05.701502393Z [err]  2025-12-29 06:34:05,698 - core_calling_service - INFO - ‚úÖ BARGE-IN: Reset silence_greeting_triggered flag
2025-12-29T06:34:05.701507145Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.699] ‚è© About to call _process_call_flow_streaming()
2025-12-29T06:34:05.701511120Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.699] üîÄ Agent type: call_flow, calling flow processor...
2025-12-29T06:34:05.701515891Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.699] üîÄ _process_call_flow_streaming() ENTRY
2025-12-29T06:34:05.701519631Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - Flow processing - History length: 3, Is first: False
2025-12-29T06:34:05.701523650Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - üîç Using explicitly set current_node_id: 2
2025-12-29T06:34:05.701527343Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.699] üîÄ About to call _follow_transition() for: Hell o....
2025-12-29T06:34:05.701531457Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - Evaluating transitions from Greeting for message: Hell o.
2025-12-29T06:34:05.701535990Z [err]  2025-12-29 06:34:05,699 - core_calling_service - INFO - üîç Checking 'Hello=Yes' override [DEPLOYMENT VERIFIED] for msg='hell o' on node='Greeting'
2025-12-29T06:34:05.712458503Z [err]  2025-12-29 06:34:05,706 - core_calling_service - INFO - ‚è±Ô∏è [06:34:05.706] üîÄ TRANSITION EVALUATION START - Calling LLM for 2 options
2025-12-29T06:34:05.893651031Z [err]  2025-12-29 06:34:05,872 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ/actions/playback_start "HTTP/1.1 200 OK"
2025-12-29T06:34:05.893658478Z [err]  2025-12-29 06:34:05,873 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.31s
2025-12-29T06:34:05.893662134Z [err]  2025-12-29 06:34:05,873 - telnyx_service - INFO - ‚è±Ô∏è  Total TTS latency: 0.75s
2025-12-29T06:34:05.893666215Z [err]  2025-12-29 06:34:05,873 - telnyx_service - INFO - ‚úÖ Playing elevenlabs audio via Telnyx playback
2025-12-29T06:34:05.893670234Z [err]  2025-12-29 06:34:05,873 - telnyx_service - INFO - üé¨ Playback ID: kokrxROTAw
2025-12-29T06:34:05.893674080Z [err]  2025-12-29 06:34:05,873 - server - INFO - üîä [WebSocket Worker] Silence greeting spoken via Telnyx TTS
2025-12-29T06:34:05.893678558Z [err]  2025-12-29 06:34:05,874 - server - INFO - ‚è±Ô∏è [WebSocket Worker] Silence tracking started for dead air monitoring
2025-12-29T06:34:05.967571078Z [err]  2025-12-29 06:34:05,936 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:05.967578655Z [err]  2025-12-29 06:34:05,936 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.machine.premium.detection.ended', 'id': '762da443-2c13-4b28-aafe-f0a99df31989', 'occurred_at': '2025-12-29T06:34:05.799119Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'from': '+14048000152', 'result': 'human_residence', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:05.967584745Z [err]  2025-12-29 06:34:05,936 - server - INFO - üéØ Event type: call.machine.premium.detection.ended, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:05.967590464Z [err]  2025-12-29 06:34:05,937 - server - INFO - üì® ================================================
2025-12-29T06:34:05.967595713Z [inf]  100.64.0.10:26842 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:06.136265410Z [inf]  100.64.0.9:42624 - "GET /api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3 HTTP/1.1" 200
2025-12-29T06:34:06.136269743Z [err]  2025-12-29 06:34:06,132 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:06.136273214Z [err]  2025-12-29 06:34:06,132 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:06.394507612Z [err]  2025-12-29 06:34:06,387 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-29T06:34:06.394518911Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - ‚è±Ô∏è [06:34:06.393] üîÄ TRANSITION EVALUATION COMPLETE - took 686ms
2025-12-29T06:34:06.394526888Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - ü§ñ AI transition decision: '-1'
2025-12-29T06:34:06.394533802Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - üìä Available transitions: ['Confirms name (Yes|Speaking|This is he/she) OR Ask...', 'Wrong number (No John here|Wrong number|etc) - don...']
2025-12-29T06:34:06.395598352Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - Selected transition index: -1
2025-12-29T06:34:06.395609079Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - No specific condition matched, looking for default transition...
2025-12-29T06:34:06.395610370Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{qc_tracking_enabled}} with False in content
2025-12-29T06:34:06.395618008Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - ‚ö†Ô∏è No transition matched, but node has GOAL. Staying on current node to continue with goal-based guidance.
2025-12-29T06:34:06.395618328Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{track_keywords}} with  in content
2025-12-29T06:34:06.395623639Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{expected_commitment}} with not_specified in content
2025-12-29T06:34:06.395629354Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - üéØ Goal: Say the customer's name...
2025-12-29T06:34:06.395636773Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - ‚è±Ô∏è [TIMING] TRANSITION_EVAL: 694ms
2025-12-29T06:34:06.395652395Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - ‚è±Ô∏è [06:34:06.393] ‚úÖ Node selected, about to process content...
2025-12-29T06:34:06.395661726Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - üîß Replaced {{now}} with Monday, December 29, 2025 at 1:34 AM EST in content
2025-12-29T06:34:06.395669118Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - üîß Replaced {{customer_name}} with Kendrick in content
2025-12-29T06:34:06.395675942Z [err]  2025-12-29 06:34:06,393 - core_calling_service - INFO - üîß Replaced {{callerName}} with  in content
2025-12-29T06:34:06.395682714Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{lead_id}} with None in content
2025-12-29T06:34:06.396641114Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{to_number}} with +17708336397 in content
2025-12-29T06:34:06.396657268Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{phone_number}} with +17708336397 in content
2025-12-29T06:34:06.396663493Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üîß Replaced {{email}} with None in content
2025-12-29T06:34:06.396669802Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - ‚úÖ Using explicit SCRIPT mode (length: 9 chars) - will return text instantly
2025-12-29T06:34:06.396676111Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - Using flow node: Greeting (type: conversation, mode: script)
2025-12-29T06:34:06.396682988Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üìö skip_mandatory_precheck=true - skipping pre-response mandatory check, will check on transition
2025-12-29T06:34:06.396689173Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - ‚è±Ô∏è [06:34:06.394] üìÑ About to process content (mode=script, length=9)
2025-12-29T06:34:06.396696153Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - üõ°Ô∏è Preventing Dead Air: User stayed on script node 'Greeting' without transition
2025-12-29T06:34:06.396702469Z [err]  2025-12-29 06:34:06,394 - core_calling_service - INFO - ü§ñ Generating sticky-prevention response...
2025-12-29T06:34:06.408832812Z [err]  
2025-12-29T06:34:06.408833943Z [err]  2025-12-29 06:34:06,401 - core_calling_service - INFO - ‚ö° PARALLEL MODE: Running KB + analysis simultaneously
2025-12-29T06:34:06.408844322Z [err]  If user asks to repeat info, rephrase naturally‚Äînever exact repeat.
2025-12-29T06:34:06.408846879Z [err]  2025-12-29 06:34:06,403 - kb_router - INFO - üö¶ KB Router: SKIP (short message: 2 words)
2025-12-29T06:34:06.408855114Z [err]  2025-12-29 06:34:06,403 - core_calling_service - INFO - ‚ö° Skipping KB (reason: short_message)
2025-12-29T06:34:06.408861530Z [err]  2025-12-29 06:34:06,403 - core_calling_service - INFO - ‚ö° Parallel operations completed in 1ms
2025-12-29T06:34:06.408870469Z [err]  2025-12-29 06:34:06,403 - core_calling_service - INFO - üîç Node 'Greeting': use_parallel_llm=True
2025-12-29T06:34:06.408875664Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - ‚ö° Parallel mode: Using condensed history (3/3 messages)
2025-12-29T06:34:06.408879789Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - ‚è±Ô∏è [06:34:06.405] üí¨ LLM REQUEST START: 3 conversation turns, 7882 system chars (KB cached)
2025-12-29T06:34:06.408884098Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LLM PROMPT BREAKDOWN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-29T06:34:06.408888829Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù [SYSTEM MSG 1 - GLOBAL PROMPT] (6467 chars):
2025-12-29T06:34:06.408893151Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù   Preview: # Global Prompt: Direct Drive Engine (V4.2 - Acknowledging & Fluid)
2025-12-29T06:34:06.408897865Z [err]  
2025-12-29T06:34:06.408902081Z [err]  When user states income, convert/update as [yearly_income] variable for logic splits.
2025-12-29T06:34:06.408906282Z [err]  
2025-12-29T06:34:06.408910870Z [err]  If user says a name, don't assume it's theirs‚Äîwait for explicit correction.
2025-12-29T06:34:06.409480673Z [err]  
2025-12-29T06:34:06.409483124Z [err]  1. Generate a natural, contextual response
2025-12-29T06:34:06.409490301Z [err]  If asked your state: "Atlanta, GA. Been in Midtown 10 years."
2025-12-29T06:34:06.409494483Z [err]  2. Evaluate transitions per your node instructions
2025-12-29T06:34:06.409499761Z [err]  
2025-12-29T06:34:06.409507352Z [err]  If asked about call number: "Company number."
2025-12-29T06:34:06.409509742Z [err]  
2025-12-29T06:34:06.409517420Z [err]  
2025-12-29T06:34:06.409521215Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-29T06:34:06.409526299Z [err]  User email: {customer_email} (for them: {{customer_email}}).
2025-12-29T06:34:06.409532685Z [err]  PREPROCESSED CONTEXT (to help you prioritize and focus):
2025-12-29T06:34:06.409534807Z [err]  
2025-12-29T06:34:06.409541515Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-29T06:34:06.409542906Z [err]  If explaining ends in peri...
2025-12-29T06:34:06.409550066Z [err]  
2025-12-29T06:34:06.409552785Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù [SYSTEM MSG 2 - DYNAMIC CONTEXT] (1415 chars):
2025-12-29T06:34:06.409557403Z [err]  USER COMMUNICATION STYLE: C type - adjust your response accordingly
2025-12-29T06:34:06.409564207Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù   Preview: 
2025-12-29T06:34:06.409565163Z [err]  CONVERSATION STATUS: Turn 2, objection handling phase
2025-12-29T06:34:06.409572109Z [err]  
2025-12-29T06:34:06.409578901Z [err]  This context is provided to help you focus. You still need to:
2025-12-29T06:34:06.409991572Z [err]  
2025-12-29T06:34:06.410003612Z [err]  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
2025-12-29T06:34:06.410010101Z [err]  
2025-12-29T06:34:06.410014722Z [err]  # CURRENT CONTEXT
2025-12-29T06:34:06.410018690Z [err]  Customer: Kendrick
2025-12-29T06:34:06.410024508Z [err]  Variables: {"now": "Monday, December 29, 2025 at 1:34 AM EST", "customer_name": "Kendrick", "callerName": "", "lead_id": null, "qc_tracking_enabled": false, "track_keywords": "", "expected_commitment": ...
2025-12-29T06:34:06.410028658Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù [CONVERSATION HISTORY] (3 messages)
2025-12-29T06:34:06.410032945Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù   assistant: Kendrick?...
2025-12-29T06:34:06.410037365Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù   user: Hell o....
2025-12-29T06:34:06.410041673Z [err]  2025-12-29 06:34:06,405 - core_calling_service - INFO - üìù ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-29T06:34:06.592715602Z [err]  2025-12-29 06:34:06,591 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:06.592721500Z [err]  2025-12-29 06:34:06,591 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.started', 'id': '77893e76-6817-47e8-a558-2a574cb9736b', 'occurred_at': '2025-12-29T06:34:06.459112Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'kokrxROTAw'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:06.592726508Z [err]  2025-12-29 06:34:06,591 - server - INFO - üéØ Event type: call.playback.started, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:06.592730865Z [err]  2025-12-29 06:34:06,591 - server - INFO - üì® ================================================
2025-12-29T06:34:06.592734685Z [inf]  100.64.0.8:60756 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:06.667623380Z [err]  2025-12-29 06:34:06,642 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:06.667633076Z [err]  2025-12-29 06:34:06,642 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:06.847433723Z [err]  2025-12-29 06:34:06,846 - httpx - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-29T06:34:07.157501738Z [err]  2025-12-29 06:34:07,154 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:07.157505809Z [err]  2025-12-29 06:34:07,154 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:07.232170861Z [err]  2025-12-29 06:34:07,223 - core_calling_service - INFO - ‚è±Ô∏è [06:34:07.223] üí¨ LLM FIRST TOKEN: 817ms (grok grok-4-1-fast-non-reasoning)
2025-12-29T06:34:07.232174613Z [err]  2025-12-29 06:34:07,224 - server - INFO - üì§ Sentence arrived from LLM: [N] Hey Kendrick,...
2025-12-29T06:34:07.232178778Z [err]  2025-12-29 06:34:07,224 - server - INFO - ‚è±Ô∏è [TIMING] TTFS (Time To First Sentence): 1988ms
2025-12-29T06:34:07.232183053Z [err]  2025-12-29 06:34:07,224 - server - INFO - ‚ö° Starting REAL-TIME TTS for first sentence
2025-12-29T06:34:07.232187602Z [err]  2025-12-29 06:34:07,224 - persistent_tts_service - WARNING - ‚ö†Ô∏è  No persistent TTS session found for call v3:vMcJPRuJdZSvQUXZz... (active sessions: [])
2025-12-29T06:34:07.232192896Z [err]  2025-12-29 06:34:07,224 - server - INFO - ‚ö° ON-DEMAND: Creating persistent TTS session (multi-worker mode)
2025-12-29T06:34:07.409963462Z [err]  2025-12-29 06:34:07,311 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:07.409973911Z [err]  2025-12-29 06:34:07,397 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:07.485081090Z [err]  2025-12-29 06:34:07,483 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:07.506845171Z [err]  2025-12-29 06:34:07,503 - telnyx_service - INFO - Telnyx service initialized with connection: 2777245537294877821
2025-12-29T06:34:07.506854663Z [err]  2025-12-29 06:34:07,503 - server - INFO - ‚úÖ ON-DEMAND: Using Telnyx WebSocket from closure for streaming audio
2025-12-29T06:34:07.506859890Z [err]  2025-12-29 06:34:07,503 - persistent_tts_service - INFO - üéôÔ∏è Extracted voice_settings from agent config: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-29T06:34:07.506870429Z [err]  2025-12-29 06:34:07,504 - persistent_tts_service - INFO - üîå [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Establishing persistent TTS WebSocket...
2025-12-29T06:34:07.506874578Z [err]  2025-12-29 06:34:07,504 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Voice settings: {'stability': 0.6, 'similarity_boost': 0.65, 'style': 0.2, 'use_speaker_boost': True}
2025-12-29T06:34:07.506879155Z [err]  2025-12-29 06:34:07,504 - elevenlabs_ws_service - INFO - üîå Connecting to ElevenLabs WebSocket: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5
2025-12-29T06:34:07.506887349Z [err]  2025-12-29 06:34:07,504 - elevenlabs_ws_service - INFO - üéôÔ∏è Voice settings: stability=0.6, similarity=0.65, style=0.2
2025-12-29T06:34:07.644908269Z [err]  2025-12-29 06:34:07,626 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:07.644918874Z [err]  2025-12-29 06:34:07,626 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'eb7b4115-229b-4a83-8198-0640d7270aa5', 'occurred_at': '2025-12-29T06:34:07.339116Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/tts_4837cb141ab1223ca76c9b05a8448cb6.mp3', 'overlay': False, 'playback_id': 'kokrxROTAw', 'status': 'completed', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:07.644926185Z [err]  2025-12-29 06:34:07,626 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.644945764Z [err]  2025-12-29 06:34:07,626 - server - INFO - üì® ================================================
2025-12-29T06:34:07.644952475Z [err]  2025-12-29 06:34:07,630 - elevenlabs_ws_service - INFO - ‚úÖ Connected to ElevenLabs WebSocket
2025-12-29T06:34:07.644958731Z [err]  2025-12-29 06:34:07,631 - elevenlabs_ws_service - INFO - üì§ Sent BOS message with voice settings
2025-12-29T06:34:07.644964499Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - ‚úÖ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Persistent TTS WebSocket established
2025-12-29T06:34:07.644971202Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üéß [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Audio receiver loop started
2025-12-29T06:34:07.644977471Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üîä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Comfort noise loop started
2025-12-29T06:34:07.645865365Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üéµ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Playback consumer started
2025-12-29T06:34:07.645872664Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üéß [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Audio Receiver Loop STARTED
2025-12-29T06:34:07.645874694Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - ‚úÖ Created persistent TTS session for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.645878858Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üíì [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Starting TTS keep-alive loop (every 15s)
2025-12-29T06:34:07.645883024Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üîä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Starting comfort noise loop
2025-12-29T06:34:07.645887559Z [err]  2025-12-29 06:34:07,631 - persistent_tts_service - INFO - üé§ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Streaming sentence #1: [N] Hey Kendrick,...
2025-12-29T06:34:07.645893919Z [err]  2025-12-29 06:34:07,631 - server - INFO - ‚úÖ ON-DEMAND: Persistent TTS session created successfully!
2025-12-29T06:34:07.645901886Z [err]  2025-12-29 06:34:07,631 - server - INFO - üîç Persistent TTS lookup: call_id=v3:vMcJPRuJdZSvQUXZz..., session=FOUND
2025-12-29T06:34:07.645908988Z [err]  2025-12-29 06:34:07,631 - server - INFO - üöÄ Streaming sentence #1 via persistent WebSocket
2025-12-29T06:34:07.645915485Z [err]  2025-12-29 06:34:07,631 - server - INFO - üéµ TTS task #1 started at +406ms
2025-12-29T06:34:07.645920369Z [err]  2025-12-29 06:34:07,631 - server - INFO - ‚è±Ô∏è [TIMING] TTFT_TTS (First TTS Task Started): 2395ms
2025-12-29T06:34:07.645924509Z [err]  2025-12-29 06:34:07,631 - core_calling_service - INFO - üì§ Streamed sentence: [N] Hey Kendrick,...
2025-12-29T06:34:07.646927831Z [err]  2025-12-29 06:34:07,634 - persistent_tts_service - INFO - üöÄ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Sent sentence #2 (NON-BLOCKING) in 0ms
2025-12-29T06:34:07.646938149Z [err]  2025-12-29 06:34:07,632 - persistent_tts_service - INFO - üöÄ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Sent sentence #1 (NON-BLOCKING) in 0ms
2025-12-29T06:34:07.646947029Z [err]  2025-12-29 06:34:07,632 - persistent_tts_service - INFO - üìä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=True, is_last=False
2025-12-29T06:34:07.646954385Z [err]  2025-12-29 06:34:07,632 - server - INFO - üì§ Sentence arrived from LLM: yeah it's me....
2025-12-29T06:34:07.646960932Z [err]  2025-12-29 06:34:07,633 - server - INFO - üîç Persistent TTS lookup: call_id=v3:vMcJPRuJdZSvQUXZz..., session=FOUND
2025-12-29T06:34:07.646967703Z [err]  2025-12-29 06:34:07,633 - server - INFO - üöÄ Streaming sentence #2 via persistent WebSocket
2025-12-29T06:34:07.646977119Z [err]  2025-12-29 06:34:07,633 - server - INFO - üéµ TTS task #2 started at +408ms
2025-12-29T06:34:07.646984887Z [err]  2025-12-29 06:34:07,633 - core_calling_service - INFO - üì§ Streamed sentence: yeah it's me....
2025-12-29T06:34:07.646991918Z [err]  2025-12-29 06:34:07,634 - persistent_tts_service - INFO - üéß [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Receiver processing sentence #1: '[N] Hey Kendrick,...'
2025-12-29T06:34:07.646998272Z [err]  2025-12-29 06:34:07,634 - persistent_tts_service - INFO - üìä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] DIAGNOSTIC: queue_latency=2ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-29T06:34:07.647002575Z [err]  2025-12-29 06:34:07,634 - persistent_tts_service - INFO - üé§ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Streaming sentence #2: yeah it's me....
2025-12-29T06:34:07.647817306Z [err]  2025-12-29 06:34:07,634 - persistent_tts_service - INFO - üìä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] DIAGNOSTIC: pending_sentences=1, audio_queue=0, is_first=False, is_last=False
2025-12-29T06:34:07.647826044Z [err]  2025-12-29 06:34:07,634 - server - INFO - üì§ Sentence arrived from LLM: You there?...
2025-12-29T06:34:07.647833691Z [err]  2025-12-29 06:34:07,634 - server - INFO - üîç Persistent TTS lookup: call_id=v3:vMcJPRuJdZSvQUXZz..., session=FOUND
2025-12-29T06:34:07.647840616Z [err]  2025-12-29 06:34:07,634 - server - INFO - üöÄ Streaming sentence #3 via persistent WebSocket
2025-12-29T06:34:07.647847465Z [err]  2025-12-29 06:34:07,634 - server - INFO - üéµ TTS task #3 started at +410ms
2025-12-29T06:34:07.647854441Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - üì§ Streamed final fragment: You there?...
2025-12-29T06:34:07.647861187Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - ‚è±Ô∏è [TIMING] LLM_TOTAL: 1228ms for 42 chars (grok grok-4-1-fast-non-reasoning)
2025-12-29T06:34:07.647867670Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - üîä Silence tracking reset for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (user responded)
2025-12-29T06:34:07.647876268Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - ‚úÖ User responded to regular message, resetting counter
2025-12-29T06:34:07.647882220Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - üíæ Storing node ID 2 in conversation history
2025-12-29T06:34:07.647886848Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - LLM response (2.31s): [N] Hey Kendrick, yeah it's me. You there?
2025-12-29T06:34:07.647891292Z [err]  2025-12-29 06:34:07,634 - core_calling_service - INFO - Total latency: 2.31s
2025-12-29T06:34:07.647895229Z [err]  2025-12-29 06:34:07,635 - server - INFO - ‚úÖ LLM finished in 2399ms, TTS tasks already running in background
2025-12-29T06:34:07.648665635Z [err]  2025-12-29 06:34:07,635 - server - INFO - üéµ Streaming 3 TTS chunks as they complete...
2025-12-29T06:34:07.648673993Z [err]  2025-12-29 06:34:07,635 - server - INFO - üöÄ Persistent TTS: Audio already streaming in background!
2025-12-29T06:34:07.648681479Z [err]  2025-12-29 06:34:07,635 - server - INFO -    3 sentences queued and playing seamlessly
2025-12-29T06:34:07.648688002Z [err]  2025-12-29 06:34:07,635 - persistent_tts_service - INFO - üé§ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Streaming sentence #3: You there?...
2025-12-29T06:34:07.648694383Z [err]  2025-12-29 06:34:07,636 - persistent_tts_service - INFO - üöÄ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Sent sentence #3 (NON-BLOCKING) in 0ms
2025-12-29T06:34:07.648702123Z [err]  2025-12-29 06:34:07,636 - persistent_tts_service - INFO - üìä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] DIAGNOSTIC: pending_sentences=2, audio_queue=0, is_first=False, is_last=False
2025-12-29T06:34:07.648708786Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚úÖ All 3 persistent TTS streams completed
2025-12-29T06:34:07.648714832Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚úÖ Agent generation complete (persistent TTS) - response window closed
2025-12-29T06:34:07.648724636Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  FIRST AUDIO STARTED: 2400ms from user stop üöÄ
2025-12-29T06:34:07.648732060Z [err]  2025-12-29 06:34:07,636 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.648739183Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚úÖ Agent generation complete - response window closed
2025-12-29T06:34:07.648745565Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-29T06:34:07.649707250Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] ==== E2E LATENCY SUMMARY ====
2025-12-29T06:34:07.649713736Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] STT: 10ms (provider: soniox, model: stt-rt-v3)
2025-12-29T06:34:07.649719728Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] LLM_TOTAL: 2399ms (provider: grok, model: grok-4-1-fast-non-reasoning)
2025-12-29T06:34:07.649723709Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] TTS_TOTAL: 411ms (provider: elevenlabs, websocket: False)
2025-12-29T06:34:07.649727417Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] E2E_TOTAL: 2400ms (user stopped ‚Üí play_audio_url called)
2025-12-29T06:34:07.649731457Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] ‚ö†Ô∏è NOTE: E2E_TOTAL does not include:
2025-12-29T06:34:07.649736375Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING]   - Telnyx processing time (~50-200ms)
2025-12-29T06:34:07.649740177Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING]   - Network latency to user's phone (~50-150ms)
2025-12-29T06:34:07.649743939Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING]   - Phone audio buffering (~50-200ms)
2025-12-29T06:34:07.649748915Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING]   - TOTAL MISSING: ~150-550ms typically
2025-12-29T06:34:07.649752887Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING]   - REAL USER LATENCY: 2700ms estimated
2025-12-29T06:34:07.649756653Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] RESPONSE_TEXT: 42 chars, 3 sentences
2025-12-29T06:34:07.649760736Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] USER_INPUT: 'Hell o....'
2025-12-29T06:34:07.649764720Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] AI_RESPONSE: '[N] Hey Kendrick, yeah it's me. You there?...'
2025-12-29T06:34:07.651023916Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  [TIMING] ==========================
2025-12-29T06:34:07.651025046Z [inf]  100.64.0.10:26842 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:07.651032169Z [err]  2025-12-29 06:34:07,636 - server - INFO - ‚è±Ô∏è  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
2025-12-29T06:34:07.651038106Z [err]  2025-12-29 06:34:07,637 - redis_service - INFO - ‚ûñ Removed playback kokrxROTAw, 0 remaining for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.651044250Z [err]  2025-12-29 06:34:07,637 - server - INFO - üîä Redis: Removed playback kokrxROTAw, 0 remaining
2025-12-29T06:34:07.651050075Z [err]  2025-12-29 06:34:07,637 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-29T06:34:07.651056259Z [err]  2025-12-29 06:34:07,643 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-29T06:34:07.651062060Z [err]  2025-12-29 06:34:07,643 - server - INFO - ‚úÖ Found session in active_telnyx_calls (local worker)
2025-12-29T06:34:07.651069008Z [err]  2025-12-29 06:34:07,643 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766990047.6434727 for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.651075243Z [err]  2025-12-29 06:34:07,643 - server - INFO - ‚è±Ô∏è Silence timer STARTED (fallback, agent wasn't marked as speaking)
2025-12-29T06:34:07.662444253Z [err]  2025-12-29 06:34:07,660 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-29T06:34:07.662456046Z [err]  2025-12-29 06:34:07,660 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766990047.6603491 for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.662462666Z [err]  2025-12-29 06:34:07,660 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:07.835877893Z [err]  2025-12-29 06:34:07,822 - server - INFO - üìù Saved assistant transcript and latency to database (Node: Greeting, Dead Air: 2820ms)
2025-12-29T06:34:07.835890308Z [err]  2025-12-29 06:34:07,822 - server - INFO - üîä Agent finished generating, 0 playbacks active - waiting for webhooks to close window and start silence tracking
2025-12-29T06:34:07.835901673Z [err]  2025-12-29 06:34:07,822 - server - INFO - üîç END CALL CHECK: should_end_call=False, max_checkins=False, max_duration=False
2025-12-29T06:34:07.911205200Z [err]  2025-12-29 06:34:07,883 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-29T06:34:07.911213727Z [err]  2025-12-29 06:34:07,883 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.1s (total: 1.1s from now)
2025-12-29T06:34:07.911219292Z [err]  2025-12-29 06:34:07,883 - persistent_tts_service - INFO - ‚úÖ Sent 56 audio chunks via WebSocket
2025-12-29T06:34:07.911305537Z [err]  2025-12-29 06:34:07,882 - persistent_tts_service - INFO - ‚è±Ô∏è [TIMING] TTFA (Time To First Audio Playback): 250ms
2025-12-29T06:34:07.911309764Z [err]  2025-12-29 06:34:07,883 - persistent_tts_service - INFO - üì§ Sending 8900 bytes of audio (56 chunks, 1.1s duration) via WebSocket
2025-12-29T06:34:08.078820969Z [err]  2025-12-29 06:34:08,060 - persistent_tts_service - INFO - üì§ Sending 7802 bytes of audio (49 chunks, 1.0s duration) via WebSocket
2025-12-29T06:34:08.078830600Z [err]  2025-12-29 06:34:08,060 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-29T06:34:08.078837797Z [err]  2025-12-29 06:34:08,060 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +1.0s (total: 1.9s from now)
2025-12-29T06:34:08.078844395Z [err]  2025-12-29 06:34:08,060 - persistent_tts_service - INFO - ‚úÖ Sent 49 audio chunks via WebSocket
2025-12-29T06:34:08.223040306Z [err]  2025-12-29 06:34:08,221 - persistent_tts_service - INFO - üì§ Sending 5202 bytes of audio (33 chunks, 0.7s duration) via WebSocket
2025-12-29T06:34:08.223052026Z [err]  2025-12-29 06:34:08,221 - persistent_tts_service - INFO - üéôÔ∏è [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] AGENT IS NOW SPEAKING (is_speaking=True)
2025-12-29T06:34:08.223058795Z [err]  2025-12-29 06:34:08,221 - persistent_tts_service - INFO - ‚è±Ô∏è EXTEND playback_expected_end_time: +0.7s (total: 2.4s from now)
2025-12-29T06:34:08.223064425Z [err]  2025-12-29 06:34:08,221 - persistent_tts_service - INFO - ‚úÖ Sent 33 audio chunks via WebSocket
2025-12-29T06:34:08.603450004Z [err]  2025-12-29 06:34:08,598 - server - INFO - üì§ Audio flowing: 301 packets sent to Soniox (5s update)
2025-12-29T06:34:10.227826075Z [err]  2025-12-29 06:34:10,198 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=2.5s, checkin_count=0/2
2025-12-29T06:34:10.227831713Z [err]  2025-12-29 06:34:10,220 - elevenlabs_ws_service - INFO - ‚è±Ô∏è  [TIMING] ElevenLabs audio stream complete (0.5s timeout reached) - End of Sentence
2025-12-29T06:34:10.227839055Z [err]  2025-12-29 06:34:10,221 - persistent_tts_service - INFO - ‚úÖ [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Receiver finished sentence #1: 3 chunks in 2589ms
2025-12-29T06:34:10.227844747Z [err]  2025-12-29 06:34:10,221 - persistent_tts_service - INFO - üéß [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Receiver processing sentence #2: 'yeah it's me....'
2025-12-29T06:34:10.227851369Z [err]  2025-12-29 06:34:10,221 - persistent_tts_service - INFO - üìä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] DIAGNOSTIC: queue_latency=2586ms, pending_sentences=1, audio_queue=0, interrupted=False
2025-12-29T06:34:10.720122171Z [err]  2025-12-29 06:34:10,705 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=3.0s, checkin_count=0/2
2025-12-29T06:34:10.903840293Z [err]  2025-12-29 06:34:10,887 - persistent_tts_service - INFO - üîá [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] FLOOR RELEASED (is_holding_floor=False)
2025-12-29T06:34:12.726776538Z [err]  2025-12-29 06:34:12,721 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-29T06:34:12.726787319Z [err]  2025-12-29 06:34:12,721 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Receiver got 0 chunks for sentence #2! interrupted=False
2025-12-29T06:34:12.726795580Z [err]  2025-12-29 06:34:12,721 - persistent_tts_service - INFO - üéß [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Receiver processing sentence #3: 'You there?...'
2025-12-29T06:34:12.726802875Z [err]  2025-12-29 06:34:12,721 - persistent_tts_service - INFO - üìä [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] DIAGNOSTIC: queue_latency=5085ms, pending_sentences=0, audio_queue=0, interrupted=False
2025-12-29T06:34:13.646626640Z [err]  2025-12-29 06:34:13,618 - server - INFO - üì§ Audio flowing: 552 packets sent to Soniox (5s update)
2025-12-29T06:34:13.708295162Z [err]  2025-12-29 06:34:13,700 - server - INFO - üé§ Soniox receiver alive - 12 messages received in last 10s
2025-12-29T06:34:14.756824153Z [err]  2025-12-29 06:34:14,752 - core_calling_service - INFO - ‚è∞ Check-in triggered after 7.1s silence (threshold: 7s)
2025-12-29T06:34:14.757973884Z [err]  2025-12-29 06:34:14,757 - core_calling_service - INFO - üí¨ Sending check-in #1/2: Are you still there?
2025-12-29T06:34:14.757981553Z [err]  2025-12-29 06:34:14,757 - dead_air_monitor - INFO - üí¨ Sending check-in after 7.1s silence: Are you still there?
2025-12-29T06:34:14.757989253Z [err]  2025-12-29 06:34:14,757 - core_calling_service - INFO - ü§ñ Agent started speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:14.757995702Z [err]  2025-12-29 06:34:14,757 - telnyx_service - INFO - üîä Speaking text on call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ: Are you still there?...
2025-12-29T06:34:14.758004048Z [err]  2025-12-29 06:34:14,757 - telnyx_service - INFO - üîç Agent config provided: True
2025-12-29T06:34:14.758011287Z [err]  2025-12-29 06:34:14,757 - telnyx_service - INFO - üîç TTS provider from settings: elevenlabs
2025-12-29T06:34:14.758018178Z [err]  2025-12-29 06:34:14,757 - telnyx_service - INFO - üîç WebSocket TTS: False
2025-12-29T06:34:14.758024643Z [err]  2025-12-29 06:34:14,757 - telnyx_service - INFO - üéôÔ∏è Attempting elevenlabs TTS (REST)
2025-12-29T06:34:14.758797150Z [err]  2025-12-29 06:34:14,757 - server - INFO - ‚è±Ô∏è [06:34:14.757] üîä TTS REQUEST START: provider=elevenlabs, user=dcafa642, comfort_noise=True
2025-12-29T06:34:14.758804776Z [err]  2025-12-29 06:34:14,757 - server - INFO - ‚ö° Using Turbo v2.5 (high quality)
2025-12-29T06:34:14.758809189Z [err]  2025-12-29 06:34:14,757 - server - INFO - üéôÔ∏è ElevenLabs streaming TTS: voice=J5iaaqzR5zn6HFG4jV3b, model=eleven_turbo_v2_5, speed=1.1, normalization=on, ssml=True
2025-12-29T06:34:14.833891210Z [err]  2025-12-29 06:34:14,810 - server - INFO - üìû Telnyx WebSocket disconnected. Sent 603 total packets
2025-12-29T06:34:14.833899436Z [err]  [2025-12-29 06:34:14 +0000] [6] [INFO] connection closed
2025-12-29T06:34:14.845416682Z [err]  2025-12-29 06:34:14,844 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:14.845426721Z [err]  2025-12-29 06:34:14,844 - server - INFO - üì¶ ElevenLabs Request Payload:
2025-12-29T06:34:14.845434755Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Text length: 20 chars
2025-12-29T06:34:14.845442134Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Text content: 'Are you still there?'
2025-12-29T06:34:14.845448519Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Text bytes: b'Are you still there?'
2025-12-29T06:34:14.845455319Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Model: eleven_turbo_v2_5
2025-12-29T06:34:14.845461318Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Voice ID: J5iaaqzR5zn6HFG4jV3b
2025-12-29T06:34:14.845467241Z [err]  2025-12-29 06:34:14,844 - server - INFO -    URL: https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream
2025-12-29T06:34:14.845473536Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Full data: {'text': 'Are you still there?', 'model_id': 'eleven_turbo_v2_5', 'voice_settings': {'stability': 0.6, 'similarity_boost': 0.65, 'use_speaker_boost': True, 'speed': 1.1, 'style': 0.2}, 'apply_text_normalization': 'on', 'enable_ssml_parsing': True, 'optimize_streaming_latency': 4}
2025-12-29T06:34:14.845479782Z [err]  2025-12-29 06:34:14,844 - server - INFO - üîå Attempting ElevenLabs connection (attempt 1/2)
2025-12-29T06:34:14.845487028Z [err]  2025-12-29 06:34:14,844 - server - INFO -    Timeout: 10.0s
2025-12-29T06:34:14.856771595Z [err]  2025-12-29 06:34:14,853 - server - INFO -    ‚úì HTTP client created (0.009s)
2025-12-29T06:34:14.856779050Z [err]  2025-12-29 06:34:14,853 - server - INFO -    ‚Üí Sending POST request to ElevenLabs (optimize_latency=0)...
2025-12-29T06:34:14.973789163Z [err]  2025-12-29 06:34:14,956 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:14.973793637Z [err]  2025-12-29 06:34:14,956 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.hangup', 'id': '205bd6fd-726c-4c0b-b979-d71e44dbea89', 'occurred_at': '2025-12-29T06:34:14.619117Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_quality_stats': {'inbound': {'jitter_max_variance': '18.46', 'jitter_packet_count': '0', 'mos': '4.50', 'packet_count': '662', 'skip_packet_count': '18'}, 'outbound': {'packet_count': '604', 'skip_packet_count': '0'}}, 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-29T06:34:14.619117Z', 'from': '+14048000152', 'hangup_cause': 'normal_clearing', 'hangup_source': 'callee', 'sip_hangup_cause': '200', 'start_time': '2025-12-29T06:33:52.699118Z', 'to': '+17708336397'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:14.973798092Z [err]  2025-12-29 06:34:14,956 - server - INFO - üéØ Event type: call.hangup, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:14.973801990Z [err]  2025-12-29 06:34:14,956 - server - INFO - üì® ================================================
2025-12-29T06:34:14.973806207Z [err]  2025-12-29 06:34:14,956 - server - INFO - üìû Call ended: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:14.973811055Z [err]  2025-12-29 06:34:14,956 - server - INFO - üìû Hangup cause: normal_clearing
2025-12-29T06:34:14.973815056Z [err]  2025-12-29 06:34:14,968 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:14.973819111Z [err]  2025-12-29 06:34:14,968 - server - INFO - üì® Full payload: {'data': {'event_type': 'streaming.stopped', 'id': '3d67b664-4d5f-4d13-8e80-920d627565f8', 'occurred_at': '2025-12-29T06:34:14.732274Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'stream_id': '8405acc8-87e1-43ae-830d-2799f0e9bb6b', 'stream_params': {'stream_track': 'inbound', 'stream_url': 'wss://api.li-ai.org/api/telnyx/audio-stream'}, 'stream_type': 'websocket'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:14.974313254Z [err]  2025-12-29 06:34:14,968 - server - INFO - üéØ Event type: streaming.stopped, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:14.974319727Z [err]  2025-12-29 06:34:14,968 - server - INFO - üì® ================================================
2025-12-29T06:34:14.974326050Z [inf]  100.64.0.10:60304 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:15.070318780Z [err]  2025-12-29 06:34:15,067 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:15.070326251Z [err]  2025-12-29 06:34:15,067 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.playback.ended', 'id': 'c3749de2-95b6-48aa-9827-fb23e9af1803', 'occurred_at': '2025-12-29T06:34:14.699130Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-29T06:34:14.699130Z', 'media_name': None, 'media_url': 'api.li-ai.org/api/tts-audio/comfort_noise_continuous.mp3', 'overlay': True, 'playback_id': 'w-ZBgQcpXQ', 'status': 'call_hangup', 'status_detail': ''}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:15.070332095Z [err]  2025-12-29 06:34:15,067 - server - INFO - üéØ Event type: call.playback.ended, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:15.070338322Z [err]  2025-12-29 06:34:15,067 - server - INFO - üì® ================================================
2025-12-29T06:34:15.081958006Z [err]  2025-12-29 06:34:15,077 - redis_service - INFO - ‚ûñ Removed playback w-ZBgQcpXQ, 0 remaining for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:15.081965410Z [err]  2025-12-29 06:34:15,077 - server - INFO - üîä Redis: Removed playback w-ZBgQcpXQ, 0 remaining
2025-12-29T06:34:15.081971256Z [err]  2025-12-29 06:34:15,077 - server - INFO - üîä ALL PLAYBACKS FINISHED (via Redis) - attempting to start silence timer
2025-12-29T06:34:15.083287523Z [err]  2025-12-29 06:34:15,082 - server - INFO - ‚úÖ Set 'agent_done_speaking' flag in Redis for worker with session to detect
2025-12-29T06:34:15.083296249Z [err]  2025-12-29 06:34:15,082 - server - INFO - ‚úÖ Found session in active_telnyx_calls (local worker)
2025-12-29T06:34:15.083303733Z [err]  2025-12-29 06:34:15,082 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766990055.0827272 for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:15.083310130Z [err]  2025-12-29 06:34:15,082 - server - INFO - ‚è±Ô∏è Silence timer STARTED (fallback, agent wasn't marked as speaking)
2025-12-29T06:34:15.084327314Z [inf]  100.64.0.9:24418 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:15.159358437Z [err]  2025-12-29 06:34:15,140 - server - INFO - üìù Updated call log: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:15.171235911Z [err]  2025-12-29 06:34:15,166 - httpx - INFO - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/J5iaaqzR5zn6HFG4jV3b/stream "HTTP/1.1 200 OK"
2025-12-29T06:34:15.171245468Z [err]  2025-12-29 06:34:15,166 - server - INFO -    ‚úì Connection established (0.322s) [TARGET: <200ms]
2025-12-29T06:34:15.171253291Z [err]  2025-12-29 06:34:15,166 - server - INFO -    ‚úì Response status: 200
2025-12-29T06:34:15.171260189Z [err]  2025-12-29 06:34:15,166 - server - INFO -    ‚Üí Streaming audio chunks...
2025-12-29T06:34:15.182248961Z [err]  2025-12-29 06:34:15,180 - server - INFO - ‚è±Ô∏è [06:34:15.179] üîä TTS COMPLETE: 422ms, audio_size=17181 bytes
2025-12-29T06:34:15.182258558Z [err]  2025-12-29 06:34:15,180 - server - INFO - üíæ TTS CACHED: elevenlabs:Are you still there?... (17181 bytes)
2025-12-29T06:34:15.182267265Z [err]  2025-12-29 06:34:15,180 - telnyx_service - INFO - ‚è±Ô∏è  TTS generation time: 0.42s
2025-12-29T06:34:15.182277346Z [err]  2025-12-29 06:34:15,176 - server - INFO -    ‚úì FIRST CHUNK received (0.331s, 996 bytes) [TARGET: <300ms]
2025-12-29T06:34:15.182277823Z [err]  2025-12-29 06:34:15,180 - telnyx_service - INFO - ‚úÖ Generated 17181 bytes, saved to /tmp/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-29T06:34:15.182286418Z [err]  2025-12-29 06:34:15,179 - server - INFO -    ‚úì ALL CHUNKS received: 60 chunks (0.335s)
2025-12-29T06:34:15.182293232Z [err]  2025-12-29 06:34:15,179 - server - INFO -    ‚úì Total audio size: 17181 bytes
2025-12-29T06:34:15.182299845Z [err]  2025-12-29 06:34:15,179 - server - INFO -    üìä TTS API TIMING BREAKDOWN:
2025-12-29T06:34:15.182300805Z [err]  2025-12-29 06:34:15,180 - telnyx_service - INFO - üîó Using audio URL: api.li-ai.org/api/tts-audio/tts_59aded63200fa5fb87dd5793c8f91482.mp3
2025-12-29T06:34:15.182306939Z [err]  2025-12-29 06:34:15,179 - server - INFO -       - Connection: 322ms
2025-12-29T06:34:15.182313917Z [err]  2025-12-29 06:34:15,179 - server - INFO -       - First chunk: 331ms
2025-12-29T06:34:15.182320465Z [err]  2025-12-29 06:34:15,179 - server - INFO -       - All chunks: 335ms
2025-12-29T06:34:15.182327640Z [err]  2025-12-29 06:34:15,179 - server - INFO -       - Audio generation only: 9ms
2025-12-29T06:34:15.224923433Z [err]  2025-12-29 06:34:15,221 - elevenlabs_ws_service - WARNING - ‚ö†Ô∏è  [TIMING] ElevenLabs timeout waiting for first chunk (2.5s) - No audio received!
2025-12-29T06:34:15.224927717Z [err]  2025-12-29 06:34:15,221 - persistent_tts_service - WARNING - ‚ö†Ô∏è [Call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ] Receiver got 0 chunks for sentence #3! interrupted=False
2025-12-29T06:34:15.236076204Z [err]  2025-12-29 06:34:15,234 - server - INFO - ‚úÖ Finalized call log: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ (duration=12s, status=completed)
2025-12-29T06:34:15.564386605Z [err]        "title": "Call has already ended",
2025-12-29T06:34:15.564397846Z [err]        "detail": "This call is no longer active and can't receive commands."
2025-12-29T06:34:15.564406702Z [err]      }
2025-12-29T06:34:15.564416979Z [err]    ]
2025-12-29T06:34:15.564418420Z [err]  2025-12-29 06:34:15,479 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ/actions/playback_start "HTTP/1.1 422 Unprocessable Entity"
2025-12-29T06:34:15.564427639Z [err]  2025-12-29 06:34:15,479 - telnyx_service - INFO - ‚è±Ô∏è  Playback API call time: 0.30s
2025-12-29T06:34:15.564428292Z [err]  }
2025-12-29T06:34:15.564436278Z [err]  2025-12-29 06:34:15,479 - telnyx_service - ERROR - ‚ùå Telnyx playback failed: 422 - {
2025-12-29T06:34:15.564438942Z [err]  2025-12-29 06:34:15,479 - telnyx_service - INFO - üì¢ Using Telnyx built-in TTS
2025-12-29T06:34:15.564444272Z [err]    "errors": [
2025-12-29T06:34:15.564452449Z [err]      {
2025-12-29T06:34:15.564459992Z [err]        "code": "90018",
2025-12-29T06:34:15.749277962Z [err]  2025-12-29 06:34:15,744 - httpx - INFO - HTTP Request: POST https://api.telnyx.com/v2/calls/v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ/actions/speak "HTTP/1.1 422 Unprocessable Entity"
2025-12-29T06:34:15.749288437Z [err]  2025-12-29 06:34:15,744 - telnyx_service - ERROR - ‚ùå Error speaking text: Error code: 422 - {'errors': [{'code': '90018', 'title': 'Call has already ended', 'detail': "This call is no longer active and can't receive commands."}]}
2025-12-29T06:34:15.749295881Z [err]  2025-12-29 06:34:15,744 - dead_air_monitor - INFO - ‚úÖ Check-in message sent
2025-12-29T06:34:15.991071042Z [err]  2025-12-29 06:34:15,937 - server - INFO - üìä Auto-added call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ to campaign b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8
2025-12-29T06:34:16.134155297Z [err]  2025-12-29 06:34:16,119 - server - INFO - üì§ Sending post-call webhook to: https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b
2025-12-29T06:34:16.134165158Z [err]  2025-12-29 06:34:16,125 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.134169819Z [err]  2025-12-29 06:34:16,125 - server - INFO - üìá [HANGUP] Data source: redis=Yes, memory=Yes
2025-12-29T06:34:16.134173905Z [err]  2025-12-29 06:34:16,125 - server - INFO - üìá [HANGUP] Missing data from cache, checking MongoDB call_logs...
2025-12-29T06:34:16.210920306Z [err]  2025-12-29 06:34:16,202 - server - INFO - üì® ========== TELNYX WEBHOOK RECEIVED ==========
2025-12-29T06:34:16.210926364Z [err]  2025-12-29 06:34:16,202 - server - INFO - üì® Full payload: {'data': {'event_type': 'call.recording.saved', 'id': 'e4df60ac-c180-4be1-b730-b95baf7ad457', 'occurred_at': '2025-12-29T06:34:16.007249Z', 'payload': {'call_control_id': 'v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ', 'call_leg_id': '579f9f4e-e480-11f0-976a-02420aef981f', 'call_session_id': '579cf794-e480-11f0-b7e9-02420aef981f', 'channels': 'dual', 'client_state': None, 'connection_id': '2777245537294877821', 'end_time': '2025-12-29T06:34:14.704257Z', 'format': 'mp3', 'public_recording_urls': {}, 'recording_ended_at': '2025-12-29T06:34:14.704257Z', 'recording_id': '3a310857-0e30-40c7-ac24-a7833486b0ec', 'recording_started_at': '2025-12-29T06:34:03.472154Z', 'recording_urls': {'mp3': 'https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-29/579f9f4e-e480-11f0-976a-02420aef981f-1766990043424319.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251229%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251229T063415Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=96ffb4c843142d808c8ceaf738658599f7f9d9c27e0b2380b5d13c58bb5767ed'}, 'start_time': '2025-12-29T06:34:03.472154Z'}, 'record_type': 'event'}, 'meta': {'attempt': 1, 'delivered_to': 'https://api.li-ai.org/api/telnyx/webhook'}}
2025-12-29T06:34:16.210932943Z [err]  2025-12-29 06:34:16,202 - server - INFO - üéØ Event type: call.recording.saved, Call ID: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.210938932Z [err]  2025-12-29 06:34:16,202 - server - INFO - üì® ================================================
2025-12-29T06:34:16.210944772Z [err]  2025-12-29 06:34:16,202 - server - INFO - üéôÔ∏è Recording saved for call: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.210950676Z [err]  2025-12-29 06:34:16,207 - redis_service - INFO - üì• Retrieved call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.211511186Z [err]  2025-12-29 06:34:16,207 - server - INFO - üîç Recording check: download_url=True, channels=dual, recording_id=3a310857-0e30-40c7-ac24-a7833486b0ec, call_data=True
2025-12-29T06:34:16.218256606Z [err]  2025-12-29 06:34:16,217 - server - INFO - üìá [HANGUP] Found call_log in MongoDB, extracting missing data...
2025-12-29T06:34:16.259131807Z [err]  2025-12-29 06:34:16,249 - dead_air_monitor - INFO - üö© Detected 'agent_done_speaking' flag from webhook - marking agent as done
2025-12-29T06:34:16.259138235Z [err]  2025-12-29 06:34:16,250 - core_calling_service - INFO - ‚è±Ô∏è SILENCE TIMER STARTED at 1766990056.2499933 for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.259142661Z [err]  2025-12-29 06:34:16,250 - core_calling_service - INFO - ü§ñ Agent stopped speaking for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.334784097Z [err]  2025-12-29 06:34:16,300 - server - INFO - üíæ Saved recording URL and ID to database: 3a310857-0e30-40c7-ac24-a7833486b0ec
2025-12-29T06:34:16.334790988Z [err]  2025-12-29 06:34:16,301 - server - INFO - ‚úÖ Entering dual-channel processing
2025-12-29T06:34:16.334797422Z [err]  2025-12-29 06:34:16,301 - server - INFO - üì• Downloading DUAL-CHANNEL recording...
2025-12-29T06:34:16.334804072Z [err]  2025-12-29 06:34:16,304 - server - INFO - üìá [HANGUP] After MongoDB fallback: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397
2025-12-29T06:34:16.334810343Z [err]  2025-12-29 06:34:16,304 - server - INFO - üìá [HANGUP] Final extracted data: user_id=dcafa642-6136-4096-b77d-a4cb99a62651, agent_id=bbeda238-e8d9-4d8c-b93b-1b7694581adb, to_number=+17708336397, lead_id=None, agent_name=JK First Caller-optimizer3
2025-12-29T06:34:16.334817881Z [err]  2025-12-29 06:34:16,304 - server - INFO - üìá [HANGUP] Agent info keys: None
2025-12-29T06:34:16.334824522Z [err]  2025-12-29 06:34:16,304 - server - INFO - üöÄ Triggered QC analysis for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.334830377Z [err]  2025-12-29 06:34:16,304 - server - INFO - üìä Triggered Campaign QC for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.334836421Z [err]  2025-12-29 06:34:16,304 - server - INFO - üìá Triggered CRM update for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.334844654Z [err]  2025-12-29 06:34:16,304 - server - INFO - ‚úÖ Closed persistent TTS session for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.334851467Z [err]  2025-12-29 06:34:16,309 - redis_service - INFO - üßπ Deleted call data from Redis: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.334857351Z [err]  2025-12-29 06:34:16,309 - server - INFO - üßπ Cleaned up call session from Redis and memory: v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.335370443Z [inf]  100.64.0.8:25084 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:16.335376239Z [err]  2025-12-29 06:34:16,310 - server - INFO - üîç Starting QC analysis for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.335380514Z [err]  2025-12-29 06:34:16,310 - server - INFO - üîç [AUTO-QC] Starting campaign QC check for call=v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ, user=dcafa642-6136-4096-b77d-a4cb99a62651, agent=bbeda238-e8d9-4d8c-b93b-1b7694581adb
2025-12-29T06:34:16.335384916Z [err]  2025-12-29 06:34:16,311 - server - INFO - üìá CRM update starting for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ: to_number=+17708336397, user_id=dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-29T06:34:16.335388804Z [err]  2025-12-29 06:34:16,311 - server - INFO - üìá Normalized phone: +17708336397
2025-12-29T06:34:16.410182732Z [err]  2025-12-29 06:34:16,401 - server - INFO - üìù Converted transcript from 3 messages to 88 characters
2025-12-29T06:34:16.581583097Z [err]  2025-12-29 06:34:16,497 - key_encryption - WARNING - Failed to decrypt key, assuming unencrypted: 
2025-12-29T06:34:16.587300932Z [err]  2025-12-29 06:34:16,584 - httpx - INFO - HTTP Request: POST https://n8n.outlier-agency.com/webhook/2adb150a-9e08-4053-9fa4-e47df18bf39b "HTTP/1.1 200 OK"
2025-12-29T06:34:16.587307516Z [err]  2025-12-29 06:34:16,584 - server - INFO - ‚úÖ Post-call webhook sent successfully (status=200)
2025-12-29T06:34:16.587311408Z [err]  2025-12-29 06:34:16,585 - qc_agents.orchestrator - INFO - No QC agent configs found, using defaults with API key
2025-12-29T06:34:16.609953803Z [err]  2025-12-29 06:34:16,603 - httpx - INFO - HTTP Request: GET https://s3.amazonaws.com/telephony-recorder-prod/227803fb-1717-407d-9bd5-fd04aa27c656/2025-12-29/579f9f4e-e480-11f0-976a-02420aef981f-1766990043424319.mp3?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASDC5E2MJDPKMH7UW%2F20251229%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251229T063415Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=96ffb4c843142d808c8ceaf738658599f7f9d9c27e0b2380b5d13c58bb5767ed "HTTP/1.1 200 OK"
2025-12-29T06:34:16.672742800Z [err]  2025-12-29 06:34:16,671 - qc_agents.orchestrator - INFO - Using QC model: gpt-4o
2025-12-29T06:34:16.672760824Z [err]  2025-12-29 06:34:16,672 - qc_agents.orchestrator - INFO - ‚úÖ Initialized 3 QC agents for user dcafa642-6136-4096-b77d-a4cb99a62651
2025-12-29T06:34:16.672767961Z [err]  2025-12-29 06:34:16,672 - qc_agents.orchestrator - INFO - üîç Running Commitment Detector on call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:16.694578087Z [err]  2025-12-29 06:34:16,689 - server - INFO - ‚úÖ Downloaded 45391 bytes
2025-12-29T06:34:16.883940387Z [err]  2025-12-29 06:34:16,866 - server - INFO - üìá CRM: Total variables collected: []
2025-12-29T06:34:16.883950337Z [err]  2025-12-29 06:34:16,866 - server - INFO - ‚úÖ Split into 2 channels
2025-12-29T06:34:16.883966082Z [err]  2025-12-29 06:34:16,866 - server - INFO - üé§ Using STT provider: soniox for interruption detection
2025-12-29T06:34:16.883972211Z [err]  2025-12-29 06:34:16,867 - server - INFO - üìä Channel 0: 245564 bytes
2025-12-29T06:34:16.883978548Z [err]  2025-12-29 06:34:16,867 - server - ERROR - ‚ùå No Soniox API key available
2025-12-29T06:34:16.883986177Z [err]  2025-12-29 06:34:16,867 - server - INFO - ‚ùå Channel 0: No speech
2025-12-29T06:34:16.884000861Z [err]  2025-12-29 06:34:16,867 - server - INFO - üìä Channel 1: 245564 bytes
2025-12-29T06:34:16.884006661Z [err]  2025-12-29 06:34:16,867 - server - ERROR - ‚ùå No Soniox API key available
2025-12-29T06:34:16.884013433Z [err]  2025-12-29 06:34:16,867 - server - INFO - ‚ùå Channel 1: No speech
2025-12-29T06:34:16.884022990Z [err]  2025-12-29 06:34:16,867 - server - WARNING - ‚ö†Ô∏è No speech in any channel
2025-12-29T06:34:16.884030735Z [inf]  100.64.0.9:24418 - "POST /api/telnyx/webhook HTTP/1.1" 200
2025-12-29T06:34:16.884036960Z [err]  2025-12-29 06:34:16,879 - server - INFO - üîç [AUTO-QC] Call log found: transcript_turns=3, logs_count=4, status=completed
2025-12-29T06:34:17.047650055Z [err]  2025-12-29 06:34:17,043 - server - INFO - üìá CRM: Updated lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e (+17708336397) - fields: ['updated_at', 'last_contact', 'last_agent_id', 'last_agent_name']
2025-12-29T06:34:17.320491435Z [err]  2025-12-29 06:34:17,216 - qc_agents.commitment_detector - ERROR - Error in CommitmentDetector LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-29T06:34:17.320500892Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2025-12-29T06:34:17.320507563Z [err]  2025-12-29 06:34:17,217 - qc_agents.orchestrator - INFO - üó∫Ô∏è  Running Conversion Pathfinder on call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:17.320512269Z [err]  2025-12-29 06:34:17,312 - server - INFO - üîç [AUTO-QC] Agent found: name=JK First Caller-optimizer3, has_auto_qc_settings=True
2025-12-29T06:34:17.320541305Z [err]  2025-12-29 06:34:17,215 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-12-29T06:34:17.320547859Z [err]  2025-12-29 06:34:17,216 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-29T06:34:17.320553762Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-29T06:34:17.576834685Z [err]  2025-12-29 06:34:17,399 - server - INFO - üìä [AUTO-QC] Running full QC analysis: call=v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ ‚Üí campaign=b7bd9ce7-2722-4c61-a2fc-ca1fb127d7b8 (tech=True, script=True, tonality=True)
2025-12-29T06:34:17.576838594Z [err]  2025-12-29 06:34:17,399 - server - INFO - üìä [AUTO-QC] LLM settings: provider=grok, model=grok-3
2025-12-29T06:34:17.576842309Z [err]  2025-12-29 06:34:17,400 - server - ERROR - ‚ùå [AUTO-QC] Error in campaign QC for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-29T06:34:17.576848071Z [err]  2025-12-29 06:34:17,400 - server - ERROR - ‚ùå [AUTO-QC] Traceback: Traceback (most recent call last):
2025-12-29T06:34:17.576854226Z [err]    File "/app/backend/server.py", line 9759, in trigger_campaign_qc_for_call
2025-12-29T06:34:17.576860286Z [err]      await run_full_qc_analysis(
2025-12-29T06:34:17.576866486Z [err]            ^^^^^^^^^^^^^^^^^^^^^
2025-12-29T06:34:17.576872271Z [err]  TypeError: run_full_qc_analysis() got an unexpected keyword argument 'llm_provider'
2025-12-29T06:34:17.576878442Z [err]  
2025-12-29T06:34:17.876114797Z [err]  2025-12-29 06:34:17,859 - qc_agents.orchestrator - INFO - ‚≠ê Running Excellence Replicator on call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:17.876145439Z [err]  2025-12-29 06:34:17,858 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-12-29T06:34:17.876150181Z [err]  2025-12-29 06:34:17,859 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-29T06:34:17.876154752Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-29T06:34:17.876158579Z [err]  2025-12-29 06:34:17,859 - qc_agents.conversion_pathfinder - ERROR - Error in ConversionPathfinder LLM analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-29T06:34:17.876162292Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429, falling back to patterns
2025-12-29T06:34:18.031670082Z [err]  2025-12-29 06:34:18,031 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-12-29T06:34:18.032758226Z [err]  2025-12-29 06:34:18,031 - qc_agents.base_agent - ERROR - Error calling LLM (openai): Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-29T06:34:18.032765434Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-29T06:34:18.032771816Z [err]  2025-12-29 06:34:18,031 - qc_agents.excellence_replicator - ERROR - Error in ExcellenceReplicator analysis: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
2025-12-29T06:34:18.032778413Z [err]  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-12-29T06:34:18.174726867Z [err]  2025-12-29 06:34:18,126 - qc_agents.orchestrator - INFO - ‚úÖ QC analysis stored for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:18.174732857Z [err]  2025-12-29 06:34:18,126 - server - INFO - ‚úÖ QC analysis completed for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:18.174736763Z [err]  2025-12-29 06:34:18,126 - server - INFO - üìä Scores: Commitment=50, Conversion=0, Excellence=50
2025-12-29T06:34:18.322191340Z [err]  2025-12-29 06:34:18,312 - server - INFO - üìä Updated campaign_calls with QC scores for v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ
2025-12-29T06:34:18.581922669Z [err]  2025-12-29 06:34:18,488 - server - INFO - üìà Synced QC scores to lead 288a0e8e-ff8b-4249-b2ea-b84e5cb9929e via phone match
2025-12-29T06:34:18.581927036Z [err]  2025-12-29 06:34:18,575 - server - INFO - üè∑Ô∏è Updated lead status to 'needs_followup' based on risk level 'high'
2025-12-29T06:34:18.581931168Z [err]  2025-12-29 06:34:18,575 - server - ERROR - ‚ùå Error in auto appointment detection for call v3:vMcJPRuJdZSvQUXZzwAlAqkp-ZFhEQ5Z7ZNslNDe6q2qio3aYVjCdQ: 'str' object has no attribute 'get'
2025-12-29T06:34:20.302480129Z [err]  2025-12-29 06:34:20,297 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=4.0s, checkin_count=1/2
2025-12-29T06:34:20.867756802Z [err]  2025-12-29 06:34:20,803 - dead_air_monitor - INFO - üîç MONITOR: agent_speaking=False, user_speaking=False, silence=4.6s, checkin_count=1/2